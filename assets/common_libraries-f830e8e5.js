var n$4,l$4,u$4,i$1,r$4,o$1,e$4,f$3,c$3,s$1,a$1,h$5,p$5={},v$4=[],y$2=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,w$4=Array.isArray;function d$3(te,ee){for(var re in ee)te[re]=ee[re];return te}function g$4(te){te&&te.parentNode&&te.parentNode.removeChild(te)}function _$1(te,ee,re){var ne,ie,oe,fe={};for(oe in ee)oe=="key"?ne=ee[oe]:oe=="ref"?ie=ee[oe]:fe[oe]=ee[oe];if(arguments.length>2&&(fe.children=arguments.length>3?n$4.call(arguments,2):re),typeof te=="function"&&te.defaultProps!=null)for(oe in te.defaultProps)fe[oe]===void 0&&(fe[oe]=te.defaultProps[oe]);return m$4(te,fe,ne,ie,null)}function m$4(te,ee,re,ne,ie){var oe={type:te,props:ee,key:re,ref:ne,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:ie??++u$4,__i:-1,__u:0};return ie==null&&l$4.vnode!=null&&l$4.vnode(oe),oe}function b$3(){return{current:null}}function k$5(te){return te.children}function x$3(te,ee){this.props=te,this.context=ee}function S(te,ee){if(ee==null)return te.__?S(te.__,te.__i+1):null;for(var re;ee<te.__k.length;ee++)if((re=te.__k[ee])!=null&&re.__e!=null)return re.__e;return typeof te.type=="function"?S(te):null}function C$2(te){var ee,re;if((te=te.__)!=null&&te.__c!=null){for(te.__e=te.__c.base=null,ee=0;ee<te.__k.length;ee++)if((re=te.__k[ee])!=null&&re.__e!=null){te.__e=te.__c.base=re.__e;break}return C$2(te)}}function M$1(te){(!te.__d&&(te.__d=!0)&&i$1.push(te)&&!$$1.__r++||r$4!=l$4.debounceRendering)&&((r$4=l$4.debounceRendering)||o$1)($$1)}function $$1(){for(var te,ee,re,ne,ie,oe,fe,ue=1;i$1.length;)i$1.length>ue&&i$1.sort(e$4),te=i$1.shift(),ue=i$1.length,te.__d&&(re=void 0,ie=(ne=(ee=te).__v).__e,oe=[],fe=[],ee.__P&&((re=d$3({},ne)).__v=ne.__v+1,l$4.vnode&&l$4.vnode(re),O$1(ee.__P,re,ne,ee.__n,ee.__P.namespaceURI,32&ne.__u?[ie]:null,oe,ie??S(ne),!!(32&ne.__u),fe),re.__v=ne.__v,re.__.__k[re.__i]=re,z$3(oe,re,fe),re.__e!=ie&&C$2(re)));$$1.__r=0}function I$1(te,ee,re,ne,ie,oe,fe,ue,ae,se,ce){var le,pe,de,me,ve,we,ge=ne&&ne.__k||v$4,_e=ee.length;for(ae=P$3(re,ee,ge,ae,_e),le=0;le<_e;le++)(de=re.__k[le])!=null&&(pe=de.__i==-1?p$5:ge[de.__i]||p$5,de.__i=le,we=O$1(te,de,pe,ie,oe,fe,ue,ae,se,ce),me=de.__e,de.ref&&pe.ref!=de.ref&&(pe.ref&&q$6(pe.ref,null,de),ce.push(de.ref,de.__c||me,de)),ve==null&&me!=null&&(ve=me),4&de.__u||pe.__k===de.__k?ae=A$3(de,ae,te):typeof de.type=="function"&&we!==void 0?ae=we:me&&(ae=me.nextSibling),de.__u&=-7);return re.__e=ve,ae}function P$3(te,ee,re,ne,ie){var oe,fe,ue,ae,se,ce=re.length,le=ce,pe=0;for(te.__k=new Array(ie),oe=0;oe<ie;oe++)(fe=ee[oe])!=null&&typeof fe!="boolean"&&typeof fe!="function"?(ae=oe+pe,(fe=te.__k[oe]=typeof fe=="string"||typeof fe=="number"||typeof fe=="bigint"||fe.constructor==String?m$4(null,fe,null,null,null):w$4(fe)?m$4(k$5,{children:fe},null,null,null):fe.constructor==null&&fe.__b>0?m$4(fe.type,fe.props,fe.key,fe.ref?fe.ref:null,fe.__v):fe).__=te,fe.__b=te.__b+1,ue=null,(se=fe.__i=L$1(fe,re,ae,le))!=-1&&(le--,(ue=re[se])&&(ue.__u|=2)),ue==null||ue.__v==null?(se==-1&&(ie>ce?pe--:ie<ce&&pe++),typeof fe.type!="function"&&(fe.__u|=4)):se!=ae&&(se==ae-1?pe--:se==ae+1?pe++:(se>ae?pe--:pe++,fe.__u|=4))):te.__k[oe]=null;if(le)for(oe=0;oe<ce;oe++)(ue=re[oe])!=null&&!(2&ue.__u)&&(ue.__e==ne&&(ne=S(ue)),B$2(ue,ue));return ne}function A$3(te,ee,re){var ne,ie;if(typeof te.type=="function"){for(ne=te.__k,ie=0;ne&&ie<ne.length;ie++)ne[ie]&&(ne[ie].__=te,ee=A$3(ne[ie],ee,re));return ee}te.__e!=ee&&(ee&&te.type&&!re.contains(ee)&&(ee=S(te)),re.insertBefore(te.__e,ee||null),ee=te.__e);do ee=ee&&ee.nextSibling;while(ee!=null&&ee.nodeType==8);return ee}function H$1(te,ee){return ee=ee||[],te==null||typeof te=="boolean"||(w$4(te)?te.some(function(re){H$1(re,ee)}):ee.push(te)),ee}function L$1(te,ee,re,ne){var ie,oe,fe=te.key,ue=te.type,ae=ee[re];if(ae===null&&te.key==null||ae&&fe==ae.key&&ue==ae.type&&!(2&ae.__u))return re;if(ne>(ae!=null&&!(2&ae.__u)?1:0))for(ie=re-1,oe=re+1;ie>=0||oe<ee.length;){if(ie>=0){if((ae=ee[ie])&&!(2&ae.__u)&&fe==ae.key&&ue==ae.type)return ie;ie--}if(oe<ee.length){if((ae=ee[oe])&&!(2&ae.__u)&&fe==ae.key&&ue==ae.type)return oe;oe++}}return-1}function T$2(te,ee,re){ee[0]=="-"?te.setProperty(ee,re??""):te[ee]=re==null?"":typeof re!="number"||y$2.test(ee)?re:re+"px"}function j$2(te,ee,re,ne,ie){var oe,fe;e:if(ee=="style")if(typeof re=="string")te.style.cssText=re;else{if(typeof ne=="string"&&(te.style.cssText=ne=""),ne)for(ee in ne)re&&ee in re||T$2(te.style,ee,"");if(re)for(ee in re)ne&&re[ee]==ne[ee]||T$2(te.style,ee,re[ee])}else if(ee[0]=="o"&&ee[1]=="n")oe=ee!=(ee=ee.replace(f$3,"$1")),fe=ee.toLowerCase(),ee=fe in te||ee=="onFocusOut"||ee=="onFocusIn"?fe.slice(2):ee.slice(2),te.l||(te.l={}),te.l[ee+oe]=re,re?ne?re.u=ne.u:(re.u=c$3,te.addEventListener(ee,oe?a$1:s$1,oe)):te.removeEventListener(ee,oe?a$1:s$1,oe);else{if(ie=="http://www.w3.org/2000/svg")ee=ee.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(ee!="width"&&ee!="height"&&ee!="href"&&ee!="list"&&ee!="form"&&ee!="tabIndex"&&ee!="download"&&ee!="rowSpan"&&ee!="colSpan"&&ee!="role"&&ee!="popover"&&ee in te)try{te[ee]=re??"";break e}catch{}typeof re=="function"||(re==null||re===!1&&ee[4]!="-"?te.removeAttribute(ee):te.setAttribute(ee,ee=="popover"&&re==1?"":re))}}function F$2(te){return function(ee){if(this.l){var re=this.l[ee.type+te];if(ee.t==null)ee.t=c$3++;else if(ee.t<re.u)return;return re(l$4.event?l$4.event(ee):ee)}}}function O$1(te,ee,re,ne,ie,oe,fe,ue,ae,se){var ce,le,pe,de,me,ve,we,ge,_e,Te,Ne,Le,Oe,xe,Se,be,De,Me=ee.type;if(ee.constructor!=null)return null;128&re.__u&&(ae=!!(32&re.__u),oe=[ue=ee.__e=re.__e]),(ce=l$4.__b)&&ce(ee);e:if(typeof Me=="function")try{if(ge=ee.props,_e="prototype"in Me&&Me.prototype.render,Te=(ce=Me.contextType)&&ne[ce.__c],Ne=ce?Te?Te.props.value:ce.__:ne,re.__c?we=(le=ee.__c=re.__c).__=le.__E:(_e?ee.__c=le=new Me(ge,Ne):(ee.__c=le=new x$3(ge,Ne),le.constructor=Me,le.render=D$2),Te&&Te.sub(le),le.props=ge,le.state||(le.state={}),le.context=Ne,le.__n=ne,pe=le.__d=!0,le.__h=[],le._sb=[]),_e&&le.__s==null&&(le.__s=le.state),_e&&Me.getDerivedStateFromProps!=null&&(le.__s==le.state&&(le.__s=d$3({},le.__s)),d$3(le.__s,Me.getDerivedStateFromProps(ge,le.__s))),de=le.props,me=le.state,le.__v=ee,pe)_e&&Me.getDerivedStateFromProps==null&&le.componentWillMount!=null&&le.componentWillMount(),_e&&le.componentDidMount!=null&&le.__h.push(le.componentDidMount);else{if(_e&&Me.getDerivedStateFromProps==null&&ge!==de&&le.componentWillReceiveProps!=null&&le.componentWillReceiveProps(ge,Ne),!le.__e&&le.shouldComponentUpdate!=null&&le.shouldComponentUpdate(ge,le.__s,Ne)===!1||ee.__v==re.__v){for(ee.__v!=re.__v&&(le.props=ge,le.state=le.__s,le.__d=!1),ee.__e=re.__e,ee.__k=re.__k,ee.__k.some(function(Ue){Ue&&(Ue.__=ee)}),Le=0;Le<le._sb.length;Le++)le.__h.push(le._sb[Le]);le._sb=[],le.__h.length&&fe.push(le);break e}le.componentWillUpdate!=null&&le.componentWillUpdate(ge,le.__s,Ne),_e&&le.componentDidUpdate!=null&&le.__h.push(function(){le.componentDidUpdate(de,me,ve)})}if(le.context=Ne,le.props=ge,le.__P=te,le.__e=!1,Oe=l$4.__r,xe=0,_e){for(le.state=le.__s,le.__d=!1,Oe&&Oe(ee),ce=le.render(le.props,le.state,le.context),Se=0;Se<le._sb.length;Se++)le.__h.push(le._sb[Se]);le._sb=[]}else do le.__d=!1,Oe&&Oe(ee),ce=le.render(le.props,le.state,le.context),le.state=le.__s;while(le.__d&&++xe<25);le.state=le.__s,le.getChildContext!=null&&(ne=d$3(d$3({},ne),le.getChildContext())),_e&&!pe&&le.getSnapshotBeforeUpdate!=null&&(ve=le.getSnapshotBeforeUpdate(de,me)),be=ce,ce!=null&&ce.type===k$5&&ce.key==null&&(be=N$1(ce.props.children)),ue=I$1(te,w$4(be)?be:[be],ee,re,ne,ie,oe,fe,ue,ae,se),le.base=ee.__e,ee.__u&=-161,le.__h.length&&fe.push(le),we&&(le.__E=le.__=null)}catch(Ue){if(ee.__v=null,ae||oe!=null)if(Ue.then){for(ee.__u|=ae?160:128;ue&&ue.nodeType==8&&ue.nextSibling;)ue=ue.nextSibling;oe[oe.indexOf(ue)]=null,ee.__e=ue}else for(De=oe.length;De--;)g$4(oe[De]);else ee.__e=re.__e,ee.__k=re.__k;l$4.__e(Ue,ee,re)}else oe==null&&ee.__v==re.__v?(ee.__k=re.__k,ee.__e=re.__e):ue=ee.__e=V$1(re.__e,ee,re,ne,ie,oe,fe,ae,se);return(ce=l$4.diffed)&&ce(ee),128&ee.__u?void 0:ue}function z$3(te,ee,re){for(var ne=0;ne<re.length;ne++)q$6(re[ne],re[++ne],re[++ne]);l$4.__c&&l$4.__c(ee,te),te.some(function(ie){try{te=ie.__h,ie.__h=[],te.some(function(oe){oe.call(ie)})}catch(oe){l$4.__e(oe,ie.__v)}})}function N$1(te){return typeof te!="object"||te==null||te.__b&&te.__b>0?te:w$4(te)?te.map(N$1):d$3({},te)}function V$1(te,ee,re,ne,ie,oe,fe,ue,ae){var se,ce,le,pe,de,me,ve,we=re.props,ge=ee.props,_e=ee.type;if(_e=="svg"?ie="http://www.w3.org/2000/svg":_e=="math"?ie="http://www.w3.org/1998/Math/MathML":ie||(ie="http://www.w3.org/1999/xhtml"),oe!=null){for(se=0;se<oe.length;se++)if((de=oe[se])&&"setAttribute"in de==!!_e&&(_e?de.localName==_e:de.nodeType==3)){te=de,oe[se]=null;break}}if(te==null){if(_e==null)return document.createTextNode(ge);te=document.createElementNS(ie,_e,ge.is&&ge),ue&&(l$4.__m&&l$4.__m(ee,oe),ue=!1),oe=null}if(_e==null)we===ge||ue&&te.data==ge||(te.data=ge);else{if(oe=oe&&n$4.call(te.childNodes),we=re.props||p$5,!ue&&oe!=null)for(we={},se=0;se<te.attributes.length;se++)we[(de=te.attributes[se]).name]=de.value;for(se in we)if(de=we[se],se!="children"){if(se=="dangerouslySetInnerHTML")le=de;else if(!(se in ge)){if(se=="value"&&"defaultValue"in ge||se=="checked"&&"defaultChecked"in ge)continue;j$2(te,se,null,de,ie)}}for(se in ge)de=ge[se],se=="children"?pe=de:se=="dangerouslySetInnerHTML"?ce=de:se=="value"?me=de:se=="checked"?ve=de:ue&&typeof de!="function"||we[se]===de||j$2(te,se,de,we[se],ie);if(ce)ue||le&&(ce.__html==le.__html||ce.__html==te.innerHTML)||(te.innerHTML=ce.__html),ee.__k=[];else if(le&&(te.innerHTML=""),I$1(ee.type=="template"?te.content:te,w$4(pe)?pe:[pe],ee,re,ne,_e=="foreignObject"?"http://www.w3.org/1999/xhtml":ie,oe,fe,oe?oe[0]:re.__k&&S(re,0),ue,ae),oe!=null)for(se=oe.length;se--;)g$4(oe[se]);ue||(se="value",_e=="progress"&&me==null?te.removeAttribute("value"):me!=null&&(me!==te[se]||_e=="progress"&&!me||_e=="option"&&me!=we[se])&&j$2(te,se,me,we[se],ie),se="checked",ve!=null&&ve!=te[se]&&j$2(te,se,ve,we[se],ie))}return te}function q$6(te,ee,re){try{if(typeof te=="function"){var ne=typeof te.__u=="function";ne&&te.__u(),ne&&ee==null||(te.__u=te(ee))}else te.current=ee}catch(ie){l$4.__e(ie,re)}}function B$2(te,ee,re){var ne,ie;if(l$4.unmount&&l$4.unmount(te),(ne=te.ref)&&(ne.current&&ne.current!=te.__e||q$6(ne,null,ee)),(ne=te.__c)!=null){if(ne.componentWillUnmount)try{ne.componentWillUnmount()}catch(oe){l$4.__e(oe,ee)}ne.base=ne.__P=null}if(ne=te.__k)for(ie=0;ie<ne.length;ie++)ne[ie]&&B$2(ne[ie],ee,re||typeof te.type!="function");re||g$4(te.__e),te.__c=te.__=te.__e=void 0}function D$2(te,ee,re){return this.constructor(te,re)}function E$1(te,ee,re){var ne,ie,oe,fe;ee==document&&(ee=document.documentElement),l$4.__&&l$4.__(te,ee),ie=(ne=typeof re=="function")?null:re&&re.__k||ee.__k,oe=[],fe=[],O$1(ee,te=(!ne&&re||ee).__k=_$1(k$5,null,[te]),ie||p$5,p$5,ee.namespaceURI,!ne&&re?[re]:ie?null:ee.firstChild?n$4.call(ee.childNodes):null,oe,!ne&&re?re:ie?ie.__e:ee.firstChild,ne,fe),z$3(oe,te,fe)}function G$1(te,ee){E$1(te,ee,G$1)}function J$1(te,ee,re){var ne,ie,oe,fe,ue=d$3({},te.props);for(oe in te.type&&te.type.defaultProps&&(fe=te.type.defaultProps),ee)oe=="key"?ne=ee[oe]:oe=="ref"?ie=ee[oe]:ue[oe]=ee[oe]===void 0&&fe!=null?fe[oe]:ee[oe];return arguments.length>2&&(ue.children=arguments.length>3?n$4.call(arguments,2):re),m$4(te.type,ue,ne||te.key,ie||te.ref,null)}function K$1(te){function ee(re){var ne,ie;return this.getChildContext||(ne=new Set,(ie={})[ee.__c]=this,this.getChildContext=function(){return ie},this.componentWillUnmount=function(){ne=null},this.shouldComponentUpdate=function(oe){this.props.value!=oe.value&&ne.forEach(function(fe){fe.__e=!0,M$1(fe)})},this.sub=function(oe){ne.add(oe);var fe=oe.componentWillUnmount;oe.componentWillUnmount=function(){ne&&ne.delete(oe),fe&&fe.call(oe)}}),re.children}return ee.__c="__cC"+h$5++,ee.__=te,ee.Provider=ee.__l=(ee.Consumer=function(re,ne){return re.children(ne)}).contextType=ee,ee}n$4=v$4.slice,l$4={__e:function(te,ee,re,ne){for(var ie,oe,fe;ee=ee.__;)if((ie=ee.__c)&&!ie.__)try{if((oe=ie.constructor)&&oe.getDerivedStateFromError!=null&&(ie.setState(oe.getDerivedStateFromError(te)),fe=ie.__d),ie.componentDidCatch!=null&&(ie.componentDidCatch(te,ne||{}),fe=ie.__d),fe)return ie.__E=ie}catch(ue){te=ue}throw te}},u$4=0,x$3.prototype.setState=function(te,ee){var re;re=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=d$3({},this.state),typeof te=="function"&&(te=te(d$3({},re),this.props)),te&&d$3(re,te),te!=null&&this.__v&&(ee&&this._sb.push(ee),M$1(this))},x$3.prototype.forceUpdate=function(te){this.__v&&(this.__e=!0,te&&this.__h.push(te),M$1(this))},x$3.prototype.render=k$5,i$1=[],o$1=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e$4=function(te,ee){return te.__v.__b-ee.__v.__b},$$1.__r=0,f$3=/(PointerCapture)$|Capture$/i,c$3=0,s$1=F$2(!1),a$1=F$2(!0),h$5=0;var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(te){return te&&te.__esModule&&Object.prototype.hasOwnProperty.call(te,"default")?te.default:te}function getAugmentedNamespace(te){if(te.__esModule)return te;var ee=te.default;if(typeof ee=="function"){var re=function ne(){if(this instanceof ne){var ie=[null];ie.push.apply(ie,arguments);var oe=Function.bind.apply(ee,ie);return new oe}return ee.apply(this,arguments)};re.prototype=ee.prototype}else re={};return Object.defineProperty(re,"__esModule",{value:!0}),Object.keys(te).forEach(function(ne){var ie=Object.getOwnPropertyDescriptor(te,ne);Object.defineProperty(re,ne,ie.get?ie:{enumerable:!0,get:function(){return te[ne]}})}),re}function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(te){for(var ee=1;ee<arguments.length;ee++){var re=arguments[ee];for(var ne in re)Object.prototype.hasOwnProperty.call(re,ne)&&(te[ne]=re[ne])}return te},_extends$1.apply(this,arguments)}var reactIs$2={exports:{}},reactIs_production_min$1={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b$2=Symbol.for("react.element"),c$2=Symbol.for("react.portal"),d$2=Symbol.for("react.fragment"),e$3=Symbol.for("react.strict_mode"),f$2=Symbol.for("react.profiler"),g$3=Symbol.for("react.provider"),h$4=Symbol.for("react.context"),k$4=Symbol.for("react.server_context"),l$3=Symbol.for("react.forward_ref"),m$3=Symbol.for("react.suspense"),n$3=Symbol.for("react.suspense_list"),p$4=Symbol.for("react.memo"),q$5=Symbol.for("react.lazy"),t$5=Symbol.for("react.offscreen"),u$3;u$3=Symbol.for("react.module.reference");function v$3(te){if(typeof te=="object"&&te!==null){var ee=te.$$typeof;switch(ee){case b$2:switch(te=te.type,te){case d$2:case f$2:case e$3:case m$3:case n$3:return te;default:switch(te=te&&te.$$typeof,te){case k$4:case h$4:case l$3:case q$5:case p$4:case g$3:return te;default:return ee}}case c$2:return ee}}}reactIs_production_min$1.ContextConsumer=h$4;reactIs_production_min$1.ContextProvider=g$3;reactIs_production_min$1.Element=b$2;reactIs_production_min$1.ForwardRef=l$3;reactIs_production_min$1.Fragment=d$2;reactIs_production_min$1.Lazy=q$5;reactIs_production_min$1.Memo=p$4;reactIs_production_min$1.Portal=c$2;reactIs_production_min$1.Profiler=f$2;reactIs_production_min$1.StrictMode=e$3;reactIs_production_min$1.Suspense=m$3;reactIs_production_min$1.SuspenseList=n$3;reactIs_production_min$1.isAsyncMode=function(){return!1};reactIs_production_min$1.isConcurrentMode=function(){return!1};reactIs_production_min$1.isContextConsumer=function(te){return v$3(te)===h$4};reactIs_production_min$1.isContextProvider=function(te){return v$3(te)===g$3};reactIs_production_min$1.isElement=function(te){return typeof te=="object"&&te!==null&&te.$$typeof===b$2};reactIs_production_min$1.isForwardRef=function(te){return v$3(te)===l$3};reactIs_production_min$1.isFragment=function(te){return v$3(te)===d$2};reactIs_production_min$1.isLazy=function(te){return v$3(te)===q$5};reactIs_production_min$1.isMemo=function(te){return v$3(te)===p$4};reactIs_production_min$1.isPortal=function(te){return v$3(te)===c$2};reactIs_production_min$1.isProfiler=function(te){return v$3(te)===f$2};reactIs_production_min$1.isStrictMode=function(te){return v$3(te)===e$3};reactIs_production_min$1.isSuspense=function(te){return v$3(te)===m$3};reactIs_production_min$1.isSuspenseList=function(te){return v$3(te)===n$3};reactIs_production_min$1.isValidElementType=function(te){return typeof te=="string"||typeof te=="function"||te===d$2||te===f$2||te===e$3||te===m$3||te===n$3||te===t$5||typeof te=="object"&&te!==null&&(te.$$typeof===q$5||te.$$typeof===p$4||te.$$typeof===g$3||te.$$typeof===h$4||te.$$typeof===l$3||te.$$typeof===u$3||te.getModuleId!==void 0)};reactIs_production_min$1.typeOf=v$3;reactIs$2.exports=reactIs_production_min$1;var reactIsExports$1=reactIs$2.exports,t$4,r$3,u$2,i,o=0,f$1=[],c$1=l$4,e$2=c$1.__b,a=c$1.__r,v$2=c$1.diffed,l$2=c$1.__c,m$2=c$1.unmount,s=c$1.__;function p$3(te,ee){c$1.__h&&c$1.__h(r$3,te,o||ee),o=0;var re=r$3.__H||(r$3.__H={__:[],__h:[]});return te>=re.__.length&&re.__.push({}),re.__[te]}function d$1(te){return o=1,h$3(D$1,te)}function h$3(te,ee,re){var ne=p$3(t$4++,2);if(ne.t=te,!ne.__c&&(ne.__=[re?re(ee):D$1(void 0,ee),function(ue){var ae=ne.__N?ne.__N[0]:ne.__[0],se=ne.t(ae,ue);ae!==se&&(ne.__N=[se,ne.__[1]],ne.__c.setState({}))}],ne.__c=r$3,!r$3.__f)){var ie=function(ue,ae,se){if(!ne.__c.__H)return!0;var ce=ne.__c.__H.__.filter(function(pe){return!!pe.__c});if(ce.every(function(pe){return!pe.__N}))return!oe||oe.call(this,ue,ae,se);var le=ne.__c.props!==ue;return ce.forEach(function(pe){if(pe.__N){var de=pe.__[0];pe.__=pe.__N,pe.__N=void 0,de!==pe.__[0]&&(le=!0)}}),oe&&oe.call(this,ue,ae,se)||le};r$3.__f=!0;var oe=r$3.shouldComponentUpdate,fe=r$3.componentWillUpdate;r$3.componentWillUpdate=function(ue,ae,se){if(this.__e){var ce=oe;oe=void 0,ie(ue,ae,se),oe=ce}fe&&fe.call(this,ue,ae,se)},r$3.shouldComponentUpdate=ie}return ne.__N||ne.__}function y$1(te,ee){var re=p$3(t$4++,3);!c$1.__s&&C$1(re.__H,ee)&&(re.__=te,re.u=ee,r$3.__H.__h.push(re))}function _(te,ee){var re=p$3(t$4++,4);!c$1.__s&&C$1(re.__H,ee)&&(re.__=te,re.u=ee,r$3.__h.push(re))}function A$2(te){return o=5,T$1(function(){return{current:te}},[])}function F$1(te,ee,re){o=6,_(function(){if(typeof te=="function"){var ne=te(ee());return function(){te(null),ne&&typeof ne=="function"&&ne()}}if(te)return te.current=ee(),function(){return te.current=null}},re==null?re:re.concat(te))}function T$1(te,ee){var re=p$3(t$4++,7);return C$1(re.__H,ee)&&(re.__=te(),re.__H=ee,re.__h=te),re.__}function q$4(te,ee){return o=8,T$1(function(){return te},ee)}function x$2(te){var ee=r$3.context[te.__c],re=p$3(t$4++,9);return re.c=te,ee?(re.__==null&&(re.__=!0,ee.sub(r$3)),ee.props.value):te.__}function P$2(te,ee){c$1.useDebugValue&&c$1.useDebugValue(ee?ee(te):te)}function b$1(te){var ee=p$3(t$4++,10),re=d$1();return ee.__=te,r$3.componentDidCatch||(r$3.componentDidCatch=function(ne,ie){ee.__&&ee.__(ne,ie),re[1](ne)}),[re[0],function(){re[1](void 0)}]}function g$2(){var te=p$3(t$4++,11);if(!te.__){for(var ee=r$3.__v;ee!==null&&!ee.__m&&ee.__!==null;)ee=ee.__;var re=ee.__m||(ee.__m=[0,0]);te.__="P"+re[0]+"-"+re[1]++}return te.__}function j$1(){for(var te;te=f$1.shift();)if(te.__P&&te.__H)try{te.__H.__h.forEach(z$2),te.__H.__h.forEach(B$1),te.__H.__h=[]}catch(ee){te.__H.__h=[],c$1.__e(ee,te.__v)}}c$1.__b=function(te){r$3=null,e$2&&e$2(te)},c$1.__=function(te,ee){te&&ee.__k&&ee.__k.__m&&(te.__m=ee.__k.__m),s&&s(te,ee)},c$1.__r=function(te){a&&a(te),t$4=0;var ee=(r$3=te.__c).__H;ee&&(u$2===r$3?(ee.__h=[],r$3.__h=[],ee.__.forEach(function(re){re.__N&&(re.__=re.__N),re.u=re.__N=void 0})):(ee.__h.forEach(z$2),ee.__h.forEach(B$1),ee.__h=[],t$4=0)),u$2=r$3},c$1.diffed=function(te){v$2&&v$2(te);var ee=te.__c;ee&&ee.__H&&(ee.__H.__h.length&&(f$1.push(ee)!==1&&i===c$1.requestAnimationFrame||((i=c$1.requestAnimationFrame)||w$3)(j$1)),ee.__H.__.forEach(function(re){re.u&&(re.__H=re.u),re.u=void 0})),u$2=r$3=null},c$1.__c=function(te,ee){ee.some(function(re){try{re.__h.forEach(z$2),re.__h=re.__h.filter(function(ne){return!ne.__||B$1(ne)})}catch(ne){ee.some(function(ie){ie.__h&&(ie.__h=[])}),ee=[],c$1.__e(ne,re.__v)}}),l$2&&l$2(te,ee)},c$1.unmount=function(te){m$2&&m$2(te);var ee,re=te.__c;re&&re.__H&&(re.__H.__.forEach(function(ne){try{z$2(ne)}catch(ie){ee=ie}}),re.__H=void 0,ee&&c$1.__e(ee,re.__v))};var k$3=typeof requestAnimationFrame=="function";function w$3(te){var ee,re=function(){clearTimeout(ne),k$3&&cancelAnimationFrame(ee),setTimeout(te)},ne=setTimeout(re,35);k$3&&(ee=requestAnimationFrame(re))}function z$2(te){var ee=r$3,re=te.__c;typeof re=="function"&&(te.__c=void 0,re()),r$3=ee}function B$1(te){var ee=r$3;te.__c=te.__(),r$3=ee}function C$1(te,ee){return!te||te.length!==ee.length||ee.some(function(re,ne){return re!==te[ne]})}function D$1(te,ee){return typeof ee=="function"?ee(te):ee}function g$1(te,ee){for(var re in ee)te[re]=ee[re];return te}function E(te,ee){for(var re in te)if(re!=="__source"&&!(re in ee))return!0;for(var ne in ee)if(ne!=="__source"&&te[ne]!==ee[ne])return!0;return!1}function C(te,ee){var re=ee(),ne=d$1({t:{__:re,u:ee}}),ie=ne[0].t,oe=ne[1];return _(function(){ie.__=re,ie.u=ee,x$1(ie)&&oe({t:ie})},[te,re,ee]),y$1(function(){return x$1(ie)&&oe({t:ie}),te(function(){x$1(ie)&&oe({t:ie})})},[te]),re}function x$1(te){var ee,re,ne=te.u,ie=te.__;try{var oe=ne();return!((ee=ie)===(re=oe)&&(ee!==0||1/ee==1/re)||ee!=ee&&re!=re)}catch{return!0}}function R(te){te()}function w$2(te){return te}function k$2(){return[!1,R]}var I=_;function N(te,ee){this.props=te,this.context=ee}function M(te,ee){function re(ie){var oe=this.props.ref,fe=oe==ie.ref;return!fe&&oe&&(oe.call?oe(null):oe.current=null),ee?!ee(this.props,ie)||!fe:E(this.props,ie)}function ne(ie){return this.shouldComponentUpdate=re,_$1(te,ie)}return ne.displayName="Memo("+(te.displayName||te.name)+")",ne.prototype.isReactComponent=!0,ne.__f=!0,ne}(N.prototype=new x$3).isPureReactComponent=!0,N.prototype.shouldComponentUpdate=function(te,ee){return E(this.props,te)||E(this.state,ee)};var T=l$4.__b;l$4.__b=function(te){te.type&&te.type.__f&&te.ref&&(te.props.ref=te.ref,te.ref=null),T&&T(te)};var A$1=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function D(te){function ee(re){var ne=g$1({},re);return delete ne.ref,te(ne,re.ref||null)}return ee.$$typeof=A$1,ee.render=ee,ee.prototype.isReactComponent=ee.__f=!0,ee.displayName="ForwardRef("+(te.displayName||te.name)+")",ee}var L=function(te,ee){return te==null?null:H$1(H$1(te).map(ee))},O={map:L,forEach:L,count:function(te){return te?H$1(te).length:0},only:function(te){var ee=H$1(te);if(ee.length!==1)throw"Children.only";return ee[0]},toArray:H$1},F=l$4.__e;l$4.__e=function(te,ee,re,ne){if(te.then){for(var ie,oe=ee;oe=oe.__;)if((ie=oe.__c)&&ie.__c)return ee.__e==null&&(ee.__e=re.__e,ee.__k=re.__k),ie.__c(te,ee)}F(te,ee,re,ne)};var U=l$4.unmount;function V(te,ee,re){return te&&(te.__c&&te.__c.__H&&(te.__c.__H.__.forEach(function(ne){typeof ne.__c=="function"&&ne.__c()}),te.__c.__H=null),(te=g$1({},te)).__c!=null&&(te.__c.__P===re&&(te.__c.__P=ee),te.__c.__e=!0,te.__c=null),te.__k=te.__k&&te.__k.map(function(ne){return V(ne,ee,re)})),te}function W(te,ee,re){return te&&re&&(te.__v=null,te.__k=te.__k&&te.__k.map(function(ne){return W(ne,ee,re)}),te.__c&&te.__c.__P===ee&&(te.__e&&re.appendChild(te.__e),te.__c.__e=!0,te.__c.__P=re)),te}function P$1(){this.__u=0,this.o=null,this.__b=null}function j(te){var ee=te.__.__c;return ee&&ee.__a&&ee.__a(te)}function z$1(te){var ee,re,ne;function ie(oe){if(ee||(ee=te()).then(function(fe){re=fe.default||fe},function(fe){ne=fe}),ne)throw ne;if(!re)throw ee;return _$1(re,oe)}return ie.displayName="Lazy",ie.__f=!0,ie}function B(){this.i=null,this.l=null}l$4.unmount=function(te){var ee=te.__c;ee&&ee.__R&&ee.__R(),ee&&32&te.__u&&(te.type=null),U&&U(te)},(P$1.prototype=new x$3).__c=function(te,ee){var re=ee.__c,ne=this;ne.o==null&&(ne.o=[]),ne.o.push(re);var ie=j(ne.__v),oe=!1,fe=function(){oe||(oe=!0,re.__R=null,ie?ie(ue):ue())};re.__R=fe;var ue=function(){if(!--ne.__u){if(ne.state.__a){var ae=ne.state.__a;ne.__v.__k[0]=W(ae,ae.__c.__P,ae.__c.__O)}var se;for(ne.setState({__a:ne.__b=null});se=ne.o.pop();)se.forceUpdate()}};ne.__u++||32&ee.__u||ne.setState({__a:ne.__b=ne.__v.__k[0]}),te.then(fe,fe)},P$1.prototype.componentWillUnmount=function(){this.o=[]},P$1.prototype.render=function(te,ee){if(this.__b){if(this.__v.__k){var re=document.createElement("div"),ne=this.__v.__k[0].__c;this.__v.__k[0]=V(this.__b,re,ne.__O=ne.__P)}this.__b=null}var ie=ee.__a&&_$1(k$5,null,te.fallback);return ie&&(ie.__u&=-33),[_$1(k$5,null,ee.__a?null:te.children),ie]};var H=function(te,ee,re){if(++re[1]===re[0]&&te.l.delete(ee),te.props.revealOrder&&(te.props.revealOrder[0]!=="t"||!te.l.size))for(re=te.i;re;){for(;re.length>3;)re.pop()();if(re[1]<re[0])break;te.i=re=re[2]}};function Z(te){return this.getChildContext=function(){return te.context},te.children}function Y(te){var ee=this,re=te.h;if(ee.componentWillUnmount=function(){E$1(null,ee.v),ee.v=null,ee.h=null},ee.h&&ee.h!==re&&ee.componentWillUnmount(),!ee.v){for(var ne=ee.__v;ne!==null&&!ne.__m&&ne.__!==null;)ne=ne.__;ee.h=re,ee.v={nodeType:1,parentNode:re,childNodes:[],__k:{__m:ne.__m},contains:function(){return!0},insertBefore:function(ie,oe){this.childNodes.push(ie),ee.h.insertBefore(ie,oe)},removeChild:function(ie){this.childNodes.splice(this.childNodes.indexOf(ie)>>>1,1),ee.h.removeChild(ie)}}}E$1(_$1(Z,{context:ee.context},te.__v),ee.v)}function $(te,ee){var re=_$1(Y,{__v:te,h:ee});return re.containerInfo=ee,re}(B.prototype=new x$3).__a=function(te){var ee=this,re=j(ee.__v),ne=ee.l.get(te);return ne[0]++,function(ie){var oe=function(){ee.props.revealOrder?(ne.push(ie),H(ee,te,ne)):ie()};re?re(oe):oe()}},B.prototype.render=function(te){this.i=null,this.l=new Map;var ee=H$1(te.children);te.revealOrder&&te.revealOrder[0]==="b"&&ee.reverse();for(var re=ee.length;re--;)this.l.set(ee[re],this.i=[1,0,this.i]);return te.children},B.prototype.componentDidUpdate=B.prototype.componentDidMount=function(){var te=this;this.l.forEach(function(ee,re){H(te,re,ee)})};var q$3=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,G=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,J=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,K=/[A-Z0-9]/g,Q=typeof document<"u",X=function(te){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(te)};function nn(te,ee,re){return ee.__k==null&&(ee.textContent=""),E$1(te,ee),typeof re=="function"&&re(),te?te.__c:null}function tn(te,ee,re){return G$1(te,ee),typeof re=="function"&&re(),te?te.__c:null}x$3.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(te){Object.defineProperty(x$3.prototype,te,{configurable:!0,get:function(){return this["UNSAFE_"+te]},set:function(ee){Object.defineProperty(this,te,{configurable:!0,writable:!0,value:ee})}})});var en=l$4.event;function rn(){}function un(){return this.cancelBubble}function on(){return this.defaultPrevented}l$4.event=function(te){return en&&(te=en(te)),te.persist=rn,te.isPropagationStopped=un,te.isDefaultPrevented=on,te.nativeEvent=te};var ln,cn={enumerable:!1,configurable:!0,get:function(){return this.class}},fn$1=l$4.vnode;l$4.vnode=function(te){typeof te.type=="string"&&function(ee){var re=ee.props,ne=ee.type,ie={},oe=ne.indexOf("-")===-1;for(var fe in re){var ue=re[fe];if(!(fe==="value"&&"defaultValue"in re&&ue==null||Q&&fe==="children"&&ne==="noscript"||fe==="class"||fe==="className")){var ae=fe.toLowerCase();fe==="defaultValue"&&"value"in re&&re.value==null?fe="value":fe==="download"&&ue===!0?ue="":ae==="translate"&&ue==="no"?ue=!1:ae[0]==="o"&&ae[1]==="n"?ae==="ondoubleclick"?fe="ondblclick":ae!=="onchange"||ne!=="input"&&ne!=="textarea"||X(re.type)?ae==="onfocus"?fe="onfocusin":ae==="onblur"?fe="onfocusout":J.test(fe)&&(fe=ae):ae=fe="oninput":oe&&G.test(fe)?fe=fe.replace(K,"-$&").toLowerCase():ue===null&&(ue=void 0),ae==="oninput"&&ie[fe=ae]&&(fe="oninputCapture"),ie[fe]=ue}}ne=="select"&&ie.multiple&&Array.isArray(ie.value)&&(ie.value=H$1(re.children).forEach(function(se){se.props.selected=ie.value.indexOf(se.props.value)!=-1})),ne=="select"&&ie.defaultValue!=null&&(ie.value=H$1(re.children).forEach(function(se){se.props.selected=ie.multiple?ie.defaultValue.indexOf(se.props.value)!=-1:ie.defaultValue==se.props.value})),re.class&&!re.className?(ie.class=re.class,Object.defineProperty(ie,"className",cn)):(re.className&&!re.class||re.class&&re.className)&&(ie.class=ie.className=re.className),ee.props=ie}(te),te.$$typeof=q$3,fn$1&&fn$1(te)};var an=l$4.__r;l$4.__r=function(te){an&&an(te),ln=te.__c};var sn=l$4.diffed;l$4.diffed=function(te){sn&&sn(te);var ee=te.props,re=te.__e;re!=null&&te.type==="textarea"&&"value"in ee&&ee.value!==re.value&&(re.value=ee.value==null?"":ee.value),ln=null};var hn={ReactCurrentDispatcher:{current:{readContext:function(te){return ln.__n[te.__c].props.value},useCallback:q$4,useContext:x$2,useDebugValue:P$2,useDeferredValue:w$2,useEffect:y$1,useId:g$2,useImperativeHandle:F$1,useInsertionEffect:I,useLayoutEffect:_,useMemo:T$1,useReducer:h$3,useRef:A$2,useState:d$1,useSyncExternalStore:C,useTransition:k$2}}},vn="18.3.1";function dn(te){return _$1.bind(null,te)}function mn(te){return!!te&&te.$$typeof===q$3}function pn(te){return mn(te)&&te.type===k$5}function yn(te){return!!te&&!!te.displayName&&(typeof te.displayName=="string"||te.displayName instanceof String)&&te.displayName.startsWith("Memo(")}function _n(te){return mn(te)?J$1.apply(null,arguments):te}function bn(te){return!!te.__k&&(E$1(null,te),!0)}function Sn(te){return te&&(te.base||te.nodeType===1&&te)||null}var gn=function(te,ee){return te(ee)},En=function(te,ee){return te(ee)},Cn=k$5,xn=mn,Rn={useState:d$1,useId:g$2,useReducer:h$3,useEffect:y$1,useLayoutEffect:_,useInsertionEffect:I,useTransition:k$2,useDeferredValue:w$2,useSyncExternalStore:C,startTransition:R,useRef:A$2,useImperativeHandle:F$1,useMemo:T$1,useCallback:q$4,useContext:x$2,useDebugValue:P$2,version:"18.3.1",Children:O,render:nn,hydrate:tn,unmountComponentAtNode:bn,createPortal:$,createElement:_$1,createContext:K$1,createFactory:dn,cloneElement:_n,createRef:b$3,Fragment:k$5,isValidElement:mn,isElement:xn,isFragment:pn,isMemo:yn,findDOMNode:Sn,Component:x$3,PureComponent:N,memo:M,forwardRef:D,flushSync:En,unstable_batchedUpdates:gn,StrictMode:Cn,Suspense:P$1,SuspenseList:B,lazy:z$1,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:hn};const React=Object.freeze(Object.defineProperty({__proto__:null,Children:O,Component:x$3,Fragment:k$5,PureComponent:N,StrictMode:Cn,Suspense:P$1,SuspenseList:B,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:hn,cloneElement:_n,createContext:K$1,createElement:_$1,createFactory:dn,createPortal:$,createRef:b$3,default:Rn,findDOMNode:Sn,flushSync:En,forwardRef:D,hydrate:tn,isElement:xn,isFragment:pn,isMemo:yn,isValidElement:mn,lazy:z$1,memo:M,render:nn,startTransition:R,unmountComponentAtNode:bn,unstable_batchedUpdates:gn,useCallback:q$4,useContext:x$2,useDebugValue:P$2,useDeferredValue:w$2,useEffect:y$1,useErrorBoundary:b$1,useId:g$2,useImperativeHandle:F$1,useInsertionEffect:I,useLayoutEffect:_,useMemo:T$1,useReducer:h$3,useRef:A$2,useState:d$1,useSyncExternalStore:C,useTransition:k$2,version:vn},Symbol.toStringTag,{value:"Module"}));function _objectWithoutPropertiesLoose(te,ee){if(te==null)return{};var re={},ne=Object.keys(te),ie,oe;for(oe=0;oe<ne.length;oe++)ie=ne[oe],!(ee.indexOf(ie)>=0)&&(re[ie]=te[ie]);return re}var reactIs$1={exports:{}},reactIs_production_min={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b=typeof Symbol=="function"&&Symbol.for,c=b?Symbol.for("react.element"):60103,d=b?Symbol.for("react.portal"):60106,e$1=b?Symbol.for("react.fragment"):60107,f=b?Symbol.for("react.strict_mode"):60108,g=b?Symbol.for("react.profiler"):60114,h$2=b?Symbol.for("react.provider"):60109,k$1=b?Symbol.for("react.context"):60110,l$1=b?Symbol.for("react.async_mode"):60111,m$1=b?Symbol.for("react.concurrent_mode"):60111,n$2=b?Symbol.for("react.forward_ref"):60112,p$2=b?Symbol.for("react.suspense"):60113,q$2=b?Symbol.for("react.suspense_list"):60120,r$2=b?Symbol.for("react.memo"):60115,t$3=b?Symbol.for("react.lazy"):60116,v$1=b?Symbol.for("react.block"):60121,w$1=b?Symbol.for("react.fundamental"):60117,x=b?Symbol.for("react.responder"):60118,y=b?Symbol.for("react.scope"):60119;function z(te){if(typeof te=="object"&&te!==null){var ee=te.$$typeof;switch(ee){case c:switch(te=te.type,te){case l$1:case m$1:case e$1:case g:case f:case p$2:return te;default:switch(te=te&&te.$$typeof,te){case k$1:case n$2:case t$3:case r$2:case h$2:return te;default:return ee}}case d:return ee}}}function A(te){return z(te)===m$1}reactIs_production_min.AsyncMode=l$1;reactIs_production_min.ConcurrentMode=m$1;reactIs_production_min.ContextConsumer=k$1;reactIs_production_min.ContextProvider=h$2;reactIs_production_min.Element=c;reactIs_production_min.ForwardRef=n$2;reactIs_production_min.Fragment=e$1;reactIs_production_min.Lazy=t$3;reactIs_production_min.Memo=r$2;reactIs_production_min.Portal=d;reactIs_production_min.Profiler=g;reactIs_production_min.StrictMode=f;reactIs_production_min.Suspense=p$2;reactIs_production_min.isAsyncMode=function(te){return A(te)||z(te)===l$1};reactIs_production_min.isConcurrentMode=A;reactIs_production_min.isContextConsumer=function(te){return z(te)===k$1};reactIs_production_min.isContextProvider=function(te){return z(te)===h$2};reactIs_production_min.isElement=function(te){return typeof te=="object"&&te!==null&&te.$$typeof===c};reactIs_production_min.isForwardRef=function(te){return z(te)===n$2};reactIs_production_min.isFragment=function(te){return z(te)===e$1};reactIs_production_min.isLazy=function(te){return z(te)===t$3};reactIs_production_min.isMemo=function(te){return z(te)===r$2};reactIs_production_min.isPortal=function(te){return z(te)===d};reactIs_production_min.isProfiler=function(te){return z(te)===g};reactIs_production_min.isStrictMode=function(te){return z(te)===f};reactIs_production_min.isSuspense=function(te){return z(te)===p$2};reactIs_production_min.isValidElementType=function(te){return typeof te=="string"||typeof te=="function"||te===e$1||te===m$1||te===g||te===f||te===p$2||te===q$2||typeof te=="object"&&te!==null&&(te.$$typeof===t$3||te.$$typeof===r$2||te.$$typeof===h$2||te.$$typeof===k$1||te.$$typeof===n$2||te.$$typeof===w$1||te.$$typeof===x||te.$$typeof===y||te.$$typeof===v$1)};reactIs_production_min.typeOf=z;reactIs$1.exports=reactIs_production_min;var reactIsExports=reactIs$1.exports,reactIs=reactIsExports,REACT_STATICS={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},KNOWN_STATICS={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},FORWARD_REF_STATICS={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},MEMO_STATICS={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},TYPE_STATICS={};TYPE_STATICS[reactIs.ForwardRef]=FORWARD_REF_STATICS;TYPE_STATICS[reactIs.Memo]=MEMO_STATICS;function getStatics(te){return reactIs.isMemo(te)?MEMO_STATICS:TYPE_STATICS[te.$$typeof]||REACT_STATICS}var defineProperty=Object.defineProperty,getOwnPropertyNames=Object.getOwnPropertyNames,getOwnPropertySymbols=Object.getOwnPropertySymbols,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,getPrototypeOf=Object.getPrototypeOf,objectPrototype=Object.prototype;function hoistNonReactStatics(te,ee,re){if(typeof ee!="string"){if(objectPrototype){var ne=getPrototypeOf(ee);ne&&ne!==objectPrototype&&hoistNonReactStatics(te,ne,re)}var ie=getOwnPropertyNames(ee);getOwnPropertySymbols&&(ie=ie.concat(getOwnPropertySymbols(ee)));for(var oe=getStatics(te),fe=getStatics(ee),ue=0;ue<ie.length;++ue){var ae=ie[ue];if(!KNOWN_STATICS[ae]&&!(re&&re[ae])&&!(fe&&fe[ae])&&!(oe&&oe[ae])){var se=getOwnPropertyDescriptor(ee,ae);try{defineProperty(te,ae,se)}catch{}}}}return te}var hoistNonReactStatics_cjs=hoistNonReactStatics;const hoistStatics=getDefaultExportFromCjs(hoistNonReactStatics_cjs),require$$0=getAugmentedNamespace(React);function _typeof(te){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ee){return typeof ee}:function(ee){return ee&&typeof Symbol=="function"&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee},_typeof(te)}function _toPrimitive(te,ee){if(_typeof(te)!=="object"||te===null)return te;var re=te[Symbol.toPrimitive];if(re!==void 0){var ne=re.call(te,ee||"default");if(_typeof(ne)!=="object")return ne;throw new TypeError("@@toPrimitive must return a primitive value.")}return(ee==="string"?String:Number)(te)}function _toPropertyKey(te){var ee=_toPrimitive(te,"string");return _typeof(ee)==="symbol"?ee:String(ee)}const scriptRel="modulepreload",assetsURL=function(te,ee){return new URL(te,ee).href},seen={},__vitePreload=function(ee,re,ne){if(!re||re.length===0)return ee();const ie=document.getElementsByTagName("link");return Promise.all(re.map(oe=>{if(oe=assetsURL(oe,ne),oe in seen)return;seen[oe]=!0;const fe=oe.endsWith(".css"),ue=fe?'[rel="stylesheet"]':"";if(!!ne)for(let ce=ie.length-1;ce>=0;ce--){const le=ie[ce];if(le.href===oe&&(!fe||le.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${oe}"]${ue}`))return;const se=document.createElement("link");if(se.rel=fe?"stylesheet":scriptRel,fe||(se.as="script",se.crossOrigin=""),se.href=oe,document.head.appendChild(se),fe)return new Promise((ce,le)=>{se.addEventListener("load",ce),se.addEventListener("error",()=>le(new Error(`Unable to preload CSS for ${oe}`)))})})).then(()=>ee())};var shim={exports:{}},useSyncExternalStoreShim_production_min={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e=require$$0;function h$1(te,ee){return te===ee&&(te!==0||1/te===1/ee)||te!==te&&ee!==ee}var k=typeof Object.is=="function"?Object.is:h$1,l=e.useState,m=e.useEffect,n$1=e.useLayoutEffect,p$1=e.useDebugValue;function q$1(te,ee){var re=ee(),ne=l({inst:{value:re,getSnapshot:ee}}),ie=ne[0].inst,oe=ne[1];return n$1(function(){ie.value=re,ie.getSnapshot=ee,r$1(ie)&&oe({inst:ie})},[te,re,ee]),m(function(){return r$1(ie)&&oe({inst:ie}),te(function(){r$1(ie)&&oe({inst:ie})})},[te]),p$1(re),re}function r$1(te){var ee=te.getSnapshot;te=te.value;try{var re=ee();return!k(te,re)}catch{return!0}}function t$2(te,ee){return ee()}var u$1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?t$2:q$1;useSyncExternalStoreShim_production_min.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u$1;shim.exports=useSyncExternalStoreShim_production_min;var shimExports=shim.exports,withSelector_production_min={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h=require$$0,n=shimExports;function p(te,ee){return te===ee&&(te!==0||1/te===1/ee)||te!==te&&ee!==ee}var q=typeof Object.is=="function"?Object.is:p,r=n.useSyncExternalStore,t$1=h.useRef,u=h.useEffect,v=h.useMemo,w=h.useDebugValue;withSelector_production_min.useSyncExternalStoreWithSelector=function(te,ee,re,ne,ie){var oe=t$1(null);if(oe.current===null){var fe={hasValue:!1,value:null};oe.current=fe}else fe=oe.current;oe=v(function(){function ae(de){if(!se){if(se=!0,ce=de,de=ne(de),ie!==void 0&&fe.hasValue){var me=fe.value;if(ie(me,de))return le=me}return le=de}if(me=le,q(ce,de))return me;var ve=ne(de);return ie!==void 0&&ie(me,ve)?me:(ce=de,le=ve)}var se=!1,ce,le,pe=re===void 0?null:re;return[function(){return ae(ee())},pe===null?void 0:function(){return ae(pe())}]},[ee,re,ne,ie]);var ue=r(te,oe[0],oe[1]);return u(function(){fe.hasValue=!0,fe.value=ue},[ue]),w(ue),ue};function defaultNoopBatch(te){te()}let batch=defaultNoopBatch;const setBatch=te=>batch=te,getBatch=()=>batch,ContextKey=Symbol.for("react-redux-context"),gT=typeof globalThis<"u"?globalThis:{};function getContext(){var te;if(!K$1)return{};const ee=(te=gT[ContextKey])!=null?te:gT[ContextKey]=new Map;let re=ee.get(K$1);return re||(re=K$1(null),ee.set(K$1,re)),re}const ReactReduxContext=getContext(),notInitialized=()=>{throw new Error("uSES not initialized!")},_excluded$1=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function pureFinalPropsSelectorFactory(te,ee,re,ne,{areStatesEqual:ie,areOwnPropsEqual:oe,areStatePropsEqual:fe}){let ue=!1,ae,se,ce,le,pe;function de(_e,Te){return ae=_e,se=Te,ce=te(ae,se),le=ee(ne,se),pe=re(ce,le,se),ue=!0,pe}function me(){return ce=te(ae,se),ee.dependsOnOwnProps&&(le=ee(ne,se)),pe=re(ce,le,se),pe}function ve(){return te.dependsOnOwnProps&&(ce=te(ae,se)),ee.dependsOnOwnProps&&(le=ee(ne,se)),pe=re(ce,le,se),pe}function we(){const _e=te(ae,se),Te=!fe(_e,ce);return ce=_e,Te&&(pe=re(ce,le,se)),pe}function ge(_e,Te){const Ne=!oe(Te,se),Le=!ie(_e,ae,Te,se);return ae=_e,se=Te,Ne&&Le?me():Ne?ve():Le?we():pe}return function(Te,Ne){return ue?ge(Te,Ne):de(Te,Ne)}}function finalPropsSelectorFactory(te,ee){let{initMapStateToProps:re,initMapDispatchToProps:ne,initMergeProps:ie}=ee,oe=_objectWithoutPropertiesLoose(ee,_excluded$1);const fe=re(te,oe),ue=ne(te,oe),ae=ie(te,oe);return pureFinalPropsSelectorFactory(fe,ue,ae,te,oe)}function bindActionCreators(te,ee){const re={};for(const ne in te){const ie=te[ne];typeof ie=="function"&&(re[ne]=(...oe)=>ee(ie(...oe)))}return re}function wrapMapToPropsConstant(te){return function(re){const ne=te(re);function ie(){return ne}return ie.dependsOnOwnProps=!1,ie}}function getDependsOnOwnProps(te){return te.dependsOnOwnProps?!!te.dependsOnOwnProps:te.length!==1}function wrapMapToPropsFunc(te,ee){return function(ne,{displayName:ie}){const oe=function(ue,ae){return oe.dependsOnOwnProps?oe.mapToProps(ue,ae):oe.mapToProps(ue,void 0)};return oe.dependsOnOwnProps=!0,oe.mapToProps=function(ue,ae){oe.mapToProps=te,oe.dependsOnOwnProps=getDependsOnOwnProps(te);let se=oe(ue,ae);return typeof se=="function"&&(oe.mapToProps=se,oe.dependsOnOwnProps=getDependsOnOwnProps(se),se=oe(ue,ae)),se},oe}}function createInvalidArgFactory(te,ee){return(re,ne)=>{throw new Error(`Invalid value of type ${typeof te} for ${ee} argument when connecting component ${ne.wrappedComponentName}.`)}}function mapDispatchToPropsFactory(te){return te&&typeof te=="object"?wrapMapToPropsConstant(ee=>bindActionCreators(te,ee)):te?typeof te=="function"?wrapMapToPropsFunc(te):createInvalidArgFactory(te,"mapDispatchToProps"):wrapMapToPropsConstant(ee=>({dispatch:ee}))}function mapStateToPropsFactory(te){return te?typeof te=="function"?wrapMapToPropsFunc(te):createInvalidArgFactory(te,"mapStateToProps"):wrapMapToPropsConstant(()=>({}))}function defaultMergeProps(te,ee,re){return _extends$1({},re,te,ee)}function wrapMergePropsFunc(te){return function(re,{displayName:ne,areMergedPropsEqual:ie}){let oe=!1,fe;return function(ae,se,ce){const le=te(ae,se,ce);return oe?ie(le,fe)||(fe=le):(oe=!0,fe=le),fe}}}function mergePropsFactory(te){return te?typeof te=="function"?wrapMergePropsFunc(te):createInvalidArgFactory(te,"mergeProps"):()=>defaultMergeProps}function createListenerCollection(){const te=getBatch();let ee=null,re=null;return{clear(){ee=null,re=null},notify(){te(()=>{let ne=ee;for(;ne;)ne.callback(),ne=ne.next})},get(){let ne=[],ie=ee;for(;ie;)ne.push(ie),ie=ie.next;return ne},subscribe(ne){let ie=!0,oe=re={callback:ne,next:null,prev:re};return oe.prev?oe.prev.next=oe:ee=oe,function(){!ie||ee===null||(ie=!1,oe.next?oe.next.prev=oe.prev:re=oe.prev,oe.prev?oe.prev.next=oe.next:ee=oe.next)}}}}const nullListeners={notify(){},get:()=>[]};function createSubscription(te,ee){let re,ne=nullListeners,ie=0,oe=!1;function fe(ve){ce();const we=ne.subscribe(ve);let ge=!1;return()=>{ge||(ge=!0,we(),le())}}function ue(){ne.notify()}function ae(){me.onStateChange&&me.onStateChange()}function se(){return oe}function ce(){ie++,re||(re=ee?ee.addNestedSub(ae):te.subscribe(ae),ne=createListenerCollection())}function le(){ie--,re&&ie===0&&(re(),re=void 0,ne.clear(),ne=nullListeners)}function pe(){oe||(oe=!0,ce())}function de(){oe&&(oe=!1,le())}const me={addNestedSub:fe,notifyNestedSubs:ue,handleChangeWrapper:ae,isSubscribed:se,trySubscribe:pe,tryUnsubscribe:de,getListeners:()=>ne};return me}const canUseDOM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",useIsomorphicLayoutEffect=canUseDOM?_:y$1;function is(te,ee){return te===ee?te!==0||ee!==0||1/te===1/ee:te!==te&&ee!==ee}function shallowEqual(te,ee){if(is(te,ee))return!0;if(typeof te!="object"||te===null||typeof ee!="object"||ee===null)return!1;const re=Object.keys(te),ne=Object.keys(ee);if(re.length!==ne.length)return!1;for(let ie=0;ie<re.length;ie++)if(!Object.prototype.hasOwnProperty.call(ee,re[ie])||!is(te[re[ie]],ee[re[ie]]))return!1;return!0}const _excluded=["reactReduxForwardedRef"];let useSyncExternalStore=notInitialized;const initializeConnect=te=>{useSyncExternalStore=te},NO_SUBSCRIPTION_ARRAY=[null,null];function useIsomorphicLayoutEffectWithArgs(te,ee,re){useIsomorphicLayoutEffect(()=>te(...ee),re)}function captureWrapperProps(te,ee,re,ne,ie,oe){te.current=ne,re.current=!1,ie.current&&(ie.current=null,oe())}function subscribeUpdates(te,ee,re,ne,ie,oe,fe,ue,ae,se,ce){if(!te)return()=>{};let le=!1,pe=null;const de=()=>{if(le||!ue.current)return;const ve=ee.getState();let we,ge;try{we=ne(ve,ie.current)}catch(_e){ge=_e,pe=_e}ge||(pe=null),we===oe.current?fe.current||se():(oe.current=we,ae.current=we,fe.current=!0,ce())};return re.onStateChange=de,re.trySubscribe(),de(),()=>{if(le=!0,re.tryUnsubscribe(),re.onStateChange=null,pe)throw pe}}function strictEqual(te,ee){return te===ee}function connect(te,ee,re,{pure:ne,areStatesEqual:ie=strictEqual,areOwnPropsEqual:oe=shallowEqual,areStatePropsEqual:fe=shallowEqual,areMergedPropsEqual:ue=shallowEqual,forwardRef:ae=!1,context:se=ReactReduxContext}={}){const ce=se,le=mapStateToPropsFactory(te),pe=mapDispatchToPropsFactory(ee),de=mergePropsFactory(re),me=!!te;return we=>{const ge=we.displayName||we.name||"Component",_e=`Connect(${ge})`,Te={shouldHandleStateChanges:me,displayName:_e,wrappedComponentName:ge,WrappedComponent:we,initMapStateToProps:le,initMapDispatchToProps:pe,initMergeProps:de,areStatesEqual:ie,areStatePropsEqual:fe,areOwnPropsEqual:oe,areMergedPropsEqual:ue};function Ne(xe){const[Se,be,De]=T$1(()=>{const{reactReduxForwardedRef:Wt}=xe,jt=_objectWithoutPropertiesLoose(xe,_excluded);return[xe.context,Wt,jt]},[xe]),Me=T$1(()=>Se&&Se.Consumer&&reactIsExports$1.isContextConsumer(_$1(Se.Consumer,null))?Se:ce,[Se,ce]),Ue=x$2(Me),Ke=!!xe.store&&!!xe.store.getState&&!!xe.store.dispatch,ft=!!Ue&&!!Ue.store,qe=Ke?xe.store:Ue.store,ot=ft?Ue.getServerState:qe.getState,nt=T$1(()=>finalPropsSelectorFactory(qe.dispatch,Te),[qe]),[Ze,Ge]=T$1(()=>{if(!me)return NO_SUBSCRIPTION_ARRAY;const Wt=createSubscription(qe,Ke?void 0:Ue.subscription),jt=Wt.notifyNestedSubs.bind(Wt);return[Wt,jt]},[qe,Ke,Ue]),et=T$1(()=>Ke?Ue:_extends$1({},Ue,{subscription:Ze}),[Ke,Ue,Ze]),tt=A$2(),Ye=A$2(De),at=A$2(),Bt=A$2(!1);A$2(!1);const Et=A$2(!1),gt=A$2();useIsomorphicLayoutEffect(()=>(Et.current=!0,()=>{Et.current=!1}),[]);const Zt=T$1(()=>()=>at.current&&De===Ye.current?at.current:nt(qe.getState(),De),[qe,De]),Ot=T$1(()=>jt=>Ze?subscribeUpdates(me,qe,Ze,nt,Ye,tt,Bt,Et,at,Ge,jt):()=>{},[Ze]);useIsomorphicLayoutEffectWithArgs(captureWrapperProps,[Ye,tt,Bt,De,at,Ge]);let Qe;try{Qe=useSyncExternalStore(Ot,Zt,ot?()=>nt(ot(),De):Zt)}catch(Wt){throw gt.current&&(Wt.message+=`
The error may be correlated with this previous error:
${gt.current.stack}

`),Wt}useIsomorphicLayoutEffect(()=>{gt.current=void 0,at.current=void 0,tt.current=Qe});const Rt=T$1(()=>_$1(we,_extends$1({},Qe,{ref:be})),[be,we,Qe]);return T$1(()=>me?_$1(Me.Provider,{value:et},Rt):Rt,[Me,Rt,et])}const Oe=M(Ne);if(Oe.WrappedComponent=we,Oe.displayName=Ne.displayName=_e,ae){const Se=D(function(De,Me){return _$1(Oe,_extends$1({},De,{reactReduxForwardedRef:Me}))});return Se.displayName=_e,Se.WrappedComponent=we,hoistStatics(Se,we)}return hoistStatics(Oe,we)}}function Provider({store:te,context:ee,children:re,serverState:ne,stabilityCheck:ie="once",noopCheck:oe="once"}){const fe=T$1(()=>{const se=createSubscription(te);return{store:te,subscription:se,getServerState:ne?()=>ne:void 0,stabilityCheck:ie,noopCheck:oe}},[te,ne,ie,oe]),ue=T$1(()=>te.getState(),[te]);return useIsomorphicLayoutEffect(()=>{const{subscription:se}=fe;return se.onStateChange=se.notifyNestedSubs,se.trySubscribe(),ue!==te.getState()&&se.notifyNestedSubs(),()=>{se.tryUnsubscribe(),se.onStateChange=void 0}},[fe,ue]),_$1((ee||ReactReduxContext).Provider,{value:fe},re)}initializeConnect(shimExports.useSyncExternalStore);setBatch(gn);function freeze(te,ee){return ee===void 0&&(ee=Object),ee&&typeof ee.freeze=="function"?ee.freeze(te):te}let MIME_TYPE=freeze({HTML:"text/html",isHTML:function(te){return te===MIME_TYPE.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),NAMESPACE$1=freeze({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(te){return te===NAMESPACE$1.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});freeze({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'});freeze({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",times:"",divide:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",fnof:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",bull:"",hellip:"",permil:"",prime:"",Prime:"",lsaquo:"",rsaquo:"",oline:"",euro:"",trade:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lceil:"",rceil:"",lfloor:"",rfloor:"",loz:"",spades:"",clubs:"",hearts:"",diams:""});var NAMESPACE=NAMESPACE$1;function copy(te,ee){for(var re in te)ee[re]=te[re]}function _extends(te,ee){var re=te.prototype;if(!(re instanceof ee)){let ne=function(){};ne.prototype=ee.prototype,ne=new ne,copy(re,ne),te.prototype=re=ne}re.constructor!=te&&(typeof te!="function"&&console.error("unknow Class:"+te),re.constructor=te)}var NodeType={},ELEMENT_NODE=NodeType.ELEMENT_NODE=1,ATTRIBUTE_NODE=NodeType.ATTRIBUTE_NODE=2,TEXT_NODE=NodeType.TEXT_NODE=3,CDATA_SECTION_NODE=NodeType.CDATA_SECTION_NODE=4,ENTITY_REFERENCE_NODE=NodeType.ENTITY_REFERENCE_NODE=5,ENTITY_NODE=NodeType.ENTITY_NODE=6,PROCESSING_INSTRUCTION_NODE=NodeType.PROCESSING_INSTRUCTION_NODE=7,COMMENT_NODE=NodeType.COMMENT_NODE=8,DOCUMENT_NODE=NodeType.DOCUMENT_NODE=9,DOCUMENT_TYPE_NODE=NodeType.DOCUMENT_TYPE_NODE=10,DOCUMENT_FRAGMENT_NODE=NodeType.DOCUMENT_FRAGMENT_NODE=11,NOTATION_NODE=NodeType.NOTATION_NODE=12,ExceptionCode={},ExceptionMessage={};ExceptionCode.INDEX_SIZE_ERR=(ExceptionMessage[1]="Index size error",1);ExceptionCode.DOMSTRING_SIZE_ERR=(ExceptionMessage[2]="DOMString size error",2);var HIERARCHY_REQUEST_ERR=ExceptionCode.HIERARCHY_REQUEST_ERR=(ExceptionMessage[3]="Hierarchy request error",3);ExceptionCode.WRONG_DOCUMENT_ERR=(ExceptionMessage[4]="Wrong document",4);ExceptionCode.INVALID_CHARACTER_ERR=(ExceptionMessage[5]="Invalid character",5);ExceptionCode.NO_DATA_ALLOWED_ERR=(ExceptionMessage[6]="No data allowed",6);ExceptionCode.NO_MODIFICATION_ALLOWED_ERR=(ExceptionMessage[7]="No modification allowed",7);var NOT_FOUND_ERR=ExceptionCode.NOT_FOUND_ERR=(ExceptionMessage[8]="Not found",8);ExceptionCode.NOT_SUPPORTED_ERR=(ExceptionMessage[9]="Not supported",9);var INUSE_ATTRIBUTE_ERR=ExceptionCode.INUSE_ATTRIBUTE_ERR=(ExceptionMessage[10]="Attribute in use",10);ExceptionCode.INVALID_STATE_ERR=(ExceptionMessage[11]="Invalid state",11);ExceptionCode.SYNTAX_ERR=(ExceptionMessage[12]="Syntax error",12);ExceptionCode.INVALID_MODIFICATION_ERR=(ExceptionMessage[13]="Invalid modification",13);ExceptionCode.NAMESPACE_ERR=(ExceptionMessage[14]="Invalid namespace",14);ExceptionCode.INVALID_ACCESS_ERR=(ExceptionMessage[15]="Invalid access",15);function DOMException(te,ee){if(ee instanceof Error)var re=ee;else re=this,Error.call(this,ExceptionMessage[te]),this.message=ExceptionMessage[te],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException);return re.code=te,ee&&(this.message=this.message+": "+ee),re}DOMException.prototype=Error.prototype;copy(ExceptionCode,DOMException);function NodeList(){}NodeList.prototype={length:0,item:function(te){return this[te]||null},toString:function(te,ee){for(var re=[],ne=0;ne<this.length;ne++)serializeToString(this[ne],re,te,ee);return re.join("")}};function LiveNodeList(te,ee){this._node=te,this._refresh=ee,_updateLiveList(this)}function _updateLiveList(te){var ee=te._node._inc||te._node.ownerDocument._inc;if(te._inc!=ee){var re=te._refresh(te._node);__set__(te,"length",re.length),copy(re,te),te._inc=ee}}LiveNodeList.prototype.item=function(te){return _updateLiveList(this),this[te]};_extends(LiveNodeList,NodeList);function NamedNodeMap(){}function _findNodeIndex(te,ee){for(var re=te.length;re--;)if(te[re]===ee)return re}function _addNamedNode(te,ee,re,ne){if(ne?ee[_findNodeIndex(ee,ne)]=re:ee[ee.length++]=re,te){re.ownerElement=te;var ie=te.ownerDocument;ie&&(ne&&_onRemoveAttribute(ie,te,ne),_onAddAttribute(ie,te,re))}}function _removeNamedNode(te,ee,re){var ne=_findNodeIndex(ee,re);if(ne>=0){for(var ie=ee.length-1;ne<ie;)ee[ne]=ee[++ne];if(ee.length=ie,te){var oe=te.ownerDocument;oe&&(_onRemoveAttribute(oe,te,re),re.ownerElement=null)}}else throw DOMException(NOT_FOUND_ERR,new Error(te.tagName+"@"+re))}NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function(te){for(var ee=this.length;ee--;){var re=this[ee];if(re.nodeName==te)return re}},setNamedItem:function(te){var ee=te.ownerElement;if(ee&&ee!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);var re=this.getNamedItem(te.nodeName);return _addNamedNode(this._ownerElement,this,te,re),re},setNamedItemNS:function(te){var ee=te.ownerElement,re;if(ee&&ee!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);return re=this.getNamedItemNS(te.namespaceURI,te.localName),_addNamedNode(this._ownerElement,this,te,re),re},removeNamedItem:function(te){var ee=this.getNamedItem(te);return _removeNamedNode(this._ownerElement,this,ee),ee},removeNamedItemNS:function(te,ee){var re=this.getNamedItemNS(te,ee);return _removeNamedNode(this._ownerElement,this,re),re},getNamedItemNS:function(te,ee){for(var re=this.length;re--;){var ne=this[re];if(ne.localName==ee&&ne.namespaceURI==te)return ne}return null}};function DOMImplementation$1(){}DOMImplementation$1.prototype={hasFeature:function(te,ee){return!0},createDocument:function(te,ee,re){var ne=new Document;if(ne.implementation=this,ne.childNodes=new NodeList,ne.doctype=re||null,re&&ne.appendChild(re),ee){var ie=ne.createElementNS(te,ee);ne.appendChild(ie)}return ne},createDocumentType:function(te,ee,re){var ne=new DocumentType;return ne.name=te,ne.nodeName=te,ne.publicId=ee||"",ne.systemId=re||"",ne}};function Node$1(){}Node$1.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(te,ee){return _insertBefore(this,te,ee)},replaceChild:function(te,ee){this.insertBefore(te,ee),ee&&this.removeChild(ee)},removeChild:function(te){return _removeChild(this,te)},appendChild:function(te){return this.insertBefore(te,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(te){return cloneNode(this.ownerDocument||this,this,te)},normalize:function(){for(var te=this.firstChild;te;){var ee=te.nextSibling;ee&&ee.nodeType==TEXT_NODE&&te.nodeType==TEXT_NODE?(this.removeChild(ee),te.appendData(ee.data)):(te.normalize(),te=ee)}},isSupported:function(te,ee){return this.ownerDocument.implementation.hasFeature(te,ee)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(te){for(var ee=this;ee;){var re=ee._nsMap;if(re){for(var ne in re)if(re[ne]==te)return ne}ee=ee.nodeType==ATTRIBUTE_NODE?ee.ownerDocument:ee.parentNode}return null},lookupNamespaceURI:function(te){for(var ee=this;ee;){var re=ee._nsMap;if(re&&te in re)return re[te];ee=ee.nodeType==ATTRIBUTE_NODE?ee.ownerDocument:ee.parentNode}return null},isDefaultNamespace:function(te){var ee=this.lookupPrefix(te);return ee==null}};function _xmlEncoder(te){return te=="<"&&"&lt;"||te==">"&&"&gt;"||te=="&"&&"&amp;"||te=='"'&&"&quot;"||"&#"+te.charCodeAt()+";"}copy(NodeType,Node$1);copy(NodeType,Node$1.prototype);function _visitNode(te,ee){if(ee(te))return!0;if(te=te.firstChild)do if(_visitNode(te,ee))return!0;while(te=te.nextSibling)}function Document(){}function _onAddAttribute(te,ee,re){te&&te._inc++;var ne=re.namespaceURI;ne===NAMESPACE.XMLNS&&(ee._nsMap[re.prefix?re.localName:""]=re.value)}function _onRemoveAttribute(te,ee,re,ne){te&&te._inc++;var ie=re.namespaceURI;ie===NAMESPACE.XMLNS&&delete ee._nsMap[re.prefix?re.localName:""]}function _onUpdateChild(te,ee,re){if(te&&te._inc){te._inc++;var ne=ee.childNodes;if(re)ne[ne.length++]=re;else{for(var ie=ee.firstChild,oe=0;ie;)ne[oe++]=ie,ie=ie.nextSibling;ne.length=oe}}}function _removeChild(te,ee){var re=ee.previousSibling,ne=ee.nextSibling;return re?re.nextSibling=ne:te.firstChild=ne,ne?ne.previousSibling=re:te.lastChild=re,_onUpdateChild(te.ownerDocument,te),ee}function _insertBefore(te,ee,re){var ne=ee.parentNode;if(ne&&ne.removeChild(ee),ee.nodeType===DOCUMENT_FRAGMENT_NODE){var ie=ee.firstChild;if(ie==null)return ee;var oe=ee.lastChild}else ie=oe=ee;var fe=re?re.previousSibling:te.lastChild;ie.previousSibling=fe,oe.nextSibling=re,fe?fe.nextSibling=ie:te.firstChild=ie,re==null?te.lastChild=oe:re.previousSibling=oe;do ie.parentNode=te;while(ie!==oe&&(ie=ie.nextSibling));return _onUpdateChild(te.ownerDocument||te,te),ee.nodeType==DOCUMENT_FRAGMENT_NODE&&(ee.firstChild=ee.lastChild=null),ee}function _appendSingleChild(te,ee){var re=ee.parentNode;if(re){var ne=te.lastChild;re.removeChild(ee);var ne=te.lastChild}var ne=te.lastChild;return ee.parentNode=te,ee.previousSibling=ne,ee.nextSibling=null,ne?ne.nextSibling=ee:te.firstChild=ee,te.lastChild=ee,_onUpdateChild(te.ownerDocument,te,ee),ee}Document.prototype={nodeName:"#document",nodeType:DOCUMENT_NODE,doctype:null,documentElement:null,_inc:1,insertBefore:function(te,ee){if(te.nodeType==DOCUMENT_FRAGMENT_NODE){for(var re=te.firstChild;re;){var ne=re.nextSibling;this.insertBefore(re,ee),re=ne}return te}return this.documentElement==null&&te.nodeType==ELEMENT_NODE&&(this.documentElement=te),_insertBefore(this,te,ee),te.ownerDocument=this,te},removeChild:function(te){return this.documentElement==te&&(this.documentElement=null),_removeChild(this,te)},importNode:function(te,ee){return importNode(this,te,ee)},getElementById:function(te){var ee=null;return _visitNode(this.documentElement,function(re){if(re.nodeType==ELEMENT_NODE&&re.getAttribute("id")==te)return ee=re,!0}),ee},getElementsByClassName:function(te){var ee=new RegExp("(^|\\s)"+te+"(\\s|$)");return new LiveNodeList(this,function(re){var ne=[];return _visitNode(re.documentElement,function(ie){ie!==re&&ie.nodeType==ELEMENT_NODE&&ee.test(ie.getAttribute("class"))&&ne.push(ie)}),ne})},createElement:function(te){var ee=new Element;ee.ownerDocument=this,ee.nodeName=te,ee.tagName=te,ee.localName=te,ee.childNodes=new NodeList;var re=ee.attributes=new NamedNodeMap;return re._ownerElement=ee,ee},createDocumentFragment:function(){var te=new DocumentFragment;return te.ownerDocument=this,te.childNodes=new NodeList,te},createTextNode:function(te){var ee=new Text;return ee.ownerDocument=this,ee.appendData(te),ee},createComment:function(te){var ee=new Comment;return ee.ownerDocument=this,ee.appendData(te),ee},createCDATASection:function(te){var ee=new CDATASection;return ee.ownerDocument=this,ee.appendData(te),ee},createProcessingInstruction:function(te,ee){var re=new ProcessingInstruction;return re.ownerDocument=this,re.tagName=re.target=te,re.nodeValue=re.data=ee,re},createAttribute:function(te){var ee=new Attr;return ee.ownerDocument=this,ee.name=te,ee.nodeName=te,ee.localName=te,ee.specified=!0,ee},createEntityReference:function(te){var ee=new EntityReference;return ee.ownerDocument=this,ee.nodeName=te,ee},createElementNS:function(te,ee){var re=new Element,ne=ee.split(":"),ie=re.attributes=new NamedNodeMap;return re.childNodes=new NodeList,re.ownerDocument=this,re.nodeName=ee,re.tagName=ee,re.namespaceURI=te,ne.length==2?(re.prefix=ne[0],re.localName=ne[1]):re.localName=ee,ie._ownerElement=re,re},createAttributeNS:function(te,ee){var re=new Attr,ne=ee.split(":");return re.ownerDocument=this,re.nodeName=ee,re.name=ee,re.namespaceURI=te,re.specified=!0,ne.length==2?(re.prefix=ne[0],re.localName=ne[1]):re.localName=ee,re}};_extends(Document,Node$1);function Element(){this._nsMap={}}Element.prototype={nodeType:ELEMENT_NODE,hasAttribute:function(te){return this.getAttributeNode(te)!=null},getAttribute:function(te){var ee=this.getAttributeNode(te);return ee&&ee.value||""},getAttributeNode:function(te){return this.attributes.getNamedItem(te)},setAttribute:function(te,ee){var re=this.ownerDocument.createAttribute(te);re.value=re.nodeValue=""+ee,this.setAttributeNode(re)},removeAttribute:function(te){var ee=this.getAttributeNode(te);ee&&this.removeAttributeNode(ee)},appendChild:function(te){return te.nodeType===DOCUMENT_FRAGMENT_NODE?this.insertBefore(te,null):_appendSingleChild(this,te)},setAttributeNode:function(te){return this.attributes.setNamedItem(te)},setAttributeNodeNS:function(te){return this.attributes.setNamedItemNS(te)},removeAttributeNode:function(te){return this.attributes.removeNamedItem(te.nodeName)},removeAttributeNS:function(te,ee){var re=this.getAttributeNodeNS(te,ee);re&&this.removeAttributeNode(re)},hasAttributeNS:function(te,ee){return this.getAttributeNodeNS(te,ee)!=null},getAttributeNS:function(te,ee){var re=this.getAttributeNodeNS(te,ee);return re&&re.value||""},setAttributeNS:function(te,ee,re){var ne=this.ownerDocument.createAttributeNS(te,ee);ne.value=ne.nodeValue=""+re,this.setAttributeNode(ne)},getAttributeNodeNS:function(te,ee){return this.attributes.getNamedItemNS(te,ee)},getElementsByTagName:function(te){return new LiveNodeList(this,function(ee){var re=[];return _visitNode(ee,function(ne){ne!==ee&&ne.nodeType==ELEMENT_NODE&&(te==="*"||ne.tagName==te)&&re.push(ne)}),re})},getElementsByTagNameNS:function(te,ee){return new LiveNodeList(this,function(re){var ne=[];return _visitNode(re,function(ie){ie!==re&&ie.nodeType===ELEMENT_NODE&&(te==="*"||ie.namespaceURI===te)&&(ee==="*"||ie.localName==ee)&&ne.push(ie)}),ne})}};Document.prototype.getElementsByTagName=Element.prototype.getElementsByTagName;Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS;_extends(Element,Node$1);function Attr(){}Attr.prototype.nodeType=ATTRIBUTE_NODE;_extends(Attr,Node$1);function CharacterData(){}CharacterData.prototype={data:"",substringData:function(te,ee){return this.data.substring(te,te+ee)},appendData:function(te){te=this.data+te,this.nodeValue=this.data=te,this.length=te.length},insertData:function(te,ee){this.replaceData(te,0,ee)},appendChild:function(te){throw new Error(ExceptionMessage[HIERARCHY_REQUEST_ERR])},deleteData:function(te,ee){this.replaceData(te,ee,"")},replaceData:function(te,ee,re){var ne=this.data.substring(0,te),ie=this.data.substring(te+ee);re=ne+re+ie,this.nodeValue=this.data=re,this.length=re.length}};_extends(CharacterData,Node$1);function Text(){}Text.prototype={nodeName:"#text",nodeType:TEXT_NODE,splitText:function(te){var ee=this.data,re=ee.substring(te);ee=ee.substring(0,te),this.data=this.nodeValue=ee,this.length=ee.length;var ne=this.ownerDocument.createTextNode(re);return this.parentNode&&this.parentNode.insertBefore(ne,this.nextSibling),ne}};_extends(Text,CharacterData);function Comment(){}Comment.prototype={nodeName:"#comment",nodeType:COMMENT_NODE};_extends(Comment,CharacterData);function CDATASection(){}CDATASection.prototype={nodeName:"#cdata-section",nodeType:CDATA_SECTION_NODE};_extends(CDATASection,CharacterData);function DocumentType(){}DocumentType.prototype.nodeType=DOCUMENT_TYPE_NODE;_extends(DocumentType,Node$1);function Notation(){}Notation.prototype.nodeType=NOTATION_NODE;_extends(Notation,Node$1);function Entity(){}Entity.prototype.nodeType=ENTITY_NODE;_extends(Entity,Node$1);function EntityReference(){}EntityReference.prototype.nodeType=ENTITY_REFERENCE_NODE;_extends(EntityReference,Node$1);function DocumentFragment(){}DocumentFragment.prototype.nodeName="#document-fragment";DocumentFragment.prototype.nodeType=DOCUMENT_FRAGMENT_NODE;_extends(DocumentFragment,Node$1);function ProcessingInstruction(){}ProcessingInstruction.prototype.nodeType=PROCESSING_INSTRUCTION_NODE;_extends(ProcessingInstruction,Node$1);Node$1.prototype.toString=nodeSerializeToString;function nodeSerializeToString(te,ee){var re=[],ne=this.nodeType==9&&this.documentElement||this,ie=ne.prefix,oe=ne.namespaceURI;if(oe&&ie==null){var ie=ne.lookupPrefix(oe);if(ie==null)var fe=[{namespace:oe,prefix:null}]}return serializeToString(this,re,te,ee,fe),re.join("")}function needNamespaceDefine(te,ee,re){var ne=te.prefix||"",ie=te.namespaceURI;if(!ie||ne==="xml"&&ie===NAMESPACE.XML||ie===NAMESPACE.XMLNS)return!1;for(var oe=re.length;oe--;){var fe=re[oe];if(fe.prefix===ne)return fe.namespace!==ie}return!0}function serializeToString(te,ee,re,ne,ie){if(ne)if(te=ne(te),te){if(typeof te=="string"){ee.push(te);return}}else return;switch(te.nodeType){case ELEMENT_NODE:ie||(ie=[]),ie.length;var oe=te.attributes,fe=oe.length,de=te.firstChild,ue=te.tagName;re=NAMESPACE.isHTML(te.namespaceURI)||re,ee.push("<",ue);for(var ae=0;ae<fe;ae++){var se=oe.item(ae);se.prefix=="xmlns"?ie.push({prefix:se.localName,namespace:se.value}):se.nodeName=="xmlns"&&ie.push({prefix:"",namespace:se.value})}for(var ae=0;ae<fe;ae++){var se=oe.item(ae);if(needNamespaceDefine(se,re,ie)){var ce=se.prefix||"",le=se.namespaceURI,pe=ce?" xmlns:"+ce:" xmlns";ee.push(pe,'="',le,'"'),ie.push({prefix:ce,namespace:le})}serializeToString(se,ee,re,ne,ie)}if(needNamespaceDefine(te,re,ie)){var ce=te.prefix||"",le=te.namespaceURI,pe=ce?" xmlns:"+ce:" xmlns";ee.push(pe,'="',le,'"'),ie.push({prefix:ce,namespace:le})}if(de||re&&!/^(?:meta|link|img|br|hr|input)$/i.test(ue)){if(ee.push(">"),re&&/^script$/i.test(ue))for(;de;)de.data?ee.push(de.data):serializeToString(de,ee,re,ne,ie),de=de.nextSibling;else for(;de;)serializeToString(de,ee,re,ne,ie),de=de.nextSibling;ee.push("</",ue,">")}else ee.push("/>");return;case DOCUMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(var de=te.firstChild;de;)serializeToString(de,ee,re,ne,ie),de=de.nextSibling;return;case ATTRIBUTE_NODE:return ee.push(" ",te.name,'="',te.value.replace(/[<&"]/g,_xmlEncoder),'"');case TEXT_NODE:return ee.push(te.data.replace(/[<&]/g,_xmlEncoder).replace(/]]>/g,"]]&gt;"));case CDATA_SECTION_NODE:return ee.push("<![CDATA[",te.data,"]]>");case COMMENT_NODE:return ee.push("<!--",te.data,"-->");case DOCUMENT_TYPE_NODE:var me=te.publicId,ve=te.systemId;if(ee.push("<!DOCTYPE ",te.name),me)ee.push(" PUBLIC ",me),ve&&ve!="."&&ee.push(" ",ve),ee.push(">");else if(ve&&ve!=".")ee.push(" SYSTEM ",ve,">");else{var we=te.internalSubset;we&&ee.push(" [",we,"]"),ee.push(">")}return;case PROCESSING_INSTRUCTION_NODE:return ee.push("<?",te.target," ",te.data,"?>");case ENTITY_REFERENCE_NODE:return ee.push("&",te.nodeName,";");default:ee.push("??",te.nodeName)}}function importNode(te,ee,re){var ne;switch(ee.nodeType){case ELEMENT_NODE:ne=ee.cloneNode(!1),ne.ownerDocument=te;case DOCUMENT_FRAGMENT_NODE:break;case ATTRIBUTE_NODE:re=!0;break}if(ne||(ne=ee.cloneNode(!1)),ne.ownerDocument=te,ne.parentNode=null,re)for(var ie=ee.firstChild;ie;)ne.appendChild(importNode(te,ie,re)),ie=ie.nextSibling;return ne}function cloneNode(te,ee,re){var ne=new ee.constructor;for(var ie in ee){var oe=ee[ie];typeof oe!="object"&&oe!=ne[ie]&&(ne[ie]=oe)}switch(ee.childNodes&&(ne.childNodes=new NodeList),ne.ownerDocument=te,ne.nodeType){case ELEMENT_NODE:var fe=ee.attributes,ue=ne.attributes=new NamedNodeMap,ae=fe.length;ue._ownerElement=ne;for(var se=0;se<ae;se++)ne.setAttributeNode(cloneNode(te,fe.item(se),!0));break;case ATTRIBUTE_NODE:re=!0}if(re)for(var ce=ee.firstChild;ce;)ne.appendChild(cloneNode(te,ce,re)),ce=ce.nextSibling;return ne}function __set__(te,ee,re){te[ee]=re}try{if(Object.defineProperty){let te=function(ee){switch(ee.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:var re=[];for(ee=ee.firstChild;ee;)ee.nodeType!==7&&ee.nodeType!==8&&re.push(te(ee)),ee=ee.nextSibling;return re.join("");default:return ee.nodeValue}};Object.defineProperty(LiveNodeList.prototype,"length",{get:function(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node$1.prototype,"textContent",{get:function(){return te(this)},set:function(ee){switch(this.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(;this.firstChild;)this.removeChild(this.firstChild);(ee||String(ee))&&this.appendChild(this.ownerDocument.createTextNode(ee));break;default:this.data=ee,this.value=ee,this.nodeValue=ee}}}),__set__=function(ee,re,ne){ee["$$"+re]=ne}}}catch{}var nameStartChar=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,nameChar=new RegExp("[\\-\\.0-9"+nameStartChar.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]");new RegExp("^"+nameStartChar.source+nameChar.source+"*(?::"+nameStartChar.source+nameChar.source+"*)?$");function ParseError$1(te,ee){this.message=te,this.locator=ee,Error.captureStackTrace&&Error.captureStackTrace(this,ParseError$1)}ParseError$1.prototype=new Error;ParseError$1.prototype.name=ParseError$1.name;let DOMImplementation=DOMImplementation$1;function DOMHandler(){this.cdata=!1}function position(te,ee){ee.lineNumber=te.lineNumber,ee.columnNumber=te.columnNumber}DOMHandler.prototype={startDocument:function(){this.doc=new DOMImplementation().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(te,ee,re,ne){var ie=this.doc,oe=ie.createElementNS(te,re||ee),fe=ne.length;appendElement(this,oe),this.currentElement=oe,this.locator&&position(this.locator,oe);for(var ue=0;ue<fe;ue++){var te=ne.getURI(ue),ae=ne.getValue(ue),re=ne.getQName(ue),se=ie.createAttributeNS(te,re);this.locator&&position(ne.getLocator(ue),se),se.value=se.nodeValue=ae,oe.setAttributeNode(se)}},endElement:function(te,ee,re){var ne=this.currentElement;ne.tagName,this.currentElement=ne.parentNode},startPrefixMapping:function(te,ee){},endPrefixMapping:function(te){},processingInstruction:function(te,ee){var re=this.doc.createProcessingInstruction(te,ee);this.locator&&position(this.locator,re),appendElement(this,re)},ignorableWhitespace:function(te,ee,re){},characters:function(te,ee,re){if(te=_toString.apply(this,arguments),te){if(this.cdata)var ne=this.doc.createCDATASection(te);else var ne=this.doc.createTextNode(te);this.currentElement?this.currentElement.appendChild(ne):/^\s*$/.test(te)&&this.doc.appendChild(ne),this.locator&&position(this.locator,ne)}},skippedEntity:function(te){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(te){(this.locator=te)&&(te.lineNumber=0)},comment:function(te,ee,re){te=_toString.apply(this,arguments);var ne=this.doc.createComment(te);this.locator&&position(this.locator,ne),appendElement(this,ne)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(te,ee,re){var ne=this.doc.implementation;if(ne&&ne.createDocumentType){var ie=ne.createDocumentType(te,ee,re);this.locator&&position(this.locator,ie),appendElement(this,ie)}},warning:function(te){console.warn("[xmldom warning]	"+te,_locator(this.locator))},error:function(te){console.error("[xmldom error]	"+te,_locator(this.locator))},fatalError:function(te){throw new ParseError(te,this.locator)}};function _locator(te){if(te)return`
@`+(te.systemId||"")+"#[line:"+te.lineNumber+",col:"+te.columnNumber+"]"}function _toString(te,ee,re){return typeof te=="string"?te.substr(ee,re):te.length>=ee+re||ee?new java.lang.String(te,ee,re)+"":te}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(te){DOMHandler.prototype[te]=function(){return null}});function appendElement(te,ee){te.currentElement?te.currentElement.appendChild(ee):te.doc.appendChild(ee)}var ParseError=ParseError$1;class ModelError extends Error{constructor(ee,re){super(ee),this.name="ModelError",this.primitive=re.primitive,this.showEditor=re.showEditor,this.line=re.line,this.details=re.details,this.code=re.code}}function isTrue(te){return te===1||te==="true"||te===!0}function toHTML(te){return te.replace(/[&<>'"]/g,ee=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;","`":"&#96;"})[ee])}function commaStr(te){if(typeof te=="string")return escape(te);if(typeof te=="boolean")return te.toString();if(te==null)return"";if(te>=1e9||te<=1e-9&&te!==0)return te.toPrecision(3);{te=round$1(te,9)+"";let ee=te.split("."),re=ee[0],ne=ee.length>1?"."+ee[1]:"",ie=/(\d+)(\d{3})/;for(;ie.test(re);)re=re.replace(ie,"$1,$2");return re+ne}}function round$1(te,ee=15){return+te.toPrecision(ee)}class Primitive{constructor(ee,re){this._node=ee,this.model=null;for(let ne in re)if(ne in this)this[ne]=re[ne];else throw new Error("Unknown property: "+ne)}delete(){let ee=this.model.find(ne=>ne instanceof Flow||ne instanceof Transition||ne instanceof Link),re=this._node;re.parent.children.includes(re)&&re.parent.children.splice(re.parent.children.indexOf(re),1),ee.forEach(ne=>{ne._node.source===re&&(ne._node.source=null,ne._node.target&&ne._node.target.parent!==ne._node.parent&&(ne.parent=ne._node.target.parent.primitive(this.model))),ne._node.target===re&&(ne._node.target=null,ne._node.source&&ne._node.source.parent!==ne._node.parent&&(ne.parent=ne._node.source.parent.primitive(this.model)))})}get parent(){let ee=this._node.parent;return ee.value&&ee.value.nodeName==="root"||ee.id==="1"?null:ee.primitive(this.model)}set parent(ee){let re;ee===null?re=this.model._graph.children[0].children[0]:re=ee._node,this._node.parent.children.includes(this._node)&&this._node.parent.children.splice(this._node.parent.children.indexOf(this._node),1),re.addChild(this._node)}getParent(ee){let re=this.parent;return re?ee(re)?re:re.getParent(ee):null}isInAgent(){return!!this.getParent(ee=>ee instanceof Agent)}neighbors(){let ee=[],re=this.model.findFlows(),ne=this.model.findLinks();if((this instanceof Flow||this instanceof Link||this instanceof Transition)&&(this.start&&ee.push({item:this.start,type:"direct"}),this.end&&ee.push({item:this.end,type:"direct"})),this instanceof Population&&this.agentBase&&(ee=ee.concat(oe(this))),this instanceof Stock)for(let fe=0;fe<re.length;fe++)re[fe].start===this&&ee.push({item:re[fe],type:"direct",linkHidden:!0}),re[fe].end===this&&ee.push({item:re[fe],type:"direct",linkHidden:!0});for(let fe=0;fe<ne.length;fe++){if(ne[fe].start===this&&ne[fe].end){let ue=!ne[fe].biDirectional;ee.push({item:ne[fe].end,type:"direct",linkHidden:ue}),ee=ee.concat(oe(ne[fe].end,ue))}ne[fe].end===this&&ne[fe].start&&!(ne[fe].start.isInAgent()&&!this.isInAgent())&&(ee.push({item:ne[fe].start,type:"direct"}),ee=ee.concat(oe(ne[fe].start)))}ee=ee.filter(fe=>!!fe);let ie=[];for(let fe=0;fe<ee.length;fe++){if(ee[fe].linkHidden)continue;let ue=!1;for(let ae=0;ae<ie.length;ae++)if(ie[ae].type===ee[fe].type&&ie[ae].item.id===ee[fe].item.id){ue=!0,ie[ae].linkHidden&&!ee[fe].linkHidden&&(ie[ae].linkHidden=!1);break}ue||(ee[fe].item instanceof ValuedPrimitive||ee[fe].item instanceof Population)&&ie.push(ee[fe])}return ie;function oe(fe,ue){let ae=[];return fe instanceof Population&&fe.agentBase&&fe.agentBase.children().forEach(ce=>{ce instanceof ValuedPrimitive&&ae.push({item:ce,type:"agent",linkHidden:ue,name:ce.name})}),ae.sort((se,ce)=>se.name===ce.name?0:se.name>ce.name?1:-1),ae}}get id(){return this._node.id}get name(){return this._node.getAttribute("name")}set name(ee){this._node.setAttribute("name",ee)}get note(){return this._node.getAttribute("Note")}set note(ee){this._node.setAttribute("Note",ee)}}class ValuedPrimitive extends Primitive{get units(){return this._node.getAttribute("Units")}set units(ee){this._node.setAttribute("Units",ee)}get constraints(){let ee={};return isTrue(this._node.getAttribute("MinConstraintUsed"))&&(ee.min=+this._node.getAttribute("MinConstraint")),isTrue(this._node.getAttribute("MaxConstraintUsed"))&&(ee.max=+this._node.getAttribute("MaxConstraint")),ee}set constraints(ee){this._node.setAttribute("MinConstraint",ee.min),this._node.setAttribute("MinConstraintUsed","min"in ee),this._node.setAttribute("MaxConstraint",ee.max),this._node.setAttribute("MaxConstraintUsed","max"in ee)}get external(){return isTrue(this._node.getAttribute("ShowSlider"))}set external(ee){this._node.setAttribute("ShowSlider",ee)}}class Stock extends ValuedPrimitive{get initial(){return this._node.getAttribute("InitialValue")||""}set initial(ee){this._node.setAttribute("InitialValue",""+ee)}get type(){return this._node.getAttribute("StockMode")}set type(ee){this._node.setAttribute("StockMode",""+ee)}get delay(){return this._node.getAttribute("Delay")}set delay(ee){this._node.setAttribute("Delay",""+ee)}get nonNegative(){return isTrue(this._node.getAttribute("NonNegative"))}set nonNegative(ee){this._node.setAttribute("NonNegative",ee)}}class Variable extends ValuedPrimitive{get value(){return this._node.getAttribute("Equation")||""}set value(ee){this._node.setAttribute("Equation",""+ee)}}class Converter extends ValuedPrimitive{get interpolation(){return this._node.getAttribute("Interpolation")}set interpolation(ee){this._node.setAttribute("Interpolation",ee)}get values(){return this._node.getAttribute("Data").split(";").map(ee=>{let re=ee.split(",");if(re.length!==2)throw new ModelError(`Converter data point should have the form "x, y", got "${ee}"`,{primitive:this,code:2100});let ne={x:+re[0],y:+re[1]};if(isNaN(ne.x)||isNaN(ne.y))throw new ModelError(`Converter has invalid data "${ee}"`,{primitive:this,showEditor:!0,code:2101});return ne})}set values(ee){this._node.setAttribute("Data",ee.map(re=>re.x+","+re.y).join(";"))}get input(){let ee=this._node.getAttribute("Source");return ee==="Time"?ee:this.model.getId(ee)}set input(ee){this._node.setAttribute("Source",ee==="Time"?ee:ee.id)}}class Flow extends ValuedPrimitive{get rate(){return this._node.getAttribute("FlowRate")||""}set rate(ee){this._node.setAttribute("FlowRate",""+ee)}get start(){return this._node.source?this._node.source.primitive(this.model):null}set start(ee){this._node.source=ee._node}get end(){return this._node.target?this._node.target.primitive(this.model):null}set end(ee){this._node.target=ee._node}get nonNegative(){return isTrue(this._node.getAttribute("OnlyPositive"))}set nonNegative(ee){this._node.setAttribute("OnlyPositive",ee)}}class Link extends Primitive{get biDirectional(){return isTrue(this._node.getAttribute("BiDirectional"))}set biDirectional(ee){this._node.setAttribute("BiDirectional",ee)}get start(){return this._node.source?this._node.source.primitive(this.model):null}set start(ee){this._node.source=ee._node}get end(){return this._node.target?this._node.target.primitive(this.model):null}set end(ee){this._node.target=ee._node}}class State extends ValuedPrimitive{get startActive(){return this._node.getAttribute("Active")}set startActive(ee){this._node.setAttribute("Active",ee)}get residency(){return this._node.getAttribute("Residency")}set residency(ee){this._node.setAttribute("Residency",ee)}}class Transition extends ValuedPrimitive{get value(){return this._node.getAttribute("Value")||""}set value(ee){this._node.setAttribute("Value",""+ee)}get start(){return this._node.source?this._node.source.primitive(this.model):null}set start(ee){this._node.source=ee._node}get end(){return this._node.target?this._node.target.primitive(this.model):null}set end(ee){this._node.target=ee._node}get recalculate(){return isTrue(this._node.getAttribute("Recalculate"))}set recalculate(ee){this._node.setAttribute("Recalculate",ee)}get repeat(){return isTrue(this._node.getAttribute("Repeat"))}set repeat(ee){this._node.setAttribute("Repeat",ee)}get trigger(){return this._node.getAttribute("Trigger")}set trigger(ee){this._node.setAttribute("Trigger",ee)}}class Action extends Primitive{get value(){return this._node.getAttribute("Value")||""}set value(ee){this._node.setAttribute("Value",""+ee)}get action(){return this._node.getAttribute("Action")}set action(ee){this._node.setAttribute("Action",""+ee)}get recalculate(){return isTrue(this._node.getAttribute("Recalculate"))}set recalculate(ee){this._node.setAttribute("Recalculate",ee)}get repeat(){return isTrue(this._node.getAttribute("Repeat"))}set repeat(ee){this._node.setAttribute("Repeat",ee)}get trigger(){return this._node.getAttribute("Trigger")}set trigger(ee){this._node.setAttribute("Trigger",ee)}}class Population extends Primitive{get agentBase(){let ee=this._node.getAttribute("Agent");return ee?this.model.getId(ee):null}set agentBase(ee){this._node.setAttribute("Agent",ee.id)}get populationSize(){return+this._node.getAttribute("Size")}set populationSize(ee){this._node.setAttribute("Size",ee)}get geoUnits(){return this._node.getAttribute("GeoDimUnits")}set geoUnits(ee){this._node.setAttribute("GeoDimUnits",ee)}get geoWidth(){return this._node.getAttribute("GeoWidth")}set geoWidth(ee){this._node.setAttribute("GeoWidth",ee)}get geoHeight(){return this._node.getAttribute("GeoHeight")}set geoHeight(ee){this._node.setAttribute("GeoHeight",ee)}get geoWrapAround(){return isTrue(this._node.getAttribute("GeoWrap"))}set geoWrapAround(ee){this._node.setAttribute("GeoWrap",ee)}get geoPlacementType(){return this._node.getAttribute("Placement")}set geoPlacementType(ee){this._node.setAttribute("Placement",ee)}get geoPlacementFunction(){return this._node.getAttribute("PlacementFunction")}set geoPlacementFunction(ee){this._node.setAttribute("PlacementFunction",ee)}get networkType(){return this._node.getAttribute("Network")}set networkType(ee){this._node.setAttribute("Network",ee)}get networkFunction(){return this._node.getAttribute("NetworkFunction")}set networkFunction(ee){this._node.setAttribute("NetworkFunction",ee)}}class Container extends Primitive{children(ee=!0){let re=this._node.children?this._node.children.map(ne=>ne.primitive(this.model)):[];if(ee){let ne=re.length;for(let ie=0;ie<ne;ie++){let oe=re[ie];oe instanceof Container&&(re=re.concat(oe.children(ee)))}}return re}Stock(ee={}){let re=this.model.Stock(ee);return re.parent=this,re}Variable(ee={}){let re=this.model.Variable(ee);return re.parent=this,re}Converter(ee={}){let re=this.model.Converter(ee);return re.parent=this,re}State(ee={}){let re=this.model.State(ee);return re.parent=this,re}Action(ee={}){let re=this.model.Action(ee);return re.parent=this,re}Population(ee={}){let re=this.model.Population(ee);return re.parent=this,re}Flow(ee,re,ne={}){let ie=this.model.Flow(ee,re,ne);return ie.parent=this,ie}Transition(ee,re,ne={}){let ie=this.model.Transition(ee,re,ne);return ie.parent=this,ie}Link(ee,re,ne={}){let ie=this.model.Link(ee,re,ne);return ie.parent=this,ie}get frozen(){return isTrue(this._node.getAttribute("Frozen"))}set frozen(ee){this._node.setAttribute("Frozen",ee)}get customTimeSettings(){let ee=JSON.parse(this._node.getAttribute("Solver")||"{}");return ee.algorithm==="RK1"&&(ee.algorithm="Euler"),ee}set customTimeSettings(ee){let re=Object.assign({},ee);re.algorithm==="Euler"&&(re.algorithm="RK1"),this._node.setAttribute("Solver",JSON.stringify(re))}}class Folder extends Container{}class Agent extends Container{get agentParent(){return this._node.getAttribute("AgentBase")}set agentParent(ee){this._node.setAttribute("AgentBase",ee)}}class ModelNode{constructor(){this.attributes=new Map,this.parent=null,this.children=[],this.id=null,this.value={nodeName:null},this._primitive=void 0,this.source=null,this.target=null}primitive(ee,re={}){return this._primitive===void 0&&(this.value.nodeName==="Stock"?this._primitive=new Stock(this,re):this.value.nodeName==="Variable"?this._primitive=new Variable(this,re):this.value.nodeName==="Converter"?this._primitive=new Converter(this,re):this.value.nodeName==="State"?this._primitive=new State(this,re):this.value.nodeName==="Action"?this._primitive=new Action(this,re):this.value.nodeName==="Agents"?this._primitive=new Population(this,re):this.value.nodeName==="Flow"?this._primitive=new Flow(this,re):this.value.nodeName==="Transition"?this._primitive=new Transition(this,re):this.value.nodeName==="Link"?this._primitive=new Link(this,re):this.value.nodeName==="Folder"?this.getAttribute("Type")==="Agent"?this._primitive=new Agent(this,re):this._primitive=new Folder(this,re):this._primitive=null,this._primitive&&!this._primitive.model&&(this._primitive.model=ee)),this._primitive}addChild(ee){if(ee.parent){let re=ee.parent.children.indexOf(ee);re>-1&&ee.parent.children.splice(re,1)}this.children.push(ee),ee.parent=this}getAttribute(ee){return ee==="id"?this.id:this.attributes.get(ee)}setAttribute(ee,re){if(ee==="id"){this.id=""+re;return}this.attributes.set(ee,""+re)}getValue(){return{removeAttribute:ee=>this.attributes.delete(ee)}}toString(ee=0){let re=" ".repeat(ee)+`<${this.value.nodeName}${this.getAttribute("name")?" ["+this.getAttribute("name")+"]":""}>`,ne=`</${this.value.nodeName}>`;return re+(this.children.length?`
`:"")+this.children.map(ie=>" ".repeat(ee)+ie.toString(ee+2)).join(`
`)+(this.children.length?`
`+" ".repeat(ee):"")+ne}}function findRootParent(te){return te.parent?findRootParent(te.parent):te}function modelNodeClone(te,ee){let re=new ModelNode;re.value=te.cloneNode(!0),re.parent=ee;let ne=["1"].concat(primitives(findRootParent(ee)).map(ie=>ie.id).filter(ie=>!!ie));if(te.attributes.length>0)for(let ie=0;ie<te.attributes.length;ie++){let oe=te.attributes.item(ie);re.setAttribute(oe.nodeName,oe.nodeValue)}return re.setAttribute("id",""+(Math.max.apply(null,ne)+1)),re}function primitives(te,ee){let re=nodeChildren(te.children[0]);if(ee){let ne=[];for(let ie of re)(Array.isArray(ee)?ee.includes(ie.value.nodeName):ie.value.nodeName===ee)&&ne.push(ie);return ne}else return re}function nodeChildren(te){let ee=te.children.slice(),re=ee.length;for(let ne=0;ne<re;ne++){let ie=ee[ne];ee=ee.concat(nodeChildren(ie))}return ee}let fn={"+":function(te,ee){return te+ee},"-":function(te,ee){return ee!==void 0?te-ee:-te},"*":function(te,ee){return te*ee},"/":function(te,ee){return te/ee},"=":function(te,ee){return te===ee},"<":function(te,ee){return te<ee},"<=":function(te,ee){return te<=ee},">":function(te,ee){return te>ee},">=":function(te,ee){return te>=ee},mod:function(te,ee){return te%ee},expt:function(te,ee){return Math.pow(te,ee)},abs:Math.abs,sin:Math.sin,asin:Math.asin,cos:Math.cos,acos:Math.acos,tan:Math.tan,atan:Math.atan,sqrt:Math.sqrt,log:function(te,ee){return ee!==void 0?Math.log(te)/Math.log(ee):Math.log(te)},exp:Math.exp,round:Math.round,floor:Math.floor,ceiling:Math.ceil};function sortAndCollapseUnits(te,ee){if(te.length<=1)te.length===1&&(te[0]=te[0].toLowerCase());else{let re=[];for(let ne=0;ne<te.length;ne++)re.push({name:te[ne].toLowerCase(),exponent:ee[ne]});re.sort((ne,ie)=>ne.name.localeCompare(ie.name)),te=[],ee=[];for(let ne=0;ne<re.length;ne++)te.push(re[ne].name),ee.push(re[ne].exponent);for(let ne=0;ne<te.length;ne++){for(let ie=ne+1;ie<te.length;ie++)te[ne]===te[ie]&&(ee[ne]=ee[ne]+ee[ie],te.splice(ie,1),ee.splice(ie,1),ie--);ee[ne]===0&&(te.splice(ne,1),ee.splice(ne,1),ne--)}}return{names:te,exponents:ee}}function getUnitsId(te,ee){return te.join(",")+ee.join(",")}class UnitStore{constructor(ee,re,ne){this.manager=ee,this.names=re,this.exponents=ne,this.toBase=null,this.baseUnits=null,this.multiples={},this.id=getUnitsId(this.names,this.exponents)}isUnitless(){return!this.exponents.find(ee=>ee!==0)}addBase(){if(this.toBase!==null)return;this.toBase=1;let ee=this.names.slice(),re=this.exponents.slice(),ne=!0;for(;ne;){ne=!1;for(let oe=ee.length-1;oe>=0;oe--){let fe=this.manager.findSource(ee[oe]);if(fe!==null&&!(fe.target.names.length===1&&fe.target.names[0]===ee[oe])){this.toBase=fn["*"](this.toBase,fn.expt(fe.scale,re[oe])),ee=ee.concat(fe.target.names),ee.splice(oe,1);let ue=re[oe];re=re.concat(fe.target.exponents.map(ae=>ae*ue)),re.splice(oe,1),ne=!0;break}}}let ie=sortAndCollapseUnits(ee,re);this.baseUnits=this.manager.getUnitStore(ie.names,ie.exponents,!1,!0)}power(ee){let re=this.names.slice(),ne=this.exponents.slice();for(let ie=0;ie<ne.length;ie++)ne[ie]=ne[ie]*ee;return this.manager.getUnitStore(re,ne)}toStringShort(){let ee="";for(let re=0;re<this.names.length;re++)ee!==""&&(ee=ee+","),ee=ee+this.names[re],this.exponents[re]!==1&&(ee=ee+"^"+this.exponents[re]);return ee}multiply(ee,re){let ne=ee.id+";"+re;if(!(ne in this.multiples)){this.toBase===null&&this.addBase(),ee.toBase===null&&ee.addBase();let ie,oe;if(this.baseUnits){if(ie=this.baseUnits.names.slice(),oe=this.baseUnits.exponents.slice(),ee.baseUnits){for(let fe=0;fe<ee.baseUnits.names.length;fe++){let ue=ie.indexOf(ee.baseUnits.names[fe]);if(ue!==-1)oe[ue]=oe[ue]+ee.baseUnits.exponents[fe]*re;else{let ae=!1;for(let se=0;se<ie.length;se++)if(ee.baseUnits.names[fe]<ie[se]){ie.splice(se,0,ee.baseUnits.names[fe]),oe.splice(se,0,ee.baseUnits.exponents[fe]*re),ae=!0;break}ae||(ie.push(ee.baseUnits.names[fe]),oe.push(ee.baseUnits.exponents[fe]*re))}}for(let fe=oe.length-1;fe>=0;fe--)oe[fe]===0&&(oe.splice(fe,1),ie.splice(fe,1))}}else ie=ee.baseUnits.names.slice(),oe=ee.baseUnits.exponents.slice();this.multiples[ne]=this.manager.getUnitStore(ie,oe)}return this.multiples[ne]}toString(){let ee="",re="",ne=0,ie=0;for(let oe=0;oe<this.names.length;oe++)if(this.names[oe]!==""){let fe='<span class="unit">'+toHTML(toTitleCase(this.names[oe]))+"</span>";this.exponents[oe]!==1&&this.exponents[oe]!==-1&&(fe=fe+"<span class='markup'>^</span><sup>"+Math.abs(this.exponents[oe])+"</sup>"),this.exponents[oe]>0?(ne>0&&(ee=ee+"<span class='markup'>*</span>"),ee=ee+fe,ne=ne+1):(ie>0&&(re=re+"<span class='markup'>*</span>"),re=re+fe,ie=ie+1)}return ee===""&&(ee="Unitless"),re===""?'<div class="units">'+ee+"</div>":(ee==="Unitless"&&(ee="1"),'<span class="units">'+ee+"<hr/><span class='markup'>/(</span>"+re+"<span class='markup'>)</span></span>")}}const titleCaseReg=/\w\S*/g;function titleCaseFunc(te){return te.charAt(0).toUpperCase()+te.substr(1).toLowerCase()}function toTitleCase(te){return te.replace(titleCaseReg,titleCaseFunc)}function convertUnits(te,ee,re=!1){if(te===ee)return 1;let ne=!te||te.isUnitless(),ie=!ee||ee.isUnitless();return ne&&ie?1:!ne&&ie?0:ne&&!ie?re?1:0:(te.toBase===null&&te.addBase(),ee.toBase===null&&ee.addBase(),te.baseUnits!==ee.baseUnits?0:fn["/"](te.toBase,ee.toBase))}const DEFAULT_UNITS=[{source:/^Degree$/i,targetString:"Degrees",scale:1},{source:/^Radians?$/i,targetString:"Degrees",scale:180/Math.PI},{source:/^Ampere$/i,targetString:"Amperes",scale:1},{source:/^Gram$/i,targetString:"Grams",scale:1},{source:/^Second$/i,targetString:"Seconds",scale:1},{source:/^Meter$/i,targetString:"Meters",scale:1},{source:/^(Meters? ?Squared?|Squared? ?Meters?)$/i,targetString:"Meters^2",scale:1},{source:/^(Centimeters? ?Squared?|Squared? ?Centimeters?)$/i,targetString:"Centimeters^2",scale:1},{source:/^(Centimeters? ?Cubed?|Cubic ?Centimeters?)$/i,targetString:"Centimeters^3",scale:1},{source:/^(Meters? Cubed?|Cubic ?Meters?)$/i,targetString:"Meters^3",scale:1},{source:/^(Kilometers? ?Cubed?|Cubic ?Kilometers?)$/i,targetString:"Kilometers^3",scale:1},{source:/^(Inches? Squared?|Squared? ?Inches?)$/i,targetString:"Inches^2",scale:1},{source:/^(Miles? ?Squared?|Squared? ?Miles?)$/i,targetString:"Miles^2",scale:1},{source:/^(Kilometers? Squared?|Squared? ?Kilometers?)$/i,targetString:"Kilometers^2",scale:1},{source:/^Acre? ?(Feet|Foot)$/i,targetString:"Acres,Feet",scale:1},{source:/^Meters? ?per ?Seconds?$/i,targetString:"Meters,Seconds^-1",scale:1},{source:/^Meters? ?per ?Seconds? ?Squared?$/i,targetString:"Meters,Seconds^-2",scale:1},{source:/^(Foot|Feet) ?per ?Seconds?$/i,targetString:"Feet,Seconds^-1",scale:1},{source:/^(Foot|Feet) ?per ?Seconds? ?Squared?$/i,targetString:"Feet,Seconds^-2",scale:1},{source:/^Miles? ?per ?Hours?$/i,targetString:"Miles,Hours^-1",scale:1},{source:/^Miles? ?per ?Hours? ?Squared?$/i,targetString:"Miles,Hours^-2",scale:1},{source:/^Kilometers? ?per ?Hours?$/i,targetString:"Kilometers,Hours^-1",scale:1},{source:/^Kilometers? ?per ?Hours? ?Squared?$/i,targetString:"Kilometers,Hours^-2",scale:1},{source:/^Liters? ?per ?Seconds?$/i,targetString:"Liters,Seconds^-1",scale:1},{source:/^(Cubic ?Meters?|Meters? ?Cubed?) ?per ?Seconds?$/i,targetString:"Meters^3,Seconds^-1",scale:1},{source:/^(Squared? ?Yards?|Yards? ?Squared?)$/i,targetString:"Yards^2",scale:1},{source:/^(Squared? ?(Feet|Foot)|(Feet|Foot) ?Squared?)$/i,targetString:"Feet^2",scale:1},{source:/^(Squared? Millimeters?|Millimeters? ?Squared?)$/i,targetString:"Millimeters^2",scale:1},{source:/^(Millimeters? ?Cubed?|Cubic ?Millimeters?)$/i,targetString:"Millimeters^3",scale:1},{source:/^Gallons? ?per ?Seconds?$/i,targetString:"Gallons,Seconds^-1",scale:1},{source:/^Gallons? ?per ?Minutes?$/i,targetString:"Gallons,Minutes^-1",scale:1},{source:/^Pounds? ?per ?Seconds?$/i,targetString:"Pounds,Seconds^-1",scale:1},{source:/^Kilograms? ?per ?Seconds?$/i,targetString:"Kilograms,Seconds^-1",scale:1},{source:/^Dollars? ?per ?Seconds?$/i,targetString:"Dollars,Seconds^-1",scale:1},{source:/^Dollars? ?per ?Hours?$/i,targetString:"Dollars,Hours^-1",scale:1},{source:/^Dollars? ?per ?Days?$/i,targetString:"Dollars,Days^-1",scale:1},{source:/^Dollars? ?per ?Weeks?$/i,targetString:"Dollars,Weeks^-1",scale:1},{source:/^Dollars? ?per ?Months?$/i,targetString:"Dollars,Months^-1",scale:1},{source:/^Dollars? ?per ?Quarters?$/i,targetString:"Dollars,Quarters^-1",scale:1},{source:/^Dollars? ?per ?Years?$/i,targetString:"Dollars,Years^-1",scale:1},{source:/^Euros? ?per ?Seconds?$/i,targetString:"Euros,Seconds^-1",scale:1},{source:/^Euros? ?per ?Hours?$/i,targetString:"Euros,Hours^-1",scale:1},{source:/^Euros? ?per ?Days?$/i,targetString:"Euros,Days^-1",scale:1},{source:/^Euros? ?per ?Weeks?$/i,targetString:"Euros,Weeks^-1",scale:1},{source:/^Euros? ?per ?Months?$/i,targetString:"Euros,Months^-1",scale:1},{source:/^Euros? ?per ?Quarters?$/i,targetString:"Euros,Quarters^-1",scale:1},{source:/^Euros? ?per ?Years?$/i,targetString:"Euros,Years^-1",scale:1},{source:/^Centimeters?$/i,targetString:"Meters",scale:.01},{source:/^Millimeters?$/i,targetString:"Meters",scale:.001},{source:/^Kilometers?$/i,targetString:"Meters",scale:1e3},{source:/^Inch(es)?$/i,targetString:"Meters",scale:.0254},{source:/^(Foot|Feet)$/i,targetString:"Meters",scale:.3048},{source:/^Yards?$/i,targetString:"Meters",scale:.9144},{source:/^Miles?$/i,targetString:"Meters",scale:1609.344},{source:/^Acres?$/i,targetString:"Meters^2",scale:4046.85642},{source:/^Hectares?$/i,targetString:"Meters^2",scale:1e4},{source:/^Liters?$/i,targetString:"Meters^3",scale:.001},{source:/^Gallons?$/i,targetString:"Meters^3",scale:.003785},{source:/^Quarts?$/i,targetString:"Meters^3",scale:946e-6},{source:/^Fluid ?Ounces?$/i,targetString:"Meters^3",scale:3e-5},{source:/^Years?$/i,targetString:"Seconds",scale:31536e3},{source:/^Quarters?$/i,targetString:"Seconds",scale:7884e3},{source:/^Months?$/i,targetString:"Seconds",scale:2628e3},{source:/^Weeks?$/i,targetString:"Seconds",scale:604800},{source:/^Days?$/i,targetString:"Seconds",scale:86400},{source:/^Hours?$/i,targetString:"Seconds",scale:3600},{source:/^Minutes?$/i,targetString:"Seconds",scale:60},{source:/^Kilograms?$/i,targetString:"Grams",scale:1e3},{source:/^Milligrams?$/i,targetString:"Grams",scale:.001},{source:/^Ounces?$/i,targetString:"Grams",scale:28.349523},{source:/^Pounds?$/i,targetString:"Grams",scale:453.59237},{source:/^Tonnes?$/i,targetString:"Grams",scale:1e6},{source:/^Tons?$/i,targetString:"Grams",scale:907184.74},{source:/^Watts?$/i,targetString:"Joules,Seconds^-1",scale:1},{source:/^Kilowatts?$/i,targetString:"Watts",scale:1e3},{source:/^Megawatts?$/i,targetString:"Watts",scale:1e6},{source:/^Gigawatts?$/i,targetString:"Watts",scale:1e9},{source:/^Calories?$/i,targetString:"Joules",scale:4.184},{source:/^Kilocalories?$/i,targetString:"Joules",scale:4184},{source:/^(BTUs?|British ?Thermal ?units?)$/i,targetString:"Joules",scale:1055.05585},{source:/^Kilojoules?$/i,targetString:"Joules",scale:1e3},{source:/^Joules?$/i,targetString:"Newtons,Meters",scale:1},{source:/^Coulombs?$/i,targetString:"Amperes,Seconds",scale:1},{source:/^Volts?$/i,targetString:"Watts,Amperes^-1",scale:1},{source:/^Millivolts?$/i,targetString:"Volts",scale:.001},{source:/^Kilovolts?$/i,targetString:"Volts",scale:1e3},{source:/^Newtons?$/i,targetString:"Kilograms,Meters,Seconds^-2",scale:1},{source:/^Pounds? ?Force$/i,targetString:"Pounds,Feet per Second Squared",scale:32.17405},{source:/^Atoms?$/i,targetString:"Moles",scale:1/602214076e15},{source:/^Molecules?$/i,targetString:"Moles",scale:1/602214076e15},{source:/^Farads?$/i,targetString:"Joules,Volts^-2",scale:1},{source:/^Pascals?$/i,targetString:"Newton,Meters^-2",scale:1},{source:/^Kilopascals?$/i,targetString:"Pascals",scale:1e3},{source:/^Bars?$/i,targetString:"Pascals",scale:1e5},{source:/^Atmospheres?$/i,targetString:"Pascals",scale:101325},{source:/^Pounds? ?per ?Squared? ?Inch(es)?$/i,targetString:"Pascals",scale:6894}];class UnitManager{constructor(){this.unitDefinitions=[],this.cachedUnits=Object.create(null),this.unitsBank=Object.create(null),this.addUnits(DEFAULT_UNITS)}addUnits(ee){for(let re of ee)re.source||(re.source=new RegExp("^"+re.sourceString+"$","i")),re.target||(re.target=this.unitsFromString(re.targetString.toLowerCase()));this.unitDefinitions=ee.concat(this.unitDefinitions)}findSource(ee){if(!(ee in this.cachedUnits)){this.cachedUnits[ee]=null;for(let re=this.unitDefinitions.length-1;re>=0;re--)if(this.unitDefinitions[re].source.test(ee)){this.cachedUnits[ee]=this.unitDefinitions[re];break}}return this.cachedUnits[ee]}getUnitStore(ee,re,ne=!1,ie=!1){if(ne){let fe=sortAndCollapseUnits(ee,re);ee=fe.names,re=fe.exponents}if(!ie&&!ee.length)return;let oe=getUnitsId(ee,re);return this.unitsBank[oe]||(this.unitsBank[oe]=new UnitStore(this,ee,re)),this.unitsBank[oe]}unitsFromString(ee){let re=[],ne=[];if(ee){let ie=ee.split(",");for(let oe=0;oe<ie.length;oe++)re.push(ie[oe].split("^")[0]),ie[oe].indexOf("^")!==-1?ne.push(parseFloat(ie[oe].split("^")[1])):ne.push(1)}return this.getUnitStore(re,ne,!0)}}class Material{constructor(ee,re){this.value=ee,this.units=re}toNum(){return this}toString(){return this.units&&!this.units.isUnitless()?"{"+this.value+" "+this.units.toStringShort()+"}":this.value+""}fullClone(){return new Material(this.value,this.units)}forceUnits(ee){if(!this.units)this.units=ee;else{let re=convertUnits(this.units,ee);re===0?unitAlert(this.units,ee,"conversion of units"):(this.value=fn["*"](this.value,re),this.units=ee)}return this}}function unitAlert(te,ee,re){throw new ModelError("Incompatible units for the "+re+" of "+(te&&!te.isUnitless()?te.toString():"unitless")+" and "+(ee&&!ee.isUnitless()?ee.toString():"unitless")+".",{code:5e3})}class AggregateSeries{constructor(ee,re,ne){this.simulate=ee,this.id=re,this.spacing=ne,this.oldValues=[]}match(ee){return this.id===ee}get(ee){let re=0;for(this.spacing<0?re=0:this.spacing===0?re=Math.floor(div(minus(this.simulate.time(),this.simulate.timeStart),this.simulate.userTimeStep).value):this.spacing instanceof Material?re=Math.floor(div(minus(this.simulate.time(),this.simulate.timeStart),this.spacing.forceUnits(this.simulate.timeUnits)).value):console.error("Invalid spacing:",this.spacing);this.oldValues.length-1<re;){let ne=evaluateNode(ee.node,ee.scope,this.simulate);ne instanceof SPrimitive&&(ne=ne.value()),this.oldValues.push(ne)}return this.oldValues[re].fullClone?this.oldValues[re].fullClone():this.oldValues[re]}}class DataBank{constructor(){this.dataSeries={}}series(){return Object.keys(this.dataSeries)}clone(){let ee=new DataBank,re=this.series();for(let ne=0;ne<re.length;ne++)ee.dataSeries[re[ne]]=this.dataSeries[re[ne]];return ee}getSeries(ee){return ee in this.dataSeries||(this.dataSeries[ee]=[]),this.dataSeries[ee]}trimValues(ee){let re=this.series();for(let ne=0;ne<re.length;ne++){let ie=this.getSeries(re[ne]);ie.length-1>ee&&ie.splice(ee+1,ie.length-ee+1)}}}function print$1(te,ee=re=>re.key){let re=[];return row(te,"",!0,ne=>re.push(ne),ee),re.join("")}function row(te,ee,re,ne,ie){if(te){ne(`${ee}${re?" ":" "}${ie(te)}
`);const oe=ee+(re?"    ":"   ");te.left&&row(te.left,oe,!1,ne,ie),te.right&&row(te.right,oe,!0,ne,ie)}}function isBalanced(te){if(te===null)return!0;let ee=height(te.left),re=height(te.right);return!!(Math.abs(ee-re)<=1&&isBalanced(te.left)&&isBalanced(te.right))}function height(te){return te?1+Math.max(height(te.left),height(te.right)):0}function loadRecursive(te,ee,re,ne,ie){const oe=ie-ne;if(oe>0){const fe=ne+Math.floor(oe/2),ue=ee[fe],ae=re[fe],se={key:ue,data:ae,parent:te};return se.left=loadRecursive(se,ee,re,ne,fe),se.right=loadRecursive(se,ee,re,fe+1,ie),se}return null}function markBalance(te){if(te===null)return 0;const ee=markBalance(te.left),re=markBalance(te.right);return te.balanceFactor=ee-re,Math.max(ee,re)+1}function sort(te,ee,re,ne,ie){if(re>=ne)return;const oe=te[re+ne>>1];let fe=re-1,ue=ne+1;for(;;){do fe++;while(ie(te[fe],oe)<0);do ue--;while(ie(te[ue],oe)>0);if(fe>=ue)break;let ae=te[fe];te[fe]=te[ue],te[ue]=ae,ae=ee[fe],ee[fe]=ee[ue],ee[ue]=ae}sort(te,ee,re,ue,ie),sort(te,ee,ue+1,ne,ie)}function DEFAULT_COMPARE(te,ee){return te>ee?1:te<ee?-1:0}function rotateLeft(te){let ee=te.right;return te.right=ee.left,ee.left&&(ee.left.parent=te),ee.parent=te.parent,ee.parent&&(ee.parent.left===te?ee.parent.left=ee:ee.parent.right=ee),te.parent=ee,ee.left=te,te.balanceFactor+=1,ee.balanceFactor<0&&(te.balanceFactor-=ee.balanceFactor),ee.balanceFactor+=1,te.balanceFactor>0&&(ee.balanceFactor+=te.balanceFactor),ee}function rotateRight(te){let ee=te.left;return te.left=ee.right,te.left&&(te.left.parent=te),ee.parent=te.parent,ee.parent&&(ee.parent.left===te?ee.parent.left=ee:ee.parent.right=ee),te.parent=ee,ee.right=te,te.balanceFactor-=1,ee.balanceFactor>0&&(te.balanceFactor-=ee.balanceFactor),ee.balanceFactor-=1,te.balanceFactor<0&&(ee.balanceFactor+=te.balanceFactor),ee}class AVLTree{constructor(ee,re=!1){this._comparator=ee||DEFAULT_COMPARE,this._root=null,this._size=0,this._noDuplicates=!!re}destroy(){return this.clear()}clear(){return this._root=null,this._size=0,this}get size(){return this._size}contains(ee){if(this._root){let re=this._root,ne=this._comparator;for(;re;){let ie=ne(ee,re.key);if(ie===0)return!0;ie<0?re=re.left:re=re.right}}return!1}next(ee){let re=ee;if(re)if(re.right)for(re=re.right;re.left;)re=re.left;else for(re=ee.parent;re&&re.right===ee;)ee=re,re=re.parent;return re}prev(ee){let re=ee;if(re)if(re.left)for(re=re.left;re.right;)re=re.right;else for(re=ee.parent;re&&re.left===ee;)ee=re,re=re.parent;return re}forEach(ee){let re=this._root,ne=[],ie=!1,oe=0;for(;!ie;)re?(ne.push(re),re=re.left):ne.length>0?(re=ne.pop(),ee(re,oe++),re=re.right):ie=!0;return this}range(ee,re,ne,ie){const oe=[],fe=this._comparator;let ue=this._root,ae;for(;oe.length!==0||ue;)if(ue)oe.push(ue),ue=ue.left;else{if(ue=oe.pop(),ae=fe(ue.key,re),ae>0)break;if(fe(ue.key,ee)>=0&&ne.call(ie,ue))return this;ue=ue.right}return this}keys(){let ee=this._root,re=[],ne=[],ie=!1;for(;!ie;)ee?(re.push(ee),ee=ee.left):re.length>0?(ee=re.pop(),ne.push(ee.key),ee=ee.right):ie=!0;return ne}values(){let ee=this._root,re=[],ne=[],ie=!1;for(;!ie;)ee?(re.push(ee),ee=ee.left):re.length>0?(ee=re.pop(),ne.push(ee.data),ee=ee.right):ie=!0;return ne}at(ee){let re=this._root,ne=[],ie=!1,oe=0;for(;!ie;)if(re)ne.push(re),re=re.left;else if(ne.length>0){if(re=ne.pop(),oe===ee)return re;oe++,re=re.right}else ie=!0;return null}minNode(){let ee=this._root;if(!ee)return null;for(;ee.left;)ee=ee.left;return ee}maxNode(){let ee=this._root;if(!ee)return null;for(;ee.right;)ee=ee.right;return ee}min(){let ee=this._root;if(!ee)return null;for(;ee.left;)ee=ee.left;return ee.key}max(){let ee=this._root;if(!ee)return null;for(;ee.right;)ee=ee.right;return ee.key}isEmpty(){return!this._root}pop(){let ee=this._root,re=null;if(ee){for(;ee.left;)ee=ee.left;re={key:ee.key,data:ee.data},this.remove(ee.key)}return re}popMax(){let ee=this._root,re=null;if(ee){for(;ee.right;)ee=ee.right;re={key:ee.key,data:ee.data},this.remove(ee.key)}return re}find(ee){let ne=this._root,ie,oe=this._comparator;for(;ne;){if(ie=oe(ee,ne.key),ie===0)return ne;ie<0?ne=ne.left:ne=ne.right}return null}insert(ee,re){if(!this._root)return this._root={parent:null,left:null,right:null,balanceFactor:0,key:ee,data:re},this._size++,this._root;let ne=this._comparator,ie=this._root,oe=null,fe=0;if(this._noDuplicates)for(;ie;){if(fe=ne(ee,ie.key),oe=ie,fe===0)return null;fe<0?ie=ie.left:ie=ie.right}else for(;ie;)fe=ne(ee,ie.key),oe=ie,fe<=0?ie=ie.left:ie=ie.right;let ue={left:null,right:null,balanceFactor:0,parent:oe,key:ee,data:re},ae;for(fe<=0?oe.left=ue:oe.right=ue;oe&&(fe=ne(oe.key,ee),fe<0?oe.balanceFactor-=1:oe.balanceFactor+=1,oe.balanceFactor!==0);){if(oe.balanceFactor<-1){oe.right.balanceFactor===1&&rotateRight(oe.right),ae=rotateLeft(oe),oe===this._root&&(this._root=ae);break}else if(oe.balanceFactor>1){oe.left.balanceFactor===-1&&rotateLeft(oe.left),ae=rotateRight(oe),oe===this._root&&(this._root=ae);break}oe=oe.parent}return this._size++,ue}remove(ee){if(!this._root)return null;let re=this._root,ne=this._comparator,ie=0;for(;re&&(ie=ne(ee,re.key),ie!==0);)ie<0?re=re.left:re=re.right;if(!re)return null;let oe=re.key,fe,ue;if(re.left){for(fe=re.left;fe.left||fe.right;){for(;fe.right;)fe=fe.right;re.key=fe.key,re.data=fe.data,fe.left&&(re=fe,fe=fe.left)}re.key=fe.key,re.data=fe.data,re=fe}if(re.right){for(ue=re.right;ue.left||ue.right;){for(;ue.left;)ue=ue.left;re.key=ue.key,re.data=ue.data,ue.right&&(re=ue,ue=ue.right)}re.key=ue.key,re.data=ue.data,re=ue}let ae=re.parent,se=re,ce;for(;ae&&(ae.left===se?ae.balanceFactor-=1:ae.balanceFactor+=1,ae.balanceFactor<-1?(ae.right.balanceFactor===1&&rotateRight(ae.right),ce=rotateLeft(ae),ae===this._root&&(this._root=ce),ae=ce):ae.balanceFactor>1&&(ae.left.balanceFactor===-1&&rotateLeft(ae.left),ce=rotateRight(ae),ae===this._root&&(this._root=ce),ae=ce),!(ae.balanceFactor===-1||ae.balanceFactor===1));)se=ae,ae=ae.parent;return re.parent&&(re.parent.left===re?re.parent.left=null:re.parent.right=null),re===this._root&&(this._root=null),this._size--,oe}load(ee=[],re=[],ne=!1){if(this._size!==0)throw new Error("bulk-load: tree is not empty");const ie=ee.length;return ne&&sort(ee,re,0,ie-1,this._comparator),this._root=loadRecursive(null,ee,re,0,ie),markBalance(this._root),this._size=ie,this}isBalanced(){return isBalanced(this._root)}toString(ee){return print$1(this._root,ee)}}AVLTree.default=AVLTree;class TaskQueue{constructor(ee){ee=ee||{},this.tasks=new AVLTree(compare),this.onMoveEvents=[],this.setTime(ee.start),this.debug=!1,this.end=ee.end,this.states={},this.cursor=null}print(){console.log("Current Time: "+this.time.value);let ee=this.tasks.minNode();for(;ee;)console.log(ee.key.name),console.log("    Time: "+ee.key.time.value),console.log("    Priority: "+ee.key.priority),ee.key.expires!==void 0&&console.log("    Expires: "+ee.key.expires),ee.key.skip!==void 0&&console.log("    Skip: "+ee.key.skip),ee=this.tasks.next(ee)}addEvent(ee){this.onMoveEvents.push(ee)}fireEvents(ee,re,ne){this.debug&&console.log("Firing Events");for(let ie=0;ie<this.onMoveEvents.length;ie++)this.onMoveEvents[ie](ee,re,ne)}setTime(ee){if(this.time===void 0||neq(ee,this.time)){let re=this.time;this.time=ee,re!==void 0&&this.fireEvents(minus(ee,re),re,ee)}}moveTo(ee){if(!eq(this.time,ee)){if(this.debug&&console.log("Shifting time to: "+ee.value),this.cursor){let re=this.tasks.max().time,ne=this.tasks.min().time;for(;lessThan(this.time,ee)&&!greaterThan(this.time,re);)this.step();for(;greaterThan(this.time,ee)&&greaterThan(this.time,ne);)this.stepBack()}this.setTime(ee),this.debug&&console.log("Time shift to  "+ee.value+" completed.")}}add(ee){ee.queue=this,this.tasks.insert(ee)}goNext(){this.cursor=this.tasks.next(this.cursor)}goPrev(){this.cursor=this.tasks.prev(this.cursor)}step(){this.time===void 0&&(this.cursor=this.tasks.minNode(),this.setTime(this.cursor.key.time));let ee=this.cursor.key;if(ee){let re=ee.deadAction;if(ee.execute(),!re&&ee.timeShift){ee.timeShift();return}this.goNext()}this.cursor?this.setTime(this.cursor.key.time):(this.goNext(),this.setTime(mult(this.tasks.max().time,new Material(10))))}stepBack(){if(this.time===void 0){this.cursor=this.tasks.minNode(),this.setTime(this.cursor.key.time);return}this.cursor?this.goPrev():this.cursor=this.tasks.maxNode();let ee=this.cursor.key.time;for(;this.cursor&&eq(ee,this.cursor.key.time);)this.cursor.key.rollback(),this.goPrev();this.cursor?this.goNext():this.cursor=this.tasks.minNode(),this.setTime(this.cursor.key.time)}atStart(){return this.time===void 0||this.cursor.key===this.tasks.min()}completed(){return this.time!==void 0&&(greaterThan(this.time,this.end)||!this.cursor)}remove(ee){ee===this.cursor.key&&this.goNext(),this.tasks.remove(ee)}}let taskIdCounter=0;class Task{constructor(ee){if(this.id=taskIdCounter++,this.name=ee.name,this.time=ee.time,!this.time)throw new TypeError("Task time is missing.");if(isNaN(this.time.value))throw new TypeError("Task time is a NaN.");this.action=ee.action,this.reverse=ee.rollback,this.priority=ee.priority||0,this.expires=ee.expires,this.skip=ee.skip,this.timeShift=ee.timeShift,this.data=ee.data,this.blocker=ee.blocker,this.queue=void 0,this.deadAction=!1,this.deadReverse=!1,this.action&&(this.action.task=this),this.reverse&&(this.action.reverse=this)}execute(){this.action&&!this.deadAction&&(!this.blocker||!this.queue.states[this.blocker])&&(this.skip!==void 0&&this.skip>0?(this.skip--,this.queue.debug&&console.log("Skipping: "+this.name)):(this.queue.debug&&console.log("%c Executing: "+this.name+" (Time: "+this.time.value+")","color:blue"),this.expires!==void 0&&(this.expires--,this.queue.debug&&console.log("    Current count before expire: "+this.expires),this.expires<=0&&(this.queue.debug&&console.log("    Task expired."),this.deadAction=!0))),this.action(this))}rollback(){this.reverse&&!this.deadReverse&&(!this.blocker||!this.queue.states[this.blocker])&&(this.queue.debug&&console.log("Rolling back: "+this.name+" (Time: "+this.time.value+")"),this.expires!==void 0&&this.expires<=0&&(this.queue.debug&&console.log("    Rollback expired."),this.deadReverse=!0),this.reverse())}reschedule(ee){this.queue.remove(this),this.time=ee,this.queue.add(this)}remove(){this.queue.remove(this)}kill(){this.deadAction=!0,this.deadReverse=!0}block(ee){ee=ee||this.blocker,this.queue.states[ee]=!0}unblock(ee){ee=ee||this.blocker,this.queue.states[ee]=!1}toString(){return this.name+" - "+this.id}}function compare(te,ee){return eq(ee.time,te.time)?ee.priority===te.priority?ee.id===te.id?0:ee.id<te.id?1:-1:ee.priority<te.priority?1:-1:lessThan(ee.time,te.time)?1:-1}let jStat={};(function(te,ee){Object.assign(jStat,ee())})(globalThis,function(){var te=function(ee,re){var ne=Array.prototype.concat,ie=Array.prototype.slice,oe=Object.prototype.toString;function fe(we,ge){var _e=we>ge?we:ge;return ee.pow(10,17-~~(ee.log(_e>0?_e:-_e)*ee.LOG10E))}var ue=Array.isArray||function(ge){return oe.call(ge)==="[object Array]"};function ae(we){return oe.call(we)==="[object Function]"}function se(we){return typeof we=="number"?we-we===0:!1}function ce(we){return ne.apply([],we)}function le(){return new le._init(arguments)}le.fn=le.prototype,le._init=function(ge){if(ue(ge[0]))if(ue(ge[0][0])){ae(ge[1])&&(ge[0]=le.map(ge[0],ge[1]));for(var _e=0;_e<ge[0].length;_e++)this[_e]=ge[0][_e];this.length=ge[0].length}else this[0]=ae(ge[1])?le.map(ge[0],ge[1]):ge[0],this.length=1;else if(se(ge[0]))this[0]=le.seq.apply(null,ge),this.length=1;else{if(ge[0]instanceof le)return le(ge[0].toArray());this[0]=[],this.length=1}return this},le._init.prototype=le.prototype,le._init.constructor=le,le.utils={calcRdx:fe,isArray:ue,isFunction:ae,isNumber:se,toVector:ce},le._random_fn=ee.random,le.setRandom=function(ge){if(typeof ge!="function")throw new TypeError("fn is not a function");le._random_fn=ge},le.extend=function(ge){var _e,Te;if(arguments.length===1){for(Te in ge)le[Te]=ge[Te];return this}for(_e=1;_e<arguments.length;_e++)for(Te in arguments[_e])ge[Te]=arguments[_e][Te];return ge},le.rows=function(ge){return ge.length||1},le.cols=function(ge){return ge[0].length||1},le.dimensions=function(ge){return{rows:le.rows(ge),cols:le.cols(ge)}},le.row=function(ge,_e){return ue(_e)?_e.map(function(Te){return le.row(ge,Te)}):ge[_e]},le.rowa=function(ge,_e){return le.row(ge,_e)},le.col=function(ge,_e){if(ue(_e)){var Te=le.arange(ge.length).map(function(){return new Array(_e.length)});return _e.forEach(function(Oe,xe){le.arange(ge.length).forEach(function(Se){Te[Se][xe]=ge[Se][Oe]})}),Te}for(var Ne=new Array(ge.length),Le=0;Le<ge.length;Le++)Ne[Le]=[ge[Le][_e]];return Ne},le.cola=function(ge,_e){return le.col(ge,_e).map(function(Te){return Te[0]})},le.diag=function(ge){for(var _e=le.rows(ge),Te=new Array(_e),Ne=0;Ne<_e;Ne++)Te[Ne]=[ge[Ne][Ne]];return Te},le.antidiag=function(ge){for(var _e=le.rows(ge)-1,Te=new Array(_e),Ne=0;_e>=0;_e--,Ne++)Te[Ne]=[ge[Ne][_e]];return Te},le.transpose=function(ge){var _e=[],Te,Ne,Le,Oe,xe;for(ue(ge[0])||(ge=[ge]),Ne=ge.length,Le=ge[0].length,xe=0;xe<Le;xe++){for(Te=new Array(Ne),Oe=0;Oe<Ne;Oe++)Te[Oe]=ge[Oe][xe];_e.push(Te)}return _e.length===1?_e[0]:_e},le.map=function(ge,_e,Te){var Ne,Le,Oe,xe,Se;for(ue(ge[0])||(ge=[ge]),Le=ge.length,Oe=ge[0].length,xe=Te?ge:new Array(Le),Ne=0;Ne<Le;Ne++)for(xe[Ne]||(xe[Ne]=new Array(Oe)),Se=0;Se<Oe;Se++)xe[Ne][Se]=_e(ge[Ne][Se],Ne,Se);return xe.length===1?xe[0]:xe},le.cumreduce=function(ge,_e,Te){var Ne,Le,Oe,xe,Se;for(ue(ge[0])||(ge=[ge]),Le=ge.length,Oe=ge[0].length,xe=Te?ge:new Array(Le),Ne=0;Ne<Le;Ne++)for(xe[Ne]||(xe[Ne]=new Array(Oe)),Oe>0&&(xe[Ne][0]=ge[Ne][0]),Se=1;Se<Oe;Se++)xe[Ne][Se]=_e(xe[Ne][Se-1],ge[Ne][Se]);return xe.length===1?xe[0]:xe},le.alter=function(ge,_e){return le.map(ge,_e,!0)},le.create=function(ge,_e,Te){var Ne=new Array(ge),Le,Oe;for(ae(_e)&&(Te=_e,_e=ge),Le=0;Le<ge;Le++)for(Ne[Le]=new Array(_e),Oe=0;Oe<_e;Oe++)Ne[Le][Oe]=Te(Le,Oe);return Ne};function pe(){return 0}le.zeros=function(ge,_e){return se(_e)||(_e=ge),le.create(ge,_e,pe)};function de(){return 1}le.ones=function(ge,_e){return se(_e)||(_e=ge),le.create(ge,_e,de)},le.rand=function(ge,_e){return se(_e)||(_e=ge),le.create(ge,_e,le._random_fn)};function me(we,ge){return we===ge?1:0}le.identity=function(ge,_e){return se(_e)||(_e=ge),le.create(ge,_e,me)},le.symmetric=function(ge){var _e=ge.length,Te,Ne;if(ge.length!==ge[0].length)return!1;for(Te=0;Te<_e;Te++)for(Ne=0;Ne<_e;Ne++)if(ge[Ne][Te]!==ge[Te][Ne])return!1;return!0},le.clear=function(ge){return le.alter(ge,pe)},le.seq=function(ge,_e,Te,Ne){ae(Ne)||(Ne=!1);var Le=[],Oe=fe(ge,_e),xe=(_e*Oe-ge*Oe)/((Te-1)*Oe),Se=ge,be;for(be=0;Se<=_e&&be<Te;be++,Se=(ge*Oe+xe*Oe*be)/Oe)Le.push(Ne?Ne(Se,be):Se);return Le},le.arange=function(ge,_e,Te){var Ne=[],Le;if(Te=Te||1,_e===re&&(_e=ge,ge=0),ge===_e||Te===0)return[];if(ge<_e&&Te<0)return[];if(ge>_e&&Te>0)return[];if(Te>0)for(Le=ge;Le<_e;Le+=Te)Ne.push(Le);else for(Le=ge;Le>_e;Le+=Te)Ne.push(Le);return Ne},le.slice=function(){function we(_e,Te,Ne,Le){var Oe,xe=[],Se=_e.length;if(Te===re&&Ne===re&&Le===re)return le.copy(_e);if(Te=Te||0,Ne=Ne||_e.length,Te=Te>=0?Te:Se+Te,Ne=Ne>=0?Ne:Se+Ne,Le=Le||1,Te===Ne||Le===0)return[];if(Te<Ne&&Le<0)return[];if(Te>Ne&&Le>0)return[];if(Le>0)for(Oe=Te;Oe<Ne;Oe+=Le)xe.push(_e[Oe]);else for(Oe=Te;Oe>Ne;Oe+=Le)xe.push(_e[Oe]);return xe}function ge(_e,Te){var Ne,Le;if(Te=Te||{},se(Te.row)){if(se(Te.col))return _e[Te.row][Te.col];var Oe=le.rowa(_e,Te.row);return Ne=Te.col||{},we(Oe,Ne.start,Ne.end,Ne.step)}if(se(Te.col)){var xe=le.cola(_e,Te.col);return Le=Te.row||{},we(xe,Le.start,Le.end,Le.step)}Le=Te.row||{},Ne=Te.col||{};var Se=we(_e,Le.start,Le.end,Le.step);return Se.map(function(be){return we(be,Ne.start,Ne.end,Ne.step)})}return ge}(),le.sliceAssign=function(ge,_e,Te){var Ne,Le;if(se(_e.row)){if(se(_e.col))return ge[_e.row][_e.col]=Te;_e.col=_e.col||{},_e.col.start=_e.col.start||0,_e.col.end=_e.col.end||ge[0].length,_e.col.step=_e.col.step||1,Ne=le.arange(_e.col.start,ee.min(ge.length,_e.col.end),_e.col.step);var Oe=_e.row;return Ne.forEach(function(Se,be){ge[Oe][Se]=Te[be]}),ge}if(se(_e.col)){_e.row=_e.row||{},_e.row.start=_e.row.start||0,_e.row.end=_e.row.end||ge.length,_e.row.step=_e.row.step||1,Le=le.arange(_e.row.start,ee.min(ge[0].length,_e.row.end),_e.row.step);var xe=_e.col;return Le.forEach(function(Se,be){ge[Se][xe]=Te[be]}),ge}return Te[0].length===re&&(Te=[Te]),_e.row.start=_e.row.start||0,_e.row.end=_e.row.end||ge.length,_e.row.step=_e.row.step||1,_e.col.start=_e.col.start||0,_e.col.end=_e.col.end||ge[0].length,_e.col.step=_e.col.step||1,Le=le.arange(_e.row.start,ee.min(ge.length,_e.row.end),_e.row.step),Ne=le.arange(_e.col.start,ee.min(ge[0].length,_e.col.end),_e.col.step),Le.forEach(function(Se,be){Ne.forEach(function(De,Me){ge[Se][De]=Te[be][Me]})}),ge},le.diagonal=function(ge){var _e=le.zeros(ge.length,ge.length);return ge.forEach(function(Te,Ne){_e[Ne][Ne]=Te}),_e},le.copy=function(ge){return ge.map(function(_e){return se(_e)?_e:_e.map(function(Te){return Te})})};var ve=le.prototype;return ve.length=0,ve.push=Array.prototype.push,ve.sort=Array.prototype.sort,ve.splice=Array.prototype.splice,ve.slice=Array.prototype.slice,ve.toArray=function(){return this.length>1?ie.call(this):ie.call(this)[0]},ve.map=function(ge,_e){return le(le.map(this,ge,_e))},ve.cumreduce=function(ge,_e){return le(le.cumreduce(this,ge,_e))},ve.alter=function(ge){return le.alter(this,ge),this},function(we){for(var ge=0;ge<we.length;ge++)(function(_e){ve[_e]=function(Te){var Ne=this,Le;return Te?(setTimeout(function(){Te.call(Ne,ve[_e].call(Ne))}),this):(Le=le[_e](this),ue(Le)?le(Le):Le)}})(we[ge])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(we){for(var ge=0;ge<we.length;ge++)(function(_e){ve[_e]=function(Te,Ne){var Le=this;return Ne?(setTimeout(function(){Ne.call(Le,ve[_e].call(Le,Te))}),this):le(le[_e](this,Te))}})(we[ge])}("row col".split(" ")),function(we){for(var ge=0;ge<we.length;ge++)(function(_e){ve[_e]=function(){return le(le[_e].apply(null,arguments))}})(we[ge])}("create zeros ones rand identity".split(" ")),le}(Math);return function(ee,re){var ne=ee.utils.isFunction;function ie(ue,ae){return ue-ae}function oe(ue,ae,se){return re.max(ae,re.min(ue,se))}ee.sum=function(ae){for(var se=0,ce=ae.length;--ce>=0;)se+=ae[ce];return se},ee.sumsqrd=function(ae){for(var se=0,ce=ae.length;--ce>=0;)se+=ae[ce]*ae[ce];return se},ee.sumsqerr=function(ae){for(var se=ee.mean(ae),ce=0,le=ae.length,pe;--le>=0;)pe=ae[le]-se,ce+=pe*pe;return ce},ee.sumrow=function(ae){for(var se=0,ce=ae.length;--ce>=0;)se+=ae[ce];return se},ee.product=function(ae){for(var se=1,ce=ae.length;--ce>=0;)se*=ae[ce];return se},ee.min=function(ae){for(var se=ae[0],ce=0;++ce<ae.length;)ae[ce]<se&&(se=ae[ce]);return se},ee.max=function(ae){for(var se=ae[0],ce=0;++ce<ae.length;)ae[ce]>se&&(se=ae[ce]);return se},ee.unique=function(ae){for(var se={},ce=[],le=0;le<ae.length;le++)se[ae[le]]||(se[ae[le]]=!0,ce.push(ae[le]));return ce},ee.mean=function(ae){return ee.sum(ae)/ae.length},ee.meansqerr=function(ae){return ee.sumsqerr(ae)/ae.length},ee.geomean=function(ae){return re.pow(ee.product(ae),1/ae.length)},ee.median=function(ae){var se=ae.length,ce=ae.slice().sort(ie);return se&1?ce[se/2|0]:(ce[se/2-1]+ce[se/2])/2},ee.cumsum=function(ae){return ee.cumreduce(ae,function(se,ce){return se+ce})},ee.cumprod=function(ae){return ee.cumreduce(ae,function(se,ce){return se*ce})},ee.diff=function(ae){var se=[],ce=ae.length,le;for(le=1;le<ce;le++)se.push(ae[le]-ae[le-1]);return se},ee.rank=function(ue){var ae,se=[],ce={};for(ae=0;ae<ue.length;ae++){var le=ue[ae];ce[le]?ce[le]++:(ce[le]=1,se.push(le))}var pe=se.sort(ie),de={},me=1;for(ae=0;ae<pe.length;ae++){var le=pe[ae],ve=ce[le],we=me,ge=me+ve-1,_e=(we+ge)/2;de[le]=_e,me+=ve}return ue.map(function(Te){return de[Te]})},ee.mode=function(ae){var se=ae.length,ce=ae.slice().sort(ie),le=1,pe=0,de=0,me=[],ve;for(ve=0;ve<se;ve++)ce[ve]===ce[ve+1]?le++:(le>pe?(me=[ce[ve]],pe=le,de=0):le===pe&&(me.push(ce[ve]),de++),le=1);return de===0?me[0]:me},ee.range=function(ae){return ee.max(ae)-ee.min(ae)},ee.variance=function(ae,se){return ee.sumsqerr(ae)/(ae.length-(se?1:0))},ee.pooledvariance=function(ae){var se=ae.reduce(function(le,pe){return le+ee.sumsqerr(pe)},0),ce=ae.reduce(function(le,pe){return le+pe.length},0);return se/(ce-ae.length)},ee.deviation=function(ue){for(var ae=ee.mean(ue),se=ue.length,ce=new Array(se),le=0;le<se;le++)ce[le]=ue[le]-ae;return ce},ee.stdev=function(ae,se){return re.sqrt(ee.variance(ae,se))},ee.pooledstdev=function(ae){return re.sqrt(ee.pooledvariance(ae))},ee.meandev=function(ae){for(var se=ee.mean(ae),ce=[],le=ae.length-1;le>=0;le--)ce.push(re.abs(ae[le]-se));return ee.mean(ce)},ee.meddev=function(ae){for(var se=ee.median(ae),ce=[],le=ae.length-1;le>=0;le--)ce.push(re.abs(ae[le]-se));return ee.median(ce)},ee.coeffvar=function(ae){return ee.stdev(ae)/ee.mean(ae)},ee.quartiles=function(ae){var se=ae.length,ce=ae.slice().sort(ie);return[ce[re.round(se/4)-1],ce[re.round(se/2)-1],ce[re.round(se*3/4)-1]]},ee.quantiles=function(ae,se,ce,le){var pe=ae.slice().sort(ie),de=[se.length],me=ae.length,ve,we,ge,_e,Te,Ne;for(typeof ce>"u"&&(ce=3/8),typeof le>"u"&&(le=3/8),ve=0;ve<se.length;ve++)we=se[ve],ge=ce+we*(1-ce-le),_e=me*we+ge,Te=re.floor(oe(_e,1,me-1)),Ne=oe(_e-Te,0,1),de[ve]=(1-Ne)*pe[Te-1]+Ne*pe[Te];return de},ee.percentile=function(ae,se,ce){var le=ae.slice().sort(ie),pe=se*(le.length+(ce?1:-1))+(ce?0:1),de=parseInt(pe),me=pe-de;return de+1<le.length?le[de-1]+me*(le[de]-le[de-1]):le[de-1]},ee.percentileOfScore=function(ae,se,ce){var le=0,pe=ae.length,de=!1,me,ve;for(ce==="strict"&&(de=!0),ve=0;ve<pe;ve++)me=ae[ve],(de&&me<se||!de&&me<=se)&&le++;return le/pe},ee.histogram=function(ae,se){se=se||4;var ce=ee.min(ae),le=(ee.max(ae)-ce)/se,pe=ae.length,de=[],me;for(me=0;me<se;me++)de[me]=0;for(me=0;me<pe;me++)de[re.min(re.floor((ae[me]-ce)/le),se-1)]+=1;return de},ee.covariance=function(ae,se){var ce=ee.mean(ae),le=ee.mean(se),pe=ae.length,de=new Array(pe),me;for(me=0;me<pe;me++)de[me]=(ae[me]-ce)*(se[me]-le);return ee.sum(de)/(pe-1)},ee.corrcoeff=function(ae,se){return ee.covariance(ae,se)/ee.stdev(ae,1)/ee.stdev(se,1)},ee.spearmancoeff=function(ue,ae){return ue=ee.rank(ue),ae=ee.rank(ae),ee.corrcoeff(ue,ae)},ee.stanMoment=function(ae,se){for(var ce=ee.mean(ae),le=ee.stdev(ae),pe=ae.length,de=0,me=0;me<pe;me++)de+=re.pow((ae[me]-ce)/le,se);return de/ae.length},ee.skewness=function(ae){return ee.stanMoment(ae,3)},ee.kurtosis=function(ae){return ee.stanMoment(ae,4)-3};var fe=ee.prototype;(function(ue){for(var ae=0;ae<ue.length;ae++)(function(se){fe[se]=function(ce,le){var pe=[],de=0,me=this;if(ne(ce)&&(le=ce,ce=!1),le)return setTimeout(function(){le.call(me,fe[se].call(me,ce))}),this;if(this.length>1){for(me=ce===!0?this:this.transpose();de<me.length;de++)pe[de]=ee[se](me[de]);return pe}return ee[se](this[0],ce)}})(ue[ae])})("cumsum cumprod".split(" ")),function(ue){for(var ae=0;ae<ue.length;ae++)(function(se){fe[se]=function(ce,le){var pe=[],de=0,me=this;if(ne(ce)&&(le=ce,ce=!1),le)return setTimeout(function(){le.call(me,fe[se].call(me,ce))}),this;if(this.length>1){for(se!=="sumrow"&&(me=ce===!0?this:this.transpose());de<me.length;de++)pe[de]=ee[se](me[de]);return ce===!0?ee[se](ee.utils.toVector(pe)):pe}return ee[se](this[0],ce)}})(ue[ae])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(ue){for(var ae=0;ae<ue.length;ae++)(function(se){fe[se]=function(){var ce=[],le=0,pe=this,de=Array.prototype.slice.call(arguments),me;if(ne(de[de.length-1])){me=de[de.length-1];var ve=de.slice(0,de.length-1);return setTimeout(function(){me.call(pe,fe[se].apply(pe,ve))}),this}else{me=void 0;var we=function(_e){return ee[se].apply(pe,[_e].concat(de))}}if(this.length>1){for(pe=pe.transpose();le<pe.length;le++)ce[le]=we(pe[le]);return ce}return we(this[0])}})(ue[ae])}("quantiles percentileOfScore".split(" "))}(te,Math),function(ee,re){ee.gammaln=function(ie){var oe=0,fe=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],ue=1.000000000190015,ae,se,ce;for(ce=(se=ae=ie)+5.5,ce-=(ae+.5)*re.log(ce);oe<6;oe++)ue+=fe[oe]/++se;return re.log(2.5066282746310007*ue/ae)-ce},ee.loggam=function(ie){var oe,fe,ue,ae,se,ce,le,pe=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(oe=ie,le=0,ie==1||ie==2)return 0;for(ie<=7&&(le=re.floor(7-ie),oe=ie+le),fe=1/(oe*oe),ue=2*re.PI,se=pe[9],ce=8;ce>=0;ce--)se*=fe,se+=pe[ce];if(ae=se/oe+.5*re.log(ue)+(oe-.5)*re.log(oe)-oe,ie<=7)for(ce=1;ce<=le;ce++)ae-=re.log(oe-1),oe-=1;return ae},ee.gammafn=function(ie){var oe=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],fe=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],ue=!1,ae=0,se=0,ce=0,le=ie,pe,de,me,ve;if(ie>171.6243769536076)return 1/0;if(le<=0)if(ve=le%1+36e-17,ve)ue=(le&1?-1:1)*re.PI/re.sin(re.PI*ve),le=1-le;else return 1/0;for(me=le,le<1?de=le++:de=(le-=ae=(le|0)-1)-1,pe=0;pe<8;++pe)ce=(ce+oe[pe])*de,se=se*de+fe[pe];if(ve=ce/se+1,me<le)ve/=me;else if(me>le)for(pe=0;pe<ae;++pe)ve*=le,le++;return ue&&(ve=ue/ve),ve},ee.gammap=function(ie,oe){return ee.lowRegGamma(ie,oe)*ee.gammafn(ie)},ee.lowRegGamma=function(ie,oe){var fe=ee.gammaln(ie),ue=ie,ae=1/ie,se=ae,ce=oe+1-ie,le=1/1e-30,pe=1/ce,de=pe,me=1,ve=-~(re.log(ie>=1?ie:1/ie)*8.5+ie*.4+17),we;if(oe<0||ie<=0)return NaN;if(oe<ie+1){for(;me<=ve;me++)ae+=se*=oe/++ue;return ae*re.exp(-oe+ie*re.log(oe)-fe)}for(;me<=ve;me++)we=-me*(me-ie),ce+=2,pe=we*pe+ce,le=ce+we/le,pe=1/pe,de*=pe*le;return 1-de*re.exp(-oe+ie*re.log(oe)-fe)},ee.factorialln=function(ie){return ie<0?NaN:ee.gammaln(ie+1)},ee.factorial=function(ie){return ie<0?NaN:ee.gammafn(ie+1)},ee.combination=function(ie,oe){return ie>170||oe>170?re.exp(ee.combinationln(ie,oe)):ee.factorial(ie)/ee.factorial(oe)/ee.factorial(ie-oe)},ee.combinationln=function(ie,oe){return ee.factorialln(ie)-ee.factorialln(oe)-ee.factorialln(ie-oe)},ee.permutation=function(ie,oe){return ee.factorial(ie)/ee.factorial(ie-oe)},ee.betafn=function(ie,oe){if(!(ie<=0||oe<=0))return ie+oe>170?re.exp(ee.betaln(ie,oe)):ee.gammafn(ie)*ee.gammafn(oe)/ee.gammafn(ie+oe)},ee.betaln=function(ie,oe){return ee.gammaln(ie)+ee.gammaln(oe)-ee.gammaln(ie+oe)},ee.betacf=function(ie,oe,fe){var ue=1e-30,ae=1,se=oe+fe,ce=oe+1,le=oe-1,pe=1,de=1-se*ie/ce,me,ve,we,ge;for(re.abs(de)<ue&&(de=ue),de=1/de,ge=de;ae<=100&&(me=2*ae,ve=ae*(fe-ae)*ie/((le+me)*(oe+me)),de=1+ve*de,re.abs(de)<ue&&(de=ue),pe=1+ve/pe,re.abs(pe)<ue&&(pe=ue),de=1/de,ge*=de*pe,ve=-(oe+ae)*(se+ae)*ie/((oe+me)*(ce+me)),de=1+ve*de,re.abs(de)<ue&&(de=ue),pe=1+ve/pe,re.abs(pe)<ue&&(pe=ue),de=1/de,we=de*pe,ge*=we,!(re.abs(we-1)<3e-7));ae++);return ge},ee.gammapinv=function(ie,oe){var fe=0,ue=oe-1,ae=1e-8,se=ee.gammaln(oe),ce,le,pe,de,me,ve,we;if(ie>=1)return re.max(100,oe+100*re.sqrt(oe));if(ie<=0)return 0;for(oe>1?(ve=re.log(ue),we=re.exp(ue*(ve-1)-se),me=ie<.5?ie:1-ie,pe=re.sqrt(-2*re.log(me)),ce=(2.30753+pe*.27061)/(1+pe*(.99229+pe*.04481))-pe,ie<.5&&(ce=-ce),ce=re.max(.001,oe*re.pow(1-1/(9*oe)-ce/(3*re.sqrt(oe)),3))):(pe=1-oe*(.253+oe*.12),ie<pe?ce=re.pow(ie/pe,1/oe):ce=1-re.log(1-(ie-pe)/(1-pe)));fe<12;fe++){if(ce<=0)return 0;if(le=ee.lowRegGamma(oe,ce)-ie,oe>1?pe=we*re.exp(-(ce-ue)+ue*(re.log(ce)-ve)):pe=re.exp(-ce+ue*re.log(ce)-se),de=le/pe,ce-=pe=de/(1-.5*re.min(1,de*((oe-1)/ce-1))),ce<=0&&(ce=.5*(ce+pe)),re.abs(pe)<ae*ce)break}return ce},ee.erf=function(ie){var oe=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],fe=oe.length-1,ue=!1,ae=0,se=0,ce,le,pe,de;for(ie<0&&(ie=-ie,ue=!0),ce=2/(2+ie),le=4*ce-2;fe>0;fe--)pe=ae,ae=le*ae-se+oe[fe],se=pe;return de=ce*re.exp(-ie*ie+.5*(oe[0]+le*ae)-se),ue?de-1:1-de},ee.erfc=function(ie){return 1-ee.erf(ie)},ee.erfcinv=function(ie){var oe=0,fe,ue,ae,se;if(ie>=2)return-100;if(ie<=0)return 100;for(se=ie<1?ie:2-ie,ae=re.sqrt(-2*re.log(se/2)),fe=-.70711*((2.30753+ae*.27061)/(1+ae*(.99229+ae*.04481))-ae);oe<2;oe++)ue=ee.erfc(fe)-se,fe+=ue/(1.1283791670955126*re.exp(-fe*fe)-fe*ue);return ie<1?fe:-fe},ee.ibetainv=function(ie,oe,fe){var ue=1e-8,ae=oe-1,se=fe-1,ce=0,le,pe,de,me,ve,we,ge,_e,Te,Ne,Le;if(ie<=0)return 0;if(ie>=1)return 1;for(oe>=1&&fe>=1?(de=ie<.5?ie:1-ie,me=re.sqrt(-2*re.log(de)),ge=(2.30753+me*.27061)/(1+me*(.99229+me*.04481))-me,ie<.5&&(ge=-ge),_e=(ge*ge-3)/6,Te=2/(1/(2*oe-1)+1/(2*fe-1)),Ne=ge*re.sqrt(_e+Te)/Te-(1/(2*fe-1)-1/(2*oe-1))*(_e+5/6-2/(3*Te)),ge=oe/(oe+fe*re.exp(2*Ne))):(le=re.log(oe/(oe+fe)),pe=re.log(fe/(oe+fe)),me=re.exp(oe*le)/oe,ve=re.exp(fe*pe)/fe,Ne=me+ve,ie<me/Ne?ge=re.pow(oe*Ne*ie,1/oe):ge=1-re.pow(fe*Ne*(1-ie),1/fe)),Le=-ee.gammaln(oe)-ee.gammaln(fe)+ee.gammaln(oe+fe);ce<10;ce++){if(ge===0||ge===1)return ge;if(we=ee.ibeta(ge,oe,fe)-ie,me=re.exp(ae*re.log(ge)+se*re.log(1-ge)+Le),ve=we/me,ge-=me=ve/(1-.5*re.min(1,ve*(ae/ge-se/(1-ge)))),ge<=0&&(ge=.5*(ge+me)),ge>=1&&(ge=.5*(ge+me+1)),re.abs(me)<ue*ge&&ce>0)break}return ge},ee.ibeta=function(ie,oe,fe){var ue=ie===0||ie===1?0:re.exp(ee.gammaln(oe+fe)-ee.gammaln(oe)-ee.gammaln(fe)+oe*re.log(ie)+fe*re.log(1-ie));return ie<0||ie>1?!1:ie<(oe+1)/(oe+fe+2)?ue*ee.betacf(ie,oe,fe)/oe:1-ue*ee.betacf(1-ie,fe,oe)/fe},ee.randn=function(ie,oe){var fe,ue,ae,se,ce;if(oe||(oe=ie),ie)return ee.create(ie,oe,function(){return ee.randn()});do fe=ee._random_fn(),ue=1.7156*(ee._random_fn()-.5),ae=fe-.449871,se=re.abs(ue)+.386595,ce=ae*ae+se*(.196*se-.25472*ae);while(ce>.27597&&(ce>.27846||ue*ue>-4*re.log(fe)*fe*fe));return ue/fe},ee.randg=function(ie,oe,fe){var ue=ie,ae,se,ce,le,pe,de;if(fe||(fe=oe),ie||(ie=1),oe)return de=ee.zeros(oe,fe),de.alter(function(){return ee.randg(ie)}),de;ie<1&&(ie+=1),ae=ie-1/3,se=1/re.sqrt(9*ae);do{do pe=ee.randn(),le=1+se*pe;while(le<=0);le=le*le*le,ce=ee._random_fn()}while(ce>1-.331*re.pow(pe,4)&&re.log(ce)>.5*pe*pe+ae*(1-le+re.log(le)));if(ie==ue)return ae*le;do ce=ee._random_fn();while(ce===0);return re.pow(ce,1/ue)*ae*le},function(ne){for(var ie=0;ie<ne.length;ie++)(function(oe){ee.fn[oe]=function(){return ee(ee.map(this,function(fe){return ee[oe](fe)}))}})(ne[ie])}("gammaln gammafn factorial factorialln".split(" ")),function(ne){for(var ie=0;ie<ne.length;ie++)(function(oe){ee.fn[oe]=function(){return ee(ee[oe].apply(null,arguments))}})(ne[ie])}("randn".split(" "))}(te,Math),function(ee,re){(function(ue){for(var ae=0;ae<ue.length;ae++)(function(se){ee[se]=function ce(le,pe,de){return this instanceof ce?(this._a=le,this._b=pe,this._c=de,this):new ce(le,pe,de)},ee.fn[se]=function(ce,le,pe){var de=ee[se](ce,le,pe);return de.data=this,de},ee[se].prototype.sample=function(ce){var le=this._a,pe=this._b,de=this._c;return ce?ee.alter(ce,function(){return ee[se].sample(le,pe,de)}):ee[se].sample(le,pe,de)},function(ce){for(var le=0;le<ce.length;le++)(function(pe){ee[se].prototype[pe]=function(de){var me=this._a,ve=this._b,we=this._c;return!de&&de!==0&&(de=this.data),typeof de!="number"?ee.fn.map.call(de,function(ge){return ee[se][pe](ge,me,ve,we)}):ee[se][pe](de,me,ve,we)}})(ce[le])}("pdf cdf inv".split(" ")),function(ce){for(var le=0;le<ce.length;le++)(function(pe){ee[se].prototype[pe]=function(){return ee[se][pe](this._a,this._b,this._c)}})(ce[le])}("mean median mode variance".split(" "))})(ue[ae])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),ee.extend(ee.beta,{pdf:function(ae,se,ce){return ae>1||ae<0?0:se==1&&ce==1?1:se<512&&ce<512?re.pow(ae,se-1)*re.pow(1-ae,ce-1)/ee.betafn(se,ce):re.exp((se-1)*re.log(ae)+(ce-1)*re.log(1-ae)-ee.betaln(se,ce))},cdf:function(ae,se,ce){return ae>1||ae<0?(ae>1)*1:ee.ibeta(ae,se,ce)},inv:function(ae,se,ce){return ee.ibetainv(ae,se,ce)},mean:function(ae,se){return ae/(ae+se)},median:function(ae,se){return ee.ibetainv(.5,ae,se)},mode:function(ae,se){return(ae-1)/(ae+se-2)},sample:function(ae,se){var ce=ee.randg(ae);return ce/(ce+ee.randg(se))},variance:function(ae,se){return ae*se/(re.pow(ae+se,2)*(ae+se+1))}}),ee.extend(ee.centralF,{pdf:function(ae,se,ce){var le,pe,de;return ae<0?0:se<=2?ae===0&&se<2?1/0:ae===0&&se===2?1:1/ee.betafn(se/2,ce/2)*re.pow(se/ce,se/2)*re.pow(ae,se/2-1)*re.pow(1+se/ce*ae,-(se+ce)/2):(le=se*ae/(ce+ae*se),pe=ce/(ce+ae*se),de=se*pe/2,de*ee.binomial.pdf((se-2)/2,(se+ce-2)/2,le))},cdf:function(ae,se,ce){return ae<0?0:ee.ibeta(se*ae/(se*ae+ce),se/2,ce/2)},inv:function(ae,se,ce){return ce/(se*(1/ee.ibetainv(ae,se/2,ce/2)-1))},mean:function(ae,se){return se>2?se/(se-2):void 0},mode:function(ae,se){return ae>2?se*(ae-2)/(ae*(se+2)):void 0},sample:function(ae,se){var ce=ee.randg(ae/2)*2,le=ee.randg(se/2)*2;return ce/ae/(le/se)},variance:function(ae,se){if(!(se<=4))return 2*se*se*(ae+se-2)/(ae*(se-2)*(se-2)*(se-4))}}),ee.extend(ee.cauchy,{pdf:function(ae,se,ce){return ce<0?0:ce/(re.pow(ae-se,2)+re.pow(ce,2))/re.PI},cdf:function(ae,se,ce){return re.atan((ae-se)/ce)/re.PI+.5},inv:function(ue,ae,se){return ae+se*re.tan(re.PI*(ue-.5))},median:function(ae){return ae},mode:function(ae){return ae},sample:function(ae,se){return ee.randn()*re.sqrt(1/(2*ee.randg(.5)))*se+ae}}),ee.extend(ee.chisquare,{pdf:function(ae,se){return ae<0?0:ae===0&&se===2?.5:re.exp((se/2-1)*re.log(ae)-ae/2-se/2*re.log(2)-ee.gammaln(se/2))},cdf:function(ae,se){return ae<0?0:ee.lowRegGamma(se/2,ae/2)},inv:function(ue,ae){return 2*ee.gammapinv(ue,.5*ae)},mean:function(ue){return ue},median:function(ae){return ae*re.pow(1-2/(9*ae),3)},mode:function(ae){return ae-2>0?ae-2:0},sample:function(ae){return ee.randg(ae/2)*2},variance:function(ae){return 2*ae}}),ee.extend(ee.exponential,{pdf:function(ae,se){return ae<0?0:se*re.exp(-se*ae)},cdf:function(ae,se){return ae<0?0:1-re.exp(-se*ae)},inv:function(ue,ae){return-re.log(1-ue)/ae},mean:function(ue){return 1/ue},median:function(ue){return 1/ue*re.log(2)},mode:function(){return 0},sample:function(ae){return-1/ae*re.log(ee._random_fn())},variance:function(ue){return re.pow(ue,-2)}}),ee.extend(ee.gamma,{pdf:function(ae,se,ce){return ae<0?0:ae===0&&se===1?1/ce:re.exp((se-1)*re.log(ae)-ae/ce-ee.gammaln(se)-se*re.log(ce))},cdf:function(ae,se,ce){return ae<0?0:ee.lowRegGamma(se,ae/ce)},inv:function(ue,ae,se){return ee.gammapinv(ue,ae)*se},mean:function(ue,ae){return ue*ae},mode:function(ae,se){if(ae>1)return(ae-1)*se},sample:function(ae,se){return ee.randg(ae)*se},variance:function(ae,se){return ae*se*se}}),ee.extend(ee.invgamma,{pdf:function(ae,se,ce){return ae<=0?0:re.exp(-(se+1)*re.log(ae)-ce/ae-ee.gammaln(se)+se*re.log(ce))},cdf:function(ae,se,ce){return ae<=0?0:1-ee.lowRegGamma(se,ce/ae)},inv:function(ue,ae,se){return se/ee.gammapinv(1-ue,ae)},mean:function(ue,ae){return ue>1?ae/(ue-1):void 0},mode:function(ae,se){return se/(ae+1)},sample:function(ae,se){return se/ee.randg(ae)},variance:function(ae,se){if(!(ae<=2))return se*se/((ae-1)*(ae-1)*(ae-2))}}),ee.extend(ee.kumaraswamy,{pdf:function(ae,se,ce){return ae===0&&se===1?ce:ae===1&&ce===1?se:re.exp(re.log(se)+re.log(ce)+(se-1)*re.log(ae)+(ce-1)*re.log(1-re.pow(ae,se)))},cdf:function(ae,se,ce){return ae<0?0:ae>1?1:1-re.pow(1-re.pow(ae,se),ce)},inv:function(ae,se,ce){return re.pow(1-re.pow(1-ae,1/ce),1/se)},mean:function(ue,ae){return ae*ee.gammafn(1+1/ue)*ee.gammafn(ae)/ee.gammafn(1+1/ue+ae)},median:function(ae,se){return re.pow(1-re.pow(2,-1/se),1/ae)},mode:function(ae,se){if(ae>=1&&se>=1&&ae!==1&&se!==1)return re.pow((ae-1)/(ae*se-1),1/ae)},variance:function(){throw new Error("variance not yet implemented")}}),ee.extend(ee.lognormal,{pdf:function(ae,se,ce){return ae<=0?0:re.exp(-re.log(ae)-.5*re.log(2*re.PI)-re.log(ce)-re.pow(re.log(ae)-se,2)/(2*ce*ce))},cdf:function(ae,se,ce){return ae<0?0:.5+.5*ee.erf((re.log(ae)-se)/re.sqrt(2*ce*ce))},inv:function(ue,ae,se){return re.exp(-1.4142135623730951*se*ee.erfcinv(2*ue)+ae)},mean:function(ae,se){return re.exp(ae+se*se/2)},median:function(ae){return re.exp(ae)},mode:function(ae,se){return re.exp(ae-se*se)},sample:function(ae,se){return re.exp(ee.randn()*se+ae)},variance:function(ae,se){return(re.exp(se*se)-1)*re.exp(2*ae+se*se)}}),ee.extend(ee.noncentralt,{pdf:function(ae,se,ce){var le=1e-14;return re.abs(ce)<le?ee.studentt.pdf(ae,se):re.abs(ae)<le?re.exp(ee.gammaln((se+1)/2)-ce*ce/2-.5*re.log(re.PI*se)-ee.gammaln(se/2)):se/ae*(ee.noncentralt.cdf(ae*re.sqrt(1+2/se),se+2,ce)-ee.noncentralt.cdf(ae,se,ce))},cdf:function(ae,se,ce){var le=1e-14,pe=200;if(re.abs(ce)<le)return ee.studentt.cdf(ae,se);var de=!1;ae<0&&(de=!0,ce=-ce);for(var me=ee.normal.cdf(-ce,0,1),ve=le+1,we=ve,ge=ae*ae/(ae*ae+se),_e=0,Te=re.exp(-ce*ce/2),Ne=re.exp(-ce*ce/2-.5*re.log(2)-ee.gammaln(3/2))*ce;_e<pe||we>le||ve>le;)we=ve,_e>0&&(Te*=ce*ce/(2*_e),Ne*=ce*ce/(2*(_e+1/2))),ve=Te*ee.beta.cdf(ge,_e+.5,se/2)+Ne*ee.beta.cdf(ge,_e+1,se/2),me+=.5*ve,_e++;return de?1-me:me}}),ee.extend(ee.normal,{pdf:function(ae,se,ce){return re.exp(-.5*re.log(2*re.PI)-re.log(ce)-re.pow(ae-se,2)/(2*ce*ce))},cdf:function(ae,se,ce){return .5*(1+ee.erf((ae-se)/re.sqrt(2*ce*ce)))},inv:function(ue,ae,se){return-1.4142135623730951*se*ee.erfcinv(2*ue)+ae},mean:function(ue){return ue},median:function(ae){return ae},mode:function(ue){return ue},sample:function(ae,se){return ee.randn()*se+ae},variance:function(ue,ae){return ae*ae}}),ee.extend(ee.pareto,{pdf:function(ae,se,ce){return ae<se?0:ce*re.pow(se,ce)/re.pow(ae,ce+1)},cdf:function(ae,se,ce){return ae<se?0:1-re.pow(se/ae,ce)},inv:function(ae,se,ce){return se/re.pow(1-ae,1/ce)},mean:function(ae,se){if(!(se<=1))return se*re.pow(ae,se)/(se-1)},median:function(ae,se){return ae*(se*re.SQRT2)},mode:function(ae){return ae},variance:function(ue,ae){if(!(ae<=2))return ue*ue*ae/(re.pow(ae-1,2)*(ae-2))}}),ee.extend(ee.studentt,{pdf:function(ae,se){return se=se>1e100?1e100:se,1/(re.sqrt(se)*ee.betafn(.5,se/2))*re.pow(1+ae*ae/se,-((se+1)/2))},cdf:function(ae,se){var ce=se/2;return ee.ibeta((ae+re.sqrt(ae*ae+se))/(2*re.sqrt(ae*ae+se)),ce,ce)},inv:function(ue,ae){var se=ee.ibetainv(2*re.min(ue,1-ue),.5*ae,.5);return se=re.sqrt(ae*(1-se)/se),ue>.5?se:-se},mean:function(ae){return ae>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(ae){return ee.randn()*re.sqrt(ae/(2*ee.randg(ae/2)))},variance:function(ae){return ae>2?ae/(ae-2):ae>1?1/0:void 0}}),ee.extend(ee.weibull,{pdf:function(ae,se,ce){return ae<0||se<0||ce<0?0:ce/se*re.pow(ae/se,ce-1)*re.exp(-re.pow(ae/se,ce))},cdf:function(ae,se,ce){return ae<0?0:1-re.exp(-re.pow(ae/se,ce))},inv:function(ue,ae,se){return ae*re.pow(-re.log(1-ue),1/se)},mean:function(ue,ae){return ue*ee.gammafn(1+1/ae)},median:function(ae,se){return ae*re.pow(re.log(2),1/se)},mode:function(ae,se){return se<=1?0:ae*re.pow((se-1)/se,1/se)},sample:function(ae,se){return ae*re.pow(-re.log(ee._random_fn()),1/se)},variance:function(ae,se){return ae*ae*ee.gammafn(1+2/se)-re.pow(ee.weibull.mean(ae,se),2)}}),ee.extend(ee.uniform,{pdf:function(ae,se,ce){return ae<se||ae>ce?0:1/(ce-se)},cdf:function(ae,se,ce){return ae<se?0:ae<ce?(ae-se)/(ce-se):1},inv:function(ue,ae,se){return ae+ue*(se-ae)},mean:function(ae,se){return .5*(ae+se)},median:function(ae,se){return ee.mean(ae,se)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(ae,se){return ae/2+se/2+(se/2-ae/2)*(2*ee._random_fn()-1)},variance:function(ae,se){return re.pow(se-ae,2)/12}});function ne(ue,ae,se,ce){for(var le=0,pe=1,de=1,me=1,ve=0,we=0,ge;re.abs((de-we)/de)>ce;)we=de,ge=-(ae+ve)*(ae+se+ve)*ue/(ae+2*ve)/(ae+2*ve+1),le=de+ge*le,pe=me+ge*pe,ve=ve+1,ge=ve*(se-ve)*ue/(ae+2*ve-1)/(ae+2*ve),de=le+ge*de,me=pe+ge*me,le=le/me,pe=pe/me,de=de/me,me=1;return de/ae}ee.extend(ee.binomial,{pdf:function(ae,se,ce){return ce===0||ce===1?se*ce===ae?1:0:ee.combination(se,ae)*re.pow(ce,ae)*re.pow(1-ce,se-ae)},cdf:function(ae,se,ce){var le,pe=1e-10;if(ae<0)return 0;if(ae>=se)return 1;if(ce<0||ce>1||se<=0)return NaN;ae=re.floor(ae);var de=ce,me=ae+1,ve=se-ae,we=me+ve,ge=re.exp(ee.gammaln(we)-ee.gammaln(ve)-ee.gammaln(me)+me*re.log(de)+ve*re.log(1-de));return de<(me+1)/(we+2)?le=ge*ne(de,me,ve,pe):le=1-ge*ne(1-de,ve,me,pe),re.round((1-le)*(1/pe))/(1/pe)}}),ee.extend(ee.negbin,{pdf:function(ae,se,ce){return ae!==ae>>>0?!1:ae<0?0:ee.combination(ae+se-1,se-1)*re.pow(1-ce,ae)*re.pow(ce,se)},cdf:function(ae,se,ce){var le=0,pe=0;if(ae<0)return 0;for(;pe<=ae;pe++)le+=ee.negbin.pdf(pe,se,ce);return le}}),ee.extend(ee.hypgeom,{pdf:function(ae,se,ce,le){if(ae!==ae|0)return!1;if(ae<0||ae<ce-(se-le))return 0;if(ae>le||ae>ce)return 0;if(ce*2>se)return le*2>se?ee.hypgeom.pdf(se-ce-le+ae,se,se-ce,se-le):ee.hypgeom.pdf(le-ae,se,se-ce,le);if(le*2>se)return ee.hypgeom.pdf(ce-ae,se,ce,se-le);if(ce<le)return ee.hypgeom.pdf(ae,se,le,ce);for(var pe=1,de=0,me=0;me<ae;me++){for(;pe>1&&de<le;)pe*=1-ce/(se-de),de++;pe*=(le-me)*(ce-me)/((me+1)*(se-ce-le+me+1))}for(;de<le;de++)pe*=1-ce/(se-de);return re.min(1,re.max(0,pe))},cdf:function(ae,se,ce,le){if(ae<0||ae<ce-(se-le))return 0;if(ae>=le||ae>=ce)return 1;if(ce*2>se)return le*2>se?ee.hypgeom.cdf(se-ce-le+ae,se,se-ce,se-le):1-ee.hypgeom.cdf(le-ae-1,se,se-ce,le);if(le*2>se)return 1-ee.hypgeom.cdf(ce-ae-1,se,ce,se-le);if(ce<le)return ee.hypgeom.cdf(ae,se,le,ce);for(var pe=1,de=1,me=0,ve=0;ve<ae;ve++){for(;pe>1&&me<le;){var we=1-ce/(se-me);de*=we,pe*=we,me++}de*=(le-ve)*(ce-ve)/((ve+1)*(se-ce-le+ve+1)),pe+=de}for(;me<le;me++)pe*=1-ce/(se-me);return re.min(1,re.max(0,pe))}}),ee.extend(ee.poisson,{pdf:function(ae,se){return se<0||ae%1!==0||ae<0?0:re.pow(se,ae)*re.exp(-se)/ee.factorial(ae)},cdf:function(ae,se){var ce=[],le=0;if(ae<0)return 0;for(;le<=ae;le++)ce.push(ee.poisson.pdf(le,se));return ee.sum(ce)},mean:function(ue){return ue},variance:function(ue){return ue},sampleSmall:function(ae){var se=1,ce=0,le=re.exp(-ae);do ce++,se*=ee._random_fn();while(se>le);return ce-1},sampleLarge:function(ae){var se=ae,ce,le,pe,de,me,ve,we,ge,_e,Te;for(de=re.sqrt(se),me=re.log(se),we=.931+2.53*de,ve=-.059+.02483*we,ge=1.1239+1.1328/(we-3.4),_e=.9277-3.6224/(we-2);;){if(le=re.random()-.5,pe=re.random(),Te=.5-re.abs(le),ce=re.floor((2*ve/Te+we)*le+se+.43),Te>=.07&&pe<=_e)return ce;if(!(ce<0||Te<.013&&pe>Te)&&re.log(pe)+re.log(ge)-re.log(ve/(Te*Te)+we)<=-se+ce*me-ee.loggam(ce+1))return ce}},sample:function(ae){return ae<10?this.sampleSmall(ae):this.sampleLarge(ae)}}),ee.extend(ee.triangular,{pdf:function(ae,se,ce,le){return ce<=se||le<se||le>ce?NaN:ae<se||ae>ce?0:ae<le?2*(ae-se)/((ce-se)*(le-se)):ae===le?2/(ce-se):2*(ce-ae)/((ce-se)*(ce-le))},cdf:function(ae,se,ce,le){return ce<=se||le<se||le>ce?NaN:ae<=se?0:ae>=ce?1:ae<=le?re.pow(ae-se,2)/((ce-se)*(le-se)):1-re.pow(ce-ae,2)/((ce-se)*(ce-le))},inv:function(ae,se,ce,le){return ce<=se||le<se||le>ce?NaN:ae<=(le-se)/(ce-se)?se+(ce-se)*re.sqrt(ae*((le-se)/(ce-se))):se+(ce-se)*(1-re.sqrt((1-ae)*(1-(le-se)/(ce-se))))},mean:function(ae,se,ce){return(ae+se+ce)/3},median:function(ae,se,ce){if(ce<=(ae+se)/2)return se-re.sqrt((se-ae)*(se-ce))/re.sqrt(2);if(ce>(ae+se)/2)return ae+re.sqrt((se-ae)*(ce-ae))/re.sqrt(2)},mode:function(ae,se,ce){return ce},sample:function(ae,se,ce){var le=ee._random_fn();return le<(ce-ae)/(se-ae)?ae+re.sqrt(le*(se-ae)*(ce-ae)):se-re.sqrt((1-le)*(se-ae)*(se-ce))},variance:function(ae,se,ce){return(ae*ae+se*se+ce*ce-ae*se-ae*ce-se*ce)/18}}),ee.extend(ee.arcsine,{pdf:function(ae,se,ce){return ce<=se?NaN:ae<=se||ae>=ce?0:2/re.PI*re.pow(re.pow(ce-se,2)-re.pow(2*ae-se-ce,2),-.5)},cdf:function(ae,se,ce){return ae<se?0:ae<ce?2/re.PI*re.asin(re.sqrt((ae-se)/(ce-se))):1},inv:function(ue,ae,se){return ae+(.5-.5*re.cos(re.PI*ue))*(se-ae)},mean:function(ae,se){return se<=ae?NaN:(ae+se)/2},median:function(ae,se){return se<=ae?NaN:(ae+se)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(ae,se){return(ae+se)/2+(se-ae)/2*re.sin(2*re.PI*ee.uniform.sample(0,1))},variance:function(ae,se){return se<=ae?NaN:re.pow(se-ae,2)/8}});function ie(ue){return ue/re.abs(ue)}ee.extend(ee.laplace,{pdf:function(ae,se,ce){return ce<=0?0:re.exp(-re.abs(ae-se)/ce)/(2*ce)},cdf:function(ae,se,ce){return ce<=0?0:ae<se?.5*re.exp((ae-se)/ce):1-.5*re.exp(-(ae-se)/ce)},mean:function(ue){return ue},median:function(ue){return ue},mode:function(ue){return ue},variance:function(ue,ae){return 2*ae*ae},sample:function(ae,se){var ce=ee._random_fn()-.5;return ae-se*ie(ce)*re.log(1-2*re.abs(ce))}});function oe(ue,ae,se){var ce=12,le=6,pe=-30,de=-50,me=60,ve=8,we=3,ge=2,_e=3,Te=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],Ne=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],Le=ue*.5;if(Le>=ve)return 1;var Oe=2*ee.normal.cdf(Le,0,1,1,0)-1;Oe>=re.exp(de/se)?Oe=re.pow(Oe,se):Oe=0;var xe;ue>we?xe=ge:xe=_e;for(var Se=Le,be=(ve-Le)/xe,De=Se+be,Me=0,Ue=se-1,Ke=1;Ke<=xe;Ke++){for(var ft=0,qe=.5*(De+Se),ot=.5*(De-Se),nt=1;nt<=ce;nt++){var Ze,Ge;le<nt?(Ze=ce-nt+1,Ge=Te[Ze-1]):(Ze=nt,Ge=-Te[Ze-1]);var et=ot*Ge,tt=qe+et,Ye=tt*tt;if(Ye>me)break;var at=2*ee.normal.cdf(tt,0,1,1,0),Bt=2*ee.normal.cdf(tt,ue,1,1,0),Et=at*.5-Bt*.5;Et>=re.exp(pe/Ue)&&(Et=Ne[Ze-1]*re.exp(-(.5*Ye))*re.pow(Et,Ue),ft+=Et)}ft*=2*ot*se/re.sqrt(2*re.PI),Me+=ft,Se=De,De+=be}return Oe+=Me,Oe<=re.exp(pe/ae)?0:(Oe=re.pow(Oe,ae),Oe>=1?1:Oe)}function fe(ue,ae,se){var ce=.322232421088,le=.099348462606,pe=-1,de=.588581570495,me=-.342242088547,ve=.531103462366,we=-.204231210125,ge=.10353775285,_e=-453642210148e-16,Te=.0038560700634,Ne=.8832,Le=.2368,Oe=1.214,xe=1.208,Se=1.4142,be=120,De=.5-.5*ue,Me=re.sqrt(re.log(1/(De*De))),Ue=Me+((((Me*_e+we)*Me+me)*Me+pe)*Me+ce)/((((Me*Te+ge)*Me+ve)*Me+de)*Me+le);se<be&&(Ue+=(Ue*Ue*Ue+Ue)/se/4);var Ke=Ne-Le*Ue;return se<be&&(Ke+=-Oe/se+xe*Ue/se),Ue*(Ke*re.log(ae-1)+Se)}ee.extend(ee.tukey,{cdf:function(ae,se,ce){var le=1,pe=se,de=16,me=8,ve=-30,we=1e-14,ge=100,_e=800,Te=5e3,Ne=25e3,Le=1,Oe=.5,xe=.25,Se=.125,be=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],De=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(ae<=0)return 0;if(ce<2||le<1||pe<2)return NaN;if(!Number.isFinite(ae))return 1;if(ce>Ne)return oe(ae,le,pe);var Me=ce*.5,Ue=Me*re.log(ce)-ce*re.log(2)-ee.gammaln(Me),Ke=Me-1,ft=ce*.25,qe;ce<=ge?qe=Le:ce<=_e?qe=Oe:ce<=Te?qe=xe:qe=Se,Ue+=re.log(qe);for(var ot=0,nt=1;nt<=50;nt++){for(var Ze=0,Ge=(2*nt-1)*qe,et=1;et<=de;et++){var tt,Ye;me<et?(tt=et-me-1,Ye=Ue+Ke*re.log(Ge+be[tt]*qe)-(be[tt]*qe+Ge)*ft):(tt=et-1,Ye=Ue+Ke*re.log(Ge-be[tt]*qe)+(be[tt]*qe-Ge)*ft);var at;if(Ye>=ve){me<et?at=ae*re.sqrt((be[tt]*qe+Ge)*.5):at=ae*re.sqrt((-(be[tt]*qe)+Ge)*.5);var Bt=oe(at,le,pe),Et=Bt*De[tt]*re.exp(Ye);Ze+=Et}}if(nt*qe>=1&&Ze<=we)break;ot+=Ze}if(Ze>we)throw new Error("tukey.cdf failed to converge");return ot>1&&(ot=1),ot},inv:function(ue,ae,se){var ce=1,le=ae,pe=1e-4,de=50;if(se<2||ce<1||le<2)return NaN;if(ue<0||ue>1)return NaN;if(ue===0)return 0;if(ue===1)return 1/0;var me=fe(ue,le,se),ve=ee.tukey.cdf(me,ae,se)-ue,we;ve>0?we=re.max(0,me-1):we=me+1;for(var ge=ee.tukey.cdf(we,ae,se)-ue,_e,Te=1;Te<de;Te++){_e=we-ge*(we-me)/(ge-ve),ve=ge,me=we,_e<0&&(_e=0,ge=-ue),ge=ee.tukey.cdf(_e,ae,se)-ue,we=_e;var Ne=re.abs(we-me);if(Ne<pe)return _e}throw new Error("tukey.inv failed to converge")}})}(te,Math),function(ee,re){var ne=Array.prototype.push,ie=ee.utils.isArray;function oe(fe){return ie(fe)||fe instanceof ee}ee.extend({add:function(ue,ae){return oe(ae)?(oe(ae[0])||(ae=[ae]),ee.map(ue,function(se,ce,le){return se+ae[ce][le]})):ee.map(ue,function(se){return se+ae})},subtract:function(ue,ae){return oe(ae)?(oe(ae[0])||(ae=[ae]),ee.map(ue,function(se,ce,le){return se-ae[ce][le]||0})):ee.map(ue,function(se){return se-ae})},divide:function(ue,ae){return oe(ae)?(oe(ae[0])||(ae=[ae]),ee.multiply(ue,ee.inv(ae))):ee.map(ue,function(se){return se/ae})},multiply:function(ue,ae){var se,ce,le,pe,de,me,ve,we;if(ue.length===void 0&&ae.length===void 0)return ue*ae;if(de=ue.length,me=ue[0].length,ve=ee.zeros(de,le=oe(ae)?ae[0].length:me),we=0,oe(ae)){for(;we<le;we++)for(se=0;se<de;se++){for(pe=0,ce=0;ce<me;ce++)pe+=ue[se][ce]*ae[ce][we];ve[se][we]=pe}return de===1&&we===1?ve[0][0]:ve}return ee.map(ue,function(ge){return ge*ae})},outer:function(ue,ae){return ee.multiply(ue.map(function(se){return[se]}),[ae])},dot:function(ue,ae){oe(ue[0])||(ue=[ue]),oe(ae[0])||(ae=[ae]);for(var se=ue[0].length===1&&ue.length!==1?ee.transpose(ue):ue,ce=ae[0].length===1&&ae.length!==1?ee.transpose(ae):ae,le=[],pe=0,de=se.length,me=se[0].length,ve,we;pe<de;pe++){for(le[pe]=[],ve=0,we=0;we<me;we++)ve+=se[pe][we]*ce[pe][we];le[pe]=ve}return le.length===1?le[0]:le},pow:function(ue,ae){return ee.map(ue,function(se){return re.pow(se,ae)})},exp:function(ue){return ee.map(ue,function(ae){return re.exp(ae)})},log:function(ue){return ee.map(ue,function(ae){return re.log(ae)})},abs:function(ue){return ee.map(ue,function(ae){return re.abs(ae)})},norm:function(ue,ae){var se=0,ce=0;for(isNaN(ae)&&(ae=2),oe(ue[0])&&(ue=ue[0]);ce<ue.length;ce++)se+=re.pow(re.abs(ue[ce]),ae);return re.pow(se,1/ae)},angle:function(ue,ae){return re.acos(ee.dot(ue,ae)/(ee.norm(ue)*ee.norm(ae)))},aug:function(ue,ae){var se=[],ce;for(ce=0;ce<ue.length;ce++)se.push(ue[ce].slice());for(ce=0;ce<se.length;ce++)ne.apply(se[ce],ae[ce]);return se},inv:function(ue){for(var ae=ue.length,se=ue[0].length,ce=ee.identity(ae,se),le=ee.gauss_jordan(ue,ce),pe=[],de=0,me;de<ae;de++)for(pe[de]=[],me=se;me<le[0].length;me++)pe[de][me-se]=le[de][me];return pe},det:function(ue){var ae=ue.length,se=ae*2,ce=new Array(se),le=ae-1,pe=se-1,de=le-ae+1,me=pe,ve=0,we=0,ge;if(ae===2)return ue[0][0]*ue[1][1]-ue[0][1]*ue[1][0];for(;ve<se;ve++)ce[ve]=1;for(ve=0;ve<ae;ve++){for(ge=0;ge<ae;ge++)ce[de<0?de+ae:de]*=ue[ve][ge],ce[me<ae?me+ae:me]*=ue[ve][ge],de++,me--;de=--le-ae+1,me=--pe}for(ve=0;ve<ae;ve++)we+=ce[ve];for(;ve<se;ve++)we-=ce[ve];return we},gauss_elimination:function(ue,ae){var se=0,ce=0,le=ue.length,pe=ue[0].length,de=1,me=0,ve=[],we,ge,_e,Te;for(ue=ee.aug(ue,ae),we=ue[0].length,se=0;se<le;se++){for(ge=ue[se][se],ce=se,Te=se+1;Te<pe;Te++)ge<re.abs(ue[Te][se])&&(ge=ue[Te][se],ce=Te);if(ce!=se)for(Te=0;Te<we;Te++)_e=ue[se][Te],ue[se][Te]=ue[ce][Te],ue[ce][Te]=_e;for(ce=se+1;ce<le;ce++)for(de=ue[ce][se]/ue[se][se],Te=se;Te<we;Te++)ue[ce][Te]=ue[ce][Te]-de*ue[se][Te]}for(se=le-1;se>=0;se--){for(me=0,ce=se+1;ce<=le-1;ce++)me=me+ve[ce]*ue[se][ce];ve[se]=(ue[se][we-1]-me)/ue[se][se]}return ve},gauss_jordan:function(ue,ae){var se=ee.aug(ue,ae),ce=se.length,le=se[0].length,pe=0,de,me,ve;for(me=0;me<ce;me++){var we=me;for(ve=me+1;ve<ce;ve++)re.abs(se[ve][me])>re.abs(se[we][me])&&(we=ve);var ge=se[me];for(se[me]=se[we],se[we]=ge,ve=me+1;ve<ce;ve++)for(pe=se[ve][me]/se[me][me],de=me;de<le;de++)se[ve][de]-=se[me][de]*pe}for(me=ce-1;me>=0;me--){for(pe=se[me][me],ve=0;ve<me;ve++)for(de=le-1;de>me-1;de--)se[ve][de]-=se[me][de]*se[ve][me]/pe;for(se[me][me]/=pe,de=ce;de<le;de++)se[me][de]/=pe}return se},triaUpSolve:function(ue,ae){var se=ue[0].length,ce=ee.zeros(1,se)[0],le,pe=!1;return ae[0].length!=null&&(ae=ae.map(function(de){return de[0]}),pe=!0),ee.arange(se-1,-1,-1).forEach(function(de){le=ee.arange(de+1,se).map(function(me){return ce[me]*ue[de][me]}),ce[de]=(ae[de]-ee.sum(le))/ue[de][de]}),pe?ce.map(function(de){return[de]}):ce},triaLowSolve:function(ue,ae){var se=ue[0].length,ce=ee.zeros(1,se)[0],le,pe=!1;return ae[0].length!=null&&(ae=ae.map(function(de){return de[0]}),pe=!0),ee.arange(se).forEach(function(de){le=ee.arange(de).map(function(me){return ue[de][me]*ce[me]}),ce[de]=(ae[de]-ee.sum(le))/ue[de][de]}),pe?ce.map(function(de){return[de]}):ce},lu:function(ue){var ae=ue.length,se=ee.identity(ae),ce=ee.zeros(ue.length,ue[0].length),le;return ee.arange(ae).forEach(function(pe){ce[0][pe]=ue[0][pe]}),ee.arange(1,ae).forEach(function(pe){ee.arange(pe).forEach(function(de){le=ee.arange(de).map(function(me){return se[pe][me]*ce[me][de]}),se[pe][de]=(ue[pe][de]-ee.sum(le))/ce[de][de]}),ee.arange(pe,ae).forEach(function(de){le=ee.arange(pe).map(function(me){return se[pe][me]*ce[me][de]}),ce[pe][de]=ue[le.length][de]-ee.sum(le)})}),[se,ce]},cholesky:function(ue){var ae=ue.length,se=ee.zeros(ue.length,ue[0].length),ce;return ee.arange(ae).forEach(function(le){ce=ee.arange(le).map(function(pe){return re.pow(se[le][pe],2)}),se[le][le]=re.sqrt(ue[le][le]-ee.sum(ce)),ee.arange(le+1,ae).forEach(function(pe){ce=ee.arange(le).map(function(de){return se[le][de]*se[pe][de]}),se[pe][le]=(ue[le][pe]-ee.sum(ce))/se[le][le]})}),se},gauss_jacobi:function(ue,ae,se,ce){for(var le=0,pe=0,de=ue.length,me=[],ve=[],we=[],ge,_e,Te,Ne;le<de;le++)for(me[le]=[],ve[le]=[],we[le]=[],pe=0;pe<de;pe++)le>pe?(me[le][pe]=ue[le][pe],ve[le][pe]=we[le][pe]=0):le<pe?(ve[le][pe]=ue[le][pe],me[le][pe]=we[le][pe]=0):(we[le][pe]=ue[le][pe],me[le][pe]=ve[le][pe]=0);for(Te=ee.multiply(ee.multiply(ee.inv(we),ee.add(me,ve)),-1),_e=ee.multiply(ee.inv(we),ae),ge=se,Ne=ee.add(ee.multiply(Te,se),_e),le=2;re.abs(ee.norm(ee.subtract(Ne,ge)))>ce;)ge=Ne,Ne=ee.add(ee.multiply(Te,ge),_e),le++;return Ne},gauss_seidel:function(ue,ae,se,ce){for(var le=0,pe=ue.length,de=[],me=[],ve=[],we,ge,_e,Te,Ne;le<pe;le++)for(de[le]=[],me[le]=[],ve[le]=[],we=0;we<pe;we++)le>we?(de[le][we]=ue[le][we],me[le][we]=ve[le][we]=0):le<we?(me[le][we]=ue[le][we],de[le][we]=ve[le][we]=0):(ve[le][we]=ue[le][we],de[le][we]=me[le][we]=0);for(Te=ee.multiply(ee.multiply(ee.inv(ee.add(ve,de)),me),-1),_e=ee.multiply(ee.inv(ee.add(ve,de)),ae),ge=se,Ne=ee.add(ee.multiply(Te,se),_e),le=2;re.abs(ee.norm(ee.subtract(Ne,ge)))>ce;)ge=Ne,Ne=ee.add(ee.multiply(Te,ge),_e),le=le+1;return Ne},SOR:function(ue,ae,se,ce,le){for(var pe=0,de=ue.length,me=[],ve=[],we=[],ge,_e,Te,Ne,Le;pe<de;pe++)for(me[pe]=[],ve[pe]=[],we[pe]=[],ge=0;ge<de;ge++)pe>ge?(me[pe][ge]=ue[pe][ge],ve[pe][ge]=we[pe][ge]=0):pe<ge?(ve[pe][ge]=ue[pe][ge],me[pe][ge]=we[pe][ge]=0):(we[pe][ge]=ue[pe][ge],me[pe][ge]=ve[pe][ge]=0);for(Ne=ee.multiply(ee.inv(ee.add(we,ee.multiply(me,le))),ee.subtract(ee.multiply(we,1-le),ee.multiply(ve,le))),Te=ee.multiply(ee.multiply(ee.inv(ee.add(we,ee.multiply(me,le))),ae),le),_e=se,Le=ee.add(ee.multiply(Ne,se),Te),pe=2;re.abs(ee.norm(ee.subtract(Le,_e)))>ce;)_e=Le,Le=ee.add(ee.multiply(Ne,_e),Te),pe++;return Le},householder:function(ue){for(var ae=ue.length,se=ue[0].length,ce=0,le=[],pe=[],de,me,ve,we,ge;ce<ae-1;ce++){for(de=0,we=ce+1;we<se;we++)de+=ue[we][ce]*ue[we][ce];for(ge=ue[ce+1][ce]>0?-1:1,de=ge*re.sqrt(de),me=re.sqrt((de*de-ue[ce+1][ce]*de)/2),le=ee.zeros(ae,1),le[ce+1][0]=(ue[ce+1][ce]-de)/(2*me),ve=ce+2;ve<ae;ve++)le[ve][0]=ue[ve][ce]/(2*me);pe=ee.subtract(ee.identity(ae,se),ee.multiply(ee.multiply(le,ee.transpose(le)),2)),ue=ee.multiply(pe,ee.multiply(ue,pe))}return ue},QR:function(){var fe=ee.sum,ue=ee.arange;function ae(se){var ce=se.length,le=se[0].length,pe=ee.zeros(le,le);se=ee.copy(se);var de,me,ve;for(me=0;me<le;me++){for(pe[me][me]=re.sqrt(fe(ue(ce).map(function(we){return se[we][me]*se[we][me]}))),de=0;de<ce;de++)se[de][me]=se[de][me]/pe[me][me];for(ve=me+1;ve<le;ve++)for(pe[me][ve]=fe(ue(ce).map(function(we){return se[we][me]*se[we][ve]})),de=0;de<ce;de++)se[de][ve]=se[de][ve]-se[de][me]*pe[me][ve]}return[se,pe]}return ae}(),lstsq:function(){function fe(ae){ae=ee.copy(ae);var se=ae.length,ce=ee.identity(se);return ee.arange(se-1,-1,-1).forEach(function(le){ee.sliceAssign(ce,{row:le},ee.divide(ee.slice(ce,{row:le}),ae[le][le])),ee.sliceAssign(ae,{row:le},ee.divide(ee.slice(ae,{row:le}),ae[le][le])),ee.arange(le).forEach(function(pe){var de=ee.multiply(ae[pe][le],-1),me=ee.slice(ae,{row:pe}),ve=ee.multiply(ee.slice(ae,{row:le}),de);ee.sliceAssign(ae,{row:pe},ee.add(me,ve));var we=ee.slice(ce,{row:pe}),ge=ee.multiply(ee.slice(ce,{row:le}),de);ee.sliceAssign(ce,{row:pe},ee.add(we,ge))})}),ce}function ue(ae,se){var ce=!1;se[0].length===void 0&&(se=se.map(function(Ne){return[Ne]}),ce=!0);var le=ee.QR(ae),pe=le[0],de=le[1],me=ae[0].length,ve=ee.slice(pe,{col:{end:me}}),we=ee.slice(de,{row:{end:me}}),ge=fe(we),_e=ee.transpose(ve);_e[0].length===void 0&&(_e=[_e]);var Te=ee.multiply(ee.multiply(ge,_e),se);return Te.length===void 0&&(Te=[[Te]]),ce?Te.map(function(Ne){return Ne[0]}):Te}return ue}(),jacobi:function(ue){for(var ae=1,se=ue.length,ce=ee.identity(se,se),le=[],pe,de,me,ve,we,ge,_e,Te;ae===1;){for(ge=ue[0][1],ve=0,we=1,de=0;de<se;de++)for(me=0;me<se;me++)de!=me&&ge<re.abs(ue[de][me])&&(ge=re.abs(ue[de][me]),ve=de,we=me);for(ue[ve][ve]===ue[we][we]?_e=ue[ve][we]>0?re.PI/4:-re.PI/4:_e=re.atan(2*ue[ve][we]/(ue[ve][ve]-ue[we][we]))/2,Te=ee.identity(se,se),Te[ve][ve]=re.cos(_e),Te[ve][we]=-re.sin(_e),Te[we][ve]=re.sin(_e),Te[we][we]=re.cos(_e),ce=ee.multiply(ce,Te),pe=ee.multiply(ee.multiply(ee.inv(Te),ue),Te),ue=pe,ae=0,de=1;de<se;de++)for(me=1;me<se;me++)de!=me&&re.abs(ue[de][me])>.001&&(ae=1)}for(de=0;de<se;de++)le.push(ue[de][de]);return[ce,le]},rungekutta:function(ue,ae,se,ce,le,pe){var de,me,ve,we,ge;if(pe===2)for(;ce<=se;)de=ae*ue(ce,le),me=ae*ue(ce+ae,le+de),ve=le+(de+me)/2,le=ve,ce=ce+ae;if(pe===4)for(;ce<=se;)de=ae*ue(ce,le),me=ae*ue(ce+ae/2,le+de/2),we=ae*ue(ce+ae/2,le+me/2),ge=ae*ue(ce+ae,le+we),ve=le+(de+2*me+2*we+ge)/6,le=ve,ce=ce+ae;return le},romberg:function(ue,ae,se,ce){for(var le=0,pe=(se-ae)/2,de=[],me=[],ve=[],we,ge,_e,Te,Ne;le<ce/2;){for(Ne=ue(ae),_e=ae,Te=0;_e<=se;_e=_e+pe,Te++)de[Te]=_e;for(we=de.length,_e=1;_e<we-1;_e++)Ne+=(_e%2!==0?4:2)*ue(de[_e]);Ne=pe/3*(Ne+ue(se)),ve[le]=Ne,pe/=2,le++}for(ge=ve.length,we=1;ge!==1;){for(_e=0;_e<ge-1;_e++)me[_e]=(re.pow(4,we)*ve[_e+1]-ve[_e])/(re.pow(4,we)-1);ge=me.length,ve=me,me=[],we++}return ve},richardson:function(ue,ae,se,ce){function le(Le,Oe){for(var xe=0,Se=Le.length,be;xe<Se;xe++)Le[xe]===Oe&&(be=xe);return be}for(var pe=re.abs(se-ue[le(ue,se)+1]),de=0,me=[],ve=[],we,ge,_e,Te,Ne;ce>=pe;)we=le(ue,se+ce),ge=le(ue,se),me[de]=(ae[we]-2*ae[ge]+ae[2*ge-we])/(ce*ce),ce/=2,de++;for(Te=me.length,_e=1;Te!=1;){for(Ne=0;Ne<Te-1;Ne++)ve[Ne]=(re.pow(4,_e)*me[Ne+1]-me[Ne])/(re.pow(4,_e)-1);Te=ve.length,me=ve,ve=[],_e++}return me},simpson:function(ue,ae,se,ce){for(var le=(se-ae)/ce,pe=ue(ae),de=[],me=ae,ve=0,we=1,ge;me<=se;me=me+le,ve++)de[ve]=me;for(ge=de.length;we<ge-1;we++)pe+=(we%2!==0?4:2)*ue(de[we]);return le/3*(pe+ue(se))},hermite:function(ue,ae,se,ce){for(var le=ue.length,pe=0,de=0,me=[],ve=[],we=[],ge=[],_e;de<le;de++){for(me[de]=1,_e=0;_e<le;_e++)de!=_e&&(me[de]*=(ce-ue[_e])/(ue[de]-ue[_e]));for(ve[de]=0,_e=0;_e<le;_e++)de!=_e&&(ve[de]+=1/(ue[de]-ue[_e]));we[de]=(1-2*(ce-ue[de])*ve[de])*(me[de]*me[de]),ge[de]=(ce-ue[de])*(me[de]*me[de]),pe+=we[de]*ae[de]+ge[de]*se[de]}return pe},lagrange:function(ue,ae,se){for(var ce=0,le=0,pe,de,me=ue.length;le<me;le++){for(de=ae[le],pe=0;pe<me;pe++)le!=pe&&(de*=(se-ue[pe])/(ue[le]-ue[pe]));ce+=de}return ce},cubic_spline:function(ue,ae,se){for(var ce=ue.length,le=0,pe,de=[],me=[],ve=[],we=[],ge=[],_e=[],Te=[];le<ce-1;le++)ge[le]=ue[le+1]-ue[le];for(ve[0]=0,le=1;le<ce-1;le++)ve[le]=3/ge[le]*(ae[le+1]-ae[le])-3/ge[le-1]*(ae[le]-ae[le-1]);for(le=1;le<ce-1;le++)de[le]=[],me[le]=[],de[le][le-1]=ge[le-1],de[le][le]=2*(ge[le-1]+ge[le]),de[le][le+1]=ge[le],me[le][0]=ve[le];for(we=ee.multiply(ee.inv(de),me),pe=0;pe<ce-1;pe++)_e[pe]=(ae[pe+1]-ae[pe])/ge[pe]-ge[pe]*(we[pe+1][0]+2*we[pe][0])/3,Te[pe]=(we[pe+1][0]-we[pe][0])/(3*ge[pe]);for(pe=0;pe<ce&&!(ue[pe]>se);pe++);return pe-=1,ae[pe]+(se-ue[pe])*_e[pe]+ee.sq(se-ue[pe])*we[pe]+(se-ue[pe])*ee.sq(se-ue[pe])*Te[pe]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(ue){var ae=ue.length,se=ue[0].length,ce=0,le,pe,de=[],me=[],ve=[],we=[],ge=[],_e=[],Te=[],Ne=[],Le=[],Oe=[];for(ce=0;ce<ae;ce++)de[ce]=ee.sum(ue[ce])/se;for(ce=0;ce<se;ce++)for(Te[ce]=[],le=0;le<ae;le++)Te[ce][le]=ue[le][ce]-de[le];for(Te=ee.transpose(Te),ce=0;ce<ae;ce++)for(Ne[ce]=[],le=0;le<ae;le++)Ne[ce][le]=ee.dot([Te[ce]],[Te[le]])/(se-1);for(ve=ee.jacobi(Ne),Le=ve[0],me=ve[1],Oe=ee.transpose(Le),ce=0;ce<me.length;ce++)for(le=ce;le<me.length;le++)me[ce]<me[le]&&(pe=me[ce],me[ce]=me[le],me[le]=pe,we=Oe[ce],Oe[ce]=Oe[le],Oe[le]=we);for(_e=ee.transpose(Te),ce=0;ce<ae;ce++)for(ge[ce]=[],le=0;le<_e.length;le++)ge[ce][le]=ee.dot([Oe[ce]],[_e[le]]);return[ue,me,Oe,ge]}}),function(fe){for(var ue=0;ue<fe.length;ue++)(function(ae){ee.fn[ae]=function(se,ce){var le=this;return ce?(setTimeout(function(){ce.call(le,ee.fn[ae].call(le,se))},15),this):typeof ee[ae](this,se)=="number"?ee[ae](this,se):ee(ee[ae](this,se))}})(fe[ue])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(te,Math),function(ee,re){var ne=[].slice,ie=ee.utils.isNumber,oe=ee.utils.isArray;ee.extend({zscore:function(){var ae=ne.call(arguments);return ie(ae[1])?(ae[0]-ae[1])/ae[2]:(ae[0]-ee.mean(ae[1]))/ee.stdev(ae[1],ae[2])},ztest:function(){var ae=ne.call(arguments),se;return oe(ae[1])?(se=ee.zscore(ae[0],ae[1],ae[3]),ae[2]===1?ee.normal.cdf(-re.abs(se),0,1):ee.normal.cdf(-re.abs(se),0,1)*2):ae.length>2?(se=ee.zscore(ae[0],ae[1],ae[2]),ae[3]===1?ee.normal.cdf(-re.abs(se),0,1):ee.normal.cdf(-re.abs(se),0,1)*2):(se=ae[0],ae[1]===1?ee.normal.cdf(-re.abs(se),0,1):ee.normal.cdf(-re.abs(se),0,1)*2)}}),ee.extend(ee.fn,{zscore:function(ae,se){return(ae-this.mean())/this.stdev(se)},ztest:function(ae,se,ce){var le=re.abs(this.zscore(ae,ce));return se===1?ee.normal.cdf(-le,0,1):ee.normal.cdf(-le,0,1)*2}}),ee.extend({tscore:function(){var ae=ne.call(arguments);return ae.length===4?(ae[0]-ae[1])/(ae[2]/re.sqrt(ae[3])):(ae[0]-ee.mean(ae[1]))/(ee.stdev(ae[1],!0)/re.sqrt(ae[1].length))},ttest:function(){var ae=ne.call(arguments),se;return ae.length===5?(se=re.abs(ee.tscore(ae[0],ae[1],ae[2],ae[3])),ae[4]===1?ee.studentt.cdf(-se,ae[3]-1):ee.studentt.cdf(-se,ae[3]-1)*2):ie(ae[1])?(se=re.abs(ae[0]),ae[2]==1?ee.studentt.cdf(-se,ae[1]-1):ee.studentt.cdf(-se,ae[1]-1)*2):(se=re.abs(ee.tscore(ae[0],ae[1])),ae[2]==1?ee.studentt.cdf(-se,ae[1].length-1):ee.studentt.cdf(-se,ae[1].length-1)*2)}}),ee.extend(ee.fn,{tscore:function(ae){return(ae-this.mean())/(this.stdev(!0)/re.sqrt(this.cols()))},ttest:function(ae,se){return se===1?1-ee.studentt.cdf(re.abs(this.tscore(ae)),this.cols()-1):ee.studentt.cdf(-re.abs(this.tscore(ae)),this.cols()-1)*2}}),ee.extend({anovafscore:function(){var ae=ne.call(arguments),se,ce,le,pe,de,me,ve,we;if(ae.length===1){for(de=new Array(ae[0].length),ve=0;ve<ae[0].length;ve++)de[ve]=ae[0][ve];ae=de}for(ce=new Array,ve=0;ve<ae.length;ve++)ce=ce.concat(ae[ve]);for(le=ee.mean(ce),se=0,ve=0;ve<ae.length;ve++)se=se+ae[ve].length*re.pow(ee.mean(ae[ve])-le,2);for(se/=ae.length-1,me=0,ve=0;ve<ae.length;ve++)for(pe=ee.mean(ae[ve]),we=0;we<ae[ve].length;we++)me+=re.pow(ae[ve][we]-pe,2);return me/=ce.length-ae.length,se/me},anovaftest:function(){var ae=ne.call(arguments),se,ce,le,pe;if(ie(ae[0]))return 1-ee.centralF.cdf(ae[0],ae[1],ae[2]);var de=ee.anovafscore(ae);for(se=ae.length-1,le=0,pe=0;pe<ae.length;pe++)le=le+ae[pe].length;return ce=le-se-1,1-ee.centralF.cdf(de,se,ce)},ftest:function(ae,se,ce){return 1-ee.centralF.cdf(ae,se,ce)}}),ee.extend(ee.fn,{anovafscore:function(){return ee.anovafscore(this.toArray())},anovaftes:function(){var ae=0,se;for(se=0;se<this.length;se++)ae=ae+this[se].length;return ee.ftest(this.anovafscore(),this.length-1,ae-this.length)}}),ee.extend({qscore:function(){var ae=ne.call(arguments),se,ce,le,pe,de;return ie(ae[0])?(se=ae[0],ce=ae[1],le=ae[2],pe=ae[3],de=ae[4]):(se=ee.mean(ae[0]),ce=ee.mean(ae[1]),le=ae[0].length,pe=ae[1].length,de=ae[2]),re.abs(se-ce)/(de*re.sqrt((1/le+1/pe)/2))},qtest:function(){var ae=ne.call(arguments),se;ae.length===3?(se=ae[0],ae=ae.slice(1)):ae.length===7?(se=ee.qscore(ae[0],ae[1],ae[2],ae[3],ae[4]),ae=ae.slice(5)):(se=ee.qscore(ae[0],ae[1],ae[2]),ae=ae.slice(3));var ce=ae[0],le=ae[1];return 1-ee.tukey.cdf(se,le,ce-le)},tukeyhsd:function(ae){for(var se=ee.pooledstdev(ae),ce=ae.map(function(we){return ee.mean(we)}),le=ae.reduce(function(we,ge){return we+ge.length},0),pe=[],de=0;de<ae.length;++de)for(var me=de+1;me<ae.length;++me){var ve=ee.qtest(ce[de],ce[me],ae[de].length,ae[me].length,se,le,ae.length);pe.push([[de,me],ve])}return pe}}),ee.extend({normalci:function(){var ae=ne.call(arguments),se=new Array(2),ce;return ae.length===4?ce=re.abs(ee.normal.inv(ae[1]/2,0,1)*ae[2]/re.sqrt(ae[3])):ce=re.abs(ee.normal.inv(ae[1]/2,0,1)*ee.stdev(ae[2])/re.sqrt(ae[2].length)),se[0]=ae[0]-ce,se[1]=ae[0]+ce,se},tci:function(){var ae=ne.call(arguments),se=new Array(2),ce;return ae.length===4?ce=re.abs(ee.studentt.inv(ae[1]/2,ae[3]-1)*ae[2]/re.sqrt(ae[3])):ce=re.abs(ee.studentt.inv(ae[1]/2,ae[2].length-1)*ee.stdev(ae[2],!0)/re.sqrt(ae[2].length)),se[0]=ae[0]-ce,se[1]=ae[0]+ce,se},significant:function(ae,se){return ae<se}}),ee.extend(ee.fn,{normalci:function(ae,se){return ee.normalci(ae,se,this.toArray())},tci:function(ae,se){return ee.tci(ae,se,this.toArray())}});function fe(ue,ae,se,ce){if(ue>1||se>1||ue<=0||se<=0)throw new Error("Proportions should be greater than 0 and less than 1");var le=(ue*ae+se*ce)/(ae+ce),pe=re.sqrt(le*(1-le)*(1/ae+1/ce));return(ue-se)/pe}ee.extend(ee.fn,{oneSidedDifferenceOfProportions:function(ae,se,ce,le){var pe=fe(ae,se,ce,le);return ee.ztest(pe,1)},twoSidedDifferenceOfProportions:function(ae,se,ce,le){var pe=fe(ae,se,ce,le);return ee.ztest(pe,2)}})}(te,Math),te.models=function(){function ee(fe){var ue=fe[0].length,ae=te.arange(ue).map(function(se){var ce=te.arange(ue).filter(function(le){return le!==se});return re(te.col(fe,se).map(function(le){return le[0]}),te.col(fe,ce))});return ae}function re(fe,ue){var ae=fe.length,se=ue[0].length-1,ce=ae-se-1,le=te.lstsq(ue,fe),pe=te.multiply(ue,le.map(function(Te){return[Te]})).map(function(Te){return Te[0]}),de=te.subtract(fe,pe),me=te.mean(fe),ve=te.sum(pe.map(function(Te){return Math.pow(Te-me,2)})),we=te.sum(fe.map(function(Te,Ne){return Math.pow(Te-pe[Ne],2)})),ge=ve+we,_e=ve/ge;return{exog:ue,endog:fe,nobs:ae,df_model:se,df_resid:ce,coef:le,predict:pe,resid:de,ybar:me,SST:ge,SSE:ve,SSR:we,R2:_e}}function ne(fe){var ue=ee(fe.exog),ae=Math.sqrt(fe.SSR/fe.df_resid),se=ue.map(function(me){var ve=me.SST,we=me.R2;return ae/Math.sqrt(ve*(1-we))}),ce=fe.coef.map(function(me,ve){return(me-0)/se[ve]}),le=ce.map(function(me){var ve=te.studentt.cdf(me,fe.df_resid);return(ve>.5?1-ve:ve)*2}),pe=te.studentt.inv(.975,fe.df_resid),de=fe.coef.map(function(me,ve){var we=pe*se[ve];return[me-we,me+we]});return{se,t:ce,p:le,sigmaHat:ae,interval95:de}}function ie(fe){var ue=fe.R2/fe.df_model/((1-fe.R2)/fe.df_resid),ae=function(ce,le,pe){return te.beta.cdf(ce/(pe/le+ce),le/2,pe/2)},se=1-ae(ue,fe.df_model,fe.df_resid);return{F_statistic:ue,pvalue:se}}function oe(fe,ue){var ae=re(fe,ue),se=ne(ae),ce=ie(ae),le=1-(1-ae.R2)*((ae.nobs-1)/ae.df_resid);return ae.t=se,ae.f=ce,ae.adjust_R2=le,ae}return{ols:oe}}(),te.extend({buildxmatrix:function(){for(var re=new Array(arguments.length),ne=0;ne<arguments.length;ne++){var ie=[1];re[ne]=ie.concat(arguments[ne])}return te(re)},builddxmatrix:function(){for(var re=new Array(arguments[0].length),ne=0;ne<arguments[0].length;ne++){var ie=[1];re[ne]=ie.concat(arguments[0][ne])}return te(re)},buildjxmatrix:function(re){for(var ne=new Array(re.length),ie=0;ie<re.length;ie++)ne[ie]=re[ie];return te.builddxmatrix(ne)},buildymatrix:function(re){return te(re).transpose()},buildjymatrix:function(re){return re.transpose()},matrixmult:function(re,ne){var ie,oe,fe,ue,ae;if(re.cols()==ne.rows()){if(ne.rows()>1){for(ue=[],ie=0;ie<re.rows();ie++)for(ue[ie]=[],oe=0;oe<ne.cols();oe++){for(ae=0,fe=0;fe<re.cols();fe++)ae+=re.toArray()[ie][fe]*ne.toArray()[fe][oe];ue[ie][oe]=ae}return te(ue)}for(ue=[],ie=0;ie<re.rows();ie++)for(ue[ie]=[],oe=0;oe<ne.cols();oe++){for(ae=0,fe=0;fe<re.cols();fe++)ae+=re.toArray()[ie][fe]*ne.toArray()[oe];ue[ie][oe]=ae}return te(ue)}},regress:function(re,ne){var ie=te.xtranspxinv(re),oe=re.transpose(),fe=te.matrixmult(te(ie),oe);return te.matrixmult(fe,ne)},regresst:function(re,ne,ie){var oe=te.regress(re,ne),fe={};fe.anova={};var ue=te.jMatYBar(re,oe);fe.yBar=ue;var ae=ne.mean();fe.anova.residuals=te.residuals(ne,ue),fe.anova.ssr=te.ssr(ue,ae),fe.anova.msr=fe.anova.ssr/(re[0].length-1),fe.anova.sse=te.sse(ne,ue),fe.anova.mse=fe.anova.sse/(ne.length-(re[0].length-1)-1),fe.anova.sst=te.sst(ne,ae),fe.anova.mst=fe.anova.sst/(ne.length-1),fe.anova.r2=1-fe.anova.sse/fe.anova.sst,fe.anova.r2<0&&(fe.anova.r2=0),fe.anova.fratio=fe.anova.msr/fe.anova.mse,fe.anova.pvalue=te.anovaftest(fe.anova.fratio,re[0].length-1,ne.length-(re[0].length-1)-1),fe.anova.rmse=Math.sqrt(fe.anova.mse),fe.anova.r2adj=1-fe.anova.mse/fe.anova.mst,fe.anova.r2adj<0&&(fe.anova.r2adj=0),fe.stats=new Array(re[0].length);for(var se=te.xtranspxinv(re),ce,le,pe,de=0;de<oe.length;de++)ce=Math.sqrt(fe.anova.mse*Math.abs(se[de][de])),le=Math.abs(oe[de]/ce),pe=te.ttest(le,ne.length-re[0].length-1,ie),fe.stats[de]=[oe[de],ce,le,pe];return fe.regress=oe,fe},xtranspx:function(re){return te.matrixmult(re.transpose(),re)},xtranspxinv:function(re){var ne=te.matrixmult(re.transpose(),re),ie=te.inv(ne);return ie},jMatYBar:function(re,ne){var ie=te.matrixmult(re,ne);return new te(ie)},residuals:function(re,ne){return te.matrixsubtract(re,ne)},ssr:function(re,ne){for(var ie=0,oe=0;oe<re.length;oe++)ie+=Math.pow(re[oe]-ne,2);return ie},sse:function(re,ne){for(var ie=0,oe=0;oe<re.length;oe++)ie+=Math.pow(re[oe]-ne[oe],2);return ie},sst:function(re,ne){for(var ie=0,oe=0;oe<re.length;oe++)ie+=Math.pow(re[oe]-ne,2);return ie},matrixsubtract:function(re,ne){for(var ie=new Array(re.length),oe=0;oe<re.length;oe++){ie[oe]=new Array(re[oe].length);for(var fe=0;fe<re[oe].length;fe++)ie[oe][fe]=re[oe][fe]-ne[oe][fe]}return te(ie)}}),te.jStat=te,te});class RandList{constructor(ee){this.simulate=ee,this.vals=[]}get(ee){if(ee>this.vals.length-1)for(let re=this.vals.length;re<=ee;re++)this.simulate.random?this.vals.push(this.simulate.random()):this.vals.push(Math.random());return this.vals[ee]}}function getRandPos(te){return Math.floor((te.time().value-te.timeStart.value)/te.timeStep.value)}function Rand(te,ee=null,re=null){if(te.stochastic=!0,ee!=null)return isNormalNumber(ee,"Rand","Minimum"),isNormalNumber(re,"Rand","Maximum"),Rand(te)*(re-ee)+(0+ee);if(te.RKOrder===1)return te.random?te.random():Math.random();let ne=getRandPos(te);for(ne!==te.lastRandPos&&(te.randLoc=-1,te.lastRandPos=ne);te.previousRandLists.length<=ne;)te.previousRandLists.push(new RandList(te));return te.randLoc=te.randLoc+1,te.previousRandLists[ne].get(te.randLoc)}function RandNormal(te,ee=null,re=null){isNormalNumber(ee,"RandNormal","mu"),isNormalNumber(re,"RandNormal","sigma"),ee===null&&(ee=0),re===null&&(re=1);let ne;return ne=Math.sqrt(-2*Math.log(1-Rand(te)))*Math.cos(Rand(te)*2*3.141593),ne*re+(0+ee)}function RandExp(te,ee=null){if(ee===null&&(ee=1),ee<0)throw new ModelError(`Lambda for RandExp must be greater than or equal to 0; got ${ee}.`,{code:4e3});return isNormalNumber(ee,"RandExp","lambda"),-(1/ee)*Math.log(Rand(te))}function RandLognormal(te,ee,re){if(isNormalNumber(ee,"RandLognormal","mu"),isNormalNumber(re,"RandLognormal","sigma"),ee<=0)throw new ModelError(`<i>Mu</i> for RandLognormal() must be greater than 0; got ${ee}.`,{code:4001});if(re<=0)throw new ModelError(`<i>Sigma</i> for RandLognormal() must be greater than 0; got ${re}.`,{code:4002});let ne=Math.log(ee)-.5*Math.log(1+Math.pow(re/ee,2)),ie=Math.sqrt(Math.log(1+Math.pow(re/ee,2)));return Math.exp(RandNormal(te,ne,ie))}function RandBinomial(te,ee,re){if(isNormalNumber(ee,"RandBinomial","count"),isNormalNumber(re,"RandBinomial","probability"),ee<0)throw new ModelError(`<i>Count</i> for RandBinomial() must be greater than or equal to 0; got ${ee}.`,{code:4003});if(re<0||re>1)throw new ModelError(`<i>Probability</i> for RandBinomial() must be between 0 and 1 (inclusive); got ${re}.`,{code:4004});if(ee===0||re===0)return 0;if(re<=.5)return re*ee<=30?randomBinomialInversion(te,ee,re):randomBinomialBtpe(te,ee,re);{let ne=1-re;return ne*ee<=30?ee-randomBinomialInversion(te,ee,ne):ee-randomBinomialBtpe(te,ee,ne)}}function randomBinomialBtpe(te,ee,re){let ne,ie,oe,fe,ue,ae,se,ce,le,pe,de,me,ve,we,ge,_e,Te,Ne,Le,Oe,xe,Se,be,De,Me,Ue,Ke,ft,qe,ot,nt,Ze,Ge,et,tt;for(ne=Math.min(re,1-re),ie=1-ne,oe=ee*ne+ne,Ze=Math.floor(oe),fe=Math.floor(2.195*Math.sqrt(ee*ne*ie)-4.6*ie)+.5,ue=Ze+.5,ae=ue-fe,se=ue+fe,ce=.134+20.5/(15.3+Ze),we=(oe-ae)/(oe-ae*ne),le=we*(1+we/2),we=(se-oe)/(se*ie),pe=we*(1+we/2),de=fe*(1+2*ce),me=de+ce/le,ve=me+ce/pe;;){if(Se=ee*ne*ie,ge=Rand(te)*ve,_e=Rand(te),!(ge>fe)){Ge=Math.floor(ue-fe*_e+ge);break}if(ge>de)if(ge>me){if(Ge=Math.floor(se-Math.log(_e)/pe),Ge>ee||_e===0)continue;_e=_e*(ge-me)*pe}else{if(Ge=Math.floor(ae+Math.log(_e)/le),Ge<0||_e===0)continue;_e=_e*(ge-de)*le}else{if(nt=ae+(ge-fe)/ce,_e=_e*ce+1-Math.abs(Ze-nt+.5)/fe,_e>1)continue;Ge=Math.floor(nt)}if(et=Math.abs(Ge-Ze),et>20&&et<Se/2-1){if(Le=et/Se*((et*(et/3+.625)+.16666666666666666)/Se+.5),Oe=-et*et/(2*Se),xe=Math.log(_e),xe<Oe-Le)break;if(xe>Oe+Le||(be=Ge+1,Me=Ze+1,Ke=ee+1-Ze,qe=ee-Ge+1,De=be*be,Ue=Me*Me,ft=Ke*Ke,ot=qe*qe,xe>ue*Math.log(Me/be)+(ee-Ze+.5)*Math.log(Ke/qe)+(Ge-Ze)*Math.log(qe*ne/(be*ie))+(13680-(462-(132-(99-140/Ue)/Ue)/Ue)/Ue)/Me/166320+(13680-(462-(132-(99-140/ft)/ft)/ft)/ft)/Ke/166320+(13680-(462-(132-(99-140/De)/De)/De)/De)/be/166320+(13680-(462-(132-(99-140/ot)/ot)/ot)/ot)/qe/166320))continue}else{if(Te=ne/ie,we=Te*(ee+1),Ne=1,Ze<Ge)for(tt=Ze+1;tt<=Ge;tt++)Ne*=we/tt-Te;else if(Ze>Ge)for(tt=Ge+1;tt<=Ze;tt++)Ne/=we/tt-Te;if(_e>Ne)continue;break}}return re>.5&&(Ge=ee-Ge),Ge}function randomBinomialInversion(te,ee,re){let ne,ie,oe,fe,ue,ae,se;for(ne=1-re,ie=Math.exp(ee*Math.log(ne)),oe=ee*re,se=Math.min(ee,oe+10*Math.sqrt(oe*ne+1)),ae=0,fe=ie,ue=Rand(te);ue>fe;)ae++,ae>se?(ae=0,fe=ie,ue=Rand(te)):(ue-=fe,fe=(ee-ae+1)*re*fe/(ae*ne));return ae}function RandNegativeBinomial(te,ee,re){if(isNormalNumber(ee,"RandNegativeBinomial","successes"),isNormalNumber(re,"RandNegativeBinomial","probability"),ee<0)throw new ModelError(`<i>Successes</i> for RandNegativeBinomial() must be greater than or equal to 0; got ${ee}.`,{code:4005});if(re<0||re>1)throw new ModelError(`<i>Probability</i> for RandNegativeBinomial() must be between 0 and 1 (inclusive); got ${re}.`,{code:4006});let ne=0,ie=0;for(;ie<ee;)Rand(te)<=re&&(ie=ie+1),ne=ne+1;return ne}function RandPoisson(te,ee){if(isNormalNumber(ee,"RandPoisson","lambda"),ee<0)throw new ModelError(`<i>Lambda</i> for RandPoisson() must be greater than or equal to 0; got ${ee}.`,{code:4007});if(ee<50){let re=Math.exp(-ee),ne=0,ie=1;for(;ne=ne+1,ie=ie*Rand(te),ie>re;);return ne-1}else{let re=.767-3.36/ee,ne=Math.PI/Math.sqrt(3*ee),ie=ne*ee,oe=Math.log(re)-ee-Math.log(ne);for(;;){let fe=Rand(te),ue=(ie-Math.log((1-fe)/fe))/ne,ae=Math.floor(ue+.5);if(ae<0)continue;let se=Rand(te),ce=ie-ne*ue,le=ce+Math.log(se/Math.pow(1+Math.exp(ce),2)),pe=oe+ae*Math.log(ee)-jStat.gammaln(ae+1);if(le<=pe)return ae}}}function RandGamma(te,ee,re){if(isNormalNumber(ee,"RandGamma","alpha"),isNormalNumber(re,"RandGamma","beta"),ee<=0)throw new ModelError(`<i>Alpha</i> (shape parameter) for RandGamma() must be greater than 0; got ${ee}.`,{code:4008});if(re<=0)throw new ModelError(`<i>Beta</i> (rate parameter) for RandGamma() must be greater than 0; got ${re}.`,{code:4009});let ne=1;for(let ie=1;ie<=ee;ie++)ne=ne*Rand(te);return-re*Math.log(ne)}function RandBeta(te,ee,re){if(isNormalNumber(ee,"RandBeta","alpha"),isNormalNumber(re,"RandBeta","beta"),ee<=0)throw new ModelError(`<i>Alpha</i> for RandBeta() must be greater than 0; got ${ee}.`,{code:4010});if(re<=0)throw new ModelError(`<i>Beta</i> for RandBeta() must be greater than 0; got ${re}.`,{code:4011});let ne=RandGamma(te,ee,1),ie=RandGamma(te,re,1);return ne/(ne+ie)}function RandTriangular(te,ee,re,ne){isNormalNumber(ee,"RandTriangular","minimum"),isNormalNumber(re,"RandTriangular","maximum"),isNormalNumber(ne,"RandTriangular","peak");let ie=0+ee,oe=0+re,fe=0+ne;if(ie===oe)throw new ModelError("Maximum can't equal the minimum for the triangular distribution.",{code:4012});if(fe<ie||fe>oe)throw new ModelError("The peak must be within the maximum and minimum for the triangular distribution.",{code:4013});let ue=(fe-ie)/(oe-ie),ae=Rand(te);return ae<ue?ie+Math.sqrt(ae*(oe-ie)*(fe-ie)):oe-Math.sqrt((1-ae)*(oe-ie)*(oe-fe))}function RandDist(te,ee,re){if(ee.length!==re.length)throw new ModelError("The lengths of the 'x' and 'y' vectors must be the same.",{code:4014});if(ee.length<2)throw new ModelError("There must be at least 2 points in a distribution to generate a random number.",{code:4015});for(let oe=0;oe<ee.length;oe++)if(isNormalNumber(ee[oe],"RandDist","x"),isNormalNumber(re[oe],"RandDist","y"),re[oe]<0)throw new ModelError("The y values of RandDist cannot be negative.",{code:4016});let ne=0;for(let oe=0;oe<ee.length-1;oe++)ne+=(ee[oe+1]-ee[oe])*(re[oe+1]+re[oe])/2;if(ne===0)throw new ModelError("The area of the distribution in RandDist cannot be 0.",{code:4017});let ie=ne*Rand(te);ne=0;for(let oe=0;oe<ee.length-1;oe++){let fe=(ee[oe+1]-ee[oe])*(re[oe+1]+re[oe])/2;if(ie>ne&&ie<ne+fe){let ue=ie-ne,ae=(re[oe+1]-re[oe])/(ee[oe+1]-ee[oe]),se;return ae===0?se=ue/re[oe]:se=(-re[oe]+Math.sqrt(Math.pow(re[oe],2)+2*ae*ue))/ae,ee[oe]+se}ne+=fe}}function isNormalNumber(te,ee,re){if(isNaN(te))throw new ModelError(`The <i>${re}</i> passed to ${ee}() was not a number.`,{code:4018});if(!isFinite(te))throw new ModelError(`The <i>${re}</i> passed to ${ee}() must not be infinite.`,{code:4019});if(te>1e15)throw new ModelError(`The <i>${re}</i> passed to ${ee}() must not be not be greater than 1e15 (got ${te}).`,{code:4020})}function stringify$1(te,ee){if(te instanceof Vector)return te.recurseApply(ne=>stringify$1(ne,ee));let re=new String(te);return re.parent=ee.varBank.stringbase,re}function selectFromMatrix(te,ee,re,ne){let ie=re.length;function oe(se){if(!(se instanceof Vector)){if(re[0]==="*")throw se instanceof Material?new ModelError("Can't use * selector on a number.",{code:3e3}):se instanceof Boolean||typeof se=="boolean"?new ModelError("Can't use * selector on an boolean.",{code:3001}):se instanceof String||typeof se=="string"?new ModelError("Can't use * selector on an string.",{code:3002}):new ModelError("Can't use * selector on an object.",{code:3003});se.vector?se=se.vector:se.parent&&(se=new Vector([],ee,[],se.parent))}return ne===void 0&&se.fullClone&&(se=se.fullClone()),se}let fe=oe(te),ue=selectFromVector(fe,ee,re.shift(),re.length?void 0:ne,ne!==void 0),ae=[];if(ue.collapsed)ae=[ue.data];else{if(!ue.data.items)throw new ModelError(`No element available for selector ${ie-re.length+1}`,{code:3004});ae=ue.data.items}for(;re.length;){let se=[],ce=re.shift();for(let le=0;le<ae.length;le++){if(!(ae[le]instanceof Vector))throw new ModelError(`No element available for selector ${ie-re.length}`,{code:3005});let pe=selectFromVector(ae[le],ee,ce,re.length?void 0:ne);pe.collapsed?(ne||(ae[le].items=[pe.data],ae[le].names=["!!BREAKOUT DATA"]),se=se.concat(pe.data)):(se=se.concat(pe.data.items),ne||(ae[le].items=pe.data.items,ae[le].names=pe.data.names))}ae=se}return doBreakouts(ue.data)}function doBreakouts(te){if(!(te instanceof Vector))return te;if(te.items.length===1&&te.names&&te.names[0]==="!!BREAKOUT DATA")return doBreakouts(te.items[0]);for(let ee=0;ee<te.items.length;ee++)te.items[ee]=doBreakouts(te.items[ee]);return te}function selectFromVector(te,ee,re,ne,ie){if(re==="*")return{data:te};if(typeof re=="function")return{data:re([te]),collapsed:!0};if(re==="parent"){if(te.parent)return{data:ie?te.parent:te.parent.fullClone(),collapsed:!0};throw new ModelError("Vector does not have a parent.",{code:3006})}if(re instanceof Vector){let oe=[],fe=te.names?[]:void 0;for(let ue=0;ue<re.items.length;ue++){let ae=re.items[ue],se=!0;if(typeof ae=="boolean"&&(ae?ae=new Material(ue+1):se=!1),se){let ce=selectElementFromVector(te,ae,ne);oe.push(ce.value),fe&&fe.push(ce.name)}}return{collapsed:!1,parent:te,data:new Vector(oe,ee,fe,te.parent)}}else return{collapsed:!0,parent:te,data:selectElementFromVector(te,re,ne).value}}function selectElementFromVector(te,ee,re){let ne,ie,oe;if(typeof ee=="string"||ee instanceof String)try{if(re===void 0&&!te.names){if(te.parent)return selectElementFromVector(te.parent,ee,re);throw new ModelError(`Key '${ee}' not in vector.`,{code:3007})}if(te.names){oe=-1;let fe=ee.toLowerCase();for(let ue=0;ue<te.names.length;ue++)if(te.names[ue]&&te.names[ue].toLowerCase()===fe){oe=ue;break}oe<0&&(oe=te.names.indexOf("*"))}if(oe<0||oe===void 0)if(re===void 0){if(te.parent)return selectElementFromVector(te.parent,ee,re);throw new ModelError(`Key '${ee}' not in vector.`,{code:3008})}else oe=ee}catch(fe){if(te.parent)return selectElementFromVector(te.parent,ee,re);throw fe}else oe=parseFloat(toNum(ee))-1;if(oe instanceof String||typeof oe=="string"){if(!te.names){te.names=[];for(let fe=0;fe<te.items.length;fe++)te.names.push(void 0)}te.items.push(re),te.names.push(oe.valueOf()),ie=re,ne=oe}else{if(oe<0||!te.items||oe>=te.items.length||oe%1!==0)throw new ModelError("Index "+(1+oe)+" is not in the vector.",{code:3009});re!==void 0&&(te.items[oe]=re),ie=te.items[oe],te.names&&(ne=te.names[oe])}return{name:ne,value:ie}}function strictEquals(te,ee){if(te instanceof SAgent||ee instanceof SAgent){if(te instanceof SAgent&&ee instanceof SAgent&&te.instanceId===ee.instanceId)return!0}else if(te instanceof Vector||ee instanceof Vector){if(te instanceof Vector&&ee instanceof Vector&&te.equals(ee))return!0}else if(eq(te,ee))return!0;return!1}function keysMatch(te,ee){if(!ee.includes("*")){for(let re=0;re<te.length;re++)if(te[re]!=="*"&&(te[re]===void 0||!ee.includes(te[re])))return!1}if(!te.includes("*")){for(let re=0;re<ee.length;re++)if(ee[re]!=="*"&&(ee[re]===void 0||!te.includes(ee[re])))return!1}return!0}class Vector{constructor(ee,re,ne,ie){if(this.simulate=re,this.parent=ie||re.varBank.vectorbase,this.items=ee,this.names=ne,this.namesLC=void 0,this.isNum=void 0,this.terminateApply=void 0,ne){this.namesLC=[];for(let oe of ne)oe?this.namesLC.push(oe.toLowerCase()):this.namesLC.push(void 0)}}toNum(){if(this.isNum)return this;let ee=this.fullClone();for(let re=0;re<ee.items.length;re++)ee.items[re]=toNum(ee.items[re]);return ee.isNum=!0,ee}toString(){let ee=[];for(let re=0;re<this.items.length;re++)try{let ne=toNum(this.items[re]).toString();this.names&&this.names[re]&&(ne=this.names[re]+": "+ne),ee.push(ne)}catch{ee.push("{Cannot convert value to string}")}return"{"+ee.join(", ")+"}"}length(){return this.items.length}cloneCombine(ee,re,ne,ie){return this.fullClone().combine(ee,re,ne,ie)}combine(ee,re,ne,ie){if(ee instanceof Vector&&this.length()!==ee.length()&&!this.names&&!ee.names)throw new ModelError("Vectors must have equal length when combined.",{code:2001});if(ee instanceof Vector&&this.names&&ee.names){if(!ie&&ee.depth()>this.depth())return ee.combine(this,re,!ne);if(!this.keysMatch(ee.namesLC))if(this.items[0]instanceof Vector){for(let oe=0;oe<this.items.length;oe++)this.items[oe].combine(ee,re,ne,!0);return this}else throw new ModelError("Keys do not match for vector operation.",{code:2e3})}for(let oe=0;oe<this.length();oe++){let fe;if(ee instanceof Vector)if(this.names&&ee.names){let ue=ee.namesLC.indexOf(this.namesLC[oe]);if(this.names.length===1&&this.names[0]==="*"&&(ue=-2),ue===-1&&(ue=ee.names.indexOf("*")),ue===-1)throw new ModelError("Mismatched keys for vector operation.",{code:2002});ue===-2?fe=void 0:fe=ee.items[ue]}else fe=ee.items[oe];else fe=ee;fe!==void 0&&(ne?this.items[oe]=re(fe,this.items[oe]):this.items[oe]=re(this.items[oe],fe))}if(this.names&&this.names.includes("*")&&ee instanceof Vector&&ee.names){let oe=this.items[this.names.indexOf("*")];for(let fe=0;fe<ee.names.length;fe++)ee.names[fe]&&!this.namesLC.includes(ee.namesLC[fe])&&(ne?this.items.push(re(ee.items[fe],oe)):this.items.push(re(oe,ee.items[fe])),this.names.push(ee.names[fe]),this.namesLC.push(ee.namesLC[fe]))}return this}collapseDimensions(ee){if(ee instanceof Vector){if(this.depth()===ee.depth())return this;{let re=[],ne=this,ie=ee;for(let oe=0;oe<this.depth();oe++)ie instanceof Vector?ne.namesLC===void 0&&ie.namesLC===void 0||ne.namesLC!==void 0&&ie.namesLC!==void 0&&keysMatch(ne.namesLC,ie.namesLC)?(re.push("*"),ne=ne.items[0],ie=ie.items[0]):(re.push(fe=>this.simulate.varBank.sum(fe[0].items)),ne=ne.items[0]):(re.push(fe=>this.simulate.varBank.sum(fe[0].items)),ne=ne.items[0]);if(ie.items)throw new ModelError("Keys do not match for vector collapsing.",{code:2003});return selectFromMatrix(this,this.simulate,re)}}else return this.simulate.varBank.sum([this.simulate.varBank.flatten([this])])}depth(){if(!this.items.length)return 1;let ee=this.items[0];return ee instanceof Vector?ee.depth()+1:1}keysMatch(ee){return this.names?keysMatch(this.namesLC,ee):!1}cloneApply(ee){return this.fullClone().apply(ee)}apply(ee){for(let re=0;re<this.items.length;re++)this.items[re]=ee(this.items[re],this.names?this.names[re]:void 0);return this}stackApply(ee){return this.depth()===1?ee(this):this.stack().recurseApply(ee)}stack(ee){let re=[];ee=ee||[0];let ne=this.select(ee);for(let ie=1;ie<this.items.length;ie++){ee[0]=ie;let oe=this.select(ee);if(ne instanceof Vector&&oe instanceof Vector){if(ne.names&&!oe.names||oe.names&&!ne.names)throw new ModelError("Mismatched keys for vector collapsing.",{code:2004});if(ne.items.length!==oe.items.length)throw new ModelError("Vectors of unequal size.",{code:2005})}else if(!(ne instanceof Vector||oe instanceof Vector))throw new ModelError("Mismatched keys for vector collapsing.",{code:2006})}ee[0]=0,ee.push(0);for(let ie=0;ie<ne.items.length;ie++)if(ee[ee.length-1]=ne.names?ne.namesLC[ie]:ie,ne.items[ie]instanceof Vector)re.push(this.stack(ee.slice()));else{let oe=[];for(let ue=0;ue<this.items.length;ue++){let ae=ee.slice();ae[0]=ue;let se=this.select(ae);if(se instanceof Vector)throw new ModelError("Number where vector expected in vector collapsing.",{code:2007});oe.push(se)}let fe=new Vector(oe,this.simulate);fe.terminateApply=!0,re.push(fe)}return new Vector(re,this.simulate,ne.names?ne.names.slice():void 0)}select(ee){let re=this;for(let ne=0;ne<ee.length;ne++){if(!(re instanceof Vector))throw new ModelError("Number where vector expected in vector collapsing.",{code:2008});if(ee[ne]instanceof String||typeof ee[ne]=="string"){let ie=re.namesLC.indexOf(ee[ne].valueOf());if(ie===-1)throw new ModelError("Mismatched keys for vector collapsing.",{code:2009});re=re.items[ie]}else re=re.items[ee[ne]]}return re}recurseApply(ee){for(let re=0;re<this.items.length;re++){let ne=this.items[re];ne instanceof Vector&&!ne.terminateApply?this.items[re]=ne.recurseApply(ee):this.items[re]=ee(this.items[re])}return this}fullNames(){let ee=this.items[0];if(ee instanceof Vector&&ee.names){let re=ee.fullNames(),ne=[];for(let ie=0;ie<this.names.length;ie++)for(let oe=0;oe<re.length;oe++)ne.push([this.names[ie]].concat(re[oe]));return ne}else return this.names.map(re=>[re])}clone(){let ee=[];for(let re of this.items)re instanceof Vector?ee.push(re.clone()):ee.push(re);return new Vector(ee,this.simulate,this.names?this.names.slice():void 0,this.parent)}fullClone(){let ee=[];for(let re of this.items)re instanceof Vector||re instanceof Material?ee.push(re.fullClone()):ee.push(re);return new Vector(ee,this.simulate,this.names?this.names.slice():void 0,this.parent)}equals(ee){if(this.length()!==ee.length())return!1;for(let re=0;re<this.items.length;re++)if(!strictEquals(this.items[re],ee.items[re]))return!1;return!0}}let DP=20,RM=1,MAX_DP=1e6,MAX_POWER=1e6,NE=-7,PE=21,STRICT=!1,NAME="[big.js] ",INVALID=NAME+"Invalid ",INVALID_DP=INVALID+"decimal places",INVALID_RM=INVALID+"rounding mode",DIV_BY_ZERO=NAME+"Division by zero",P={},UNDEFINED,NUMERIC=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function _Big_(){function te(ee){let re=this;if(!(re instanceof te))return ee===UNDEFINED?_Big_():new te(ee);if(ee instanceof te)re.s=ee.s,re.e=ee.e,re.c=ee.c.slice();else{if(typeof ee!="string"){if(te.strict===!0)throw TypeError(INVALID+"number");ee=ee===0&&1/ee<0?"-0":String(ee)}parse(re,ee)}re.constructor=te}return te.prototype=P,te.DP=DP,te.RM=RM,te.NE=NE,te.PE=PE,te.strict=STRICT,te.roundDown=0,te.roundHalfUp=1,te.roundHalfEven=2,te.roundUp=3,te}function parse(te,ee){let re,ne,ie;if(!NUMERIC.test(ee))throw Error(INVALID+"number");for(te.s=ee.charAt(0)=="-"?(ee=ee.slice(1),-1):1,(re=ee.indexOf("."))>-1&&(ee=ee.replace(".","")),(ne=ee.search(/e/i))>0?(re<0&&(re=ne),re+=+ee.slice(ne+1),ee=ee.substring(0,ne)):re<0&&(re=ee.length),ie=ee.length,ne=0;ne<ie&&ee.charAt(ne)=="0";)++ne;if(ne==ie)te.c=[te.e=0];else{for(;ie>0&&ee.charAt(--ie)=="0";);for(te.e=re-ne-1,te.c=[],re=0;ne<=ie;)te.c[re++]=+ee.charAt(ne++)}return te}function round(te,ee,re,ne){let ie=te.c;if(re===UNDEFINED&&(re=te.constructor.RM),re!==0&&re!==1&&re!==2&&re!==3)throw Error(INVALID_RM);if(ee<1)ne=re===3&&(ne||!!ie[0])||ee===0&&(re===1&&ie[0]>=5||re===2&&(ie[0]>5||ie[0]===5&&(ne||ie[1]!==UNDEFINED))),ie.length=1,ne?(te.e=te.e-ee+1,ie[0]=1):ie[0]=te.e=0;else if(ee<ie.length){if(ne=re===1&&ie[ee]>=5||re===2&&(ie[ee]>5||ie[ee]===5&&(ne||ie[ee+1]!==UNDEFINED||ie[ee-1]&1))||re===3&&(ne||!!ie[0]),ie.length=ee--,ne)for(;++ie[ee]>9;)ie[ee]=0,ee--||(++te.e,ie.unshift(1));for(ee=ie.length;!ie[--ee];)ie.pop()}return te}function stringify(te,ee,re){let ne=te.e,ie=te.c.join(""),oe=ie.length;if(ee)ie=ie.charAt(0)+(oe>1?"."+ie.slice(1):"")+(ne<0?"e":"e+")+ne;else if(ne<0){for(;++ne;)ie="0"+ie;ie="0."+ie}else if(ne>0)if(++ne>oe)for(ne-=oe;ne--;)ie+="0";else ne<oe&&(ie=ie.slice(0,ne)+"."+ie.slice(ne));else oe>1&&(ie=ie.charAt(0)+"."+ie.slice(1));return te.s<0&&re?"-"+ie:ie}P.abs=function(){let te=new this.constructor(this);return te.s=1,te};P.cmp=function(te){let ee,re=this,ne=re.c,ie=(te=new re.constructor(te)).c,oe=re.s,fe=te.s,ue=re.e,ae=te.e;if(!ne[0]||!ie[0])return ne[0]?oe:ie[0]?-fe:0;if(oe!=fe)return oe;if(ee=oe<0,ue!=ae)return ue>ae^ee?1:-1;for(fe=(ue=ne.length)<(ae=ie.length)?ue:ae,oe=-1;++oe<fe;)if(ne[oe]!=ie[oe])return ne[oe]>ie[oe]^ee?1:-1;return ue==ae?0:ue>ae^ee?1:-1};P.div=function(te){let ee=this,re=ee.constructor,ne=ee.c,ie=(te=new re(te)).c,oe=ee.s==te.s?1:-1,fe=re.DP;if(fe!==~~fe||fe<0||fe>MAX_DP)throw Error(INVALID_DP);if(!ie[0])throw Error(DIV_BY_ZERO);if(!ne[0])return te.s=oe,te.c=[te.e=0],te;let ue,ae,se,ce,le,pe=ie.slice(),de=ue=ie.length,me=ne.length,ve=ne.slice(0,ue),we=ve.length,ge=te,_e=ge.c=[],Te=0,Ne=fe+(ge.e=ee.e-te.e)+1;for(ge.s=oe,oe=Ne<0?0:Ne,pe.unshift(0);we++<ue;)ve.push(0);do{for(se=0;se<10;se++){if(ue!=(we=ve.length))ce=ue>we?1:-1;else for(le=-1,ce=0;++le<ue;)if(ie[le]!=ve[le]){ce=ie[le]>ve[le]?1:-1;break}if(ce<0){for(ae=we==ue?ie:pe;we;){if(ve[--we]<ae[we]){for(le=we;le&&!ve[--le];)ve[le]=9;--ve[le],ve[we]+=10}ve[we]-=ae[we]}for(;!ve[0];)ve.shift()}else break}_e[Te++]=ce?se:++se,ve[0]&&ce?ve[we]=ne[de]||0:ve=[ne[de]]}while((de++<me||ve[0]!==UNDEFINED)&&oe--);return!_e[0]&&Te!=1&&(_e.shift(),ge.e--,Ne--),Te>Ne&&round(ge,Ne,re.RM,ve[0]!==UNDEFINED),ge};P.eq=function(te){return this.cmp(te)===0};P.gt=function(te){return this.cmp(te)>0};P.gte=function(te){return this.cmp(te)>-1};P.lt=function(te){return this.cmp(te)<0};P.lte=function(te){return this.cmp(te)<1};P.minus=P.sub=function(te){let ee,re,ne,ie,oe=this,fe=oe.constructor,ue=oe.s,ae=(te=new fe(te)).s;if(ue!=ae)return te.s=-ae,oe.plus(te);let se=oe.c.slice(),ce=oe.e,le=te.c,pe=te.e;if(!se[0]||!le[0])return le[0]?te.s=-ae:se[0]?te=new fe(oe):te.s=1,te;if(ue=ce-pe){for((ie=ue<0)?(ue=-ue,ne=se):(pe=ce,ne=le),ne.reverse(),ae=ue;ae--;)ne.push(0);ne.reverse()}else for(re=((ie=se.length<le.length)?se:le).length,ue=ae=0;ae<re;ae++)if(se[ae]!=le[ae]){ie=se[ae]<le[ae];break}if(ie&&(ne=se,se=le,le=ne,te.s=-te.s),(ae=(re=le.length)-(ee=se.length))>0)for(;ae--;)se[ee++]=0;for(ae=ee;re>ue;){if(se[--re]<le[re]){for(ee=re;ee&&!se[--ee];)se[ee]=9;--se[ee],se[re]+=10}se[re]-=le[re]}for(;se[--ae]===0;)se.pop();for(;se[0]===0;)se.shift(),--pe;return se[0]||(te.s=1,se=[pe=0]),te.c=se,te.e=pe,te};P.mod=function(te){let ee,re=this,ne=re.constructor,ie=re.s,oe=(te=new ne(te)).s;if(!te.c[0])throw Error(DIV_BY_ZERO);return re.s=te.s=1,ee=te.cmp(re)==1,re.s=ie,te.s=oe,ee?new ne(re):(ie=ne.DP,oe=ne.RM,ne.DP=ne.RM=0,re=re.div(te),ne.DP=ie,ne.RM=oe,this.minus(re.times(te)))};P.plus=P.add=function(te){let ee,re,ne,ie=this,oe=ie.constructor;if(te=new oe(te),ie.s!=te.s)return te.s=-te.s,ie.minus(te);let fe=ie.e,ue=ie.c,ae=te.e,se=te.c;if(!ue[0]||!se[0])return se[0]||(ue[0]?te=new oe(ie):te.s=ie.s),te;if(ue=ue.slice(),ee=fe-ae){for(ee>0?(ae=fe,ne=se):(ee=-ee,ne=ue),ne.reverse();ee--;)ne.push(0);ne.reverse()}for(ue.length-se.length<0&&(ne=se,se=ue,ue=ne),ee=se.length,re=0;ee;ue[ee]%=10)re=(ue[--ee]=ue[ee]+se[ee]+re)/10|0;for(re&&(ue.unshift(re),++ae),ee=ue.length;ue[--ee]===0;)ue.pop();return te.c=ue,te.e=ae,te};P.pow=function(te){let ee=this,re=new ee.constructor("1"),ne=re,ie=te<0;if(te!==~~te||te<-MAX_POWER||te>MAX_POWER)throw Error(INVALID+"exponent");for(ie&&(te=-te);te&1&&(ne=ne.times(ee)),te>>=1,!!te;)ee=ee.times(ee);return ie?re.div(ne):ne};P.prec=function(te,ee){if(te!==~~te||te<1||te>MAX_DP)throw Error(INVALID+"precision");return round(new this.constructor(this),te,ee)};P.round=function(te,ee){if(te===UNDEFINED)te=0;else if(te!==~~te||te<-MAX_DP||te>MAX_DP)throw Error(INVALID_DP);return round(new this.constructor(this),te+this.e+1,ee)};P.sqrt=function(){let te,ee,re,ne=this,ie=ne.constructor,oe=ne.s,fe=ne.e,ue=new ie("0.5");if(!ne.c[0])return new ie(ne);if(oe<0)throw Error(NAME+"No square root");oe=Math.sqrt(ne+""),oe===0||oe===1/0?(ee=ne.c.join(""),ee.length+fe&1||(ee+="0"),oe=Math.sqrt(ee),fe=((fe+1)/2|0)-(fe<0||fe&1),te=new ie((oe==1/0?"5e":(oe=oe.toExponential()).slice(0,oe.indexOf("e")+1))+fe)):te=new ie(oe+""),fe=te.e+(ie.DP+=4);do re=te,te=ue.times(re.plus(ne.div(re)));while(re.c.slice(0,fe).join("")!==te.c.slice(0,fe).join(""));return round(te,(ie.DP-=4)+te.e+1,ie.RM)};P.times=P.mul=function(te){let ee,re=this,ne=re.constructor,ie=re.c,oe=(te=new ne(te)).c,fe=ie.length,ue=oe.length,ae=re.e,se=te.e;if(te.s=re.s==te.s?1:-1,!ie[0]||!oe[0])return te.c=[te.e=0],te;for(te.e=ae+se,fe<ue&&(ee=ie,ie=oe,oe=ee,se=fe,fe=ue,ue=se),ee=new Array(se=fe+ue);se--;)ee[se]=0;for(ae=ue;ae--;){for(ue=0,se=fe+ae;se>ae;)ue=ee[se]+oe[ae]*ie[se-ae-1]+ue,ee[se--]=ue%10,ue=ue/10|0;ee[se]=ue}for(ue?++te.e:ee.shift(),ae=ee.length;!ee[--ae];)ee.pop();return te.c=ee,te};P.toExponential=function(te,ee){let re=this,ne=re.c[0];if(te!==UNDEFINED){if(te!==~~te||te<0||te>MAX_DP)throw Error(INVALID_DP);for(re=round(new re.constructor(re),++te,ee);re.c.length<te;)re.c.push(0)}return stringify(re,!0,!!ne)};P.toFixed=function(te,ee){let re=this,ne=re.c[0];if(te!==UNDEFINED){if(te!==~~te||te<0||te>MAX_DP)throw Error(INVALID_DP);for(re=round(new re.constructor(re),te+re.e+1,ee),te=te+re.e+1;re.c.length<te;)re.c.push(0)}return stringify(re,!1,!!ne)};P.toJSON=P.toString=function(){let te=this,ee=te.constructor;return stringify(te,te.e<=ee.NE||te.e>=ee.PE,!!te.c[0])};P.toNumber=function(){let te=Number(stringify(this,!0,!0));if(this.constructor.strict===!0&&!this.eq(te.toString()))throw Error(NAME+"Imprecise conversion");return te};P.toPrecision=function(te,ee){let re=this,ne=re.constructor,ie=re.c[0];if(te!==UNDEFINED){if(te!==~~te||te<1||te>MAX_DP)throw Error(INVALID+"precision");for(re=round(new ne(re),te,ee);re.c.length<te;)re.c.push(0)}return stringify(re,te<=re.e||re.e<=ne.NE||re.e>=ne.PE,!!ie)};P.valueOf=function(){let te=this,ee=te.constructor;if(ee.strict===!0)throw Error(NAME+"valueOf disallowed");return stringify(te,te.e<=ee.NE||te.e>=ee.PE,!0)};var Big=_Big_();class SPrimitive{constructor(ee){this.id=null,this.agentId=null,this.index=null,this.instanceId=null,this.container=null,this.constructorFunction=null,this.dna=null,this.DNAs=null,this.equation=null,this.cachedValue=void 0,this.pastValues=[],this.pastData=new DataBank,this.frozen=!1,this.simulate=ee,this.neighborProxyPrimitive=null,this.parent=ee.varBank.primitivebase}orig(){return this.neighborProxyPrimitive||this}clone(){let ee=new this.constructorFunction(this.simulate);return ee.dna=this.dna,ee.container=this.container,ee.agentId=this.agentId,ee.index=this.index,ee.id=this.id,ee.createIds(),ee.pastValues=this.pastValues.slice(),ee.neighborProxyPrimitive=this.neighborProxyPrimitive,this.dna.slider&&(this.simulate.sliders[this.dna.id]?this.simulate.sliders[this.dna.id].push(ee):this.simulate.sliders[this.dna.id]=[ee]),ee.cachedValue=this.cachedValue?this.cachedValue.fullClone():this.cachedValue,this.innerClone(ee),ee}innerClone(ee){}clearCached(){this.cachedValue=void 0}storeValue(){this.cachedValue===void 0&&this.value(),this.pastValues.push(this.cachedValue)}toNum(){let ee=this.value();return typeof ee=="string"?stringify$1(ee,this.simulate):ee}calculateValue(){throw new ModelError(`<i>[${toHTML(this.dna.name)}]</i> does not have a value and can not be used as a value in an equation.`,{code:1080})}createIds(){this.instanceId=this.simulate.getID(this.agentId+"-"+this.index)}getPastValues(ee){let re=this.pastValues.slice(),ne=Math.ceil(div(this.simulate.time(),this.dna.solver.userTimeStep).value)+1;re.length<ne&&re.push(this.value());let ie;if(ee===void 0)ie=re.map(oe=>oe.fullClone());else{let oe=Math.ceil(div(ee.forceUnits(this.simulate.timeUnits),this.dna.solver.userTimeStep).value);ie=[];for(let fe=Math.max(0,re.length-1-oe);fe<re.length;fe++)ie.push(re[fe].fullClone())}return ie}pastValue(ee,re=null){let ne;if(this.pastValues.length-1<Math.round((this.simulate.time().value-this.simulate.timeStart.value)/this.dna.solver.userTimeStep.value)?ne=div(ee.forceUnits(this.simulate.timeUnits),this.dna.solver.userTimeStep).value:ne=div(ee.forceUnits(this.simulate.timeUnits),this.dna.solver.userTimeStep).value+1,ne===0)return this.value();if(Math.ceil(ne)>this.pastValues.length)return re===null?this.pastValues.length>0?this.pastValues[0].fullClone():this.value():re;if(ne===Math.round(ne))return this.pastValues[this.pastValues.length-ne].fullClone();let ie=ne-Math.floor(ne),oe=Math.floor(ne),fe,ue;return oe===0?fe=this.value():fe=this.pastValues[this.pastValues.length-oe],ue=this.pastValues[this.pastValues.length-1-oe],plus(mult(fe,new Material(1-ie)),mult(ue,new Material(ie)))}testUnits(ee,re){if(ee instanceof Vector){ee.recurseApply(ne=>(this.testUnits(ne,re),ne));return}if(this.dna.adoptUnits&&(ee.units||(ee.units=this.simulate.unitManager.getUnitStore([],[],!1,!0)),this.dna.units=ee.units,this.dna.flowUnitless=!1),!this.dna.units&&ee.units&&!ee.units.isUnitless())throw new ModelError(`Wrong units generated for <i>[${toHTML(this.dna.name)}]</i>. Expected no units and got <i>${ee.units.toString()}</i>. Either specify units for the primitive or adjust the equation.`,{primitive:this.orig(),showEditor:!0,code:1081});if(this.dna.units!==ee.units){if(typeof ee=="boolean"||typeof ee=="string"||ee instanceof String||ee instanceof Boolean){if(!this.dna.units)return;throw new ModelError(`Cannot add units to a String or Boolean in <i>[${toHTML(this.dna.name)}]</i>.`,{primitive:this.orig(),showEditor:!0,code:1082})}let ne=convertUnits(ee.units,this.dna.units,!0);if(ne===0)throw new ModelError(`Wrong units generated for <i>[${toHTML(this.dna.name)}]</i>. Expected <i>${this.dna.units?this.dna.units.toString():"unitless"}</i>, and got <i>${ee.units?ee.units.toString():"unitless"}</i>.`,{primitive:this.orig(),showEditor:!0,code:1083});ee.value=ee.value*ne,ee.units=this.dna.units}if(this instanceof SFlow&&re!==!0&&this.dna.flowUnitless){let ne=mult(ee,new Material(1,this.simulate.timeUnits));ee.value=ne.value,ee.units=ne.units}}setValue(ee){throw new ModelError("You cannot set the value for that primitive.",{code:1084})}value(){if(this.cachedValue===void 0&&this.frozen&&this.pastValues.length>0){let ee=this.pastValues[this.pastValues.length-1];ee.fullClone?this.cachedValue=ee.fullClone():this.cachedValue=ee}if(this.cachedValue===void 0){if(this.simulate.valuedPrimitives.includes(this))throw new ModelError(`Circular equation loop identified including the primitives: ${toHTML(this.simulate.valuedPrimitives.slice(this.simulate.valuedPrimitives.indexOf(this)).map(re=>re.dna.name).join(", "))}`,{primitive:this.orig(),showEditor:!0,code:1085});this.simulate.valuedPrimitives.push(this);let ee;try{if(ee=toNum(this.calculateValue()),ee instanceof Material&&!isFinite(ee.value))throw this instanceof SStock?new ModelError("The stock has become infinite in size. Check the flows into it for rapid growth.",{primitive:this.orig(),showEditor:!0,code:1086}):new ModelError("The result of this calculation is not finite (are you dividing by 0?).",{primitive:this.orig(),showEditor:!0,code:1087})}catch(re){throw re instanceof ModelError?re.primitive&&re.showEditor?re:new ModelError(re.message,{primitive:this.orig(),showEditor:!0,code:1088}):re}this instanceof SState||(this.testUnits(ee),this.testConstraints(ee)),this.cachedValue=ee}return this.cachedValue.fullClone?this.cachedValue.fullClone():this.cachedValue}testConstraints(ee){let re=ne=>(this.dna.useMaxConstraint&&ne.value>this.dna.maxConstraint&&constraintAlert(this,"max",ne,this.simulate),this.dna.useMinConstraint&&ne.value<this.dna.minConstraint&&constraintAlert(this,"min",ne,this.simulate),ne);ee instanceof Vector?ee.recurseApply(re):re(ee)}setEquation(ee,re){(this instanceof SFlow||this instanceof STransition)&&(this.omega!==null&&(re.omega=this.omega),this.alpha!==null&&(re.alpha=this.alpha));try{this.equation=trimTree(ee,re,this.simulate)}catch(ne){throw ne instanceof ModelError?ne.primitive&&ne.showEditor?ne:new ModelError(ne.message,{primitive:this.orig(),showEditor:!0,code:1089}):ne}}}class Placeholder extends SPrimitive{constructor(ee,re,ne){super(ne),this.dna=ee,this.id=ee.id,this.primitive=re}calculateValue(){throw new ModelError(`<i>[${toHTML(this.dna.name)}]</i> is a placeholder and cannot be used as a direct value in equations.`,{primitive:this.primitive.dna.primitive,showEditor:!0,code:1091})}}class SState extends SPrimitive{constructor(ee){super(ee),this.active=null,this.downStreamTransitions=[],this.constructorFunction=SState}innerClone(ee){ee.setValue(this.active)}setValue(ee){this.setActive(trueValue(ee)),this.cachedValue=void 0,this.simulate.valuedPrimitives=[],this.value(),this.agentId&&this.container.updateStates()}calculateValue(){return this.active===null&&this.setInitialActive(!0),this.active?new Material(1):new Material(0)}setInitialActive(ee){let re;try{re=toNum(evaluateTree(this.equation,globalVars(this,this.simulate),this.simulate))}catch(ne){throw ne instanceof ModelError?ne.primitive&&ne.showEditor?ne:new ModelError(ne.message,{primitive:this.orig(),showEditor:!0,code:1092}):ne}this.setActive(trueValue(re),ee),this.agentId&&this.container.updateStates()}setActive(ee,re){if(this.active=ee,!ee||this.dna.residency===null){if(!re){if(ee){if(this.simulate.transitionPrimitives||(this.simulate.transitionPrimitives=[]),this.simulate.transitionPrimitives.length>1200&&this.simulate.transitionPrimitives.includes(this))throw new ModelError(`Circular fully active transition loop identified including the states: ${toHTML(this.simulate.transitionPrimitives.slice(0,5).map(ne=>"["+ne.dna.name+"]").join(", "))}`,{code:1105});this.simulate.transitionPrimitives.push(this)}for(let ne of this.downStreamTransitions)scheduleTrigger.call(ne);ee&&(this.simulate.transitionPrimitives=[])}}else this.simulate.tasks.add(new Task({name:"State Residency",time:plus(this.simulate.time(),this.dna.residency),priority:5,expires:1,action:ne=>{for(let ie of this.downStreamTransitions)scheduleTrigger.call(ie)}}))}getActive(){return this.active===null&&this.setInitialActive(!0),this.active}}class STransition extends SPrimitive{constructor(ee){super(ee),this.alpha=null,this.omega=null,this.scheduledTrigger=null,this.initialized=!1,this.constructorFunction=STransition}innerClone(){}setEnds(ee,re){this.alpha=ee,this.omega=re,ee&&ee.downStreamTransitions.push(this)}canTrigger(){return!this.alpha||this.alpha&&this.alpha.getActive()||this.dna.repeat&&this.dna.trigger!=="Condition"}trigger(){this.scheduledTrigger=null,!this.frozen&&(this.alpha&&this.alpha.setActive(!1),this.omega&&this.omega.setActive(!0),this.agentId&&this.container.updateStates(),this.dna.repeat&&this.dna.trigger!=="Condition"&&scheduleTrigger.call(this))}}function scheduleTrigger(){updateTrigger.call(this,!0)}function clearTrigger(te){this.scheduledTrigger&&(te||!this.dna.repeat)&&(this.scheduledTrigger.kill(),this.scheduledTrigger=null)}function updateTrigger(te){if(this.initialized=!0,te&&clearTrigger.call(this),this.canTrigger()){let ee;try{ee=toNum(evaluateTree(this.equation,globalVars(this,this.simulate),this.simulate))}catch(re){throw re instanceof ModelError?re.primitive&&re.showEditor?re:new ModelError(re.message,{primitive:this.orig(),showEditor:!1,code:1090}):re}try{if(this.dna.trigger==="Condition")trueValue(ee)&&this.trigger();else{if(!(ee instanceof Material))throw new ModelError(`The value of this trigger must evaluate to a number. Got <i>${toHTML(""+ee)}</i>.`,{primitive:this.orig(),showEditor:!0,code:1112});let re;if(this.dna.trigger==="Timeout"){if(!ee.units)verifyValuedType(ee,this),ee.units=this.simulate.timeUnits;else{ee.units.addBase();let ie=ee.units.baseUnits;if(ie.names.length!==1||ie.names[0]!=="seconds"||ie.exponents[0]!==1)throw new ModelError(`A trigger Timeout must have units of time, got <i>${ee.units.toString()}</i>.`,{primitive:this.orig(),showEditor:!0,code:1113})}if(this.scheduledTrigger&&eq(ee,this.scheduledTrigger.data.value))return;if(ee.value===0){if(this.dna.repeat)throw new ModelError("A trigger Timeout of 0 with 'Repeat' set to true results in an infinite loop.",{primitive:this.orig(),showEditor:!0,code:1114});this.trigger();return}if(ee.value<0)throw new ModelError("The timeout for a transition cannot be less than 0.",{primitive:this.orig(),showEditor:!0,code:1115});if(isNaN(ee.value))throw new ModelError("The timeout for the transition is not a valid number.",{primitive:this.orig(),showEditor:!0,code:1116});re=ee}else if(this.dna.trigger==="Probability"){if(ee.units&&!ee.units.isUnitless())throw new ModelError(`The probability for the trigger had units of <i>${ee.units.toString()}</i>. Probabilities must be unitless.`,{primitive:this.orig(),showEditor:!0,code:1121});if(isNaN(ee.value))throw new ModelError("The probability for the transition is not a valid number.",{primitive:this.orig(),showEditor:!0,code:1117});if(ee=ee.value,this.scheduledTrigger&&eq(ee,this.scheduledTrigger.data.value))return;if(ee===1){if(this.dna.repeat)throw new ModelError("A trigger probability of 1 with 'Repeat' as true results in an infinite loop.",{primitive:this.orig(),showEditor:!0,code:1118});this.trigger();return}else{if(ee>1)throw new ModelError("The probability for the trigger must be less than or equal to 1.",{primitive:this.orig(),showEditor:!0,code:1119});if(ee<0)throw new ModelError("The probability for the trigger must be greater than or equal to 0.",{primitive:this.orig(),showEditor:!0,code:1120});if(ee===0){if(!this.scheduledTrigger)return}else{let ie=-Math.log(1-ee);re=new Material(RandExp(this.simulate,ie),this.simulate.timeUnits)}}}let ne=this.simulate.time();if(this.scheduledTrigger){if(this.scheduledTrigger.kill(),this.dna.trigger==="Timeout")if(lessThanEq(re,minus(this.simulate.time(),this.scheduledTrigger.data.start))){this.scheduledTrigger=null,this.trigger();return}else ne=this.scheduledTrigger.data.start,re=minus(re,minus(this.simulate.time(),ne)),this.scheduledTrigger=null;else if(this.dna.trigger==="Probability"){if(ee===0){this.scheduledTrigger=null;return}re=minus(this.scheduledTrigger.time,this.simulate.time());let ie=this.scheduledTrigger.data.value;if(ie!==ee){let oe=-Math.log(1-ie),fe=-Math.log(1-ee);re=mult(re,new Material(oe/fe))}ne=this.scheduledTrigger.data.start,this.scheduledTrigger=null}}re=plus(re,this.simulate.time()),this.scheduledTrigger=new Task({name:"Trigger",time:re,priority:5,expires:1,action:ie=>{this.trigger()},data:{start:ne,value:ee}}),this.simulate.tasks.add(this.scheduledTrigger)}}catch(re){throw re instanceof ModelError?re.primitive&&re.showEditor?re:new ModelError(re.message,{primitive:this.orig(),showEditor:!0,code:1094}):re}}}class SAction extends SPrimitive{constructor(ee){super(ee),this.action=null,this.scheduledTrigger=null,this.block=!1,this.initialized=!1,this.constructorFunction=SAction}innerClone(){}canTrigger(){return!this.block}resetTimer(){scheduleTrigger.call(this)}trigger(){if(this.scheduledTrigger=null,!this.frozen)try{evaluateTree(this.action,globalVars(this,this.simulate),this.simulate),this.dna.repeat?this.dna.trigger!=="Condition"&&scheduleTrigger.call(this):this.block=!0}catch(ee){throw ee instanceof ModelError?ee.primitive&&ee.showEditor?ee:new ModelError(ee.message,{primitive:this.orig(),showEditor:!0,code:1096}):ee}}}class SPopulation extends SPrimitive{constructor(ee){super(ee),this.size=null,this.agents=null,this.geoWidth=null,this.geoHeight=null,this.halfWidth=null,this.halfHeight=null,this.geoDimUnits=null,this.geoDimUnitsObject=null,this.geoWrap=null,this.DNAs=null,this.stateIds=new Set,this.placement=void 0,this.placementFunction=void 0,this.network=void 0,this.networkFunction=void 0,this.agentBase=void 0,this.constructorFunction=SPopulation,this.vector=new Vector([],ee,[],ee.varBank.primitivebase)}collectData(){let ee=[];for(let re of this.agents)ee.push({instanceId:re.instanceId,connected:re.connected.map(ne=>ne.instanceId),location:simpleNum(re.location.clone(),this.geoDimUnitsObject,this.simulate),state:re.states.length>0?re.states.slice():null});return ee}states(){return this.stateIds}toNum(){throw new ModelError(`<i>[${toHTML(this.dna.name)}]</i> is a population of agents and cannot be used as a direct value in equations.`,{code:1107})}add(ee){this.size=1+this.size;let re;if(ee){re=ee.agentClone(),re.agentId=this.agentId,re.setIndex(this.size-1),re.createAgentIds();for(let ne=0;ne<this.DNAs.length;ne++){let ie=re.children[ne],oe=this.DNAs[ne];ie.container=re,linkPrimitive(ie,oe,this.simulate)}re.updateStates()}else{re=new SAgent(this.simulate),re.container=this,re.children=[],re.childrenId={},re.agentId=this.agentId;for(let ie of this.DNAs)decodeDNA(ie,re,this.simulate);re.setIndex(this.size-1),re.createAgentIds();for(let ie=0;ie<this.DNAs.length;ie++)linkPrimitive(re.children[ie],this.DNAs[ie],this.simulate);setAgentInitialValues(re);let ne=getPrimitiveNeighborhood(this,this.dna,this.simulate,[]);if(this.placement==="Custom Function"?(ne.self=re,re.location=simpleUnitsTest(simpleEquation(this.placementFunction,this.simulate,{"-parent":this.simulate.varBank,self:re},ne),this.geoDimUnitsObject,this.simulate,null,null,"Agent placement functions must return a two element vector"),validateAgentLocation(re.location,this),re.location.names||(re.location.names=["x","y"],re.location.namesLC=["x","y"])):re.location=new Vector([mult(this.geoWidth,new Material(Rand(this.simulate))),mult(this.geoHeight,new Material(Rand(this.simulate)))],this.simulate,["x","y"]),this.network==="Custom Function"){let ie=trimTree(createTree(this.networkFunction),ne,this.simulate);for(let oe of this.agents)re!==oe&&trueValue(simpleEquation(this.networkFunction,this.simulate,{"-parent":this.simulate.varBank,a:re,b:oe},ne,ie))&&re.connect(oe)}}return this.simulate.tasks.add(new Task({priority:10,expires:1,name:"Add Agent",time:this.simulate.time(),action:ne=>{this.agents.push(re);for(let ie=0;ie<re.children.length;ie++){let oe=re.children[ie],fe=this.DNAs[ie];(oe instanceof SAction||oe instanceof STransition)&&fe.trigger!=="Condition"&&scheduleTrigger.call(oe),ee&&(oe instanceof SAction?fe.solver.actions.push(oe):oe instanceof STransition?fe.solver.transitions.push(oe):oe instanceof SPopulation||(fe.solver.valued.push(oe),oe instanceof SFlow?fe.solver.flows.push(oe):oe instanceof SStock?fe.solver.stocks.push(oe):oe instanceof SState&&fe.solver.states.push(oe)))}}})),re}}class SAgent{constructor(ee){this.agentId=null,this.instanceId=null,this.index=null,this.children=null,this.location=null,this.connected=[],this.connectedWeights=[],this.dead=!1,this.constructorFunction=SAgent,this.stateIDs=new Set,this.states=[],this.container=void 0,this.dna=void 0,this.childrenId=void 0,this.simulate=ee,this.vector=new Vector([],ee,[],ee.varBank.agentbase)}createIds(){this.instanceId=this.simulate.getID(this.agentId+"-"+this.index)}toString(){return"Agent "+(this.index+1)}toNum(){return this}updateStates(){this.states=[],this.stateIDs=new Set;for(let ee of this.children)ee instanceof SState&&ee.active&&(this.states.push(ee),this.stateIDs.add(ee.dna.id))}agentClone(){let ee=new SAgent(this.simulate);ee.dna=this.dna,ee.children=[],ee.childrenId={};for(let re of this.children)ee.children.push(re.clone()),ee.childrenId[re.dna.id]=re;return ee.location=this.location.clone(),ee.connected=this.connected.slice(),ee.connectedWeights=this.connectedWeights.slice(),ee.container=this.container,ee}setIndex(ee){this.index=ee;for(let re of this.children)re.index=ee}createAgentIds(){this.createIds();for(let ee of this.children)ee.createIds()}die(){for(;this.connected.length>0;)this.unconnect(this.connected[0]);for(let ee=0;ee<this.container.agents.length;ee++)if(this.container.agents[ee]===this){this.container.agents.splice(ee,1);break}for(let ee of this.children){let re=ee.dna.solver;ee instanceof SAction?(re.actions.splice(re.actions.indexOf(ee),1),clearTrigger.call(ee,!0)):ee instanceof STransition?(re.transitions.splice(re.transitions.indexOf(ee),1),clearTrigger.call(ee,!0)):ee instanceof SPopulation||(re.valued.splice(re.valued.indexOf(ee),1),ee instanceof SFlow?re.flows.splice(re.flows.indexOf(ee),1):ee instanceof SStock?re.stocks.splice(re.stocks.indexOf(ee),1):ee instanceof SState&&re.states.splice(re.states.indexOf(ee),1))}this.dead=!0}connect(ee,re){let ne=re===void 0?new Material(1):re;if(ee!==this)if(this.connected.includes(ee))re!==void 0&&(this.connectedWeights[this.connected.indexOf(ee)]=re,ee.connectedWeights[ee.connected.indexOf(ee)]=re);else if(ee instanceof SAgent)this.connected.push(ee),this.connectedWeights.push(ne),ee.connected.push(this),ee.connectedWeights.push(ne);else throw new ModelError("Only agents may be connected.",{code:1106})}unconnect(ee){if(ee!==this){let re=this.connected.indexOf(ee);re!==-1&&(this.connected.splice(re,1),this.connectedWeights.splice(re,1),re=ee.connected.indexOf(this),ee.connected.splice(re,1),ee.connectedWeights.splice(re,1))}}connectionWeight(ee){if(ee!==this){let re=this.connected.indexOf(ee);if(re!==-1)return this.connectedWeights[re].fullClone()}throw new ModelError("Agents are not connected and so do not have a connection weight.",{code:1108})}setConnectionWeight(ee,re){if(ee!==this){let ne=this.connected.indexOf(ee);if(ne!==-1){this.connectedWeights[ne]=re.fullClone();return}}throw new ModelError("Agents are not connected and so do not have a connection weight.",{code:1109})}}function verifyValuedType(te,ee){if(!(te instanceof Vector||te instanceof Material))throw new ModelError(`This value may only be numbers or vectors, found a ${typeof te}.`,{primitive:ee,showEditor:!1,code:1110})}class SStock extends SPrimitive{constructor(ee){super(ee),this.level=null,this.constructorFunction=SStock,this.delay=void 0,this.tasks=[],this.initRate=null,this.oldLevel=null}innerClone(ee){ee.level=this.level,ee.oldLevel=this.oldLevel,ee.tasks=this.tasks,ee.delay=this.delay}setValue(ee){this.level=ee,this.cachedValue=void 0,this.simulate.valuedPrimitives=[],this.value()}preserveLevel(){for(let ee=this.tasks.length-1;ee>=0;ee--)this.tasks[ee].data.tentative=!1;this.oldLevel=this.level}restoreLevel(){for(let ee=this.tasks.length-1;ee>=0;ee--)this.tasks[ee].data.tentative&&(this.tasks[ee].remove(),this.tasks.splice(ee,1));this.level=this.oldLevel}setDelay(ee){var re;ee=ee||this.dna.delay,this.delay=ee,((re=this.delay)==null?void 0:re.value)===0&&(this.delay=void 0)}setInitialValue(){let ee;try{ee=toNum(evaluateTree(this.equation,globalVars(this,this.simulate),this.simulate))}catch(re){throw re instanceof ModelError?re.primitive&&re.showEditor?re:new ModelError(re.message,{primitive:this.orig(),showEditor:!0,code:1098}):re}if(typeof ee=="boolean"&&(ee?ee=new Material(1):ee=new Material(0)),ee instanceof Vector){let re=this.dna;ee.recurseApply(ne=>(verifyValuedType(ne),re.nonNegative&&ne.value<0&&(ne=new Material(0,re.units)),ne.units||(ne.units=re.units),ne))}else verifyValuedType(ee),this.dna.nonNegative&&ee.value<0&&(ee=new Material(0,this.dna.units)),ee.units||(ee.units=this.dna.units);if(this.delay===void 0||lessThanEq(this.delay,this.simulate.timeStep.fullClone()))this.level=ee;else{this.initRate=div(ee,this.delay.forceUnits(this.simulate.timeUnits));let re=mult(this.initRate,this.simulate.userTimeStep.fullClone());this.level=re,this.simulate.tasks.addEvent((ne,ie,oe)=>{if(ne.value>0){let fe=minus(this.delay,this.simulate.userTimeStep),ue=[minus(ie,this.simulate.timeStart),minus(oe,this.simulate.timeStart)];if(lessThan(fe,ue[0]))return;let ae=minus(this.simulate.varBank.min([fe,ue[1]]),ue[0]);this.level=plus(this.level,mult(ae,this.initRate))}})}}subtract(ee){if(this.level=minus(this.level,ee),this.dna.nonNegative)if(this.level instanceof Vector){let re=this.dna;this.level.recurseApply(ne=>ne.value<0?new Material(0,re.units):ne)}else this.level.value<0&&(this.level=new Material(0,this.dna.units))}add(ee,re){let ne;if(this.delay!==void 0&&(ne=new Material(Big(re.value).plus(this.delay.forceUnits(re.units).value).toNumber(),re.units)),this.delay===void 0||lessThanEq(ne,this.simulate.time())){if(this.level=plus(this.level,ee),this.dna.nonNegative)if(this.level instanceof Vector){let ie=this.dna;this.level.recurseApply(oe=>oe.value<0?new Material(0,ie.units):oe)}else this.level.value<0&&(this.level=new Material(0,this.dna.units))}else this.scheduleAdd(ee,ne)}scheduleAdd(ee,re){let ne,ie=new Task({time:re,data:{amnt:ee,tentative:!0},priority:-100,name:"Conveyor Add ("+this.dna.name+")",action:oe=>{if(ne=this.level,this.level=plus(this.level,ee),this.dna.nonNegative)if(this.level instanceof Vector){let fe=this.dna;this.level.recurseApply(ue=>ue.value<0?new Material(0,fe.units):ue)}else this.level.value<0&&(this.level=new Material(0,this.dna.units))},rollback:()=>{this.level=ne}});this.tasks.push(ie),this.simulate.tasks.add(ie)}totalContents(){if(this.level===null&&this.setInitialValue(),this.delay!==void 0){let ee=this.level,re=this.simulate.time();for(let ie=this.tasks.length-1;ie>=0&&greaterThan(this.tasks[ie].time,re);ie--)ee=plus(ee,this.tasks[ie].data.amnt);let ne=plus(this.simulate.timeProgressed(),this.simulate.userTimeStep);if(greaterThan(this.delay,ne)){let ie=minus(this.delay,ne);ee=plus(ee,mult(this.initRate,ie))}return ee}else return this.level}calculateValue(){if(this.level===null&&this.setInitialValue(),this.delay!==void 0&&this.dna.solver.RKOrder===4){let ee=this.level;for(let re=0;re<this.tasks.length;re++)greaterThan(this.tasks[re].time,this.simulate.time())&&lessThanEq(this.tasks[re].time,plus(this.simulate.time(),this.dna.solver.timeStep))&&(ee=plus(ee,this.tasks[re].data.amnt));return ee}else return this.level}}class SConverter extends SPrimitive{constructor(ee){super(ee),this.source=null,this.constructorFunction=SConverter}innerClone(){}setSource(ee){this.source=ee}getInputValue(){if(this.source==="*time")return this.simulate.time();if(this.source instanceof SPrimitive){let ee=toNum(this.source.value());if(!ee)throw new ModelError("Undefined input value.",{primitive:this.orig(),showEditor:!1,code:1199});if(ee instanceof Vector)throw new ModelError("Converters do not accept vectors as input values.",{primitive:this.orig(),showEditor:!1,code:1200});return ee}else throw console.error("Invalid source",this.source),new Error("Invalid source")}calculateValue(){return new Material(this.getOutputValue().value,this.dna.units)}getOutputValue(){let ee=this.getInputValue();if(!this.dna.inputs.length)return new Material(0);for(let re=0;re<this.dna.inputs.length;re++)if(this.dna.interpolation==="discrete"){if(greaterThan(this.dna.inputs[re],ee))return re===0?this.dna.outputs[0]:this.dna.outputs[re-1]}else if(this.dna.interpolation==="linear"){if(eq(this.dna.inputs[re],ee))return this.dna.outputs[re];if(greaterThan(this.dna.inputs[re],ee))return re===0?this.dna.outputs[0]:div(plus(mult(minus(ee,this.dna.inputs[re-1]),this.dna.outputs[re]),mult(minus(this.dna.inputs[re],ee),this.dna.outputs[re-1])),minus(this.dna.inputs[re],this.dna.inputs[re-1]))}return this.dna.outputs[this.dna.outputs.length-1]}}class SVariable extends SPrimitive{constructor(ee){super(ee),this.constructorFunction=SVariable}innerClone(){}calculateValue(){let ee=evaluateTree(this.equation,globalVars(this,this.simulate),this.simulate);if(typeof ee=="boolean")ee?ee=new Material(1):ee=new Material(0);else{if(ee instanceof Vector)return ee;if(typeof ee=="string")return ee}return ee.units||(ee.units=this.dna.units),ee}}class SFlow extends SPrimitive{constructor(ee){super(ee),this.alpha=null,this.omega=null,this.rate=null,this.blendedRate=null,this.RKPrimary=[],this.constructorFunction=SFlow}innerClone(){}setEnds(ee,re){this.alpha=ee,this.omega=re}calculateValue(){return this.predict(),this.rate.fullClone()}clean(){this.rate=null,this.blendedRate=null,this.RKPrimary=[]}doRK4Aggregation(){this.blendedRate=div(plus(plus(plus(this.RKPrimary[0],mult(new Material(2),this.RKPrimary[1])),mult(new Material(2),this.RKPrimary[2])),this.RKPrimary[3]),new Material(6)),this.blendedRate=this.checkRate(this.blendedRate)}checkRate(ee){let re=div(ee,this.dna.adoptUnits?new Material(this.dna.solver.timeStep.value):this.dna.solver.timeStep.fullClone());return this.dna.nonNegative&&(re instanceof Vector?re.recurseApply(ne=>ne.value>=0?ne:new Material(0,ne.units)):re.value<=0&&(re=new Material(0,re.units))),re}predict(ee){if(this.rate===null||ee){let re;try{if(re=toNum(evaluateTree(this.equation,globalVars(this,this.simulate),this.simulate)),!(re instanceof Vector||isFinite(re.value)))throw verifyValuedType(re,this),new ModelError("The result of this calculation is not finite. Flows must have finite values. Are you dividing by 0?",{primitive:this.orig(),showEditor:!0,code:1111})}catch(ne){throw ne instanceof ModelError?ne.primitive&&ne.showEditor?ne:new ModelError(ne.message,{primitive:this.orig(),showEditor:!0,code:1100}):ne}if(typeof re=="boolean"&&(re?re=new Material(1):re=new Material(0)),this.rate=re.fullClone(),!this.dna.adoptUnits)if(this.rate instanceof Vector){let ne=this.dna;this.rate.recurseApply(ie=>(verifyValuedType(ie,this),ie.units||(ie.units=ne.units),ie))}else this.rate.units||(verifyValuedType(this.rate,this),this.rate.units=this.dna.units);this.testUnits(this.rate,!0),this.rate=mult(this.rate,this.dna.adoptUnits?new Material(this.dna.solver.timeStep.value):this.dna.solver.timeStep.fullClone()),ee?this.RKPrimary.length>0?this.RKPrimary[this.RKPrimary.length-1]=this.rate:this.RKPrimary.push(this.rate):this.RKPrimary.push(this.rate),this.rate=this.checkRate(this.rate)}}apply(ee,re){try{if(this.rate===null&&this.blendedRate===null)return;let ne=this.blendedRate?this.blendedRate.fullClone():this.rate.fullClone();ne=mult(ne,this.dna.adoptUnits?new Material(ee.forceUnits(this.simulate.timeUnits).value):ee);let ie=ne,oe=ne,fe=!1;if(this.alpha!==null){let ae=this.alpha.level;if(ne instanceof Vector&&(!(ae instanceof Vector)||ae.depth()<ne.depth()))ie=ne.fullClone().collapseDimensions(ae),fe=!0;else if(ae instanceof Vector&&(!(ne instanceof Vector)||ae.depth()>ne.depth()))throw new ModelError("The start of the flow is a vector with a higher order than the flow rate. There has to be at least one element in the flow rate for each element in the start.",{primitive:this.orig(),showEditor:!0,code:1201})}if(this.omega!==null){let ae=this.omega.level;if(ne instanceof Vector&&(!(ae instanceof Vector)||ae.depth()<ne.depth()))oe=ne.fullClone().collapseDimensions(ae),fe=!0;else if(ae instanceof Vector&&(!(ne instanceof Vector)||ae.depth()>ne.depth()))throw new ModelError("The end of the flow is a vector with a higher order than the flow rate. There has to be at least one element in the flow rate for each element in the end.",{primitive:this.orig(),showEditor:!0,code:1202})}if(fe){if(this.alpha&&this.alpha.dna.nonNegative)throw new ModelError("Cannot use non-negative stocks when the flow rate is a vector that needs to be collapsed.",{primitive:this.alpha.dna.primitive,showEditor:!1,code:1207});if(this.omega&&this.omega.dna.nonNegative)throw new ModelError("Cannot use non-negative stocks when the flow rate is a vector that needs to be collapsed.",{primitive:this.omega.dna.primitive,showEditor:!1,code:1208})}else{if(this.omega!==null&&this.omega.dna.nonNegative){let ae;try{ae=plus(toNum(this.omega.level),ne)}catch{throw new ModelError(`Incompatible units for flow <i>[${toHTML(this.dna.name)}]</i> and connected stock <i>[${toHTML(this.omega.dna.name)}]</i>. Stock has units of <i>${this.omega.dna.units?this.omega.dna.units.toString():"unitless"}</i>. The flow should have the equivalent units divided by some time unit such as Years.`,{primitive:this.orig(),showEditor:!1,code:1203})}ae instanceof Vector?(ae.recurseApply(se=>se.value<0?se:new Material(0,se.units)),ne=minus(ne,ae)):ae.value<0&&(ne=negate(toNum(this.omega.level)))}if(this.alpha!==null&&this.alpha.dna.nonNegative){let ae;try{ae=minus(toNum(this.alpha.level),ne)}catch{throw new ModelError(`Incompatible units for flow <i>[${toHTML(this.dna.name)}]</i> and connected stock <i>[${toHTML(this.alpha.dna.name)}]</i>. Stock has units of <i>${this.alpha.dna.units?this.alpha.dna.units.toString():"unitless"}</i>. The flow should have the equivalent units divided by some time unit such as Years.`,{primitive:this.orig(),showEditor:!1,code:1204})}ae instanceof Vector?(ae.recurseApply(se=>se.value<0?se:new Material(0,se.units)),ne=minus(ne,ae),ne=minus(ne,ae)):ae.value<0&&(ne=toNum(this.alpha.level))}if(this.omega&&this.omega.dna.nonNegative)if(ne instanceof Vector){let ae=this.simulate.varBank.flatten([plus(toNum(this.omega.level),ne)]);for(let se of ae.items)if(se instanceof Material&&se.value<0)throw new ModelError("Inconsistent non-negative constraints for flow.",{primitive:this.orig(),showEditor:!1,code:1205})}else{let ae=plus(toNum(this.omega.level),ne);if(ae instanceof Material&&ae.value<0)throw new ModelError("Inconsistent non-negative constraints for flow.",{primitive:this.orig(),showEditor:!1,code:1206})}}let ue=0;try{this.omega!==null&&(ue=1,fe?this.omega.add(oe,re):this.omega.add(ne,re)),this.alpha!==null&&(ue=2,fe?this.alpha.subtract(ie):this.alpha.subtract(ne))}catch(ae){let se;throw ue===1?se=this.omega:ue===2&&(se=this.alpha),ae.code===2e3?new ModelError(`Incompatible vector keys for flow <i>[${toHTML(this.dna.name)}]</i> and connected stock <i>[${toHTML(se.dna.name)}]</i>.`,{primitive:this.orig(),showEditor:!1,code:1209}):new ModelError(`Incompatible units for flow <i>[${toHTML(this.dna.name)}]</i> and connected stock <i>[${toHTML(se.dna.name)}]</i>. Stock has units of <i>${se.dna.units?se.dna.units.toString():"unitless"}</i>. The flow should have the equivalent units divided by some time unit such as Years.`,{primitive:this.orig(),showEditor:!1,code:1210})}}catch(ne){throw ne instanceof ModelError?ne.primitive&&ne.showEditor?ne:new ModelError(ne.message,{primitive:this.orig(),showEditor:!0,code:1102}):ne}}}function globalVars(te,ee){return te instanceof SAgent?{"-parent":ee.varBank,self:te}:te.container?{"-parent":ee.varBank,self:te.container}:ee.varBank}function constraintAlert(te,ee,re,ne){let ie="The "+(ee==="max"?"maximum":"minimum")+" constraint on the primitive [<i>"+toHTML(ne.model.getId(te.id).name)+"</i>] has been violated. The primitive's value attempted to become "+toHTML(""+re.value)+" when the "+(ee==="max"?"maximum":"minimum")+" allowed value is "+(ee==="max"?te.dna.maxConstraint:te.dna.minConstraint)+".";throw new ModelError(ie,{primitive:te.dna.primitive,showEditor:!1,code:1150})}function createFunctions$1(te){let ee={},re={};defineFunction(te,"Stop",{params:[]},()=>{throw te.config.showNotification&&te.config.showNotification("Simulation ended early by a call to stop()."),{simulationCommand:"STOP"}}),defineFunction(te,"Pause",{params:[]},()=>(te.sleep(!0),new Material(0))),defineFunction(te,"Time",{params:[]},()=>te.time().fullClone()),defineFunction(te,"TimeStep",{params:[]},()=>te.timeStep.fullClone()),defineFunction(te,"TimeLength",{params:[]},()=>te.timeLength.fullClone()),defineFunction(te,"TimeStart",{params:[]},()=>te.timeStart.fullClone()),defineFunction(te,"TimeEnd",{params:[]},()=>te.timeEnd.fullClone()),defineFunction(te,"Seconds",{params:[{name:"Value",defaultVal:"time",vectorize:!0}]},ie=>{let oe;return ie.length?oe=toNum(ie[0]):oe=te.time().fullClone(),mult(oe,new Material(1,te.unitManager.getUnitStore(["seconds"],[-1])))}),defineFunction(te,"Minutes",{params:[{name:"Value",defaultVal:"time",vectorize:!0}]},ie=>{let oe;return ie.length?oe=toNum(ie[0]):oe=te.time().fullClone(),mult(oe,new Material(1,te.unitManager.getUnitStore(["minutes"],[-1])))}),defineFunction(te,"Hours",{params:[{name:"Value",defaultVal:"time",vectorize:!0}]},ie=>{let oe;return ie.length?oe=toNum(ie[0]):oe=te.time().fullClone(),mult(oe,new Material(1,te.unitManager.getUnitStore(["hours"],[-1])))}),defineFunction(te,"Days",{params:[{name:"Value",defaultVal:"time",vectorize:!0}]},ie=>{let oe;return ie.length?oe=toNum(ie[0]):oe=te.time().fullClone(),mult(oe,new Material(1,te.unitManager.getUnitStore(["days"],[-1])))}),defineFunction(te,"Weeks",{params:[{name:"Value",defaultVal:"time",vectorize:!0}]},ie=>{let oe;return ie.length?oe=toNum(ie[0]):oe=te.time().fullClone(),mult(oe,new Material(1,te.unitManager.getUnitStore(["weeks"],[-1])))}),defineFunction(te,"Months",{params:[{name:"Value",defaultVal:"time",vectorize:!0}]},ie=>{let oe;return ie.length?oe=toNum(ie[0]):oe=te.time().fullClone(),mult(oe,new Material(1,te.unitManager.getUnitStore(["months"],[-1])))}),defineFunction(te,"Years",{params:[{name:"Value",defaultVal:"time",vectorize:!0}]},ie=>{let oe;return ie.length?oe=toNum(ie[0]):oe=te.time().fullClone(),mult(oe,new Material(1,te.unitManager.getUnitStore(["years"],[-1])))}),defineFunction(te,"Seasonal",{params:[{name:"Peak",defaultVal:"0",vectorize:!0}]},ie=>{let oe;ie.length?(oe=toNum(ie[0]).fullClone(),oe.units||(oe.units=te.timeUnits)):oe=new Material(0,te.timeUnits);let ue=minus(te.varBank.time([]),oe).forceUnits(createUnitStore("years",te)).value*2*3.14159265359;return new Material(Math.cos(ue))}),defineFunction(te,"Unitless",{params:[{name:"Value",noVector:!0}]},ie=>new Material(toNum(ie[0]).value)),defineFunction(te,"RemoveUnits",{params:[{name:"Value",noVector:!0},{name:"ExpectedUnits",needString:!0}]},ie=>{let oe=toNum(ie[0]);return new Material(oe.forceUnits(createUnitStore(ie[1],te)).value)}),defineFunction(te,"PastMean",{object:[te.varBank,re],params:[{name:"[Primitive]",noVector:!0,needPrimitive:!0},{name:"Past Range",defaultVal:"All Time",vectorize:!0}]},ie=>ie.length===1?te.varBank.mean(ie[0].getPastValues()):te.varBank.mean(ie[0].getPastValues(toNum(ie[1])))),defineFunction(te,"PastMedian",{object:[te.varBank,re],params:[{name:"[Primitive]",noVector:!0,needPrimitive:!0},{name:"Past Range",defaultVal:"All Time",vectorize:!0}]},ie=>ie.length===1?te.varBank.median(ie[0].getPastValues()):te.varBank.median(ie[0].getPastValues(toNum(ie[1])))),defineFunction(te,"PastValues",{object:[te.varBank,re],params:[{name:"[Primitive]",noVector:!0,needPrimitive:!0},{name:"Past Range",defaultVal:"All Time",vectorize:!0}]},ie=>{let oe;return ie.length===1?oe=ie[0].getPastValues():oe=ie[0].getPastValues(toNum(ie[1])),new Vector(oe,te)}),defineFunction(te,"PastStdDev",{object:[te.varBank,re],params:[{name:"[Primitive]",noVector:!0,needPrimitive:!0},{name:"Past Range",defaultVal:"All Time",vectorize:!0}]},ie=>{let oe;return ie.length===1?oe=ie[0].getPastValues():oe=ie[0].getPastValues(toNum(ie[1])),oe.length>1?te.varBank.stddev(oe):new Material(0)}),defineFunction(te,"PastCorrelation",{params:[{name:"[Primitive]",noVector:!0,needPrimitive:!0},{name:"[Primitive]",noVector:!0,needPrimitive:!0,object:[te.varBank,re]},{name:"Past Range",vectorize:!0,defaultVal:"All Time"}]},ie=>{let oe,fe;return ie[2]!=="All Time"?(oe=ie[0].getPastValues(),fe=ie[1].getPastValues()):(oe=ie[0].getPastValues(toNum(ie[2])),fe=ie[1].getPastValues(toNum(ie[2]))),oe.length>1?te.varBank.correlation([new Vector(oe,te),new Vector(fe,te)]):new Material(0)}),defineFunction(te,"PastMax",{object:[te.varBank,re],params:[{name:"[Primitive]",noVector:!0,needPrimitive:!0},{name:"Past Range",defaultVal:"All Time",vectorize:!0}]},ie=>ie.length===1?te.varBank.max(ie[0].getPastValues()):te.varBank.max(ie[0].getPastValues(toNum(ie[1])))),defineFunction(te,"PastMin",{object:[te.varBank,re],params:[{name:"[Primitive]",noVector:!0,needPrimitive:!0},{name:"Past Range",defaultVal:"All Time",vectorize:!0}]},ie=>ie.length===1?te.varBank.min(ie[0].getPastValues()):te.varBank.min(ie[0].getPastValues(toNum(ie[1])))),defineFunction(te,"Pulse",{params:[{name:"Start Time",vectorize:!0},{name:"Height",vectorize:!0,defaultVal:1},{name:"Width",vectorize:!0,defaultVal:0},{name:"Repeat Period",vectorize:!0,defaultVal:0}]},ie=>{let oe=toNum(ie[0]),fe=new Material(1),ue=new Material(0),ae=new Material(0);if(ie.length>1&&(fe=toNum(ie[1]),ie.length>2&&(ue=toNum(ie[2]),ie.length>3&&(ae=toNum(ie[3])))),oe.units||(oe.units=te.timeUnits),ue.units||(ue.units=te.timeUnits),ae.units||(ae.units=te.timeUnits),ae.value<=0){if(eq(te.time(),oe)||greaterThanEq(te.time(),oe)&&lessThanEq(te.time(),plus(oe,ue)))return fe}else if(greaterThanEq(te.time(),oe)){let se=minus(te.time(),mult(te.varBank.floor([div(minus(te.time(),oe),ae)]),ae)),ce=minus(te.time(),oe);if(minus(te.varBank.round([div(ce,ae)]),div(ce,ae)).value===0||greaterThanEq(se,oe)&&lessThanEq(se,plus(oe,ue)))return fe}return new Material(0,fe.units)}),defineFunction(te,"Ramp",{params:[{name:"Start Time",vectorize:!0},{name:"Finish Time",vectorize:!0},{name:"Height",vectorize:!0,defaultVal:1}]},ie=>{let oe=toNum(ie[0]),fe=toNum(ie[1]),ue=new Material(1);return ie.length===3&&(ue=toNum(ie[2])),oe.units||(oe.units=te.timeUnits),fe.units||(fe.units=te.timeUnits),greaterThanEq(te.time(),oe)?div(mult(te.varBank.min([minus(fe,oe),minus(te.time(),oe)]),ue),minus(fe,oe)):new Material(0,ue.units)}),defineFunction(te,"Step",{params:[{name:"Start Time",vectorize:!0},{name:"Height",vectorize:!0,defaultVal:1}]},ie=>{let oe=toNum(ie[0]),fe=new Material(1);return ie.length===2&&(fe=toNum(ie[1])),oe.units||(oe.units=te.timeUnits),greaterThanEq(te.time(),oe)?fe:new Material(0,fe.units)}),te.varBank.staircase=te.varBank.step,defineFunction(te,"Delay",{object:[te.varBank,re],params:[{name:"[Primitive]",noVector:!0,needPrimitive:!0},{name:"Delay",vectorize:!0},{name:"Initial Value",defaultVal:"None",vectorize:!0}]},ie=>{if(toNum(ie[1]).value<0)throw new ModelError("The delay must be greater than or equal to 0.",{code:1026});return ie.length===2?ie[0].pastValue(toNum(ie[1])):ie[0].pastValue(toNum(ie[1]),toNum(ie[2]))}),defineFunction(te,"Smooth",{object:[te.varBank,re],params:[{name:"Expression",noVector:!0},{name:"Period",vectorize:!0},{name:"Initial Value",vectorize:!0,defaultVal:"None"}]},ie=>{throw new ModelError("Smooth() may only be called in a top level primitive equation",{code:1052})}),defineFunction(te,"Delay1",{object:[te.varBank,re],params:[{name:"Expression",noVector:!0},{name:"Delay",vectorize:!0},{name:"Initial Value",vectorize:!0,defaultVal:"None"}]},ie=>{throw new ModelError("Delay1() may only be called in a top level primitive equation",{code:1053})}),defineFunction(te,"Delay3",{object:[te.varBank,re],params:[{name:"Expression",noVector:!0},{name:"Delay",vectorize:!0},{name:"Initial Value",vectorize:!0,defaultVal:"None"}]},ie=>{throw new ModelError("Delay3() may only be called in a top level primitive equation",{code:1054})}),te.varBank.fix=function(ie,oe){testArgumentsSize(ie,"Fix",1,2);let fe=-1;ie.length===2&&(fe=toNum(evaluateNode(ie[1].node,ie[1].scope,te)));let ue=null;for(let ae=0;ae<te.oldAggregateSeries.length;ae++)if(te.oldAggregateSeries[ae].match(oe)){ue=te.oldAggregateSeries[ae];break}return ue===null&&(ue=new AggregateSeries(te,oe,fe),te.oldAggregateSeries.push(ue)),ue.get(ie[0])},te.varBank.fix.delayEvalParams=!0,te.varBank.populationsize=function(ie){if(testArgumentsSize(ie,"PopulationSize",1,1),ie[0]instanceof SPopulation)return new Material(ie[0].agents.length);throw new ModelError("PopulationSize must be passed an agent population as an argument.",{code:1327})},re.populationsize=te.varBank.populationsize,defineFunction(te,"Remove",{object:[te.varBank,ee],params:[{needAgent:!0,name:"[Agent]"}]},ie=>{if(ie[0].dead)throw new ModelError("Cannot remove an already removed agent.",{code:1328});return te.tasks.add(new Task({time:te.time(),priority:10,expires:1,name:"Remove Agent",action:oe=>{ie[0].die()}})),new Material(1)}),defineFunction(te,"Add",{object:[te.varBank,re],params:[{name:"[Agent Population]"},{needAgent:!0,name:"[Base]",defaultVal:"Agent Base"}]},ie=>{for(;!(ie[0]instanceof SPopulation)&&ie[0].container!==null;)ie[0]=ie[0].container;if(!(ie[0]instanceof SPopulation))throw new ModelError("You must pass an agent population as the first argument to Add().",{code:1029});return ie.length===2?ie[0].add(ie[1]):ie[0].add()}),defineFunction(te,"FindAll",{object:[te.varBank,VectorObject,re],params:[{needPopulation:!0,name:"[Agent Population]"}]},ie=>ie[0]),defineFunction(te,"ResetTimer",{object:[te.varBank,re],params:[{needPrimitive:!0,name:"[Action]"}]},ie=>{if(!(ie[0]instanceof SAction))throw new ModelError("ResetTimer requires an Action primitive.",{code:1030});return ie[0].resetTimer(),new Material(0)}),defineFunction(te,"Transition",{object:[te.varBank,re],params:[{needPrimitive:!0,name:"[Transition]"}]},ie=>{if(!(ie[0]instanceof STransition))throw new ModelError("Transition requires an Transition primitive.",{code:1031});return ie[0].trigger(),new Material(0)}),defineFunction(te,"Value",{object:[te.varBank,VectorObject,ee],params:[{name:"[Population]"},{needPrimitive:!0,name:"[Primitive]"}]},ie=>{let oe=ie[1].id,fe=null;if(ie[0]instanceof SPopulation||ie[0]instanceof SAgent||ie[0]instanceof Vector||!ie[0]||(ie[0]=toNum(ie[0])),ie[0]instanceof SPopulation&&(fe=getPopulation(ie[0],te)),ie[0]instanceof Vector&&(fe=ie[0]),fe!==null){let ue=[],ae=-1;for(let se of fe.items){if(!(se instanceof SAgent))throw new ModelError('Cannot take "Value()" of vector that does not contain agents.',{code:1172});if(ae!==-1)ue.push(se.children[ae]);else for(let ce=0;ce<se.children.length;ce++)if(se.children[ce].id===oe){ue.push(se.children[ce]),ae=ce;break}}return new Vector(ue,te)}else if(ie[0]instanceof SAgent){for(let ue of ie[0].children)if(ue.id===oe)return ue;throw new ModelError('Could not find referenced primitive for "Value()".',{code:1032})}throw new ModelError('Invalid type for the first argument of "Value()".',{code:1033})}),defineFunction(te,"SetValue",{object:[te.varBank,VectorObject,re,ee],params:[{name:"[Population]"},{needPrimitive:!0,name:"[Primitive]"},{name:"Value",noVector:!0,allowBoolean:!0}]},ie=>{let oe=ie[1].id,fe=null;if(ie[0]instanceof SPopulation&&(fe=getPopulation(ie[0],te)),ie[0]instanceof Vector&&(fe=ie[0]),fe!==null){for(let ue=0;ue<fe.length();ue++)for(let ae of fe.items[ue].children)ae.id===oe&&ae.setValue(ie[2]);return new Material(1)}else if(ie[0]instanceof SAgent){for(let ue of ie[0].children)if(ue.id===oe)return ue.setValue(ie[2]),new Material(1);throw new ModelError('Could not find referenced primitive for "SetValue()".',{code:1034})}throw new ModelError('Invalid type for the first argument of "SetValue()".',{code:1035})}),defineFunction(te,"FindIndex",{object:[te.varBank,VectorObject,re],params:[{needPopulation:!0,name:"[Agent Population]"},{name:"Index",noVector:!0,needNum:!0,noUnits:!0}]},ie=>{let oe=ie[0];for(let fe of oe.items)if(fe.index+1===ie[1].value)return fe;throw new ModelError("Index not found in population.",{code:1036})}),defineFunction(te,"FindState",{object:[te.varBank,VectorObject,re],params:[{needPopulation:!0,name:"[Agent Population]"},{needPrimitive:!0,name:"[State]"}]},ie=>{let oe=ie[0];if(!(ie[1]instanceof SState||ie[1].dna.primitive instanceof State))throw new ModelError("FindState() requires a State primitive as its argument.",{code:1037});let fe=ie[1].id,ue=[];for(let ae=0;ae<oe.items.length;ae++)oe.items[ae].stateIDs.has(fe)&&ue.push(oe.items[ae]);return new Vector(ue,te)}),defineFunction(te,"FindNotState",{object:[te.varBank,VectorObject,re],params:[{needPopulation:!0,name:"[Agent Population]"},{needPrimitive:!0,name:"[State]"}]},ie=>{let oe=ie[0];if(!(ie[1]instanceof SState||ie[1].dna.primitive instanceof State))throw new ModelError("FindNotState() requires a State primitive as its argument.",{code:1038});let fe=ie[1].id,ue=[];for(let ae of oe.items)ae.stateIDs.has(fe)||ue.push(ae);return new Vector(ue,te)}),defineFunction(te,"FindNearby",{object:[te.varBank,VectorObject,re],params:[{needPopulation:!0,name:"[Agent Population]"},{name:"Target"},{name:"Distance Limit",needNum:!0,noVector:!0}]},ie=>{let oe=ie[0],fe=ne(ie[1]),ue;try{ue=agent(ie[1],te)}catch{}let ae=[];for(let se=0;se<oe.length();se++){let ce=agent(oe.items[se]);ce!==ue&&lessThanEq(distance(fe,ne(ce),te),ie[2])&&ae.push(ce)}return new Vector(ae,te)}),defineFunction(te,"FindNearest",{object:[te.varBank,VectorObject,re],params:[{needPopulation:!0,name:"[Agent Population]"},{name:"Target"},{noUnits:!0,noVector:!0,needNum:!0,defaultVal:1,name:"Count"}]},ie=>{let oe=ie[0],fe=1;if(ie.length===3){if(fe=ie[2].value,fe<1)throw new ModelError("You must select at least one agent in FindNearest().",{code:1039});if(fe!==Math.floor(fe))throw new ModelError("Count must be an integer.",{code:1040})}let ue=ne(ie[1]),ae;try{ae=agent(ie[1],te)}catch{}let se=[];for(let le of oe.items)le=agent(le),le!==ae&&se.push({distance:distance(ue,ne(le),te),item:le});if(se.length<fe)throw new ModelError(`Can't find nearest ${fe} agents of a population of size ${se.length}.`,{code:1041});let ce=[se[0]];for(let le=1;le<se.length;le++){let pe=!1;for(let de=0;de<ce.length;de++)if(lessThan(se[le].distance,ce[de].distance)){ce.splice(de,0,se[le]),pe=!0;break}!pe&&ce.length<fe?ce.push(se[le]):ce.length>fe&&(ce.length=fe)}return ce.length===1?ce[0].item:new Vector(ce.map(le=>le.item),te)}),defineFunction(te,"FindFurthest",{object:[te.varBank,VectorObject,re],params:[{needPopulation:!0,name:"[Agent Population]"},{name:"Target"},{noUnits:!0,noVector:!0,needNum:!0,defaultVal:1,name:"Count"}]},ie=>{let oe=ie[0],fe=1;if(ie.length===3){if(fe=ie[2].value,fe<1)throw new ModelError("You must select at least one agent in FindFurthest().",{code:1042});if(fe!==Math.floor(fe))throw new ModelError("Count must be an integer.",{code:1043})}let ue=ne(ie[1]),ae;try{ae=agent(ie[1],te)}catch{}let se=[];for(let le of oe.items){let pe=agent(le);pe!==ae&&se.push({distance:distance(ue,ne(pe),te),item:pe})}if(se.length<fe)throw new ModelError(`Can't find furthest ${fe} agents of a population of size ${se.length}.`,{code:1044});let ce=[se[0]];for(let le=1;le<se.length;le++){let pe=!1;for(let de=0;de<ce.length;de++)if(greaterThan(se[le].distance,ce[de].distance)){ce.splice(de,0,se[le]),pe=!0;break}!pe&&ce.length<fe?ce.push(se[le]):ce.length>fe&&(ce.length=fe)}return ce.length===1?ce[0].item:new Vector(ce.map(le=>le.item),te)}),defineFunction(te,"Index",{object:[te.varBank,ee],params:[{noVector:!0,needAgent:!0,name:"[Agent]"}]},ie=>new Material(ie[0].index+1)),defineFunction(te,"Connect",{object:[te.varBank,ee],params:[{needAgent:!0,name:"[Agent 1]"},{name:"[Agent 2]"},{name:"Weight",defaultVal:"missing",needNum:!0}]},ie=>{let oe;return ie[2]!=="missing"&&(oe=ie[2]),ie[1]instanceof Vector?ie[1].items.forEach(fe=>{ie[0].connect(fe,oe)}):ie[0].connect(ie[1],oe),new Material(1)}),defineFunction(te,"Unconnect",{object:[te.varBank,ee],params:[{needAgent:!0,name:"[Agent 1]"},{name:"[Agent 2]"}]},ie=>(ie[1]instanceof Vector?ie[1].items.forEach(oe=>{ie[0].unconnect(oe)}):ie[0].unconnect(ie[1]),new Material(1))),defineFunction(te,"Connected",{object:[te.varBank,ee],params:[{needAgent:!0,name:"[Agent]"}]},ie=>new Vector(ie[0].connected.slice(),te)),defineFunction(te,"ConnectionWeight",{object:[te.varBank,ee],params:[{needAgent:!0,name:"[Agent 1]"},{name:"[Agent 2]"}]},ie=>ie[1]instanceof Vector?new Vector(ie[1].items.map(oe=>ie[0].connectionWeight(oe)),te):ie[0].connectionWeight(ie[1])),defineFunction(te,"SetConnectionWeight",{object:[te.varBank,ee],params:[{needAgent:!0,name:"[Agent 1]"},{name:"[Agent 2]"},{name:"Weight",needNum:!0}]},ie=>(ie[1]instanceof Vector?ie[1].items.forEach(oe=>{ie[0].setConnectionWeight(oe,ie[2])}):ie[0].setConnectionWeight(ie[1],ie[2]),new Material(1))),te.varBank.print=function(ie){function oe(fe){return fe instanceof String&&(fe=""+fe),fe}return ie.length===2?(console.log(oe(ie[0].value.toString())),console.log(oe(ie[1])),ie[1]):(console.log(oe(ie[0])),ie[0])},defineFunction(te,"Width",{params:[{needAgents:!0,name:"[Agent Population]"}]},ie=>ie[0].geoWidth),defineFunction(te,"Height",{params:[{needAgents:!0,name:"[Agent Population]"}]},ie=>ie[0].geoHeight),defineFunction(te,"Distance",{object:[te.varBank,ee],params:[{name:"Location 1"},{name:"Location 2"}]},ie=>{let oe=ne(ie[0]),fe=ne(ie[1]);return distance(oe,fe,te)}),defineFunction(te,"Location",{object:[te.varBank,ee],params:[{needAgent:!0,name:"[Agent]"}]},ie=>{if(ie[0].location)return ie[0].location.fullClone();throw new ModelError("The location is not defined.",{code:1046})}),defineFunction(te,"SetLocation",{object:[te.varBank,ee],params:[{needAgent:!0,name:"[Agent]"},{needVector:!0,name:"Direction"}]},ie=>{let oe=toNum(ie[1]),fe=ie[0];return fe.location=oe.fullClone(),fe.location.names||(fe.location.names=["x","y"],fe.location.namesLC=["x","y"]),new Material(0)}),defineFunction(te,"Move",{object:[te.varBank,ee],params:[{needAgent:!0,name:"[Mover]"},{needVector:!0,name:"Direction"}]},ie=>{let oe=toNum(ie[1]);return shiftLocation(ie[0],plus(ie[0].location,oe)),new Material(0)});function ne(ie){const oe="Location not initialized yet for agents. Location initialization happens after agent primitive value initialization.";if(ie instanceof Vector){if(ie.items.length!==2||!(ie.items[0]instanceof Material)||!(ie.items[1]instanceof Material))throw new ModelError("Location vector does not contain exactly two numbers.",{code:1047});return{location:ie,agent:null}}else try{let fe=agent(ie,te),ue=fe.location;if(ue===null)throw new ModelError(oe,{code:1048});return{location:ue,agent:fe}}catch(fe){throw fe.message===oe?fe:new ModelError("Location must be a vector or an agent.",{code:1049})}}defineFunction(te,"MoveTowards",{object:[te.varBank,ee],params:[{needAgent:!0,name:"[Mover]"},{name:"[Target]"},{name:"Distance",noVector:!0,needNum:!0}]},ie=>{let oe=ne(ie[0]),fe=ne(ie[1]),ue=oe.location,ae=fe.location,se=minus(ae.items[0],ue.items[0]),ce=minus(ae.items[1],ue.items[1]);if(se.value===0&&ce.value===0)return new Material(1);let le=oe.agent;le.container.geoWrap&&(greaterThan(se,le.container.halfWidth)?se=minus(se,le.container.geoWidth):lessThan(se,negate(le.container.halfWidth))&&(se=plus(se,le.container.geoWidth)),greaterThan(ce,le.container.halfHeight)?ce=minus(ce,le.container.geoHeight):lessThan(ce,negate(le.container.halfHeight))&&(ce=plus(ce,le.container.geoHeight)));let pe=new Vector([se,ce],te,["x","y"]);return shiftLocation(le,plus(le.location,mult(pe,div(ie[2],distance(oe,fe,te))))),new Material(1)}),te.varBank.primitivebase=makeObjectBase(re,te),te.varBank.agentbase=makeObjectBase(ee,te),te.varBank.primitivebase.parent=te.varBank.agentbase,te.varBank.vectorbase=makeObjectBase(VectorObject,te)}const MAX_DISTANCE_CACHES=1e6;function distance(te,ee,re){let ne=te.location,ie=ee.location;re.distanceCacheCount++;let oe=te.agent?te.agent.container:ee.agent?ee.agent.container:null,fe;if(re.distanceCacheCount<MAX_DISTANCE_CACHES){let de=ne.items[0].toString()+","+ne.items[1].toString(),me=ie.items[0].toString()+","+ie.items[1].toString();if(me<de&&([de,me]=[me,de]),fe=de+":"+me,oe&&(fe+="/"+oe.id),fe in re.distanceCache)return re.distanceCache[fe]}let ue=minus(ne.items[0],ie.items[0]),ae=minus(ne.items[1],ie.items[1]);oe&&oe.geoWrap&&(greaterThan(ue,oe.halfWidth)?ue=minus(oe.geoWidth,ue):lessThan(ue,negate(oe.halfWidth))&&(ue=minus(ue,negate(oe.geoWidth))),greaterThan(ae,oe.halfHeight)?ae=minus(oe.geoHeight,ae):lessThan(ae,negate(oe.halfHeight))&&(ae=minus(ae,negate(oe.geoHeight))));let se=ue.value,ce=ae.value;ue.units!==ae.units&&(ce=fn["*"](ce,convertUnits(ue.units,ae.units)));let le=fn.sqrt(fn["+"](fn["*"](se,se),fn["*"](ce,ce))),pe=new Material(le,ue.units);return re.distanceCacheCount<MAX_DISTANCE_CACHES&&(re.distanceCache[fe]=pe),pe}function agent(te,ee){if((te instanceof SVariable||te instanceof SStock)&&(te=toNum(te)),te instanceof SAgent)return te;if(te instanceof SPrimitive)return agent(te.container);throw new ModelError("An agent is required here.",{code:1050})}function agents(te){if(te instanceof SPopulation)return te;if(te instanceof SPrimitive||te instanceof SAgent)return agents(te.container);throw new ModelError("An agent population is required here.",{code:1051})}function getPopulation(te,ee){return te.items?te:te instanceof SPopulation?new Vector(te.agents.slice(),ee):toNum(te)instanceof Vector?toNum(te):new Vector([agent(te)],ee)}function shiftLocation(te,ee){if(te.container.geoWrap){for(;lessThan(ee.items[0],new Material(0));)ee.items[0]=plus(ee.items[0],te.container.geoWidth);for(;greaterThan(ee.items[0],te.container.geoWidth);)ee.items[0]=minus(ee.items[0],te.container.geoWidth);for(;lessThan(ee.items[1],new Material(0));)ee.items[1]=plus(ee.items[1],te.container.geoHeight);for(;greaterThan(ee.items[1],te.container.geoHeight);)ee.items[1]=minus(ee.items[1],te.container.geoHeight)}te.location=ee,te.location.names||(te.location.names=["x","y"],te.location.namesLC=["x","y"])}let SeedRandom={};(function(te,ee,re){var ne=256,ie=6,oe=52,fe="random",ue=re.pow(ne,ie),ae=re.pow(2,oe),se=ae*2,ce=ne-1,le;function pe(Te,Ne,Le){var Oe=[];Ne=Ne==!0?{entropy:!0}:Ne||{};var xe=we(ve(Ne.entropy?[Te,_e(ee)]:Te??ge(),3),Oe),Se=new de(Oe),be=function(){for(var De=Se.g(ie),Me=ue,Ue=0;De<ae;)De=(De+Ue)*ne,Me*=ne,Ue=Se.g(1);for(;De>=se;)De/=2,Me/=2,Ue>>>=1;return(De+Ue)/Me};return be.int32=function(){return Se.g(4)|0},be.quick=function(){return Se.g(4)/4294967296},be.double=be,we(_e(Se.S),ee),(Ne.pass||Le||function(De,Me,Ue,Ke){return Ke&&(Ke.S&&me(Ke,Se),De.state=function(){return me(Se,{})}),Ue?(re[fe]=De,Me):De})(be,xe,"global"in Ne?Ne.global:this==re,Ne.state)}function de(Te){var Ne,Le=Te.length,Oe=this,xe=0,Se=Oe.i=Oe.j=0,be=Oe.S=[];for(Le||(Te=[Le++]);xe<ne;)be[xe]=xe++;for(xe=0;xe<ne;xe++)be[xe]=be[Se=ce&Se+Te[xe%Le]+(Ne=be[xe])],be[Se]=Ne;(Oe.g=function(De){for(var Me,Ue=0,Ke=Oe.i,ft=Oe.j,qe=Oe.S;De--;)Me=qe[Ke=ce&Ke+1],Ue=Ue*ne+qe[ce&(qe[Ke]=qe[ft=ce&ft+Me])+(qe[ft]=Me)];return Oe.i=Ke,Oe.j=ft,Ue})(ne)}function me(Te,Ne){return Ne.i=Te.i,Ne.j=Te.j,Ne.S=Te.S.slice(),Ne}function ve(Te,Ne){var Le=[],Oe=typeof Te,xe;if(Ne&&Oe=="object")for(xe in Te)try{Le.push(ve(Te[xe],Ne-1))}catch{}return Le.length?Le:Oe=="string"?Te:Te+"\0"}function we(Te,Ne){for(var Le=Te+"",Oe,xe=0;xe<Le.length;)Ne[ce&xe]=ce&(Oe^=Ne[ce&xe]*19)+Le.charCodeAt(xe++);return _e(Ne)}function ge(){try{var Te;return le&&(Te=le.randomBytes)||(Te=new Uint8Array(ne),(te.crypto||te.msCrypto).getRandomValues(Te)),_e(Te)}catch{var Ne=te.navigator,Le=Ne&&Ne.plugins;return[+new Date,te,Le,te.screen,_e(ee)]}}function _e(Te){return String.fromCharCode.apply(0,Te)}we(re.random(),ee),SeedRandom.seedrandom=pe})(typeof self<"u"?self:globalThis,[],Math);function createFunctions(te){defineFunction(te,"RandBeta",{params:[{name:"Alpha",noUnits:!0,noVector:!0},{name:"Beta",noUnits:!0,noVector:!0}]},ae=>new Material(RandBeta(te,ae[0].value,ae[1].value))),defineFunction(te,"RandDist",{params:[{name:"Distribution",noUnits:!0,needVector:!0},{name:"Y (in which case Distribution is X)",noUnits:!0,needVector:!0,defaultVal:!1}]},ae=>{let se,ce;if(ae.length===1||ae[1]===!1){let le=ae[0];se=[],ce=[];for(let pe=0;pe<le.items.length;pe++){if(!(le.items[pe]instanceof Vector))throw new ModelError("Invalid vector provided to RandDist.",{code:6e3});se.push(toNum(le.items[pe].items[0]).value),ce.push(toNum(le.items[pe].items[1]).value)}}else se=toNum(ae[0]).items.map(le=>le.value),ce=toNum(ae[1]).items.map(le=>le.value);return new Material(RandDist(te,se,ce))}),defineFunction(te,"RandBoolean",{params:[{name:"Probability",defaultVal:.5,noUnits:!0,noVector:!0}]},ae=>{let se;return ae.length!==0?se=toNum(ae[0]).value:se=.5,Rand(te)<se}),defineFunction(te,"Rand",{params:[{name:"Lower Bound",defaultVal:0,noUnits:!0,noVector:!0},{name:"Upper Bound",defaultVal:1,noUnits:!0,noVector:!0}]},ae=>{if(ae.length===0)return new Material(Rand(te));if(ae.length===2)return new Material(Rand(te,toNum(ae[0]).value,toNum(ae[1]).value));throw new ModelError("Rand() must either have no parameters or a two: Min and Max bounds.",{code:6001})}),defineFunction(te,"RandNormal",{params:[{name:"Mean",defaultVal:0,noUnits:!0,noVector:!0},{name:"Standard Deviation",defaultVal:1,noUnits:!0,noVector:!0}]},ae=>{if(ae.length===0)return new Material(RandNormal(te));if(ae.length===2)return new Material(RandNormal(te,toNum(ae[0]).value,toNum(ae[1]).value));throw new ModelError("RandNormal() must either have no parameters or a two: Mean and Standard Deviation.",{code:6002})}),defineFunction(te,"RandExp",{params:[{name:"Rate",defaultVal:1,noUnits:!0,noVector:!0}]},ae=>ae.length!==0?new Material(RandExp(te,toNum(ae[0]).value)):new Material(RandExp(te))),defineFunction(te,"RandLognormal",{params:[{name:"Mean",noUnits:!0,noVector:!0},{name:"Standard Deviation",noUnits:!0,noVector:!0}]},ae=>new Material(RandLognormal(te,toNum(ae[0]).value,toNum(ae[1]).value))),defineFunction(te,"RandBinomial",{params:[{name:"Count",noUnits:!0,noVector:!0},{name:"Probability",noUnits:!0,noVector:!0}]},ae=>new Material(RandBinomial(te,toNum(ae[0]).value,toNum(ae[1]).value))),defineFunction(te,"RandNegativeBinomial",{params:[{name:"Successes",noUnits:!0,noVector:!0},{name:"Probability",noUnits:!0,noVector:!0}]},ae=>new Material(RandNegativeBinomial(te,toNum(ae[0]).value,toNum(ae[1]).value))),defineFunction(te,"RandGamma",{params:[{name:"Alpha",noUnits:!0,noVector:!0},{name:"Beta",noUnits:!0,noVector:!0}]},ae=>new Material(RandGamma(te,toNum(ae[0]).value,toNum(ae[1]).value))),defineFunction(te,"RandPoisson",{params:[{name:"Rate",noUnits:!0,noVector:!0}]},ae=>new Material(RandPoisson(te,toNum(ae[0]).value))),defineFunction(te,"RandTriangular",{params:[{name:"Minimum",noUnits:!0,noVector:!0},{name:"Maximum",noUnits:!0,noVector:!0},{name:"Peak",noUnits:!0,noVector:!0}]},ae=>new Material(RandTriangular(te,toNum(ae[0]).value,toNum(ae[1]).value,toNum(ae[2]).value))),defineFunction(te,"Magnitude",{params:[{name:"Number"}]},ae=>{if(toNum(ae[0])instanceof Vector)return te.varBank.sqrt([te.varBank.sum([mult(ae[0],ae[0])])]);let se=toNum(ae[0]);return se.value=fn.magnitude(se.value),se}),defineFunction(te,"Abs",{params:[{name:"Number"}],recurse:!0,leafNeedNum:!0},ae=>{let se=toNum(ae[0]);return se.value=fn.abs(se.value),se}),defineFunction(te,"sin",{params:[{name:"Number"}],recurse:!0,leafNeedNum:!0},ae=>{let se=toNum(ae[0]);if(se.units&&!se.units.isUnitless()&&(se=mult(se,new Material(1,te.unitManager.getUnitStore(["radians"],[-1])))),se.units)throw new ModelError("Non-angular units cannot be used in Sin().",{code:6003});return new Material(fn.sin(se.value))}),defineFunction(te,"cos",{params:[{name:"Number"}],recurse:!0,leafNeedNum:!0},ae=>{let se=toNum(ae[0]);if(se.units&&!se.units.isUnitless()&&(se=mult(se,new Material(1,te.unitManager.getUnitStore(["radians"],[-1])))),se.units)throw new ModelError("Non-angular units cannot be used in Cos().",{code:6004});return new Material(fn.cos(se.value))}),defineFunction(te,"tan",{params:[{name:"Number"}],recurse:!0,leafNeedNum:!0},ae=>{let se=toNum(ae[0]);if(se.units&&!se.units.isUnitless()&&(se=mult(se,new Material(1,te.unitManager.getUnitStore(["radians"],[-1])))),se.units)throw new ModelError("Non-angular units cannot be used in Tan().",{code:6005});return new Material(fn.tan(se.value))}),defineFunction(te,"asin",{params:[{name:"Number",noUnits:!0}],recurse:!0,leafNeedNum:!0},ae=>new Material(fn.asin(toNum(ae[0]).value))),defineFunction(te,"acos",{params:[{name:"Number",noUnits:!0}],recurse:!0,leafNeedNum:!0},ae=>new Material(fn.acos(toNum(ae[0]).value))),defineFunction(te,"atan",{params:[{name:"Number",noUnits:!0}],recurse:!0,leafNeedNum:!0},ae=>new Material(fn.atan(toNum(ae[0]).value))),defineFunction(te,"arcsin",{params:[{name:"Number",noUnits:!0}],recurse:!0,leafNeedNum:!0},ae=>new Material(fn.asin(toNum(ae[0]).value),te.unitManager.getUnitStore(["radians"],[1]))),defineFunction(te,"arccos",{params:[{name:"Number",noUnits:!0,leafNeedNum:!0}],recurse:!0},ae=>new Material(fn.acos(toNum(ae[0]).value),te.unitManager.getUnitStore(["radians"],[1]))),defineFunction(te,"arctan",{params:[{name:"Number",noUnits:!0,leafNeedNum:!0}],recurse:!0},ae=>new Material(fn.atan(toNum(ae[0]).value),te.unitManager.getUnitStore(["radians"],[1]))),defineFunction(te,"Sign",{params:[{name:"Number",leafNeedNum:!0}],recurse:!0},ae=>{let se=toNum(ae[0]);if(se.value<0)return div(new Material(-1),new Material(1));if(se.value>0)return div(new Material(1),new Material(1));if(se.value===0)return new Material(0);throw new ModelError("Invalid value for <i>Sign</i>.",{code:6006})}),defineFunction(te,"Sqrt",{params:[{name:"Number",leafNeedNum:!0}],recurse:!0},ae=>{let se=toNum(ae[0]).fullClone();if(se.value<0)throw new ModelError("Sqrt() requires a number greater than or equal to 0.",{code:6007});return se.value=fn.sqrt(se.value),se.units&&!se.units.isUnitless()&&(se.units=se.units.power(.5)),se}),defineFunction(te,"Ln",{params:[{name:"Number",noUnits:!0,leafNeedNum:!0}],recurse:!0},ae=>{let se=toNum(ae[0]).value;if(se<0)throw new ModelError("Ln() requires a number greater than or equal to 0.",{code:6008});return new Material(fn.log(se))}),defineFunction(te,"Log",{params:[{name:"Number",noUnits:!0,leafNeedNum:!0}],recurse:!0},ae=>{let se=toNum(ae[0]).value;if(se<0)throw new ModelError("Log() requires a number greater than or equal to 0.",{code:6009});return new Material(fn.log(se,10))}),defineFunction(te,"Logit",{params:[{name:"Number",noUnits:!0,leafNeedNum:!0}],recurse:!0},ae=>{let se=toNum(ae[0]);return se.value=fn["-"](fn.log(se.value),fn.log(fn["-"](1,se.value))),se}),defineFunction(te,"Expit",{params:[{name:"Number",noUnits:!0,leafNeedNum:!0}],recurse:!0},ae=>{let se=toNum(ae[0]);return se.value=fn["/"](1,fn["+"](1,fn.exp(fn["-"](se.value)))),se}),defineFunction(te,"Round",{params:[{name:"Number",noUnits:!1,leafNeedNum:!0}],recurse:!0},ae=>{let se=toNum(ae[0]);return se.value=fn.round(se.value),se}),defineFunction(te,"Ceiling",{params:[{name:"Number",noUnits:!1,leafNeedNum:!0}],recurse:!0},ae=>{let se=toNum(ae[0]);return se.value=fn.ceiling(se.value),se}),defineFunction(te,"Floor",{params:[{name:"Number",noUnits:!1,leafNeedNum:!0}],recurse:!0},ae=>{let se=toNum(ae[0]);return se.value=fn.floor(se.value),se}),defineFunction(te,"Exp",{params:[{name:"Number",noUnits:!0,leafNeedNum:!0}],recurse:!0},ae=>new Material(fn.exp(toNum(ae[0]).value))),te.varBank.ifthenelse=function(ae){testArgumentsSize(ae,"IfThenElse",3,3);let se=toNum(evaluateNode(ae[0].node,ae[0].scope,te));return se instanceof Vector?ee(se,evaluateNode(ae[1].node,ae[1].scope,te),evaluateNode(ae[2].node,ae[2].scope,te)):trueValue(se)?evaluateNode(ae[1].node,ae[1].scope,te):evaluateNode(ae[2].node,ae[2].scope,te)},te.varBank.ifthenelse.delayEvalParams=!0,te.varBank.assert=function(ae){testArgumentsSize(ae,"Assert",1,2);let se=evaluateNode(ae[0].node,ae[0].scope,te);if(trueValue(se))return new Material(1);throw new ModelError(ae[1]?evaluateNode(ae[1].node,ae[1].scope,te):"Assert() failed",{code:2e4})},te.varBank.assert.delayEvalParams=!0;function ee(ae,se,ce){let le=function(me,ve){return me instanceof Vector?me.combine(ve,le):[me,ve]};se=toNum(se),ce=toNum(ce);let pe;se instanceof Vector?pe=se.cloneCombine(ce,le):ce instanceof Vector?pe=ce.cloneCombine(se,(me,ve)=>le(ve,me)):pe=le(se,ce);let de=function(me,ve){return me instanceof Vector?me.combine(ve,de):trueValue(me)?ve[0]:ve[1]};return ae.cloneCombine(pe,de)}te.varBank.map=function(ae){testArgumentsSize(ae,"Map",2,2);let se;if(ae[0].node instanceof Vector?se=ae[0].node:ae[0]instanceof Vector?se=ae[0]:se=evaluateNode(ae[0].node,ae[1].scope,te),se instanceof SPrimitive&&(se=toNum(se)),!(se instanceof Vector))throw new ModelError("Map() requires a vector as its first argument.",{code:6010});se=se.fullClone();let ce,le={x:null,"-parent":ae[1].scope},pe=ae[1].node;try{ce=evaluateNode(pe,le,te)}catch{}let de;return ce instanceof Function||ce instanceof UserFunction?(ce.fn&&(ce=ce.fn),de=function(me){return ce([me])}):de=function(me,ve){return le.x=me,le.key=ve||"",evaluateNode(pe,le,te)},se.apply(de)},te.varBank.map.delayEvalParams=!0,VectorObject.map=te.varBank.map,defineFunction(te,"Sample",{object:[te.varBank,VectorObject],params:[{name:"Vector",needVector:!0},{name:"Sample Size"},{name:"Repeat",noVector:!0,allowBoolean:!0,defaultVal:!1}]},ae=>{let se=toNum(ae[0]),ce=toNum(ae[1]).value;if(ce===0)return new Vector([],te);let le=se.length(),pe=ae[2]&&trueValue(toNum(ae[2]));if(le===0)throw new ModelError("Sample() requires a non-empty vector.",{code:6011});let de=[];if(pe)for(let me=0;me<ce;me++)de.push(se.items[Math.floor(Rand(te)*le)]);else{if(le<ce)throw new ModelError("Vector for Sample() is too small for the given sample size.",{code:6012});let me=se.items.slice();for(let ve=0;ve<ce;ve++)de.push(me.splice(Math.floor(Rand(te)*me.length),1)[0])}return new Vector(de,te)}),defineFunction(te,"IndexOf",{object:[te.varBank,VectorObject],params:[{name:"Haystack",needVector:!0,noUnits:!0},{name:"Needle",allowBoolean:!0,allowString:!0}]},ae=>{let se=ae[1];if(se instanceof Vector){let ce=[];for(let le=0;le<se.items.length;le++)ce.push(re(se.items[le],ae[0]));return new Vector(ce,te)}else return re(se,ae[0])}),defineFunction(te,"Contains",{object:[te.varBank,VectorObject],params:[{name:"Haystack",needVector:!0,noUnits:!0},{name:"Needle",allowBoolean:!0,noVector:!0,allowString:!0}]},ae=>!eq(new Material(0),te.varBank.indexof(ae))),defineFunction(te,"Collapse",{params:[{name:"Source",needVector:!0,noUnits:!1},{name:"Target",noVector:!1}]},ae=>toNum(ae[0]).collapseDimensions(toNum(ae[1])));function re(ae,se){for(let ce=0;ce<se.length();ce++)if(eq(ae,se.items[ce]))return new Material(ce+1);return new Material(0)}te.varBank.filter=function(ae){testArgumentsSize(ae,"Filter",2,2);let se;if(ae[0].node instanceof Vector?se=ae[0].node:ae[0]instanceof Vector?se=ae[0]:se=evaluateNode(ae[0].node,ae[0].scope,te),se instanceof SPrimitive&&(se=toNum(se)),!(se instanceof Vector))throw new ModelError("Filter() requires a vector as its first argument.",{code:6013});se=se.fullClone();let ce=te.varBank.map(ae);return te.varBank.select([se,ce])},te.varBank.filter.delayEvalParams=!0,VectorObject.filter=te.varBank.filter,te.varBank.join=function(ae){let se=[],ce=[],le=!1;for(let pe=0;pe<ae.length;pe++){let de=ae[pe];if(de instanceof SPrimitive&&(de=toNum(de)),de instanceof Vector)if(se=se.concat(de.items),de.names)ce=ce.concat(de.names),le=!0;else for(let me=0;me<de.items.length;me++)ce.push(void 0);else se.push(de),ce.push(void 0)}return new Vector(se,te,le?ce:void 0)},te.varBank.repeat=function(ae){testArgumentsSize(ae,"Repeat",2,2);let se=toNum(evaluateNode(ae[1].node,ae[1].scope,te)),ce=se;if(se instanceof Vector){if(se.names&&se.names.length)throw new ModelError(`If a repeat count is a vector, it can't have names. Got, <i>${se}</i>.`,{code:6070});let de=se.items;if(de.find(me=>!(typeof me=="string"||me instanceof String)))throw new ModelError(`If a repeat count is a vector, it must consist of all strings. Got, <i>${se}</i>.`,{code:6071});if(new Set(de).size!==de.length)throw new ModelError(`If a repeat count is a vector, it must contain unique strings. Got, <i>${se}</i>.`,{code:6072});ce=se.items.length}else if(se instanceof Material){if(se.units&&!se.units.isUnitless())throw new ModelError(`Repeat count must be unitless. Got, <i>${se}</i>.`,{code:6073})}else throw new ModelError(`Repeat count must be a Number or Vector. Got, <i>${se}</i>.`,{code:6074});let le=[],pe={x:null,"-parent":ae[1].scope,key:null};for(let de=0;de<ce;de++)se instanceof Vector&&(pe.key=se.items[de]),pe.x=new Material(de+1),le.push(evaluateNode(ae[0].node,pe,te));return new Vector(le,te,se instanceof Vector?se.items.slice():void 0)},te.varBank.repeat.delayEvalParams=!0,defineFunction(te,"Select",{params:[{name:"Haystack",needVector:!0,noUnits:!0},{name:"Indexes",noUnits:!0}]},ae=>{if(ae[1]instanceof Vector){let se=toNum(ae[1]),ce=!0;for(let le=0;le<se.length();le++)if(se.items[le]instanceof Material){ce=!1;break}if(ce===!0){let le=[],pe=ae[0].names?[]:void 0;if(se.length()!==ae[0].length())throw new ModelError("Length of vector must be equal for boolean selection.",{code:6014});for(let de=0;de<se.length();de++)trueValue(se.items[de])&&(le.push(ae[0].items[de]),ae[0].names&&pe.push(ae[0].names[de]));return new Vector(le,te,pe)}else{let le=[],pe=ae[0].names?[]:void 0;for(let de=0;de<se.length();de++){let me=se.items[de].value;if(me<=0||me>ae[0].length())throw new ModelError("Selected element out of range.",{code:6015});le.push(ae[0].items[me-1]),ae[0].names&&pe.push(ae[0].names[me-1])}return new Vector(le,te,pe)}}else{if(ae[1].value>0&&ae[1].value<=ae[0].length())return ae[0].items[ae[1].value-1];throw new ModelError("Selected element out of range.",{code:6016})}}),defineFunction(te,"Reverse",{allowEmpty:!0,params:{name:"Items..."},prep:function(ae){return te.varBank.join(ae)}},ae=>new Vector(ae.items.slice().reverse(),te,ae.names?ae.names.slice().reverse():void 0)),defineFunction(te,"Reverse",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>te.varBank.reverse(ae)),defineFunction(te,"Sort",{allowEmpty:!0,params:{name:"Items..."},prep:function(ae){return toNum(te.varBank.join(ae))}},ae=>ae.stackApply(ce=>{let le=[];for(let me=0;me<ce.items.length;me++)le.push({item:ce.items[me],name:ce.names?ce.names[me]:void 0});let pe=le.sort((me,ve)=>lessThan(me.item,ve.item)?-1:greaterThan(me.item,ve.item)?1:0),de=ce.names?[]:void 0;le=[];for(let me=0;me<pe.length;me++)le.push(pe[me].item),de&&de.push(pe[me].name);return new Vector(le,te,de)})),defineFunction(te,"Sort",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>te.varBank.sort(ae)),defineFunction(te,"Unique",{allowEmpty:!0,params:{name:"Items....",allowBoolean:!0},prep:function(ae){return toNum(te.varBank.join(ae))}},ae=>{if(!ae.items.length)return new Vector([],te);let se=[],ce=ae.names?[]:void 0;for(let le=0;le<ae.items.length;le++){let pe=!1;for(let de=0;de<se.length;de++)if(strictEquals(ae.items[le],se[de])){pe=!0;break}pe||(se.push(ae.items[le]),ce&&ce.push(ae.names[le]))}return new Vector(se,te,ce)}),defineFunction(te,"Unique",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>te.varBank.unique(ae)),defineFunction(te,"Union",{object:[te.varBank,VectorObject],params:[{name:"Vector 1",needVector:!0},{name:"Vector 2",needVector:!0}]},ae=>te.varBank.unique(te.varBank.join(ae).items)),defineFunction(te,"Intersection",{object:[te.varBank,VectorObject],params:[{name:"Vector 1",needVector:!0},{name:"Vector 2",needVector:!0}]},ae=>{let se=ae[0],ce=ae[1],le=[];for(let pe=0;pe<se.items.length;pe++)for(let de=0;de<ce.items.length;de++)if(strictEquals(se.items[pe],ce.items[de])){le.push(se.items[pe]);break}return te.varBank.unique(le)}),defineFunction(te,"Difference",{object:[te.varBank,VectorObject],params:[{name:"Vector 1",needVector:!0},{name:"Vector 2",needVector:!0}]},ae=>{let se=ae[0],ce=ae[1],le=[];for(let pe=0;pe<se.items.length;pe++){let de=!1;for(let me=0;me<ce.items.length;me++)if(strictEquals(se.items[pe],ce.items[me])){de=!0;break}de||le.push(se.items[pe])}for(let pe=0;pe<ce.items.length;pe++){let de=!1;for(let me=0;me<se.items.length;me++)if(strictEquals(ce.items[pe],se.items[me])){de=!0;break}de||le.push(ce.items[pe])}return te.varBank.unique(le)}),defineFunction(te,"Factorial",{params:[{name:"Number",noUnits:!0,leafNeedNum:!0}],recurse:!0},ae=>new Material(factorial(toNum(ae[0]).value))),defineFunction(te,"Max",{params:{name:"Items..."},prep:ne},ae=>ae.stackApply(ce=>{let le=ce.items;if(le.length>0){let pe=le[0];for(let de=1;de<le.length;de++)greaterThan(le[de],pe)&&(pe=le[de]);return pe}else throw new ModelError("You must have at least one element to calculate a max.",{code:6017})})),defineFunction(te,"Max",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>te.varBank.max(ae));function ne(ae,se,ce){if(!se)for(let le=0;le<ae.length;le++)ae[le]=toNum(ae[le]);return ae.length===1&&ae[0]instanceof Vector?ce?ae[0]:te.varBank.flatten([ae[0]]):new Vector(oe(ae),te)}function ie(ae){for(let se=0;se<ae.length;se++)ae[se].toNum&&(ae[se]=toNum(ae[se]));return ae.length===1&&ae[0]instanceof Vector?te.varBank.flatten([toNum(ae[0])]).items:ne(ae,void 0,!0).items}function oe(ae){let se=!1,ce;for(let le=0;le<ae.length;le++)if(ae[le]instanceof Vector){ce=ae[le],se=!0;break}if(se)for(let le=0;le<ae.length;le++)ae[le]instanceof Vector||(ae[le]=fe(ce,ae[le]));return ae}function fe(ae,se){let ce=ae.fullClone();for(let le=0;le<ce.items.length;le++)ce.items[le]instanceof Vector?ce.items[le]=fe(ce.items[le],se):ce.items[le]=se;return ce}defineFunction(te,"Lookup",{params:[{name:"Value",noVector:!0},{name:"Value Vector",needVector:!0},{name:"Results Vector",needVector:!0}]},ae=>{let se=toNum(ae[0]),ce=toNum(ae[1]),le=toNum(ae[2]);if(ce.items.length!==le.items.length)throw new ModelError("The <i>value</i> and <i>results</i> vectors must be the same length",{code:6018});if(ce.items.length<1)throw new ModelError("You must have at least one element in your vectors",{code:6019});let pe=[];for(let de=0;de<ce.items.length;de++)pe.push({x:ce.items[de],y:le.items[de]});pe.sort((de,me)=>greaterThan(de.x,me.x)?1:lessThan(de.x,me.x)?-1:0);for(let de=0;de<pe.length;de++){if(eq(pe[de].x,se))return pe[de].y.fullClone();if(greaterThan(pe[de].x,se)){if(de===0)return pe[de].y.fullClone();let me=minus(pe[de].x,pe[de-1].x),ve=minus(se,pe[de-1].x),we=minus(pe[de].x,se),ge=div(we,me),_e=div(ve,me);return plus(mult(pe[de-1].y,ge),mult(pe[de].y,_e))}}return pe[pe.length-1].y.fullClone()}),defineFunction(te,"Fill",{object:[te.varBank,VectorObject],params:[{name:"Vector",needVector:!0},{name:"Value",allowBoolean:!0}]},ae=>fe(ae[0],ae[1])),defineFunction(te,"Min",{params:{name:"Items..."},prep:ne},ae=>ae.stackApply(ce=>{let le=ce.items;if(le.length>0){let pe=le[0];for(let de=1;de<le.length;de++)lessThan(le[de],pe)&&(pe=le[de]);return pe}else throw new ModelError("You must have at least one element to calculate a min.",{code:6020})})),defineFunction(te,"Min",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>te.varBank.min(ae)),defineFunction(te,"Mean",{params:{name:"Items..."},prep:ie},ae=>{let se=ae[0];for(let ce=1;ce<ae.length;ce++)se=plus(se,ae[ce]);return div(se,new Material(ae.length))}),defineFunction(te,"Mean",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>te.varBank.mean(ae)),defineFunction(te,"Sum",{params:{name:"Items..."},prep:ie},ae=>{let se=ae[0];for(let ce=1;ce<ae.length;ce++)se=plus(se,ae[ce]);return se}),defineFunction(te,"Sum",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>te.varBank.sum(ae)),defineFunction(te,"Product",{params:{name:"Items..."},prep:ie},ae=>{let se=ae[0];for(let ce=1;ce<ae.length;ce++)se=mult(se,ae[ce]);return se}),defineFunction(te,"Product",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>te.varBank.product(ae)),defineFunction(te,"Median",{params:{name:"Items..."},prep:ne},ae=>ae.stackApply(ce=>{let le=te.varBank.sort([ce]).items;if(le.length>0)return Math.floor((le.length-1)/2)===(le.length-1)/2?le[(le.length-1)/2]:div(plus(le[Math.floor((le.length-1)/2)],le[Math.ceil((le.length-1)/2)]),new Material(2));throw new ModelError("You must have at least one element to calculate a median.",{code:6021})})),defineFunction(te,"Median",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>te.varBank.median(ae)),defineFunction(te,"StdDev",{params:{name:"Items..."},prep:ne},ae=>ae.stackApply(ce=>{let le=ce.items;if(le.length>1){let pe=te.varBank.mean(le),de=power(minus(le[0],pe),new Material(2));for(let ve=1;ve<le.length;ve++)de=plus(de,power(minus(le[ve],pe),new Material(2)));return power(div(de,new Material(le.length-1)),new Material(.5))}else throw new ModelError("You must have at least two elements to calculate the standard deviation.",{code:6022})})),defineFunction(te,"StdDev",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>te.varBank.stddev(ae)),defineFunction(te,"Correlation",{params:[{name:"Vector 1",needVector:!0},{name:"Vector 2",needVector:!0}]},ae=>{let se=toNum(ae[0]),ce=toNum(ae[1]);if(se.length()<=1)throw new ModelError("You must have at least two elements in your vectors to calculate their correlation.",{code:6023});if(se.length()!==ce.length())throw new ModelError("The vectors for Correlation() must be of the same size.",{code:6024});let le=te.varBank.mean([se]),pe=te.varBank.mean([ce]),de=te.varBank.stddev([se]),me=te.varBank.stddev([ce]);return de.value===0||me.value===0?new Material(0):div(te.varBank.sum([mult(minus(se.clone(),le),minus(ce.clone(),pe))]),mult(minus(te.varBank.count([se]),new Material(1)),mult(de,me)))}),te.varBank.count=function(ae){return ae=te.varBank.join(ae).items,new Material(ae.length)},te.varBank.flatten=function(ae){let se=ue(te.varBank.join(ae));return new Vector(se.items,te,se.hasName?se.names:void 0)},defineFunction(te,"Keys",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>ae[0].names?new Vector(ae[0].names.filter(se=>se!==void 0).map(se=>stringify$1(se,te)),te):new Vector([],te)),defineFunction(te,"Values",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>new Vector(ae[0].items,te)),defineFunction(te,"Length",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>new Material(ae[0].items.length)),defineFunction(te,"Count",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>new Material(ae[0].items.length)),defineFunction(te,"Flatten",{object:VectorObject,params:[{name:"Vector",needVector:!0}]},ae=>te.varBank.flatten(ae));function ue(ae){let se=[],ce=[],le;for(let pe=0;pe<ae.length();pe++)if(ae.items[pe]instanceof Vector){let de=ue(ae.items[pe]);se=se.concat(de.items),ce=ce.concat(de.names),le=le||de.hasName}else se.push(ae.items[pe]),ae.names?(ce.push(ae.names[pe]),le=!0):ce.push(void 0);return{items:se,names:ce,hasName:le}}defineFunction(te,"CDFNormal",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Mean",defaultVal:0,noUnits:!0,noVector:!0},{name:"Standard Deviation",defaultVal:1,noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=ae[1]?toNum(ae[1]).value:0,le=ae[2]?toNum(ae[2]).value:1;return new Material(jStat.normal.cdf(se,ce,le))}),defineFunction(te,"PDFNormal",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Mean",defaultVal:0,noUnits:!0,noVector:!0},{name:"Standard Deviation",defaultVal:1,noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=ae[1]?toNum(ae[1]).value:0,le=ae[2]?toNum(ae[2]).value:1;return new Material(jStat.normal.pdf(se,ce,le))}),defineFunction(te,"InvNormal",{params:[{name:"p",noUnits:!0,noVector:!0},{name:"Mean",defaultVal:0,noUnits:!0,noVector:!0},{name:"Standard Deviation",defaultVal:1,noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value;if(se<0||se>1)throw new ModelError("<i>p</i> is a probability and must be between 0 and 1 inclusive.",{code:6025});let ce=ae[1]?toNum(ae[1]).value:0,le=ae[2]?toNum(ae[2]).value:1;return new Material(jStat.normal.inv(se,ce,le))}),defineFunction(te,"CDFLogNormal",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Mean",defaultVal:0,noUnits:!0,noVector:!0},{name:"Standard Deviation",defaultVal:1,noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=ae[1]?toNum(ae[1]).value:0,le=ae[2]?toNum(ae[2]).value:1;return new Material(jStat.lognormal.cdf(se,ce,le))}),defineFunction(te,"PDFLogNormal",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Mean",defaultVal:0,noUnits:!0,noVector:!0},{name:"Standard Deviation",defaultVal:1,noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=ae[1]?toNum(ae[1]).value:0,le=ae[2]?toNum(ae[2]).value:1;return new Material(jStat.lognormal.pdf(se,ce,le))}),defineFunction(te,"InvLogNormal",{params:[{name:"p",noUnits:!0,noVector:!0},{name:"Mean",defaultVal:0,noUnits:!0,noVector:!0},{name:"Standard Deviation",defaultVal:1,noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value;if(se<0||se>1)throw new ModelError("<i>p</i> is a probability and must be between 0 and 1 inclusive.",{code:6026});let ce=ae[1]?toNum(ae[1]).value:0,le=ae[2]?toNum(ae[2]).value:1;return new Material(jStat.lognormal.inv(se,ce,le))}),defineFunction(te,"CDFt",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Degrees of Freedom",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Degrees of Freedom</i> must be greater than 0.",{code:6027});return new Material(jStat.studentt.cdf(se,ce))}),defineFunction(te,"PDFt",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Degrees of Freedom",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Degrees of Freedom</i> must be greater than 0.",{code:6028});return new Material(jStat.studentt.pdf(se,ce))}),defineFunction(te,"Invt",{params:[{name:"p",noUnits:!0,noVector:!0},{name:"Degrees of Freedom",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value;if(se<0||se>1)throw new ModelError("<i>p</i> is a probability and must be between 0 and 1 inclusive.",{code:6029});let ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Degrees of Freedom</i> must be greater than 0.",{code:6030});return new Material(jStat.studentt.inv(se,ce))}),defineFunction(te,"CDFF",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Degrees of Freedom 1",noUnits:!0,noVector:!0},{name:"Degrees of Freedom 2",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Degrees of Freedom</i> must be greater than 0.",{code:6031});let le=toNum(ae[2]).value;if(le<=0)throw new ModelError("<i>Degrees of Freedom</i> must be greater than 0.",{code:6032});return new Material(jStat.centralF.cdf(se,ce,le))}),defineFunction(te,"PDFF",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Degrees of Freedom 1",noUnits:!0,noVector:!0},{name:"Degrees of Freedom 2",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Degrees of Freedom 1</i> must be greater than 0.",{code:6033});let le=toNum(ae[2]).value;if(le<=0)throw new ModelError("<i>Degrees of Freedom 2</i> must be greater than 0.",{code:6034});return new Material(jStat.centralF.pdf(se,ce,le))}),defineFunction(te,"InvF",{params:[{name:"p",noUnits:!0,noVector:!0},{name:"Degrees of Freedom 1",noUnits:!0,noVector:!0},{name:"Degrees of Freedom 2",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value;if(se<0||se>1)throw new ModelError("<i>p</i> is a probability and must be between 0 and 1 inclusive.",{code:6035});let ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Degrees of Freedom 1</i> must be greater than 0.",{code:6036});let le=toNum(ae[2]).value;if(le<=0)throw new ModelError("<i>Degrees of Freedom</i> must be greater than 0.",{code:6037});return new Material(jStat.centralF.inv(se,ce,le))}),defineFunction(te,"CDFChiSquared",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Degrees of Freedom",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Degrees of Freedom</i> must be greater than 0.",{code:6038});return new Material(jStat.chisquare.cdf(se,ce))}),defineFunction(te,"PDFChiSquared",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Degrees of Freedom",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Degrees of Freedom</i> must be greater than 0.",{code:6039});return new Material(jStat.chisquare.pdf(se,ce))}),defineFunction(te,"InvChiSquared",{params:[{name:"p",noUnits:!0,noVector:!0},{name:"Degrees of Freedom",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value;if(se<0||se>1)throw new ModelError("<i>p</i> is a probability and must be between 0 and 1 inclusive.",{code:6040});let ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Degrees of Freedom</i> must be greater than 0.",{code:6041});return new Material(jStat.chisquare.inv(se,ce))}),defineFunction(te,"CDFExponential",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Rate",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Rate</i> must be greater than 0.",{code:6042});return new Material(jStat.exponential.cdf(se,ce))}),defineFunction(te,"PDFExponential",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Rate",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Rate</i> must be greater than 0.",{code:6043});return new Material(jStat.exponential.pdf(se,ce))}),defineFunction(te,"InvExponential",{params:[{name:"p",noUnits:!0,noVector:!0},{name:"DRate",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value;if(se<0||se>1)throw new ModelError("<i>p</i> is a probability and must be between 0 and 1 inclusive.",{code:6044});let ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Rate</i> must be greater than 0.",{code:6045});return new Material(jStat.exponential.inv(se,ce))}),defineFunction(te,"CDFPoisson",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Lambda",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Lambda</i> must be greater than 0.",{code:6046});return new Material(jStat.poisson.cdf(se,ce))}),defineFunction(te,"PMFPoisson",{params:[{name:"x",noUnits:!0,noVector:!0},{name:"Lambda",noUnits:!0,noVector:!0}]},ae=>{let se=toNum(ae[0]).value,ce=toNum(ae[1]).value;if(ce<=0)throw new ModelError("<i>Rate</i> must be greater than 0.",{code:6047});return new Material(jStat.poisson.pdf(se,ce))}),defineFunction(te,"SetRandSeed",{params:[{name:"Seed Number",noUnits:!0,noVector:!0}]},ae=>(te.random=new SeedRandom.seedrandom(toNum(ae[0]).value),stringify$1("Random Seed Set",te))),defineFunction(te,"Alert",{params:[{name:"Message",allowString:!0,allowBoolean:!0}]},ae=>{if(typeof alert>"u")throw new ModelError("Alert() is not implemented on this platform.",{code:6048});return alert(ae[0]),new Material(1)}),defineFunction(te,"Console",{params:[{name:"Message",allowString:!0,allowBoolean:!0}]},ae=>(console.log(ae[0]),new Material(1))),defineFunction(te,"Prompt",{params:[{name:"Message",allowString:!0,allowBoolean:!0},{name:"Default",defaultVal:"",allowString:!0,allowBoolean:!0}]},ae=>{if(typeof prompt>"u")throw new ModelError("Prompt() is not implemented on this platform.",{code:6049});let se=ae[1];return se instanceof Material&&!se.units&&(se=se.value),ae=prompt(ae[0],se),parseFloat(ae).toString()===ae?new Material(parseFloat(ae)):ae===null?new Material(0):stringify$1(ae,te)}),defineFunction(te,"Confirm",{params:[{name:"Message",allowString:!0,allowBoolean:!0}]},ae=>{if(typeof window>"u"||typeof window.confirm>"u")throw new ModelError("Confirm() is not implemented on this platform.",{code:6050});return window.confirm(ae[0])}),defineFunction(te,"Parse",{object:StringObject,params:[{name:"String",allowString:!0}]},ae=>new Material(parseFloat(ae[0]))),defineFunction(te,"Split",{object:StringObject,params:[{name:"String",needString:!0},{name:"Splitter",needString:!0}]},ae=>stringify$1(new Vector(ae[0].split(ae[1]),te),te)),defineFunction(te,"Join",{object:VectorObject,params:[{name:"String",needVector:!0},{name:"Joiner",needString:!0}]},ae=>stringify$1(ae[0].items.join(ae[1]),te)),defineFunction(te,"Trim",{object:StringObject,params:[{name:"String",needString:!0}],recurse:!0},ae=>stringify$1(ae[0].trim(),te)),defineFunction(te,"Range",{object:StringObject,params:[{name:"String",needString:!0},{name:"Indexes",noUnits:!0,allowVector:!0}]},ae=>{if(ae[1]instanceof Vector){let se="";for(let ce=0;ce<ae[1].items.length;ce++)se+=ae[0].charAt(toNum(ae[1].items[ce]).value-1);return stringify$1(se,te)}else return stringify$1(ae[0].charAt(toNum(ae[1]).value-1),te)}),defineFunction(te,"Length",{object:StringObject,params:[{name:"String",needString:!0}]},ae=>new Material(ae[0].length)),defineFunction(te,"IndexOf",{object:StringObject,params:[{name:"Haystack",needString:!0},{name:"Needle",needString:!0}]},ae=>new Material(ae[0].indexOf(ae[1])+1)),defineFunction(te,"Contains",{object:StringObject,params:[{name:"Haystack",needString:!0},{name:"Needle",needString:!0}]},ae=>!eq(StringObject.indexof(ae),new Material(0))),defineFunction(te,"Lowercase",{object:StringObject,params:[{name:"String",needString:!0}]},ae=>stringify$1(ae[0].toLowerCase(),te)),defineFunction(te,"Uppercase",{object:StringObject,params:[{name:"String",needString:!0}]},ae=>stringify$1(ae[0].toUpperCase(),te)),te.varBank.stringbase=makeObjectBase(StringObject,te),te.varBank.vectorbase=makeObjectBase(VectorObject,te)}function makeObjectBase(te,ee){let re=Object.keys(te),ne=[];for(let oe of re)ne.push(objectizeFunction(te[oe]));let ie=new Vector(ne,ee,re);return ie.parent=void 0,ie}function defineFunction(te,ee,re,ne){let ie=re.params,oe=Array.isArray(ie),fe=[],ue=ie.length;for(let le=0;le<ie.length;le++)if("defaultVal"in ie[le]){ue=le;break}for(let le=0;le<ie.length;le++)if(ie[le].vectorize&&(fe.push(le),ie[le].noVector))throw new ModelError(`Cannot have a non-vector vectorized parameter. Function '${ee}', parameter '${ie[le].name}'.`,{code:6051});let ae,se;oe?(ae=ee+"("+ie.map(le=>le.name+("defaultVal"in le?"="+le.defaultVal.toString():"")).join(", ")+")",se=ee+"("+ie.slice(1).map(le=>le.name+("defaultVal"in le?"="+le.defaultVal.toString():"")).join(", ")+")"):(ae=ee+"(items...)",se=ee+"(items...)");let ce=function(le,pe,de,me={}){let ve;if(me.isObjectCaller?ve=se:ve=ae,re.prep&&(le=re.prep(le)),oe&&(le.length>ie.length||le.length<ue))throw new ModelError(`Wrong number of parameters for ${ve}.`,{code:6052});if(!oe&&!le.length&&!re.allowEmpty)throw new ModelError(`At least one parameter required for ${ee}().`,{code:6053});for(let ge=0;ge<le.length;ge++){let _e=oe?ie[ge]:ie;if(_e.noUnits&&toNum(le[ge])instanceof Material&&toNum(le[ge]).units&&!toNum(le[ge]).units.isUnitless())throw new ModelError(`${ve} does not accept units for the parameter '${_e.name}'.`,{code:6054});if(_e.noVector&&le[ge]instanceof Vector)throw new ModelError(`${ve} does not accept vectors for the parameter '${_e.name}'.`,{code:6055});if(_e.vectorize&&le[ge]instanceof Vector&&!le[ge].names)throw new ModelError(`${ve} does not accepted non-named vectors for the parameter '${_e.name}'.`,{code:6056});if(_e.needVector&&(le[ge]instanceof SPrimitive&&(le[ge]=toNum(le[ge])),!(le[ge]instanceof Vector)))throw new ModelError(`${ve} requires a vector for the parameter '${_e.name}'.`,{code:6057});if(_e.needNum&&(le[ge]instanceof SPrimitive&&(le[ge]=toNum(le[ge])),!(le[ge]instanceof Material)))throw new ModelError(`${ve} requires a number for the parameter '${_e.name}'.`,{code:6058});if(_e.needPrimitive&&!(le[ge]instanceof SPrimitive))throw new ModelError(`${ve} requires a primitive for the parameter '${_e.name}'.`,{code:6059});if(!_e.allowBoolean&&typeof le[ge]=="boolean")throw new ModelError(`${ve} does not accept boolean values for the parameter '${_e.name}'.`,{code:6060});if(_e.needAgent&&!(le[ge]instanceof SAgent)&&(le[ge]=agent(le[ge])),_e.needString&&!(typeof le[ge]=="string"||le[ge]instanceof String))throw new ModelError(`${ve} requires a string for the parameter '${_e.name}'.`,{code:6061});if(!_e.allowString&&!_e.needString&&(typeof le[ge]=="string"||le[ge]instanceof String))throw new ModelError(`${ve} does not accept string values for the parameter '${_e.name}'.`,{code:6062});if(_e.needAgents&&!(le[ge]instanceof SPopulation)&&(le[ge]=agents(le[ge])),_e.needPopulation&&!(le[ge]instanceof Vector)&&(le[ge]=getPopulation(le[ge],te)),_e.needFunction&&!(le[ge]instanceof Function||le[ge]instanceof UserFunction))throw new ModelError(`${ve} requires a function for the parameter '${_e.name}'.`,{code:6063})}let we;if(re.recurse&&(we=toNum(le[0]),ie[0]&&ie[0].leafNeedNum&&!(we instanceof Vector)&&!(we instanceof Material)))throw new ModelError(`${ve} requires a number for the parameter '${ie[0].name}'.`,{code:6058});if(re.recurse&&we instanceof Vector)return we.cloneApply(ge=>{if(!(ge instanceof Vector)&&ie[0]&&ie[0].leafNeedNum&&!(ge instanceof Material))throw new ModelError(`${ve} requires a number for the parameter '${ie[0].name}'.`,{code:6058});return ce([ge].concat(le.slice(1)),pe)});if(fe.length>0){let ge,_e=-1;for(let Te=0;Te<fe.length;Te++)if(le[fe[Te]]){let Ne=toNum(le[fe[Te]]);if(Ne instanceof Vector&&Ne.namesLC){if(!ge)ge=Ne,_e=fe[Te];else if(!ge.keysMatch(Ne.namesLC))throw new ModelError(`Vector keys do not match between parameters '${ie[_e].name}' and '${ie[fe[Te]].name}' in ${ve}.`,{code:6064})}}if(ge){let Te=ge.namesLC,Ne=[];for(let Le=0;Le<Te.length;Le++){let Oe=[];for(let Se=0;Se<le.length;Se++)if(fe.indexOf(Se)===-1)Oe.push(le[Se]);else{let be=toNum(le[Se]);be instanceof Vector&&be.namesLC?Oe.push(be.select([Te[Le]])):Oe.push(be)}let xe=ne(Oe,pe);if(xe instanceof Vector){if(!ge.keysMatch(xe.namesLC))throw new ModelError(`Vector keys do not match between parameter '${ie[_e].name}' and calculation result.`,{code:6065});Ne.push(xe.select([Te[Le]]))}else Ne.push(xe)}return new Vector(Ne,te,Te)}else return ne(le,pe)}else return ne(le,pe)};if(!re.object)te.varBank[ee.toLowerCase()]=ce;else if(re.object instanceof Array)for(let le=0;le<re.object.length;le++)re.object[le][ee.toLowerCase()]=ce;else re.object[ee.toLowerCase()]=ce;re.recurse&&(VectorObject[ee.toLowerCase()]=ce)}function objectizeFunction(te){let ee=function(re,ne,ie){if(!ie)throw new ModelError("Object function not used on object",{code:6066});return te([ie].concat(re),ne,ie,{isObjectCaller:!0})};return ee.delayEvalParams=te.delayEvalParams,ee}function factorial(te){if(Math.round(te)!==te)throw new ModelError("The factorial() function only accepts integers.",{code:6067});if(te<0)throw new ModelError("The factorial() function is only defined for integers 0 or larger.",{code:6068});return te>1?te*factorial(te-1):1}function testArgumentsSize(te,ee,re,ne){if(te.length<re||te.length>ne)throw new ModelError(`Wrong number of parameters for ${ee}().`,{code:6069})}let org={};(typeof org.antlr>"u"||!org.antlr)&&(org.antlr={});org.antlr.global={org};org.antlr.namespace=function(){var te=arguments,ee=null,re,ne,ie;for(re=0;re<te.length;re=re+1)for(ie=te[re].split("."),ee=org.antlr.global,ne=0;ne<ie.length;ne=ne+1)ee[ie[ne]]=ee[ie[ne]]||{},ee=ee[ie[ne]];return ee};org.antlr.env=org.antlr.env||{};org.antlr.env.ua=function(){var te={ie:0,opera:0,gecko:0,webkit:0,mobile:null,air:0,rhino:!1},ee,re;try{ee=navigator.userAgent,/KHTML/.test(ee)&&(te.webkit=1),re=ee.match(/AppleWebKit\/([^\s]*)/),re&&re[1]&&(te.webkit=parseFloat(re[1]),/ Mobile\//.test(ee)?te.mobile="Apple":(re=ee.match(/NokiaN[^\/]*/),re&&(te.mobile=re[0])),re=ee.match(/AdobeAIR\/([^\s]*)/),re&&(te.air=re[0])),te.webkit||(re=ee.match(/Opera[\s\/]([^\s]*)/),re&&re[1]?(te.opera=parseFloat(re[1]),re=ee.match(/Opera Mini[^;]*/),re&&(te.mobile=re[0])):(re=ee.match(/MSIE\s([^;]*)/),re&&re[1]?te.ie=parseFloat(re[1]):(re=ee.match(/Gecko\/([^\s]*)/),re&&(te.gecko=1,re=ee.match(/rv:([^\s\)]*)/),re&&re[1]&&(te.gecko=parseFloat(re[1]))))))}catch{}try{typeof window>"u"&&loadClass&&(te.rhino=!0)}catch{}return te}();org.antlr.namespace("org.antlr.runtime.tree");org.antlr.lang=org.antlr.lang||{isArray:function(te){if(te){var ee=org.antlr.lang;return ee.isNumber(te.length)&&ee.isFunction(te.splice)}return!1},isBoolean:function(te){return typeof te=="boolean"},isFunction:function(te){return typeof te=="function"},isNull:function(te){return te===null},isNumber:function(te){return typeof te=="number"&&isFinite(te)},isObject:function(te){return te&&(typeof te=="object"||org.antlr.lang.isFunction(te))||!1},isString:function(te){return typeof te=="string"},isUndefined:function(te){return typeof te>"u"},_IEEnumFix:function(te,ee){if(org.antlr.env.ua.ie){var re=["toString","valueOf"],ne;for(ne=0;ne<re.length;ne=ne+1){var ie=re[ne],oe=ee[ie];org.antlr.lang.isFunction(oe)&&oe!=Object.prototype[ie]&&(te[ie]=oe)}}},extend:function(te,ee,re){if(!ee||!te)throw new Error("org.antlr.lang.extend failed, please check that all dependencies are included.");var ne=function(){};if(ne.prototype=ee.prototype,te.prototype=new ne,te.prototype.constructor=te,te.superclass=ee.prototype,ee.prototype.constructor==Object.prototype.constructor&&(ee.prototype.constructor=ee),re){for(var ie in re)te.prototype[ie]=re[ie];org.antlr.lang._IEEnumFix(te.prototype,re)}},augmentObject:function(te,ee){if(!ee||!te)throw new Error("Absorb failed, verify dependencies.");var re=arguments,ne,ie,oe=re[2];if(oe&&oe!==!0)for(ne=2;ne<re.length;ne=ne+1)te[re[ne]]=ee[re[ne]];else{for(ie in ee)(oe||!te[ie])&&(te[ie]=ee[ie]);org.antlr.lang._IEEnumFix(te,ee)}},augmentProto:function(te,ee){if(!ee||!te)throw new Error("Augment failed, verify dependencies.");for(var re=[te.prototype,ee.prototype],ne=2;ne<arguments.length;ne=ne+1)re.push(arguments[ne]);org.antlr.lang.augmentObject.apply(this,re)},merge:function(){for(var te={},ee=arguments,re=0,ne=ee.length;re<ne;re=re+1)org.antlr.lang.augmentObject(te,ee[re],!0);return te},isValue:function(te){var ee=org.antlr.lang;return ee.isObject(te)||ee.isString(te)||ee.isNumber(te)||ee.isBoolean(te)},array:{peek:function(te){if(!org.antlr.lang.isArray(te))throw new Error("org.antlr.lang.array.peek: a is not an array.");var ee=te.length;if(ee<=0)throw new Error("org.antlr.lang.array.peek: a is empty.");return te[ee-1]}}};org.antlr.runtime.RecognizerSharedState=function(){this.following=[],this._fsp=-1,this.errorRecovery=!1,this.lastErrorIndex=-1,this.failed=!1,this.syntaxErrors=0,this.backtracking=0,this.ruleMemo=null,this.token=null,this.tokenStartCharIndex=-1,this.text=null};org.antlr.runtime.IndexOutOfBoundsException=function(te){org.antlr.runtime.IndexOutOfBoundsException.superclass.constructor.call(this,te)};org.antlr.lang.extend(org.antlr.runtime.IndexOutOfBoundsException,Error,{name:"org.antlr.runtime.IndexOutOfBoundsException"});org.antlr.runtime.RecognitionException=function(te){org.antlr.runtime.RecognitionException.superclass.constructor.call(this),this.input=te,this.index=te.index(),te instanceof org.antlr.runtime.CommonTokenStream&&(this.token=te.LT(1),this.line=this.token.getLine(),this.charPositionInLine=this.token.getCharPositionInLine()),te instanceof org.antlr.runtime.tree.TreeNodeStream?this.extractInformationFromTreeNodeStream(te):te instanceof org.antlr.runtime.ANTLRStringStream?(this.c=te.LA(1),this.line=te.getLine(),this.charPositionInLine=te.getCharPositionInLine()):this.c=te.LA(1),this.message=this.toString()};org.antlr.lang.extend(org.antlr.runtime.RecognitionException,Error,{input:null,index:null,token:null,node:null,c:null,line:null,name:"org.antlr.runtime.RecognitionException",charPositionInLine:null,approximateLineInfo:null,extractInformationFromTreeNodeStream:function(te){var ee=te,re,ne,ie,oe;this.node=ee.LT(1);var fe=ee.getTreeAdaptor(),ue=fe.getToken(this.node);if(ue)if(this.token=ue,ue.getLine()<=0)for(oe=-1,re=ee.LT(oe);re;){if(priorPayload=fe.getToken(re),priorPayload&&priorPayload.getLine()>0){this.line=priorPayload.getLine(),this.charPositionInLine=priorPayload.getCharPositionInLine(),this.approximateLineInfo=!0;break}--oe,re=ee.LT(oe)}else this.line=ue.getLine(),this.charPositionInLine=ue.getCharPositionInLine();else this.node instanceof org.antlr.runtime.tree.CommonTree?(this.line=this.node.getLine(),this.charPositionInLine=this.node.getCharPositionInLine(),this.node instanceof org.antlr.runtime.tree.CommonTree&&(this.token=this.node.token)):(ne=fe.getType(this.node),ie=fe.getText(this.node),this.token=new org.antlr.runtime.CommonToken(ne,ie))},getUnexpectedType:function(){if(this.input instanceof org.antlr.runtime.CommonTokenStream)return this.token.getType();if(this.input instanceof org.antlr.runtime.tree.TreeNodeStream){var te=this.input,ee=te.getTreeAdaptor();return ee.getType(this.node)}else return this.c}});org.antlr.runtime.MismatchedTokenException=function(te,ee){arguments.length===0?this.expecting=org.antlr.runtime.Token.INVALID_TOKEN_TYPE:(org.antlr.runtime.MismatchedTokenException.superclass.constructor.call(this,ee),this.expecting=te)};org.antlr.lang.extend(org.antlr.runtime.MismatchedTokenException,org.antlr.runtime.RecognitionException,{toString:function(){return"MismatchedTokenException("+this.getUnexpectedType()+"!="+this.expecting+")"},name:"org.antlr.runtime.MismatchedTokenException"});org.antlr.runtime.UnwantedTokenException=function(te,ee){arguments.length>0&&org.antlr.runtime.UnwantedTokenException.superclass.constructor.call(this,te,ee)};org.antlr.lang.extend(org.antlr.runtime.UnwantedTokenException,org.antlr.runtime.MismatchedTokenException,{getUnexpectedToken:function(){return this.token},toString:function(){var te=", expected "+this.expecting;return this.expecting===org.antlr.runtime.Token.INVALID_TOKEN_TYPE&&(te=""),org.antlr.lang.isValue(this.token)?"UnwantedTokenException(found="+this.token.getText()+te+")":"UnwantedTokenException(found="+te+")"},name:"org.antlr.runtime.UnwantedTokenException"});org.antlr.runtime.MissingTokenException=function(te,ee,re){arguments.length>0&&(org.antlr.runtime.MissingTokenException.superclass.constructor.call(this,te,ee),this.inserted=re)};org.antlr.lang.extend(org.antlr.runtime.MissingTokenException,org.antlr.runtime.MismatchedTokenException,{getMissingType:function(){return this.expecting},toString:function(){return org.antlr.lang.isValue(this.inserted)&&org.antlr.lang.isValue(this.token)?"MissingTokenException(inserted "+this.inserted+" at "+this.token.getText()+")":org.antlr.lang.isValue(this.token)?"MissingTokenException(at "+this.token.getText()+")":"MissingTokenException"},name:"org.antlr.runtime.MissingTokenException"});org.antlr.runtime.NoViableAltException=function(te,ee,re,ne){org.antlr.runtime.NoViableAltException.superclass.constructor.call(this,ne),this.grammarDecisionDescription=te,this.decisionNumber=ee,this.stateNumber=re};org.antlr.lang.extend(org.antlr.runtime.NoViableAltException,org.antlr.runtime.RecognitionException,{toString:function(){return this.input instanceof org.antlr.runtime.ANTLRStringStream?"NoViableAltException('"+this.getUnexpectedType()+"'@["+this.grammarDecisionDescription+"])":"NoViableAltException("+this.getUnexpectedType()+"@["+this.grammarDecisionDescription+"])"},name:"org.antlr.runtime.NoViableAltException"});org.antlr.runtime.EarlyExitException=function(te,ee){org.antlr.runtime.EarlyExitException.superclass.constructor.call(this,ee),this.decisionNumber=te};org.antlr.lang.extend(org.antlr.runtime.EarlyExitException,org.antlr.runtime.RecognitionException,{name:"org.antlr.runtime.EarlyExitException"});org.antlr.runtime.MismatchedSetException=function(te,ee){org.antlr.runtime.MismatchedSetException.superclass.constructor.call(this,ee),this.expecting=te};org.antlr.lang.extend(org.antlr.runtime.MismatchedSetException,org.antlr.runtime.RecognitionException,{toString:function(){return"MismatchedSetException("+this.getUnexpectedType()+"!="+this.expecting+")"},name:"org.antlr.runtime.MismatchedSetException"});org.antlr.runtime.MismatchedNotSetException=function(te,ee){org.antlr.runtime.MismatchedNotSetException.superclass.constructor.call(this,te,ee)};org.antlr.lang.extend(org.antlr.runtime.MismatchedNotSetException,org.antlr.runtime.MismatchedSetException,{toString:function(){return"MismatchedNotSetException("+this.getUnexpectedType()+"!="+this.expecting+")"},name:"org.antlr.runtime.MismatchedNotSetException"});org.antlr.runtime.MismatchedRangeException=function(te,ee,re){if(arguments.length===0)return this;org.antlr.runtime.MismatchedRangeException.superclass.constructor.call(this,re),this.a=te,this.b=ee};org.antlr.lang.extend(org.antlr.runtime.MismatchedRangeException,org.antlr.runtime.RecognitionException,{toString:function(){return"MismatchedRangeException("+this.getUnexpectedType()+" not in ["+this.a+","+this.b+"])"},name:"org.antlr.runtime.MismatchedRangeException"});org.antlr.runtime.FailedPredicateException=function(te,ee,re){org.antlr.runtime.FailedPredicateException.superclass.constructor.call(this,te),this.ruleName=ee,this.predicateText=re};org.antlr.lang.extend(org.antlr.runtime.FailedPredicateException,org.antlr.runtime.RecognitionException,{toString:function(){return"FailedPredicateException("+this.ruleName+",{"+this.predicateText+"}?)"},name:"org.antlr.runtime.FailedPredicateException"});org.antlr.runtime.BitSet=function(te){te||(te=org.antlr.runtime.BitSet.BITS),org.antlr.lang.isArray(te)?this.bits=te:org.antlr.lang.isNumber(te)&&(this.bits=[])};org.antlr.lang.augmentObject(org.antlr.runtime.BitSet,{BITS:32,LOG_BITS:5,MOD_MASK:31,bitMask:function(te){var ee=te&org.antlr.runtime.BitSet.MOD_MASK;return 1<<ee},numWordsToHold:function(te){return(te>>org.antlr.runtime.BitSet.LOG_BITS)+1},wordNumber:function(te){return te>>org.antlr.runtime.BitSet.LOG_BITS},of:function(te,ee){var re,ne,ie,oe;if(org.antlr.lang.isNumber(te))if(org.antlr.lang.isNumber(ee)){for(ie=new org.antlr.runtime.BitSet(ee+1),re=te;re<=ee;re++)ne=org.antlr.runtime.BitSet.wordNumber(re),ie.bits[ne]|=org.antlr.runtime.BitSet.bitMask(re);return ie}else return ie=new org.antlr.runtime.BitSet(te+1),ie.add(te),ie;else if(org.antlr.lang.isArray(te)){for(ie=new org.antlr.runtime.BitSet,re=te.length-1;re>=0;re--)ie.add(te[re]);return ie}else{if(te instanceof org.antlr.runtime.BitSet)return te||null;if(te instanceof org.antlr.runtime.IntervalSet)return te?(ie=new org.antlr.runtime.BitSet,ie.addAll(te),ie):null;if(org.antlr.lang.isObject(te)){oe=[];for(re in te)org.antlr.lang.isNumber(re)&&oe.push(re);return org.antlr.runtime.BitSet.of(oe)}}}});org.antlr.runtime.BitSet.prototype={add:function(te){var ee=org.antlr.runtime.BitSet.wordNumber(te);ee>=this.bits.length&&this.growToInclude(te),this.bits[ee]|=org.antlr.runtime.BitSet.bitMask(te)},addAll:function(te){var ee,re;if(te instanceof org.antlr.runtime.BitSet)this.orInPlace(te);else if(!(te instanceof org.antlr.runtime.IntervalSet))if(org.antlr.lang.isArray(te))for(ee=0;ee<te.length;ee++)re=te[ee],this.add(re);else return},and:function(te){var ee=this.clone();return ee.andInPlace(te),ee},andInPlace:function(te){var ee=Math.min(this.bits.length,te.bits.length),re;for(re=ee-1;re>=0;re--)this.bits[re]&=te.bits[re];for(re=ee;re<this.bits.length;re++)this.bits[re]=0},clear:function(te){if(arguments.length===0){var ee;for(ee=this.bits.length-1;ee>=0;ee--)this.bits[ee]=0;return}var re=org.antlr.runtime.BitSet.wordNumber(te);re>=this.bits.length&&this.growToInclude(te),this.bits[re]&=~org.antlr.runtime.BitSet.bitMask(te)},clone:function(){var te,ee,re=[];for(te=0,ee=this.bits.length;te<ee;te++)re[te]=this.bits[te];return new org.antlr.runtime.BitSet(re)},size:function(){var te=0,ee,re,ne;for(ee=this.bits.length-1;ee>=0;ee--)if(re=this.bits[ee],re!==0)for(ne=org.antlr.runtime.BitSet.BITS-1;ne>=0;ne--)re&1<<ne&&te++;return te},equals:function(te){if(!te||!(te instanceof org.antlr.runtime.BitSet))return!1;var ee=te,re,ne=Math.min(this.bits.length,ee.bits.length);for(re=0;re<ne;re++)if(this.bits[re]!=ee.bits[re])return!1;if(this.bits.length>ne){for(re=ne+1;re<this.bits.length;re++)if(this.bits[re]!==0)return!1}else if(ee.bits.length>ne){for(re=ne+1;re<ee.bits.length;re++)if(ee.bits[re]!==0)return!1}return!0},growToInclude:function(te){Math.max(this.bits.length<<1,org.antlr.runtime.BitSet.numWordsToHold(te));var ee=[],re;for(re=0,len=this.bits.length;re<len;re++)ee[re]=this.bits[re];this.bits=ee},member:function(te){var ee=org.antlr.runtime.BitSet.wordNumber(te);return ee>=this.bits.length?!1:(this.bits[ee]&org.antlr.runtime.BitSet.bitMask(te))!==0},getSingleElement:function(){var te;for(te=0;te<this.bits.length<<org.antlr.runtime.BitSet.LOG_BITS;te++)if(this.member(te))return te;return-1},isNil:function(){var te;for(te=this.bits.length-1;te>=0;te--)if(this.bits[te]!==0)return!1;return!0},complement:function(te){if(te)return te.subtract(this);var ee=this.clone();return ee.notInPlace(),ee},notInPlace:function(){var te,ee,re,ne;if(arguments.length===0)for(re=this.bits.length-1;re>=0;re--)this.bits[re]=~this.bits[re];else for(arguments.length===1?(te=0,ee=arguments[0]):(te=arguments[0],ee=arguments[1]),this.growToInclude(ee),re=te;re<=ee;re++)ne=org.antlr.runtime.BitSet.wordNumber(re),this.bits[ne]^=org.antlr.runtime.BitSet.bitMask(re)},or:function(te){if(!te)return this;var ee=this.clone();return ee.orInPlace(te),ee},orInPlace:function(te){if(te){te.bits.length>this.bits.length&&this.setSize(te.bits.length);var ee=Math.min(this.bits.length,te.bits.length),re;for(re=ee-1;re>=0;re--)this.bits[re]|=te.bits[re]}},remove:function(te){var ee=org.antlr.runtime.BitSet.wordNumber(te);ee>=this.bits.length&&this.growToInclude(te),this.bits[ee]&=~org.antlr.runtime.BitSet.bitMask(te)},setSize:function(te){for(var ee=te-this.bits.length;ee>=0;)this.bits.push(0),ee--},numBits:function(){return this.bits.length<<org.antlr.runtime.BitSet.LOG_BITS},lengthInLongWords:function(){return this.bits.length},subset:function(te){return te?this.and(te).equals(this):!1},subtractInPlace:function(te){if(te){var ee;for(ee=0;ee<this.bits.length&&ee<te.bits.length;ee++)this.bits[ee]&=~te.bits[ee]}},subtract:function(te){if(!te||!(te instanceof org.antlr.runtime.BitSet))return null;var ee=this.clone();return ee.subtractInPlace(te),ee},toArray:function(){var te=[],ee,re=0;for(ee=0;ee<this.bits.length<<org.antlr.runtime.BitSet.LOG_BITS;ee++)this.member(ee)&&(te[re++]=ee);return te},toPackedArray:function(){return this.bits},toString:function(){return arguments.length===0?this.toString1(null):org.antlr.lang.isString(arguments[0])?org.antlr.lang.isValue(arguments[1])?this.toString2(arguments[0],arguments[1]):this.toString1(null):this.toString1(arguments[0])},toString1:function(te){var ee="{",re=",",ne,ie=!1;for(ne=0;ne<this.bits.length<<org.antlr.runtime.BitSet.LOG_BITS;ne++)this.member(ne)&&(ne>0&&ie&&(ee+=re),te?ee+=te.getTokenDisplayName(ne):ee+=ne.toString(),ie=!0);return ee+"}"},toString2:function(te,ee){var re="",ne;for(ne=0;ne<this.bits.length<<org.antlr.runtime.BitSet.LOG_BITS;ne++)this.member(ne)&&(re.length>0&&(re+=te),ne>=ee.size()?re+="'"+ne+"'":org.antlr.lang.isValue(ee.get(ne))?re+=ee.get(ne):re+="'"+ne+"'");return re}};org.antlr.runtime.CharStream={EOF:-1};org.antlr.runtime.CommonToken=function(){var te;this.charPositionInLine=-1,this.channel=0,this.index=-1,arguments.length==1?org.antlr.lang.isNumber(arguments[0])?this.type=arguments[0]:(te=arguments[0],this.text=te.getText(),this.type=te.getType(),this.line=te.getLine(),this.index=te.getTokenIndex(),this.charPositionInLine=te.getCharPositionInLine(),this.channel=te.getChannel(),te instanceof org.antlr.runtime.CommonToken&&(this.start=te.start,this.stop=te.stop)):arguments.length==2?(this.type=arguments[0],this.text=arguments[1],this.channel=0):arguments.length==5&&(this.input=arguments[0],this.type=arguments[1],this.channel=arguments[2],this.start=arguments[3],this.stop=arguments[4])};org.antlr.runtime.CommonToken.prototype={getType:function(){return this.type},setLine:function(te){this.line=te},getText:function(){return org.antlr.lang.isString(this.text)?this.text:this.input?(this.text=this.input.substring(this.start,this.stop),this.text):null},setText:function(te){this.text=te},getLine:function(){return this.line},getCharPositionInLine:function(){return this.charPositionInLine},setCharPositionInLine:function(te){this.charPositionInLine=te},getChannel:function(){return this.channel},setChannel:function(te){this.channel=te},setType:function(te){this.type=te},getStartIndex:function(){return this.start},setStartIndex:function(te){this.start=te},getStopIndex:function(){return this.stop},setStopIndex:function(te){this.stop=te},getTokenIndex:function(){return this.index},setTokenIndex:function(te){this.index=te},getInputStream:function(){return this.input},setInputStream:function(te){this.input=te},toString:function(){var te="";this.channel>0&&(te=",channel="+this.channel);var ee=this.getText();return org.antlr.lang.isNull(ee)?ee="<no text>":(ee=ee.replace(/\n/g,"\\\\n"),ee=ee.replace(/\r/g,"\\\\r"),ee=ee.replace(/\t/g,"\\\\t")),"[@"+this.getTokenIndex()+","+this.start+":"+this.stop+"='"+ee+"',<"+this.type+">"+te+","+this.line+":"+this.getCharPositionInLine()+"]"}};org.antlr.runtime.Token=function(){};org.antlr.lang.augmentObject(org.antlr.runtime.Token,{EOR_TOKEN_TYPE:1,DOWN:2,UP:3,MIN_TOKEN_TYPE:4,EOF:org.antlr.runtime.CharStream.EOF,EOF_TOKEN:new org.antlr.runtime.CommonToken(org.antlr.runtime.CharStream.EOF),INVALID_TOKEN_TYPE:0,INVALID_TOKEN:new org.antlr.runtime.CommonToken(0),SKIP_TOKEN:new org.antlr.runtime.CommonToken(0),DEFAULT_CHANNEL:0,HIDDEN_CHANNEL:99});org.antlr.lang.augmentObject(org.antlr.runtime.CommonToken,org.antlr.runtime.Token);org.antlr.runtime.tree.RewriteCardinalityException=function(te){this.elementDescription=te};org.antlr.lang.extend(org.antlr.runtime.tree.RewriteCardinalityException,Error,{getMessage:function(){return org.antlr.lang.isString(this.elementDescription)?this.elementDescription:null},name:function(){return"org.antlr.runtime.tree.RewriteCardinalityException"}});org.antlr.runtime.tree.RewriteEmptyStreamException=function(te){var ee=org.antlr.runtime.tree.RewriteEmptyStreamException.superclass;ee.constructor.call(this,te)};org.antlr.lang.extend(org.antlr.runtime.tree.RewriteEmptyStreamException,org.antlr.runtime.tree.RewriteCardinalityException,{name:function(){return"org.antlr.runtime.tree.RewriteEmptyStreamException"}});org.antlr.runtime.tree.RewriteEarlyExitException=function(te){var ee=org.antlr.runtime.tree.RewriteEarlyExitException.superclass;org.antlr.lang.isUndefined(te)&&(te=null),ee.constructor.call(this,te)};org.antlr.lang.extend(org.antlr.runtime.tree.RewriteEarlyExitException,org.antlr.runtime.tree.RewriteCardinalityException,{name:function(){return"org.antlr.runtime.tree.RewriteEarlyExitException"}});org.antlr.runtime.MismatchedTreeNodeException=function(te,ee){te&&ee&&(org.antlr.runtime.MismatchedTreeNodeException.superclass.constructor.call(this,ee),this.expecting=te)};org.antlr.lang.extend(org.antlr.runtime.MismatchedTreeNodeException,org.antlr.runtime.RecognitionException,{toString:function(){return"MismatchedTreeNodeException("+this.getUnexpectedType()+"!="+this.expecting+")"},name:"org.antlr.runtime.MismatchedTreeNodeException"});org.antlr.runtime.tree.BaseTree=function(){};org.antlr.runtime.tree.BaseTree.prototype={getChild:function(te){return!this.children||te>=this.children.length?null:this.children[te]},getChildren:function(){return this.children},getFirstChildWithType:function(te){var ee,re;for(ee=0;this.children&&ee<this.children.length;ee++)if(re=this.children[ee],re.getType()===te)return re;return null},getChildCount:function(){return this.children?this.children.length:0},addChild:function(te){if(org.antlr.lang.isValue(te)){var ee=te,re,ne,ie;if(ee.isNil()){if(this.children&&this.children==ee.children)throw new Error("attempt to add child list to itself");if(ee.children)if(this.children)for(re=ee.children.length,ne=0;ne<re;ne++)ie=ee.children[ne],this.children.push(ie),ie.setParent(this),ie.setChildIndex(this.children.length-1);else this.children=ee.children,this.freshenParentAndChildIndexes()}else this.children||(this.children=this.createChildrenList()),this.children.push(te),ee.setParent(this),ee.setChildIndex(this.children.length-1)}},addChildren:function(te){var ee,re;for(ee=0;ee<te.length;ee++)re=te[ee],this.addChild(re)},setChild:function(te,ee){if(ee){if(ee.isNil())throw new Error("Can't set single child to a list");this.children||(this.children=this.createChildrenList()),this.children[te]=ee,ee.setParent(this),ee.setChildIndex(te)}},deleteChild:function(te){if(!this.children)return null;if(te<0||te>=this.children.length)throw new Error("Index out of bounds.");var ee=this.children.splice(te,1)[0];return this.freshenParentAndChildIndexes(te),ee},replaceChildren:function(te,ee,re){if(!this.children)throw new Error("indexes invalid; no children in list");var ne=ee-te+1,ie,oe=re,fe=null;oe.isNil()?fe=oe.children:(fe=[],fe.push(oe)),ie=fe.length;var ue=fe.length,ae=ne-ie,se,ce,le,pe,de;if(ae===0)for(se=0,ce=te;ce<=ee;ce++)le=fe[se],this.children[ce]=le,le.setParent(this),le.setChildIndex(ce),se++;else if(ae>0){for(se=0;se<ue;se++)this.children[te+se]=fe[se];for(pe=te+ue,de=pe;de<=ee;de++)this.children.splice(pe,1)[0];this.freshenParentAndChildIndexes(te)}else{for(se=0;se<ne;se++)this.children[te+se]=fe[se];for(se=ne;se<ie;se++)this.children.splice(te+se,0,fe[se]);this.freshenParentAndChildIndexes(te)}},createChildrenList:function(){return[]},isNil:function(){return!1},freshenParentAndChildIndexes:function(te){org.antlr.lang.isNumber(te)||(te=0);var ee=this.getChildCount(),re,ne;for(re=te;re<ee;re++)ne=this.getChild(re),ne.setChildIndex(re),ne.setParent(this)},sanityCheckParentAndChildIndexes:function(te,ee){if(arguments.length===0&&(te=null,ee=-1),te!==this.getParent())throw new Error("parents don't match; expected "+te+" found "+this.getParent());if(ee!==this.getChildIndex())throw new Error("child indexes don't match; expected "+ee+" found "+this.getChildIndex());var re=this.getChildCount(),ne,ie;for(ne=0;ne<re;ne++)ie=this.getChild(ne),ie.sanityCheckParentAndChildIndexes(this,ne)},getChildIndex:function(){return 0},setChildIndex:function(te){},getParent:function(){return null},setParent:function(te){},getTree:function(){return this},toStringTree:function(){if(!this.children||this.children.length===0)return this.toString();var te="",ee,re;for(this.isNil()||(te+="(",te+=this.toString(),te+=" "),ee=0;this.children&&ee<this.children.length;ee++)re=this.children[ee],ee>0&&(te+=" "),te+=re.toStringTree();return this.isNil()||(te+=")"),te},getLine:function(){return 0},getCharPositionInLine:function(){return 0}};org.antlr.runtime.tree.CommonTree=function(te){this.startIndex=-1,this.stopIndex=-1,this.childIndex=-1,this.parent=null,this.token=null,te instanceof org.antlr.runtime.tree.CommonTree?(org.antlr.runtime.tree.CommonTree.superclass.constructor.call(this,te),this.token=te.token,this.startIndex=te.startIndex,this.stopIndex=te.stopIndex):te instanceof org.antlr.runtime.CommonToken&&(this.token=te)};org.antlr.lang.extend(org.antlr.runtime.tree.CommonTree,org.antlr.runtime.tree.BaseTree,{getToken:function(){return this.token},dupNode:function(){return new org.antlr.runtime.tree.CommonTree(this)},isNil:function(){return!this.token},getType:function(){return this.token?this.token.getType():org.antlr.runtime.Token.INVALID_TOKEN_TYPE},getText:function(){return this.token?this.token.getText():null},getLine:function(){return!this.token||this.token.getLine()===0?this.getChildCount()>0?this.getChild(0).getLine():0:this.token.getLine()},getCharPositionInLine:function(){return!this.token||this.token.getCharPositionInLine()===-1?this.getChildCount()>0?this.getChild(0).getCharPositionInLine():0:this.token.getCharPositionInLine()},getTokenStartIndex:function(){return this.token?this.token.getTokenIndex():this.startIndex},setTokenStartIndex:function(te){this.startIndex=te},getTokenStopIndex:function(){return this.token?this.token.getTokenIndex():this.stopIndex},setTokenStopIndex:function(te){this.stopIndex=te},getChildIndex:function(){return this.childIndex},getParent:function(){return this.parent},setParent:function(te){this.parent=te},setChildIndex:function(te){this.childIndex=te},toString:function(){return this.isNil()?"nil":this.getType()===org.antlr.runtime.Token.INVALID_TOKEN_TYPE?"<errornode>":this.token?this.token.getText():null}});org.antlr.runtime.tree.Tree={INVALID_NODE:new org.antlr.runtime.tree.CommonTree(org.antlr.runtime.Token.INVALID_TOKEN)};org.antlr.runtime.tree.CommonErrorNode=function(te,ee,re,ne){(!re||re.getTokenIndex()<ee.getTokenIndex()&&re.getType()!=org.antlr.runtime.Token.EOF)&&(re=ee),this.input=te,this.start=ee,this.stop=re,this.trappedException=ne};org.antlr.lang.extend(org.antlr.runtime.tree.CommonErrorNode,org.antlr.runtime.tree.CommonTree,{isNil:function(){return!1},getType:function(){return org.antlr.runtime.Token.INVALID_TOKEN_TYPE},getText:function(){var te=null;if(this.start instanceof org.antlr.runtime.CommonToken){var ee=this.start.getTokenIndex(),re=this.stop.getTokenIndex();this.stop.getType()===org.antlr.runtime.Token.EOF&&(re=this.input.size()),te=this.input.toString(ee,re)}else this.start instanceof org.antlr.runtime.tree.CommonTree?te=this.input.toString(this.start,this.stop):te="<unknown>";return te},toString:function(){return this.trappedException instanceof org.antlr.runtime.MissingTokenException?"<missing type: "+this.trappedException.getMissingType()+">":this.trappedException instanceof org.antlr.runtime.UnwantedTokenException?"<extraneous: "+this.trappedException.getUnexpectedToken()+", resync="+this.getText()+">":this.trappedException instanceof org.antlr.runtime.MismatchedTokenException?"<mismatched token: "+this.trappedException.token+", resync="+this.getText()+">":this.trappedException instanceof org.antlr.runtime.NoViableAltException?"<unexpected: "+this.trappedException.token+", resync="+this.getText()+">":"<error: "+this.getText()+">"}});org.antlr.runtime.tree.BaseTreeAdaptor=function(){this.uniqueNodeID=1};org.antlr.runtime.tree.BaseTreeAdaptor.prototype={nil:function(){return this.create(null)},errorNode:function(te,ee,re,ne){var ie=new org.antlr.runtime.tree.CommonErrorNode(te,ee,re,ne);return ie},isNil:function(te){return te.isNil()},dupTree:function(te,ee){if(arguments.length===1&&(ee=null),!te)return null;var re=this.dupNode(te);this.setChildIndex(re,this.getChildIndex(te)),this.setParent(re,ee);var ne=this.getChildCount(te),ie,oe,fe;for(ie=0;ie<ne;ie++)oe=this.getChild(te,ie),fe=this.dupTree(oe,te),this.addChild(re,fe);return re},addChild:function(te,ee){te&&org.antlr.lang.isValue(ee)&&te.addChild(ee)},becomeRoot:function(te,ee){(te instanceof org.antlr.runtime.CommonToken||!te)&&(te=this.create(te));var re=te,ne=ee;if(!ee)return te;if(re.isNil()){if(re.getChildCount()>1)throw new Error("more than one node as root (TODO: make exception hierarchy)");re=re.getChild(0)}return re.addChild(ne),re},rulePostProcessing:function(te){var ee=te;return ee&&ee.isNil()&&(ee.getChildCount()===0?ee=null:ee.getChildCount()===1&&(ee=ee.getChild(0),ee.setParent(null),ee.setChildIndex(-1))),ee},create:function(te,ee){var re,ne;if(arguments.length===2)return org.antlr.lang.isString(arguments[1])?(re=arguments[1],ee=this.createToken(te,re),ne=this.create(ee),ne):(ee=this.createToken(ee),ee.setType(te),ne=this.create(ee),ne);if(arguments.length===3)return re=arguments[2],ee=this.createToken(ee),ee.setType(te),ee.setText(re),ne=this.create(ee),ne},getType:function(te){return te.getType(),0},setType:function(te,ee){throw new Error("don't know enough about Tree node")},getText:function(te){return te.getText()},setText:function(te,ee){throw new Error("don't know enough about Tree node")},getChild:function(te,ee){return te.getChild(ee)},setChild:function(te,ee,re){te.setChild(ee,re)},deleteChild:function(te,ee){return te.deleteChild(ee)},getChildCount:function(te){return te.getChildCount()},getUniqueID:function(te){this.treeToUniqueIDMap||(this.treeToUniqueIDMap={});var ee=this.treeToUniqueIDMap[te];if(org.antlr.lang.isValue(ee))return ee;var re=this.uniqueNodeID;return this.treeToUniqueIDMap[te]=re,this.uniqueNodeID++,re}};org.antlr.runtime.tree.CommonTreeAdaptor=function(){};org.antlr.lang.extend(org.antlr.runtime.tree.CommonTreeAdaptor,org.antlr.runtime.tree.BaseTreeAdaptor,{dupNode:function(te){return org.antlr.lang.isValue(te)?te.dupNode():null},create:function(te){return arguments.length>1?org.antlr.runtime.tree.CommonTreeAdaptor.superclass.create.apply(this,arguments):new org.antlr.runtime.tree.CommonTree(te)},createToken:function(te){return arguments.length===2?new org.antlr.runtime.CommonToken(arguments[0],arguments[1]):new org.antlr.runtime.CommonToken(arguments[0])},setTokenBoundaries:function(te,ee,re){if(org.antlr.lang.isValue(te)){var ne=0,ie=0;org.antlr.lang.isValue(ee)&&(ee.getTokenIndex?ne=ee.getTokenIndex():ee.getStartIndex?ne=ee.getStartIndex():ne=ee.getTokenStartIndex()),org.antlr.lang.isValue(re)&&(ie.getTokenIndex?ie=re.getTokenIndex():re.getStopIndex?ie=re.getStopIndex():ie=re.getTokenStopIndex()),te.setTokenStartIndex(ne),te.setTokenStopIndex(ie)}},getTokenStartIndex:function(te){return te?te.getTokenStartIndex():-1},getTokenStopIndex:function(te){return te?te.getTokenStopIndex():-1},getText:function(te){return te?te.getText():null},getType:function(te){return te?te.getType():org.antlr.runtime.Token.INVALID_TOKEN_TYPE},getToken:function(te){return te instanceof org.antlr.runtime.tree.CommonTree?te.getToken():null},getChild:function(te,ee){return te?te.getChild(ee):null},getChildCount:function(te){return te?te.getChildCount():0},getParent:function(te){return te.getParent()},setParent:function(te,ee){te.setParent(ee)},getChildIndex:function(te){return te.getChildIndex()},setChildIndex:function(te,ee){te.setChildIndex(ee)},replaceChildren:function(te,ee,re,ne){te&&te.replaceChildren(ee,re,ne)}});org.antlr.runtime.ANTLRStringStream=function(te){this.p=0,this.line=1,this.charPositionInLine=0,this.markDepth=0,this.markers=null,this.lastMarker=null,this.data=te,this.n=te.length};org.antlr.runtime.ANTLRStringStream.prototype={reset:function(){this.p=0,this.line=1,this.charPositionInLine=0,this.markDepth=0},consume:function(){this.p<this.n&&(this.charPositionInLine++,this.data.charAt(this.p)===`
`&&(this.line++,this.charPositionInLine=0),this.p++)},LA:function(te){te<0&&te++;var ee=this.p+te-1;return ee>=this.n||ee<0?org.antlr.runtime.CharStream.EOF:this.data.charAt(ee)},index:function(){return this.p},size:function(){return this.n},mark:function(){this.markers||(this.markers=[],this.markers.push(null)),this.markDepth++;var te=null;return this.markDepth>=this.markers.length?(te={},this.markers.push(te)):te=this.markers[this.markDepth],te.p=this.p,te.line=this.line,te.charPositionInLine=this.charPositionInLine,this.lastMarker=this.markDepth,this.markDepth},rewind:function(te){org.antlr.lang.isNumber(te)||(te=this.lastMarker);var ee=this.markers[te];this.seek(ee.p),this.line=ee.line,this.charPositionInLine=ee.charPositionInLine,this.release(te)},release:function(te){this.markDepth=te,this.markDepth--},seek:function(te){if(te<=this.p){this.p=te;return}for(;this.p<te;)this.consume()},substring:function(te,ee){return this.data.substr(te,ee-te+1)},getLine:function(){return this.line},getCharPositionInLine:function(){return this.charPositionInLine},setLine:function(te){this.line=te},setCharPositionInLine:function(te){this.charPositionInLine=te},getSourceName:function(){return null}};org.antlr.runtime.ANTLRStringStream.LT=org.antlr.runtime.ANTLRStringStream.LA;org.antlr.runtime.CommonTokenStream=function(te,ee){this.p=-1,this.channel=org.antlr.runtime.Token.DEFAULT_CHANNEL,this.v_discardOffChannelTokens=!1,this.tokens=[],arguments.length>=2?this.channel=ee:arguments.length===1&&(this.tokenSource=te)};org.antlr.runtime.CommonTokenStream.prototype={setTokenSource:function(te){this.tokenSource=te,this.tokens=[],this.p=-1,this.channel=org.antlr.runtime.Token.DEFAULT_CHANNEL},fillBuffer:function(){for(var te=0,ee=this.tokenSource.nextToken(),re,ne;org.antlr.lang.isValue(ee)&&ee.getType()!=org.antlr.runtime.CharStream.EOF;)re=!1,this.channelOverrideMap&&(ne=this.channelOverrideMap[ee.getType()],org.antlr.lang.isValue(ne)&&ee.setChannel(ne)),(this.discardSet&&this.discardSet[ee.getType()]||this.v_discardOffChannelTokens&&ee.getChannel()!=this.channel)&&(re=!0),re||(ee.setTokenIndex(te),this.tokens.push(ee),te++),ee=this.tokenSource.nextToken();this.p=0,this.p=this.skipOffTokenChannels(this.p)},consume:function(){this.p<this.tokens.length&&(this.p++,this.p=this.skipOffTokenChannels(this.p))},skipOffTokenChannels:function(te){for(var ee=this.tokens.length;te<ee&&this.tokens[te].getChannel()!=this.channel;)te++;return te},skipOffTokenChannelsReverse:function(te){for(;te>=0&&this.tokens[te].getChannel()!=this.channel;)te--;return te},setTokenTypeChannel:function(te,ee){this.channelOverrideMap||(this.channelOverrideMap={}),this.channelOverrideMap[te]=ee},discardTokenType:function(te){this.discardSet||(this.discardSet={}),this.discardSet[te]=!0},discardOffChannelTokens:function(te){this.v_discardOffChannelTokens=te},getTokens:function(te,ee,re){if(this.p===-1&&this.fillBuffer(),arguments.length===0)return this.tokens;if(org.antlr.lang.isArray(re)?re=new org.antlr.runtime.BitSet(re):org.antlr.lang.isNumber(re)&&(re=org.antlr.runtime.BitSet.of(re)),ee>=this.tokens.length&&(ee=this.tokens.length-1),te<0&&(te=0),te>ee)return null;var ne=[],ie,oe;for(ie=te;ie<=ee;ie++)oe=this.tokens[ie],(!this.types||re.member(oe.getType()))&&ne.push(oe);return ne.length===0&&(ne=null),ne},LT:function(te){if(this.p===-1&&this.fillBuffer(),te===0)return null;if(te<0)return this.LB(-1*te);if(this.p+te-1>=this.tokens.length)return org.antlr.runtime.Token.EOF_TOKEN;for(var ee=this.p,re=1;re<te;)ee=this.skipOffTokenChannels(ee+1),re++;return ee>=this.tokens.length?org.antlr.runtime.Token.EOF_TOKEN:this.tokens[ee]},LB:function(te){if(this.p===-1&&this.fillBuffer(),te===0||this.p-te<0)return null;for(var ee=this.p,re=1;re<=te;)ee=this.skipOffTokenChannelsReverse(ee-1),re++;return ee<0?null:this.tokens[ee]},get:function(te){return this.tokens[te]},LA:function(te){return this.LT(te).getType()},mark:function(){return this.p===-1&&this.fillBuffer(),this.lastMarker=this.index(),this.lastMarker},release:function(te){},size:function(){return this.tokens.length},index:function(){return this.p},rewind:function(te){org.antlr.lang.isNumber(te)||(te=this.lastMarker),this.seek(te)},reset:function(){this.p=-1,this.lastMarker=0},seek:function(te){this.p=te},getTokenSource:function(){return this.tokenSource},getSourceName:function(){return this.getTokenSource().getSourceName()},toString:function(te,ee){if(arguments.length===0&&(this.p===-1&&this.fillBuffer(),te=0,ee=this.tokens.length-1),!org.antlr.lang.isNumber(te)&&!org.antlr.lang.isNumber(ee))if(org.antlr.lang.isValue(te)&&org.antlr.lang.isValue(ee))te=te.getTokenIndex(),ee=ee.getTokenIndex();else return null;var re="",ne;if(te<0||ee<0)return null;for(this.p==-1&&this.fillBuffer(),ee>=this.tokens.length&&(ee=this.tokens.length-1),ne=te;ne<=ee;ne++)t=this.tokens[ne],re=re+this.tokens[ne].getText();return re}};org.antlr.runtime.TokenRewriteStream=function(){var te=org.antlr.runtime.TokenRewriteStream.superclass;this.programs=null,this.lastRewriteTokenIndexes=null,arguments.length===0?this.init():(te.constructor.apply(this,arguments),this.init())};(function(){var te=org.antlr.runtime.TokenRewriteStream;org.antlr.lang.augmentObject(te,{DEFAULT_PROGRAM_NAME:"default",PROGRAM_INIT_SIZE:100,MIN_TOKEN_INDEX:0}),te.RewriteOperation=function(ee,re){this.index=ee,this.text=re},te.RewriteOperation.prototype={execute:function(ee){return this.index},toString:function(){return this.text}},te.InsertBeforeOp=function(ee,re){te.InsertBeforeOp.superclass.constructor.call(this,ee,re)},org.antlr.lang.extend(te.InsertBeforeOp,te.RewriteOperation,{execute:function(ee){return ee.push(this.text),this.index}}),te.ReplaceOp=function(ee,re,ne){te.ReplaceOp.superclass.constructor.call(this,ee,ne),this.lastIndex=re},org.antlr.lang.extend(te.ReplaceOp,te.RewriteOperation,{execute:function(ee){return org.antlr.lang.isValue(this.text)&&ee.push(this.text),this.lastIndex+1}}),te.DeleteOp=function(ee,re){te.DeleteOp.superclass.constructor.call(this,ee,re)},org.antlr.lang.extend(te.DeleteOp,te.ReplaceOp),org.antlr.lang.extend(te,org.antlr.runtime.CommonTokenStream,{init:function(){this.programs={},this.programs[te.DEFAULT_PROGRAM_NAME]=[],this.lastRewriteTokenIndexes={}},rollback:function(){var ee;arguments.length===1?ee=te.DEFAULT_PROGRAM_NAME:arguments.length===2&&(ee=arguments[0]);var re=this.programs[ee];re&&(programs[ee]=re.slice(te.MIN_TOKEN_INDEX,this.instructionIndex))},deleteProgram:function(ee){ee=ee||te.DEFAULT_PROGRAM_NAME,this.rollback(ee,te.MIN_TOKEN_INDEX)},addToSortedRewriteList:function(){var ee,re;arguments.length===1?(ee=te.DEFAULT_PROGRAM_NAME,re=arguments[0]):arguments.length===2&&(ee=arguments[0],re=arguments[1]);var ne=this.getProgram(ee),ie,oe,fe,ue,ae,se;for(oe=0,ie=ne.length;oe<ie;oe++)if(fe=ne[oe],fe.index===re.index){if(re instanceof te.ReplaceOp){for(ue=!1,se=oe;se<ne.length&&(ae=ne[oe],ae.index===re.index);se++)if(ae instanceof te.ReplaceOp){ne[oe]=re,ue=!0;break}ue||ne.splice(se,0,re)}else ne.splice(oe,0,re);break}else if(fe.index>re.index){ne.splice(oe,0,re);break}oe===ie&&ne.push(re)},insertAfter:function(){var ee,re,ne;arguments.length===2?(re=te.DEFAULT_PROGRAM_NAME,ee=arguments[0],ne=arguments[1]):arguments.length===3&&(re=arguments[0],ee=arguments[1],ne=arguments[2]),ee instanceof org.antlr.runtime.CommonToken&&(ee=ee.index),this.insertBefore(re,ee+1,ne)},insertBefore:function(){var ee,re,ne;arguments.length===2?(re=te.DEFAULT_PROGRAM_NAME,ee=arguments[0],ne=arguments[1]):arguments.length===3&&(re=arguments[0],ee=arguments[1],ne=arguments[2]),ee instanceof org.antlr.runtime.CommonToken&&(ee=ee.index),this.addToSortedRewriteList(re,new te.InsertBeforeOp(ee,ne))},replace:function(){var ee,re,ne,ie;arguments.length===2?(ee=te.DEFAULT_PROGRAM_NAME,re=arguments[0],ne=arguments[0],ie=arguments[1]):arguments.length===3&&(ee=te.DEFAULT_PROGRAM_NAME,re=arguments[0],ne=arguments[1],ie=arguments[2]),arguments.length===4&&(ee=arguments[0],re=arguments[1],ne=arguments[2],ie=arguments[3]),re instanceof org.antlr.runtime.CommonToken&&(re=re.index),ne instanceof org.antlr.runtime.CommonToken&&(ne=ne.index),!(re>ne||ne<0||re<0)&&this.addToSortedRewriteList(ee,new te.ReplaceOp(re,ne,ie))},remove:function(){for(var ee=[],re=arguments.length-1;re>=0;)ee[re]=arguments[re],re--;ee.push(""),this.replace.apply(this,ee)},getLastRewriteTokenIndex:function(ee){return ee=ee||te.DEFAULT_PROGRAM_NAME,this.lastRewriteTokenIndexes[ee]||-1},setLastRewriteTokenIndex:function(ee,re){this.lastRewriteTokenIndexes[ee]=re},getProgram:function(ee){var re=this.programs[ee];return re||(re=this.initializeProgram(ee)),re},initializeProgram:function(ee){var re=[];return this.programs[ee]=re,re},toOriginalString:function(ee,re){org.antlr.lang.isNumber(ee)||(ee=te.MIN_TOKEN_INDEX),org.antlr.lang.isNumber(re)||(re=this.size()-1);var ne=[],ie;for(ie=ee;ie>=te.MIN_TOKEN_INDEX&&ie<=re&&ie<this.tokens.length;ie++)ne.push(this.get(ie).getText());return ne.join("")},toString:function(){var ee,re,ne;arguments.length===0?(ee=te.DEFAULT_PROGRAM_NAME,re=te.MIN_TOKEN_INDEX,ne=this.size()-1):arguments.length===1?(ee=arguments[0],re=te.MIN_TOKEN_INDEX,ne=this.size()-1):arguments.length===2&&(ee=te.DEFAULT_PROGRAM_NAME,re=arguments[0],ne=arguments[1]);var ie=this.programs[ee];if(!ie||ie.length===0)return this.toOriginalString(re,ne);for(var oe=0,fe=re,ue=[],ae;fe>=te.MIN_TOKEN_INDEX&&fe<=ne&&fe<this.tokens.length;){if(oe<ie.length){for(ae=ie[oe];ae.index<fe&&oe<ie.length;)oe++,oe<ie.length&&(ae=ie[oe]);for(;fe===ae.index&&oe<ie.length;)fe=ae.execute(ue),oe++,oe<ie.length&&(ae=ie[oe])}fe<=ne&&(ue.push(this.get(fe).getText()),fe++)}var se;for(se=oe;se<ie.length;se++)ae=ie[se],ae.index>=this.size()&&ae.execute(ue);return ue.join("")},toDebugString:function(ee,re){org.antlr.lang.isNumber(ee)||(ee=te.MIN_TOKEN_INDEX),org.antlr.lang.isNumber(re)||(re=this.size()-1);var ne=[],ie;for(ie=ee;ie>=te.MIN_TOKEN_INDEX&&ie<=re&&ie<this.tokens.length;ie++)ne.push(this.get(ie));return ne.join("")}})})();org.antlr.runtime.tree.TreeNodeStream=function(){};org.antlr.runtime.tree.CommonTreeNodeStream=function(te,ee,re){arguments.length===1&&(ee=te,te=new org.antlr.runtime.tree.CommonTreeAdaptor),arguments.length<=2&&(re=org.antlr.runtime.tree.CommonTreeNodeStream.DEFAULT_INITIAL_BUFFER_SIZE),this.uniqueNavigationNodes=!1,this.p=-1;var ne=org.antlr.runtime.Token;this.root=ee,this.adaptor=te,this.nodes=[],this.down=this.adaptor.create(ne.DOWN,"DOWN"),this.up=this.adaptor.create(ne.UP,"UP"),this.eof=this.adaptor.create(ne.EOF,"EOF")};org.antlr.lang.augmentObject(org.antlr.runtime.tree.CommonTreeNodeStream,{DEFAULT_INITIAL_BUFFER_SIZE:100,INITIAL_CALL_STACK_SIZE:10});org.antlr.lang.extend(org.antlr.runtime.tree.CommonTreeNodeStream,org.antlr.runtime.tree.TreeNodeStream,{StreamIterator:function(){var te=0,ee=this.nodes,re=this.eof;return{hasNext:function(){return te<ee.length},next:function(){var ne=te;return te++,ne<ee.length?ee[ne]:re},remove:function(){throw new Error("cannot remove nodes from stream")}}},fillBuffer:function(te){var ee=!1;org.antlr.lang.isUndefined(te)&&(te=this.root,ee=!0);var re=this.adaptor.isNil(te);re||this.nodes.push(te);var ne=this.adaptor.getChildCount(te);!re&&ne>0&&this.addNavigationNode(org.antlr.runtime.Token.DOWN);var ie,oe;for(ie=0;ie<ne;ie++)oe=this.adaptor.getChild(te,ie),this.fillBuffer(oe);!re&&ne>0&&this.addNavigationNode(org.antlr.runtime.Token.UP),ee&&(this.p=0)},getNodeIndex:function(te){this.p==-1&&this.fillBuffer();var ee,re;for(ee=0;ee<this.nodes.length;ee++)if(re=this.nodes[ee],re===te)return ee;return-1},addNavigationNode:function(te){var ee=null;te===org.antlr.runtime.Token.DOWN?this.hasUniqueNavigationNodes()?ee=this.adaptor.create(org.antlr.runtime.Token.DOWN,"DOWN"):ee=this.down:this.hasUniqueNavigationNodes()?ee=this.adaptor.create(org.antlr.runtime.Token.UP,"UP"):ee=this.up,this.nodes.push(ee)},get:function(te){return this.p===-1&&this.fillBuffer(),this.nodes[te]},LT:function(te){return this.p===-1&&this.fillBuffer(),te===0?null:te<0?this.LB(-1*te):this.p+te-1>=this.nodes.length?this.eof:this.nodes[this.p+te-1]},getCurrentSymbol:function(){return this.LT(1)},LB:function(te){return te===0||this.p-te<0?null:this.nodes[this.p-te]},getTreeSource:function(){return this.root},getSourceName:function(){return this.getTokenStream().getSourceName()},getTokenStream:function(){return this.tokens},setTokenStream:function(te){this.tokens=te},getTreeAdaptor:function(){return this.adaptor},setTreeAdaptor:function(te){this.adaptor=te},hasUniqueNavigationNodes:function(){return this.uniqueNavigationNodes},setUniqueNavigationNodes:function(te){this.uniqueNavigationNodes=te},consume:function(){this.p===-1&&this.fillBuffer(),this.p++},LA:function(te){return this.adaptor.getType(this.LT(te))},mark:function(){return this.p===-1&&this.fillBuffer(),this.lastMarker=this.index(),this.lastMarker},release:function(te){},index:function(){return this.p},rewind:function(te){org.antlr.lang.isNumber(te)||(te=this.lastMarker),this.seek(te)},seek:function(te){this.p===-1&&this.fillBuffer(),this.p=te},push:function(te){this.calls||(this.calls=[]),this.calls.push(this.p),this.seek(te)},pop:function(){var te=this.calls.pop();return this.seek(te),te},reset:function(){this.p=-1,this.lastMarker=0,this.calls&&(this.calls=[])},size:function(){return this.p===-1&&this.fillBuffer(),this.nodes.length},iterator:function(){return this.p===-1&&this.fillBuffer(),this.StreamIterator()},replaceChildren:function(te,ee,re,ne){te&&this.adaptor.replaceChildren(te,ee,re,ne)},toTokenString:function(te,ee){this.p===-1&&this.fillBuffer();var re="",ne,ie;for(ne=te;ne<this.nodes.length&&ne<=ee;ne++)ie=this.nodes[ne],re+=" "+this.adaptor.getToken(ie);return re},toString:function(te,ee){var re="",ne,ie,oe;if(arguments.length===0){for(this.p===-1&&this.fillBuffer(),oe=0;oe<this.nodes.length;oe++)ie=this.nodes[oe],re+=" ",re+=this.adaptor.getType(ie);return re}else{if(!org.antlr.lang.isNumber(te)||!org.antlr.lang.isNumber(ee))return null;this.p===-1&&this.fillBuffer(),te instanceof org.antlr.runtime.tree.CommonTree,ee instanceof org.antlr.runtime.tree.CommonTree;var fe,ue;if(this.tokens)return fe=this.adaptor.getTokenStartIndex(te),ue=this.adaptor.getTokenStopIndex(ee),this.adaptor.getType(ee)===org.antlr.runtime.Token.UP?ue=this.adaptor.getTokenStopIndex(te):this.adaptor.getType(ee)==org.antlr.runtime.Token.EOF&&(ue=this.size()-2),this.tokens.toString(fe,ue);for(ie=null,oe=0;oe<this.nodes.length&&(ie=this.nodes[oe],ie!==te);oe++);for(re=ne="",ie=this.nodes[oe];ie!==ee;)ne=this.adaptor.getText(ie),org.antlr.lang.isString(ne)||(ne=" "+this.adaptor.getType(ie).toString()),re+=ne,oe++,ie=nodes[oe];return ne=this.adaptor.getText(ee),org.antlr.lang.isString(ne)||(ne=" "+this.adaptor.getType(ee).toString()),re+=ne,re}}});org.antlr.runtime.tree.RewriteRuleElementStream=function(te,ee,re){this.cursor=0,this.dirty=!1,this.elementDescription=ee,this.adaptor=te,re&&(org.antlr.lang.isArray(re)?(this.singleElement=null,this.elements=re):this.add(re))};org.antlr.runtime.tree.RewriteRuleElementStream.prototype={reset:function(){this.cursor=0,this.dirty=!0},add:function(te){if(org.antlr.lang.isValue(te)){if(this.elements){this.elements.push(te);return}if(!org.antlr.lang.isValue(this.singleElement)){this.singleElement=te;return}this.elements=[],this.elements.push(this.singleElement),this.singleElement=null,this.elements.push(te)}},nextTree:function(){var te=this.size(),ee;return this.dirty||this.cursor>=te&&te==1?(ee=this._next(),this.dup(ee)):(ee=this._next(),ee)},_next:function(){var te=this.size();if(te===0)throw new org.antlr.runtime.tree.RewriteEmptyStreamException(this.elementDescription);if(this.cursor>=te){if(te===1)return this.toTree(this.singleElement);throw new org.antlr.runtime.tree.RewriteCardinalityException(this.elementDescription)}if(org.antlr.lang.isValue(this.singleElement))return this.cursor++,this.toTree(this.singleElement);var ee=this.toTree(this.elements[this.cursor]);return this.cursor++,ee},toTree:function(te){return te&&te.getTree?te.getTree():te},hasNext:function(){return org.antlr.lang.isValue(this.singleElement)&&this.cursor<1||this.elements&&this.cursor<this.elements.length},size:function(){var te=0;return org.antlr.lang.isValue(this.singleElement)&&(te=1),this.elements?this.elements.length:te},getDescription:function(){return this.elementDescription}};org.antlr.runtime.tree.RewriteRuleNodeStream=function(te,ee,re){org.antlr.runtime.tree.RewriteRuleNodeStream.superclass.constructor.apply(this,arguments)};org.antlr.lang.extend(org.antlr.runtime.tree.RewriteRuleNodeStream,org.antlr.runtime.tree.RewriteRuleElementStream,{nextNode:function(){return this._next()},toTree:function(te){return this.adaptor.dupNode(te)},dup:function(){throw new Error("dup can't be called for a node stream.")}});org.antlr.runtime.tree.RewriteRuleTokenStream=function(te,ee,re){var ne=org.antlr.runtime.tree.RewriteRuleTokenStream.superclass;ne.constructor.apply(this,arguments)};org.antlr.lang.extend(org.antlr.runtime.tree.RewriteRuleTokenStream,org.antlr.runtime.tree.RewriteRuleElementStream,{nextNode:function(){var te=this._next();return this.adaptor.create(te)},nextToken:function(){return this._next()},toTree:function(te){return te},dup:function(te){throw new Error("dup can't be called for a token stream.")}});org.antlr.runtime.tree.RewriteRuleSubtreeStream=function(){var te=org.antlr.runtime.tree.RewriteRuleSubtreeStream.superclass;te.constructor.apply(this,arguments)};org.antlr.lang.extend(org.antlr.runtime.tree.RewriteRuleSubtreeStream,org.antlr.runtime.tree.RewriteRuleElementStream,{nextNode:function(){var te=this.size(),ee;return this.dirty||this.cursor>=te&&te===1?(ee=this._next(),this.adaptor.dupNode(ee)):(ee=this._next(),ee)},dup:function(te){return this.adaptor.dupTree(te)}});org.antlr.runtime.BaseRecognizer=function(te){this.state=te||new org.antlr.runtime.RecognizerSharedState};org.antlr.lang.augmentObject(org.antlr.runtime.BaseRecognizer,{MEMO_RULE_FAILED:-2,MEMO_RULE_UNKNOWN:-1,INITIAL_FOLLOW_STACK_SIZE:100,MEMO_RULE_FAILED_I:-2,DEFAULT_TOKEN_CHANNEL:org.antlr.runtime.Token.DEFAULT_CHANNEL,HIDDEN:org.antlr.runtime.Token.HIDDEN_CHANNEL,NEXT_TOKEN_RULE_NAME:"nextToken"});org.antlr.runtime.BaseRecognizer.prototype={reset:function(){var te,ee;if(this.state&&(this.state._fsp=-1,this.state.errorRecovery=!1,this.state.lastErrorIndex=-1,this.state.failed=!1,this.state.syntaxErrors=0,this.state.backtracking=0,this.state.ruleMemo))for(te=0,ee=this.state.ruleMemo.length;te<ee;te++)this.state.ruleMemo[te]=null},match:function(te,ee,re){var ne=this.getCurrentInputSymbol(te);return te.LA(1)===ee?(te.consume(),this.state.errorRecovery=!1,this.state.failed=!1,ne):this.state.backtracking>0?(this.state.failed=!0,ne):(ne=this.recoverFromMismatchedToken(te,ee,re),ne)},matchAny:function(te){this.state.errorRecovery=!1,this.state.failed=!1,te.consume()},mismatchIsUnwantedToken:function(te,ee){return te.LA(2)===ee},mismatchIsMissingToken:function(te,ee){return ee?(ee.member(org.antlr.runtime.Token.EOR_TOKEN_TYPE)&&(this.state._fsp>=0&&ee.remove(org.antlr.runtime.Token.EOR_TOKEN_TYPE),this.computeContextSensitiveRuleFOLLOW(),ee=ee.or(this.viableTokensFollowingThisRule)),!!(ee.member(te.LA(1))||ee.member(org.antlr.runtime.Token.EOR_TOKEN_TYPE))):!1},mismatch:function(te,ee,re){throw this.mismatchIsUnwantedToken(te,ee)?new org.antlr.runtime.UnwantedTokenException(ee,te):this.mismatchIsMissingToken(te,re)?new org.antlr.runtime.MissingTokenException(ee,te,null):new org.antlr.runtime.MismatchedTokenException(ee,te)},reportError:function(te){this.state.errorRecovery||(this.state.syntaxErrors++,this.state.errorRecovery=!0,this.displayRecognitionError(this.getTokenNames(),te))},displayRecognitionError:function(te,ee){var re=this.getErrorHeader(ee),ne=this.getErrorMessage(ee,te);this.emitErrorMessage(re+" "+ne)},getErrorHeader:function(te){return org.antlr.lang.isNumber(te.line)||(te.line=0),"line "+te.line+":"+te.charPositionInLine},emitErrorMessage:function(te){typeof window<"u"&&window.alert?alert(te):print(te)},getErrorMessage:function(te,ee){var re=te&&te.getMessage?te.getMessage():null,ne,ie;if(te instanceof org.antlr.runtime.UnwantedTokenException){var oe=te;ie="<unknown>",oe.expecting==org.antlr.runtime.Token.EOF?ie="EOF":ie=ee[oe.expecting],re="extraneous input "+this.getTokenErrorDisplay(oe.getUnexpectedToken())+" expecting "+ie}else te instanceof org.antlr.runtime.MissingTokenException?(ne=te,ie="<unknown>",ne.expecting==org.antlr.runtime.Token.EOF?ie="EOF":ie=ee[ne.expecting],re="missing "+ie+" at "+this.getTokenErrorDisplay(te.token)):te instanceof org.antlr.runtime.MismatchedTokenException?(ne=te,ie="<unknown>",ne.expecting==org.antlr.runtime.Token.EOF?ie="EOF":ie=ee[ne.expecting],re="mismatched input "+this.getTokenErrorDisplay(te.token)+" expecting "+ie):te instanceof org.antlr.runtime.NoViableAltException?re="no viable alternative at input "+this.getTokenErrorDisplay(te.token):te instanceof org.antlr.runtime.EarlyExitException?re="required (...)+ loop did not match anything at input "+this.getTokenErrorDisplay(te.token):te instanceof org.antlr.runtime.MismatchedSetException?re="mismatched input "+this.getTokenErrorDisplay(te.token)+" expecting set "+te.expecting:te instanceof org.antlr.runtime.MismatchedNotSetException?re="mismatched input "+this.getTokenErrorDisplay(te.token)+" expecting set "+te.expecting:te instanceof org.antlr.runtime.FailedPredicateException&&(re="rule "+te.ruleName+" failed predicate: {"+te.predicateText+"}?");return re},getNumberOfSyntaxErrors:function(){return this.state.syntaxErrors},getTokenErrorDisplay:function(te){var ee=te.getText();return org.antlr.lang.isValue(ee)||(te.getType()==org.antlr.runtime.Token.EOF?ee="<EOF>":ee="<"+te.getType()+">"),ee=ee.replace(/\n/g,"\\n"),ee=ee.replace(/\r/g,"\\r"),ee=ee.replace(/\t/g,"\\t"),"'"+ee+"'"},recover:function(te,ee){this.state.lastErrorIndex==te.index()&&te.consume(),this.state.lastErrorIndex=te.index();var re=this.computeErrorRecoverySet();this.beginResync(),this.consumeUntil(te,re),this.endResync()},beginResync:function(){},endResync:function(){},computeErrorRecoverySet:function(){return this.combineFollows(!1)},computeContextSensitiveRuleFOLLOW:function(){return this.combineFollows(!0)},combineFollows:function(te){var ee=this.state._fsp,re,ne,ie=new org.antlr.runtime.BitSet;for(re=ee;re>=0;re--)if(ne=this.state.following[re],ie.orInPlace(ne),te)if(ne.member(org.antlr.runtime.Token.EOR_TOKEN_TYPE))re>0&&ie.remove(org.antlr.runtime.Token.EOR_TOKEN_TYPE);else break;return ie},recoverFromMismatchedToken:function(te,ee,re){var ne=null;if(this.mismatchIsUnwantedToken(te,ee)){ne=new org.antlr.runtime.UnwantedTokenException(ee,te),this.beginResync(),te.consume(),this.endResync(),this.reportError(ne);var ie=this.getCurrentInputSymbol(te);return te.consume(),ie}if(this.mismatchIsMissingToken(te,re)){var oe=this.getMissingSymbol(te,ne,ee,re);return ne=new org.antlr.runtime.MissingTokenException(ee,te,oe),this.reportError(ne),oe}throw ne=new org.antlr.runtime.MismatchedTokenException(ee,te),ne},recoverFromMismatchedSet:function(te,ee,re){if(this.mismatchIsMissingToken(te,re))return this.reportError(ee),this.getMissingSymbol(te,ee,org.antlr.runtime.Token.INVALID_TOKEN_TYPE,re);throw ee},getCurrentInputSymbol:function(te){return null},getMissingSymbol:function(te,ee,re,ne){return null},consumeUntil:function(te,ee){for(var re=te.LA(1);re!=org.antlr.runtime.Token.EOF&&!ee.member(re);)te.consume(),re=te.LA(1)},pushFollow:function(te){if(this.state._fsp+1>=this.state.following.length){var ee=[],re;for(re=this.state.following.length-1;re>=0;re--)ee[re]=this.state.following[re];this.state.following=ee}this.state._fsp++,this.state.following[this.state._fsp]=te},getRuleInvocationStack:function(te,ee){throw new Error("Not implemented.")},getBacktrackingLevel:function(){return this.state.backtracking},getTokenNames:function(){return null},getGrammarFileName:function(){return null},toStrings:function(te){if(!te)return null;var ee=[],re;for(re=0;re<te.length;re++)ee.push(te[re].getText());return ee},getRuleMemoization:function(te,ee){this.state.ruleMemo[te]||(this.state.ruleMemo[te]={});var re=this.state.ruleMemo[te][ee];return org.antlr.lang.isNumber(re)?re:org.antlr.runtime.BaseRecognizer.MEMO_RULE_UNKNOWN},alreadyParsedRule:function(te,ee){var re=this.getRuleMemoization(ee,te.index());return re==org.antlr.runtime.BaseRecognizer.MEMO_RULE_UNKNOWN?!1:(re==org.antlr.runtime.BaseRecognizer.MEMO_RULE_FAILED?this.state.failed=!0:te.seek(re+1),!0)},memoize:function(te,ee,re){var ne=this.state.failed?org.antlr.runtime.BaseRecognizer.MEMO_RULE_FAILED:te.index()-1;if(!org.antlr.lang.isValue(this.state.ruleMemo))throw new Error("!!!!!!!!! memo array is null for "+this.getGrammarFileName());if(ee>=this.state.ruleMemo.length)throw new Error("!!!!!!!!! memo size is "+this.state.ruleMemo.length+", but rule index is "+ee);org.antlr.lang.isValue(this.state.ruleMemo[ee])&&(this.state.ruleMemo[ee][re]=ne)},getRuleMemoizationCacheSize:function(){var te=0,ee;for(ee=0;this.state.ruleMemo&&ee<this.state.ruleMemo.length;ee++){var re=this.state.ruleMemo[ee];re&&(te+=re.length)}return te},traceIn:function(te,ee,re){this.emitErrorMessage("enter "+te+" "+re),this.state.failed&&this.emitErrorMessage(" failed="+this.failed),this.state.backtracking>0&&this.emitErrorMessage(" backtracking="+this.state.backtracking)},traceOut:function(te,ee,re){this.emitErrorMessage("exit "+te+" "+re),this.state.failed&&this.emitErrorMessage(" failed="+this.state.failed),this.state.backtracking>0&&this.emitErrorMessage(" backtracking="+this.state.backtracking)}};org.antlr.runtime.Lexer=function(te,ee){ee&&org.antlr.runtime.Lexer.superclass.constructor.call(this,ee),te&&(this.input=te)};org.antlr.lang.extend(org.antlr.runtime.Lexer,org.antlr.runtime.BaseRecognizer,{reset:function(){org.antlr.runtime.Lexer.superclass.reset.call(this),org.antlr.lang.isValue(this.input)&&this.input.seek(0),org.antlr.lang.isValue(this.state)&&(this.state.token=null,this.state.type=org.antlr.runtime.Token.INVALID_TOKEN_TYPE,this.state.channel=org.antlr.runtime.Token.DEFAULT_CHANNEL,this.state.tokenStartCharIndex=-1,this.state.tokenStartCharPositionInLine=-1,this.state.tokenStartLine=-1,this.state.text=null)},nextToken:function(){for(;;){if(this.state.token=null,this.state.channel=org.antlr.runtime.Token.DEFAULT_CHANNEL,this.state.tokenStartCharIndex=this.input.index(),this.state.tokenStartCharPositionInLine=this.input.getCharPositionInLine(),this.state.tokenStartLine=this.input.getLine(),this.state.text=null,this.input.LA(1)===org.antlr.runtime.CharStream.EOF)return org.antlr.runtime.Token.EOF_TOKEN;try{if(this.mTokens(),!org.antlr.lang.isValue(this.state.token))this.emit();else if(this.state.token==org.antlr.runtime.Token.SKIP_TOKEN)continue;return this.state.token}catch(te){if(te instanceof org.antlr.runtime.RecognitionException)this.reportError(te);else if(te instanceof org.antlr.runtime.NoViableAltException)this.reportError(te),this.recover(te);else throw te}}},skip:function(){this.state.token=org.antlr.runtime.Token.SKIP_TOKEN},setCharStream:function(te){this.input=null,this.reset(),this.input=te},getCharStream:function(){return this.input},getSourceName:function(){return this.input.getSourceName()},emit:function(){if(arguments.length===0){var te=new org.antlr.runtime.CommonToken(this.input,this.state.type,this.state.channel,this.state.tokenStartCharIndex,this.getCharIndex()-1);return te.setLine(this.state.tokenStartLine),te.setText(this.state.text),te.setCharPositionInLine(this.state.tokenStartCharPositionInLine),this.state.token=te,te}else this.state.token=arguments[0]},match:function(te){var ee=0,re;if(org.antlr.lang.isString(te))for(;ee<te.length;){if(this.input.LA(1)!=te.charAt(ee)){if(this.state.backtracking>0){this.state.failed=!0;return}throw re=new org.antlr.runtime.MismatchedTokenException(te.charAt(ee),this.input),this.recover(re),re}ee++,this.input.consume(),this.state.failed=!1}else if(org.antlr.lang.isNumber(te)){if(this.input.LA(1)!=te){if(this.state.backtracking>0){this.state.failed=!0;return}throw re=new org.antlr.runtime.MismatchedTokenException(te,this.input),this.recover(re),re}this.input.consume(),this.state.failed=!1}},matchAny:function(){this.input.consume()},matchRange:function(te,ee){if(this.input.LA(1)<te||this.input.LA(1)>ee){if(this.state.backtracking>0){this.state.failed=!0;return}throw mre=new org.antlr.runtime.MismatchedRangeException(te,ee,this.input),this.recover(mre),mre}this.input.consume(),this.state.failed=!1},getLine:function(){return this.input.getLine()},getCharPositionInLine:function(){return this.input.getCharPositionInLine()},getCharIndex:function(){return this.input.index()},getText:function(){return org.antlr.lang.isString(this.state.text)?this.state.text:this.input.substring(this.state.tokenStartCharIndex,this.getCharIndex()-1)},setText:function(te){this.state.text=te},reportError:function(te){this.displayRecognitionError(this.getTokenNames(),te)},getErrorMessage:function(te,ee){var re=null;return te instanceof org.antlr.runtime.MismatchedTokenException?re="mismatched character "+this.getCharErrorDisplay(te.c)+" expecting "+this.getCharErrorDisplay(te.expecting):te instanceof org.antlr.runtime.NoViableAltException?re="no viable alternative at character "+this.getCharErrorDisplay(te.c):te instanceof org.antlr.runtime.EarlyExitException?re="required (...)+ loop did not match anything at character "+this.getCharErrorDisplay(te.c):te instanceof org.antlr.runtime.MismatchedNotSetException?re="mismatched character "+this.getCharErrorDisplay(te.c)+" expecting set "+te.expecting:te instanceof org.antlr.runtime.MismatchedSetException?re="mismatched character "+this.getCharErrorDisplay(te.c)+" expecting set "+te.expecting:te instanceof org.antlr.runtime.MismatchedRangeException?re="mismatched character "+this.getCharErrorDisplay(te.c)+" expecting set "+this.getCharErrorDisplay(te.a)+".."+this.getCharErrorDisplay(te.b):re=org.antlr.runtime.Lexer.superclass.getErrorMessage.call(this,te,ee),re},getCharErrorDisplay:function(te){var ee=te;switch(ee){case org.antlr.runtime.Token.EOF:ee="<EOF>";break;case`
`:ee="\\n";break;case"	":ee="\\t";break;case"\r":ee="\\r";break}return"'"+ee+"'"},recover:function(te){this.input.consume()},traceIn:function(te,ee){var re=String.fromCharCode(this.input.LT(1))+" line="+this.getLine()+":"+this.getCharPositionInLine();org.antlr.runtime.Lexer.superclass.traceIn.call(this,te,ee,re)},traceOut:function(te,ee){var re=String.fromCharCode(this.input.LT(1))+" line="+this.getLine()+":"+this.getCharPositionInLine();org.antlr.runtime.Lexer.superclass.traceOut.call(this,te,ee,re)}});org.antlr.runtime.ParserRuleReturnScope=function(){};org.antlr.runtime.ParserRuleReturnScope.prototype={getStart:function(){return this.start},getStop:function(){return this.stop}};org.antlr.runtime.tree.TreeRuleReturnScope=function(){};org.antlr.runtime.tree.TreeRuleReturnScope.prototype={getStart:function(){return this.start}};org.antlr.runtime.Parser=function(te,ee){org.antlr.runtime.Parser.superclass.constructor.call(this,ee),this.setTokenStream(te)};org.antlr.lang.extend(org.antlr.runtime.Parser,org.antlr.runtime.BaseRecognizer,{reset:function(){org.antlr.runtime.Parser.superclass.reset.call(this),org.antlr.lang.isValue(this.input)&&this.input.seek(0)},getCurrentInputSymbol:function(te){return te.LT(1)},getMissingSymbol:function(te,ee,re,ne){var ie="<missing "+this.getTokenNames()[re]+">",oe=new org.antlr.runtime.CommonToken(re,ie),fe=te.LT(1),ue;return fe.getType()===org.antlr.runtime.Token.EOF&&(ue=fe,fe=te.LT(-1),fe||(fe=ue)),oe.line=fe.getLine(),oe.charPositionInLine=fe.getCharPositionInLine(),oe.channel=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,oe},setTokenStream:function(te){this.input=null,this.reset(),this.input=te},getTokenStream:function(){return this.input},getSourceName:function(){return this.input.getSourceName()},traceIn:function(te,ee){org.antlr.runtime.Parser.superclass.traceIn.call(this,te,ee,this.input.LT(1))},traceOut:function(te,ee){org.antlr.runtime.Parser.superclass.traceOut.call(this,te,ee,this.input.LT(1))}});org.antlr.runtime.DFA=function(){};org.antlr.runtime.DFA.prototype={predict:function(te){var ee=te.mark(),re=0,ne,ie,oe;try{for(;;){if(ne=this.special[re],ne>=0){if(re=this.specialStateTransition(ne,te),re===-1)return this.noViableAlt(re,te),0;te.consume();continue}if(this.accept[re]>=1)return this.accept[re];if(ie=te.LA(1),ie===org.antlr.runtime.Token.EOF?ie=-1:org.antlr.lang.isString(ie)&&(ie=ie.charCodeAt(0)),ie>=this.min[re]&&ie<=this.max[re]){if(oe=this.transition[re][ie-this.min[re]],oe<0){if(this.eot[re]>=0){re=this.eot[re],te.consume();continue}return this.noViableAlt(re,te),0}re=oe,te.consume();continue}if(this.eot[re]>=0){re=this.eot[re],te.consume();continue}return ie==org.antlr.runtime.Token.EOF&&this.eof[re]>=0?this.accept[this.eof[re]]:(this.noViableAlt(re,te),0)}}finally{te.rewind(ee)}},noViableAlt:function(te,ee){if(this.recognizer.state.backtracking>0){this.recognizer.state.failed=!0;return}var re=new org.antlr.runtime.NoViableAltException(this.getDescription(),this.decisionNumber,te,ee);throw this.error(re),re},error:function(te){throw new ModelError("Invalid equation syntax",{code:9e3})},specialStateTransition:function(te,ee){return-1},getDescription:function(){return"n/a"}};org.antlr.lang.augmentObject(org.antlr.runtime.DFA,{unpackEncodedString:function(te){var ee,re=[],ne=0,ie,oe,fe;for(ee=0;ee<te.length;ee+=2)for(ie=te.charCodeAt(ee),oe=te.charCodeAt(ee+1),oe===65535&&(oe=-1),fe=1;fe<=ie;fe++)re[ne++]=oe;return re},unpackEncodedStringToUnsignedChars:function(te){return org.antlr.runtime.DFA.unpackEncodedString(te)}});org.antlr.runtime.tree.TreeParser=function(te){org.antlr.runtime.tree.TreeParser.superclass.constructor.call(this,arguments[1]),this.setTreeNodeStream(te)};(function(){var te=org.antlr.runtime.tree.TreeParser;org.antlr.lang.augmentObject(te,{DOWN:org.antlr.runtime.Token.DOWN,UP:org.antlr.runtime.Token.UP}),org.antlr.lang.extend(te,org.antlr.runtime.BaseRecognizer,{reset:function(){te.superclass.reset.call(this),this.input&&this.input.seek(0)},setTreeNodeStream:function(ee){this.input=ee},getTreeNodeStream:function(){return this.input},getSourceName:function(){return this.input.getSourceName()},getCurrentInputSymbol:function(ee){return ee.LT(1)},getMissingSymbol:function(ee,re,ne,ie){var oe="<missing "+this.getTokenNames()[ne]+">";return new org.antlr.runtime.tree.CommonTree(new org.antlr.runtime.CommonToken(ne,oe))},matchAny:function(ee){this.state.errorRecovery=!1,this.state.failed=!1;var re=this.input.LT(1);if(this.input.getTreeAdaptor().getChildCount(re)===0){this.input.consume();return}for(var ne=0,ie=this.input.getTreeAdaptor().getType(re);ie!==org.antlr.runtime.Token.EOF&&!(ie===te.UP&&ne===0);)this.input.consume(),re=this.input.LT(1),ie=this.input.getTreeAdaptor().getType(re),ie===te.DOWN?ne++:ie===te.UP&&ne--;this.input.consume()},mismatch:function(ee,re,ne){throw new org.antlr.runtime.MismatchedTreeNodeException(re,ee)},getErrorHeader:function(ee){return this.getGrammarFileName()+": node from "+(ee.approximateLineInfo?"after ":"")+"line "+ee.line+":"+ee.charPositionInLine},getErrorMessage:function(ee,re){var ne;return this instanceof te&&(ne=ee.input.getTreeAdaptor(),ee.token=ne.getToken(ee.node),org.antlr.lang.isValue(ee.token)||(ee.token=new org.antlr.runtime.CommonToken(ne.getType(ee.node),ne.getText(ee.node)))),te.superclass.getErrorMessage.call(this,ee,re)},traceIn:function(ee,re){te.superclass.traceIn.call(this,ee,re,this.input.LT(1))},traceOut:function(ee,re){te.superclass.traceOut.call(this,ee,re,this.input.LT(1))}})})();function FormulaLexer(te,ee){ee||(ee=new org.antlr.runtime.RecognizerSharedState),function(){}.call(this),this.dfa30=new FormulaLexer.DFA30(this),FormulaLexer.superclass.constructor.call(this,te,ee)}org.antlr.lang.augmentObject(FormulaLexer,{EOF:-1,T__113:113,T__114:114,T__115:115,T__116:116,NEGATE:4,ASSIGN:5,FUNCALL:6,MATERIAL:7,UNIT:8,POWER:9,DEFAULTS:10,PARAMS:11,UNITCLUMP:12,ARRAY:13,LINES:14,WHILE:15,IFTHENELSE:16,ELSE:17,FOR:18,FORIN:19,FUNCTION:20,ANONFUNCTION:21,NUMBER:22,LABEL:23,RANGE:24,INNER:25,ASSIGNED:26,SELECTOR:27,DOTSELECTOR:28,NEW:29,TRYCATCH:30,THROW:31,NEWLINE:32,W:33,H:34,I:35,L:36,E:37,WHILESTATEMENT:38,F:39,O:40,R:41,FORSTATEMENT:42,M:43,FROMSTATEMENT:44,N:45,INSTATEMENT:46,T:47,TOSTATEMENT:48,B:49,Y:50,BYSTATEMENT:51,P:52,LOOPSTATEMENT:53,IFSTATEMENT:54,THENSTATEMENT:55,S:56,ELSESTATEMENT:57,U:58,C:59,FUNCTIONSTATEMENT:60,D:61,ENDBLOCK:62,RETURNSTATEMENT:63,NEWSTATEMENT:64,TRYSTATEMENT:65,A:66,CATCHSTATEMENT:67,THROWSTATEMENT:68,IDENT:69,EQUALS:70,PRIMITIVE:71,OR:72,XOR:73,X:74,AND:75,NOTEQUALS:76,LT:77,LTEQ:78,GT:79,GTEQ:80,PLUS:81,MINUS:82,MULT:83,DIV:84,MOD:85,COLON:86,POW:87,NOT:88,LARR:89,RARR:90,LCURL:91,RCURL:92,COMMA:93,STRING:94,INTEGER:95,FLOAT:96,TRUE:97,FALSE:98,PER:99,CUBED:100,SQUARED:101,Q:102,LBRACKET:103,RBRACKET:104,COMMENT:105,LINE_COMMENT:106,WS:107,G:108,J:109,K:110,V:111,Z:112});(function(){var te=org.antlr.runtime.Token.HIDDEN_CHANNEL;org.antlr.runtime.Token.EOF,org.antlr.lang.extend(FormulaLexer,org.antlr.runtime.Lexer,{EOF:-1,T__113:113,T__114:114,T__115:115,T__116:116,NEGATE:4,ASSIGN:5,FUNCALL:6,MATERIAL:7,UNIT:8,POWER:9,DEFAULTS:10,PARAMS:11,UNITCLUMP:12,ARRAY:13,LINES:14,WHILE:15,IFTHENELSE:16,ELSE:17,FOR:18,FORIN:19,FUNCTION:20,ANONFUNCTION:21,NUMBER:22,LABEL:23,RANGE:24,INNER:25,ASSIGNED:26,SELECTOR:27,DOTSELECTOR:28,NEW:29,TRYCATCH:30,THROW:31,NEWLINE:32,W:33,H:34,I:35,L:36,E:37,WHILESTATEMENT:38,F:39,O:40,R:41,FORSTATEMENT:42,M:43,FROMSTATEMENT:44,N:45,INSTATEMENT:46,T:47,TOSTATEMENT:48,B:49,Y:50,BYSTATEMENT:51,P:52,LOOPSTATEMENT:53,IFSTATEMENT:54,THENSTATEMENT:55,S:56,ELSESTATEMENT:57,U:58,C:59,FUNCTIONSTATEMENT:60,D:61,ENDBLOCK:62,RETURNSTATEMENT:63,NEWSTATEMENT:64,TRYSTATEMENT:65,A:66,CATCHSTATEMENT:67,THROWSTATEMENT:68,IDENT:69,EQUALS:70,PRIMITIVE:71,OR:72,XOR:73,X:74,AND:75,NOTEQUALS:76,LT:77,LTEQ:78,GT:79,GTEQ:80,PLUS:81,MINUS:82,MULT:83,DIV:84,MOD:85,COLON:86,POW:87,NOT:88,LARR:89,RARR:90,LCURL:91,RCURL:92,COMMA:93,STRING:94,INTEGER:95,FLOAT:96,TRUE:97,FALSE:98,PER:99,CUBED:100,SQUARED:101,Q:102,LBRACKET:103,RBRACKET:104,COMMENT:105,LINE_COMMENT:106,WS:107,G:108,J:109,K:110,V:111,Z:112,getGrammarFileName:function(){return"/Library/WebServer/Documents/calc/Formula.g"}}),org.antlr.lang.augmentObject(FormulaLexer.prototype,{mT__113:function(){try{var ee=this.T__113,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("("),this.state.type=ee,this.state.channel=re}finally{}},mT__114:function(){try{var ee=this.T__114,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(")"),this.state.type=ee,this.state.channel=re}finally{}},mT__115:function(){try{var ee=this.T__115,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("<-"),this.state.type=ee,this.state.channel=re}finally{}},mT__116:function(){try{var ee=this.T__116,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("."),this.state.type=ee,this.state.channel=re}finally{}},mNEWLINE:function(){try{var ee=this.NEWLINE,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=2,ie=this.input.LA(1);switch(ie=="\r"&&(ne=1),ne){case 1:this.match("\r");break}this.match(`
`),this.state.type=ee,this.state.channel=re}finally{}},mWHILESTATEMENT:function(){try{var ee=this.WHILESTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mW(),this.mH(),this.mI(),this.mL(),this.mE(),this.state.type=ee,this.state.channel=re}finally{}},mFORSTATEMENT:function(){try{var ee=this.FORSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mF(),this.mO(),this.mR(),this.state.type=ee,this.state.channel=re}finally{}},mFROMSTATEMENT:function(){try{var ee=this.FROMSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mF(),this.mR(),this.mO(),this.mM(),this.state.type=ee,this.state.channel=re}finally{}},mINSTATEMENT:function(){try{var ee=this.INSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mI(),this.mN(),this.state.type=ee,this.state.channel=re}finally{}},mTOSTATEMENT:function(){try{var ee=this.TOSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mT(),this.mO(),this.state.type=ee,this.state.channel=re}finally{}},mBYSTATEMENT:function(){try{var ee=this.BYSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mB(),this.mY(),this.state.type=ee,this.state.channel=re}finally{}},mLOOPSTATEMENT:function(){try{var ee=this.LOOPSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mL(),this.mO(),this.mO(),this.mP(),this.state.type=ee,this.state.channel=re}finally{}},mIFSTATEMENT:function(){try{var ee=this.IFSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mI(),this.mF(),this.state.type=ee,this.state.channel=re}finally{}},mTHENSTATEMENT:function(){try{var ee=this.THENSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mT(),this.mH(),this.mE(),this.mN(),this.state.type=ee,this.state.channel=re}finally{}},mELSESTATEMENT:function(){try{var ee=this.ELSESTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mE(),this.mL(),this.mS(),this.mE(),this.state.type=ee,this.state.channel=re}finally{}},mFUNCTIONSTATEMENT:function(){try{var ee=this.FUNCTIONSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mF(),this.mU(),this.mN(),this.mC(),this.mT(),this.mI(),this.mO(),this.mN(),this.state.type=ee,this.state.channel=re}finally{}},mENDBLOCK:function(){try{var ee=this.ENDBLOCK,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mE(),this.mN(),this.mD(),this.state.type=ee,this.state.channel=re}finally{}},mRETURNSTATEMENT:function(){try{var ee=this.RETURNSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mR(),this.mE(),this.mT(),this.mU(),this.mR(),this.mN(),this.state.type=ee,this.state.channel=re}finally{}},mNEWSTATEMENT:function(){try{var ee=this.NEWSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mN(),this.mE(),this.mW(),this.state.type=ee,this.state.channel=re}finally{}},mTRYSTATEMENT:function(){try{var ee=this.TRYSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mT(),this.mR(),this.mY(),this.state.type=ee,this.state.channel=re}finally{}},mCATCHSTATEMENT:function(){try{var ee=this.CATCHSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mC(),this.mA(),this.mT(),this.mC(),this.mH(),this.state.type=ee,this.state.channel=re}finally{}},mTHROWSTATEMENT:function(){try{var ee=this.THROWSTATEMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mT(),this.mH(),this.mR(),this.mO(),this.mW(),this.state.type=ee,this.state.channel=re}finally{}},mOR:function(){try{var ee=this.OR,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=2,ie=this.input.LA(1);if(ie=="|")ne=1;else if(ie=="O"||ie=="o")ne=2;else{var oe=new org.antlr.runtime.NoViableAltException("",2,0,this.input);throw oe}switch(ne){case 1:this.match("||");break;case 2:this.mO(),this.mR();break}this.state.type=ee,this.state.channel=re}finally{}},mXOR:function(){try{var ee=this.XOR,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mX(),this.mO(),this.mR(),this.state.type=ee,this.state.channel=re}finally{}},mAND:function(){try{var ee=this.AND,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=2,ie=this.input.LA(1);if(ie=="&")ne=1;else if(ie=="A"||ie=="a")ne=2;else{var oe=new org.antlr.runtime.NoViableAltException("",3,0,this.input);throw oe}switch(ne){case 1:this.match("&&");break;case 2:this.mA(),this.mN(),this.mD();break}this.state.type=ee,this.state.channel=re}finally{}},mEQUALS:function(){try{var ee=this.EQUALS,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=2,ie=this.input.LA(1);if(ie=="="){var oe=this.input.LA(2);oe=="="?ne=2:ne=1}else{var fe=new org.antlr.runtime.NoViableAltException("",4,0,this.input);throw fe}switch(ne){case 1:this.match("=");break;case 2:this.match("==");break}this.state.type=ee,this.state.channel=re}finally{}},mNOTEQUALS:function(){try{var ee=this.NOTEQUALS,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=2,ie=this.input.LA(1);if(ie=="!")ne=1;else if(ie=="<")ne=2;else{var oe=new org.antlr.runtime.NoViableAltException("",5,0,this.input);throw oe}switch(ne){case 1:this.match("!=");break;case 2:this.match("<>");break}this.state.type=ee,this.state.channel=re}finally{}},mLT:function(){try{var ee=this.LT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("<"),this.state.type=ee,this.state.channel=re}finally{}},mLTEQ:function(){try{var ee=this.LTEQ,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("<="),this.state.type=ee,this.state.channel=re}finally{}},mGT:function(){try{var ee=this.GT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(">"),this.state.type=ee,this.state.channel=re}finally{}},mGTEQ:function(){try{var ee=this.GTEQ,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(">="),this.state.type=ee,this.state.channel=re}finally{}},mPLUS:function(){try{var ee=this.PLUS,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("+"),this.state.type=ee,this.state.channel=re}finally{}},mMINUS:function(){try{var ee=this.MINUS,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("-"),this.state.type=ee,this.state.channel=re}finally{}},mMULT:function(){try{var ee=this.MULT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("*"),this.state.type=ee,this.state.channel=re}finally{}},mDIV:function(){try{var ee=this.DIV,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("/"),this.state.type=ee,this.state.channel=re}finally{}},mMOD:function(){try{var ee=this.MOD,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=2,ie=this.input.LA(1);if(ie=="%")ne=1;else if(ie=="M"||ie=="m")ne=2;else{var oe=new org.antlr.runtime.NoViableAltException("",6,0,this.input);throw oe}switch(ne){case 1:this.match("%");break;case 2:this.mM(),this.mO(),this.mD();break}this.state.type=ee,this.state.channel=re}finally{}},mPOW:function(){try{var ee=this.POW,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("^"),this.state.type=ee,this.state.channel=re}finally{}},mNOT:function(){try{var ee=this.NOT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=2,ie=this.input.LA(1);if(ie=="!")ne=1;else if(ie=="N"||ie=="n")ne=2;else{var oe=new org.antlr.runtime.NoViableAltException("",7,0,this.input);throw oe}switch(ne){case 1:this.match("!");break;case 2:this.mN(),this.mO(),this.mT();break}this.state.type=ee,this.state.channel=re}finally{}},mLARR:function(){try{var ee=this.LARR,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=2,ie=this.input.LA(1);if(ie=="")ne=1;else if(ie=="<")ne=2;else{var oe=new org.antlr.runtime.NoViableAltException("",8,0,this.input);throw oe}switch(ne){case 1:this.match("");break;case 2:this.match("<<");break}this.state.type=ee,this.state.channel=re}finally{}},mRARR:function(){try{var ee=this.RARR,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=2,ie=this.input.LA(1);if(ie=="")ne=1;else if(ie==">")ne=2;else{var oe=new org.antlr.runtime.NoViableAltException("",9,0,this.input);throw oe}switch(ne){case 1:this.match("");break;case 2:this.match(">>");break}this.state.type=ee,this.state.channel=re}finally{}},mLCURL:function(){try{var ee=this.LCURL,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("{"),this.state.type=ee,this.state.channel=re}finally{}},mRCURL:function(){try{var ee=this.RCURL,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("}"),this.state.type=ee,this.state.channel=re}finally{}},mINTEGER:function(){try{var ee=this.INTEGER,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=0;e:do{var ie=2,oe=this.input.LA(1);switch(oe>="0"&&oe<="9"&&(ie=1),ie){case 1:this.matchRange("0","9");break;default:if(ne>=1)break e;var fe=new org.antlr.runtime.EarlyExitException(10,this.input);throw fe}ne++}while(!0);var ue=2,ae=this.input.LA(1);switch(ae=="e"&&(ue=1),ue){case 1:this.match("e");var se=2,ce=this.input.LA(1);switch((ce=="+"||ce=="-")&&(se=1),se){case 1:if(this.input.LA(1)=="+"||this.input.LA(1)=="-")this.input.consume();else{var le=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(le),le}break}e:do{var pe=2,de=this.input.LA(1);switch(de>="0"&&de<="9"&&(pe=1),pe){case 1:this.matchRange("0","9");break;default:break e}}while(!0);break}this.state.type=ee,this.state.channel=re}finally{}},mFLOAT:function(){try{var ee=this.FLOAT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;e:do{var ne=2,ie=this.input.LA(1);switch(ie>="0"&&ie<="9"&&(ne=1),ne){case 1:this.matchRange("0","9");break;default:break e}}while(!0);this.match(".");var oe=0;e:do{var fe=2,ue=this.input.LA(1);switch(ue>="0"&&ue<="9"&&(fe=1),fe){case 1:this.matchRange("0","9");break;default:if(oe>=1)break e;var ae=new org.antlr.runtime.EarlyExitException(15,this.input);throw ae}oe++}while(!0);var se=2,ce=this.input.LA(1);switch(ce=="e"&&(se=1),se){case 1:this.match("e");var le=2,pe=this.input.LA(1);switch((pe=="+"||pe=="-")&&(le=1),le){case 1:if(this.input.LA(1)=="+"||this.input.LA(1)=="-")this.input.consume();else{var de=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(de),de}break}e:do{var me=2,ve=this.input.LA(1);switch(ve>="0"&&ve<="9"&&(me=1),me){case 1:this.matchRange("0","9");break;default:break e}}while(!0);break}this.state.type=ee,this.state.channel=re}finally{}},mTRUE:function(){try{var ee=this.TRUE,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mT(),this.mR(),this.mU(),this.mE(),this.state.type=ee,this.state.channel=re}finally{}},mFALSE:function(){try{var ee=this.FALSE,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mF(),this.mA(),this.mL(),this.mS(),this.mE(),this.state.type=ee,this.state.channel=re}finally{}},mPER:function(){try{var ee=this.PER,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mP(),this.mE(),this.mR(),this.state.type=ee,this.state.channel=re}finally{}},mSQUARED:function(){try{var ee=this.SQUARED,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mS(),this.mQ(),this.mU(),this.mA(),this.mR(),this.mE(),this.mD(),this.state.type=ee,this.state.channel=re}finally{}},mCUBED:function(){try{var ee=this.CUBED,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.mC(),this.mU(),this.mB(),this.mE(),this.mD(),this.state.type=ee,this.state.channel=re}finally{}},mIDENT:function(){try{var ee=this.IDENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;if(this.input.LA(1)>="A"&&this.input.LA(1)<="Z"||this.input.LA(1)>="a"&&this.input.LA(1)<="z")this.input.consume();else{var ne=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ne),ne}e:do{var ie=2,oe=this.input.LA(1);switch((oe>="0"&&oe<="9"||oe>="A"&&oe<="Z"||oe=="_"||oe>="a"&&oe<="z")&&(ie=1),ie){case 1:if(this.input.LA(1)>="0"&&this.input.LA(1)<="9"||this.input.LA(1)>="A"&&this.input.LA(1)<="Z"||this.input.LA(1)=="_"||this.input.LA(1)>="a"&&this.input.LA(1)<="z")this.input.consume();else{var ne=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ne),ne}break;default:break e}}while(!0);this.state.type=ee,this.state.channel=re}finally{}},mPRIMITIVE:function(){try{var ee=this.PRIMITIVE,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=2,ie=this.input.LA(1);if(ie=="["){var oe=this.input.LA(2);if(oe>="\0"&&oe<="Z"||oe>="\\"&&oe<="")ne=1;else if(oe=="[")ne=2;else{var fe=new org.antlr.runtime.NoViableAltException("",22,1,this.input);throw fe}}else{var fe=new org.antlr.runtime.NoViableAltException("",22,0,this.input);throw fe}switch(ne){case 1:if(this.mLBRACKET(),this.input.LA(1)>="\0"&&this.input.LA(1)<="Z"||this.input.LA(1)>="\\"&&this.input.LA(1)<="")this.input.consume();else{var ue=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ue),ue}e:do{var ae=2,se=this.input.LA(1);switch(se=="]"?ae=2:(se>="\0"&&se<="\\"||se>="^"&&se<="")&&(ae=1),ae){case 1:this.matchAny();break;default:break e}}while(!0);this.mRBRACKET();break;case 2:this.mLBRACKET(),this.mLBRACKET();e:do{var ce=2,le=this.input.LA(1);switch(le=="]"?ce=2:(le>="\0"&&le<="\\"||le>="^"&&le<="")&&(ce=1),ce){case 1:this.matchAny();break;default:break e}}while(!0);this.mRBRACKET(),this.mRBRACKET();break}this.state.type=ee,this.state.channel=re}finally{}},mLBRACKET:function(){try{var ee=this.LBRACKET,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("["),this.state.type=ee,this.state.channel=re}finally{}},mRBRACKET:function(){try{var ee=this.RBRACKET,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("]"),this.state.type=ee,this.state.channel=re}finally{}},mCOMMENT:function(){try{var ee=this.COMMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match("/*");e:do{var ne=2,ie=this.input.LA(1);if(ie=="*"){var oe=this.input.LA(2);oe=="/"?ne=2:(oe>="\0"&&oe<="."||oe>="0"&&oe<="")&&(ne=1)}else(ie>="\0"&&ie<=")"||ie>="+"&&ie<="")&&(ne=1);switch(ne){case 1:this.matchAny();break;default:break e}}while(!0);this.match("*/"),re=te,this.state.type=ee,this.state.channel=re}finally{}},mLINE_COMMENT:function(){try{var ee=this.LINE_COMMENT,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=2,ie=this.input.LA(1);if(ie=="/")ne=1;else if(ie=="#")ne=2;else{var oe=new org.antlr.runtime.NoViableAltException("",24,0,this.input);throw oe}switch(ne){case 1:this.match("//");break;case 2:this.match("#");break}e:do{var fe=2,ue=this.input.LA(1);switch((ue>="\0"&&ue<="	"||ue>="\v"&&ue<="\f"||ue>=""&&ue<="")&&(fe=1),fe){case 1:if(this.input.LA(1)>="\0"&&this.input.LA(1)<="	"||this.input.LA(1)>="\v"&&this.input.LA(1)<="\f"||this.input.LA(1)>=""&&this.input.LA(1)<="")this.input.consume();else{var ae=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ae),ae}break;default:break e}}while(!0);re=te,this.state.type=ee,this.state.channel=re}finally{}},mCOLON:function(){try{var ee=this.COLON,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(":"),this.state.type=ee,this.state.channel=re}finally{}},mWS:function(){try{var ee=this.WS,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=0;e:do{var ie=2,oe=this.input.LA(1);switch((oe=="	"||oe=="\f"||oe==" ")&&(ie=1),ie){case 1:if(this.input.LA(1)=="	"||this.input.LA(1)=="\f"||this.input.LA(1)==" ")this.input.consume();else{var fe=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(fe),fe}break;default:if(ne>=1)break e;var ue=new org.antlr.runtime.EarlyExitException(26,this.input);throw ue}ne++}while(!0);re=te,this.state.type=ee,this.state.channel=re}finally{}},mA:function(){try{if(this.input.LA(1)=="A"||this.input.LA(1)=="a")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mB:function(){try{if(this.input.LA(1)=="B"||this.input.LA(1)=="b")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mC:function(){try{if(this.input.LA(1)=="C"||this.input.LA(1)=="c")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mD:function(){try{if(this.input.LA(1)=="D"||this.input.LA(1)=="d")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mE:function(){try{if(this.input.LA(1)=="E"||this.input.LA(1)=="e")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mF:function(){try{if(this.input.LA(1)=="F"||this.input.LA(1)=="f")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mG:function(){try{if(this.input.LA(1)=="G"||this.input.LA(1)=="g")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mH:function(){try{if(this.input.LA(1)=="H"||this.input.LA(1)=="h")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mI:function(){try{if(this.input.LA(1)=="I"||this.input.LA(1)=="i")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mJ:function(){try{if(this.input.LA(1)=="J"||this.input.LA(1)=="j")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mK:function(){try{if(this.input.LA(1)=="K"||this.input.LA(1)=="k")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mL:function(){try{if(this.input.LA(1)=="L"||this.input.LA(1)=="l")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mM:function(){try{if(this.input.LA(1)=="M"||this.input.LA(1)=="m")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mN:function(){try{if(this.input.LA(1)=="N"||this.input.LA(1)=="n")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mO:function(){try{if(this.input.LA(1)=="O"||this.input.LA(1)=="o")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mP:function(){try{if(this.input.LA(1)=="P"||this.input.LA(1)=="p")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mQ:function(){try{if(this.input.LA(1)=="Q"||this.input.LA(1)=="q")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mR:function(){try{if(this.input.LA(1)=="R"||this.input.LA(1)=="r")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mS:function(){try{if(this.input.LA(1)=="S"||this.input.LA(1)=="s")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mT:function(){try{if(this.input.LA(1)=="T"||this.input.LA(1)=="t")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mU:function(){try{if(this.input.LA(1)=="U"||this.input.LA(1)=="u")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mV:function(){try{if(this.input.LA(1)=="V"||this.input.LA(1)=="v")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mW:function(){try{if(this.input.LA(1)=="W"||this.input.LA(1)=="w")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mX:function(){try{if(this.input.LA(1)=="X"||this.input.LA(1)=="x")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mY:function(){try{if(this.input.LA(1)=="Y"||this.input.LA(1)=="y")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mZ:function(){try{if(this.input.LA(1)=="Z"||this.input.LA(1)=="z")this.input.consume();else{var ee=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(ee),ee}}finally{}},mCOMMA:function(){try{var ee=this.COMMA,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL;this.match(","),this.state.type=ee,this.state.channel=re}finally{}},mSTRING:function(){try{var ee=this.STRING,re=org.antlr.runtime.BaseRecognizer.DEFAULT_TOKEN_CHANNEL,ne=2,ie=this.input.LA(1);if(ie=="'")ne=1;else if(ie=='"')ne=2;else{var oe=new org.antlr.runtime.NoViableAltException("",29,0,this.input);throw oe}switch(ne){case 1:this.match("'");e:do{var fe=2,ue=this.input.LA(1);switch(ue=="'"?fe=2:(ue>="\0"&&ue<="&"||ue>="("&&ue<="")&&(fe=1),fe){case 1:this.matchAny();break;default:break e}}while(!0);this.match("'");break;case 2:this.match('"');e:do{var ae=3,se=this.input.LA(1);if(se=="\\"){var ce=this.input.LA(2);if(ce=='"'){var le=this.input.LA(3);le>="\0"&&le<=""?ae=1:ae=2}else(ce>="\0"&&ce<="!"||ce>="#"&&ce<="")&&(ae=2)}else(se>="\0"&&se<="!"||se>="#"&&se<="["||se>="]"&&se<="")&&(ae=2);switch(ae){case 1:this.match('\\"');break;case 2:if(this.input.LA(1)>="\0"&&this.input.LA(1)<="!"||this.input.LA(1)>="#"&&this.input.LA(1)<="")this.input.consume();else{var pe=new org.antlr.runtime.MismatchedSetException(null,this.input);throw this.recover(pe),pe}break;default:break e}}while(!0);this.match('"');break}this.state.type=ee,this.state.channel=re}finally{}},mTokens:function(){var ee=59;switch(ee=this.dfa30.predict(this.input),ee){case 1:this.mT__113();break;case 2:this.mT__114();break;case 3:this.mT__115();break;case 4:this.mT__116();break;case 5:this.mNEWLINE();break;case 6:this.mWHILESTATEMENT();break;case 7:this.mFORSTATEMENT();break;case 8:this.mFROMSTATEMENT();break;case 9:this.mINSTATEMENT();break;case 10:this.mTOSTATEMENT();break;case 11:this.mBYSTATEMENT();break;case 12:this.mLOOPSTATEMENT();break;case 13:this.mIFSTATEMENT();break;case 14:this.mTHENSTATEMENT();break;case 15:this.mELSESTATEMENT();break;case 16:this.mFUNCTIONSTATEMENT();break;case 17:this.mENDBLOCK();break;case 18:this.mRETURNSTATEMENT();break;case 19:this.mNEWSTATEMENT();break;case 20:this.mTRYSTATEMENT();break;case 21:this.mCATCHSTATEMENT();break;case 22:this.mTHROWSTATEMENT();break;case 23:this.mOR();break;case 24:this.mXOR();break;case 25:this.mAND();break;case 26:this.mEQUALS();break;case 27:this.mNOTEQUALS();break;case 28:this.mLT();break;case 29:this.mLTEQ();break;case 30:this.mGT();break;case 31:this.mGTEQ();break;case 32:this.mPLUS();break;case 33:this.mMINUS();break;case 34:this.mMULT();break;case 35:this.mDIV();break;case 36:this.mMOD();break;case 37:this.mPOW();break;case 38:this.mNOT();break;case 39:this.mLARR();break;case 40:this.mRARR();break;case 41:this.mLCURL();break;case 42:this.mRCURL();break;case 43:this.mINTEGER();break;case 44:this.mFLOAT();break;case 45:this.mTRUE();break;case 46:this.mFALSE();break;case 47:this.mPER();break;case 48:this.mSQUARED();break;case 49:this.mCUBED();break;case 50:this.mIDENT();break;case 51:this.mPRIMITIVE();break;case 52:this.mLBRACKET();break;case 53:this.mRBRACKET();break;case 54:this.mCOMMENT();break;case 55:this.mLINE_COMMENT();break;case 56:this.mCOLON();break;case 57:this.mWS();break;case 58:this.mCOMMA();break;case 59:this.mSTRING();break}}},!0),org.antlr.lang.augmentObject(FormulaLexer,{DFA30_eotS:`12
&&&JLN&P&S\f&Z[\\&a\b&&&&&p&&v&&z&|J&&&&&&&&&&&&`,DFA30_eofS:"",DFA30_minS:"	-0HAFHYOLEARON=*O.EQ\0\fIRONL0EU0OSDTWTB0RDDRUL0MCSNO0EPE0U0CE0AE0TE0W0RHDR0I00N0EO0DN0",DFA30_maxS:">9hunryoneouron=>/o9eq\fironlzryzosdtwtbzrddrulzmcsnozepezuzcezaeztezwzrhdrzizznzeozdnz",DFA30_acceptS:`
 !"$%'()*25789:;\x1B,&6#+43	\r
\v\x07/\b-\f.10`,DFA30_specialS:"'\0u}>",DFA30_transitionS:[`+++-)-,\x1B
#*
&\f\x07&\b&\v$&\r%	&&'(
&\f\x07&\b&\v$&\r%	&&!"- `,"","",".0/",`
3`,"","44","8\r567\v8\r567",":\x079:\x079","<;=<;=",">>","??","@A@A","BB","C	DC	D","EF\vEF","","GG","HH","","II","","/","K ","","","","M)","","OO","","","","","",`3
#`,"QQ","RR","","\0T","","","","","","","","","","","","","UU","VV","WW","XX","YY",`
&\x07&&&`,`
&\x07&&&`,`
&\x07&&&`,"]\f^]\f^","`_\x1B`_",`
&\x07&&&`,"bb","cc","dd","ee","ff","gg","hh","ii",`
&\x07&&&`,"jj","kk","","","","","","ll","","mm","nn","","","oo",`
&\x07&&&`,"qq","rr","ss","","","","tt","uu",`
&\x07&&&`,"ww","","xx","yy",`
&\x07&&&`,"{{",`
&\x07&&&`,`
&\x07&&&`,"}}","~~",`
&\x07&&&`,`
&\x07&&&`,`
&\x07&&&`,`
&\x07&&&`,"","","",`
&\x07&&&`,"","",`
&\x07&&&`,"","",`
&\x07&&&`,`
&\x07&&&`,`
&\x07&&&`,"","","","","","","","",`
&\x07&&&`,"","",`
&\x07&&&`,"",`
&\x07&&&`,"","","","",`
&\x07&&&`,`
&\x07&&&`,"","","","","",`
&\x07&&&`,"","","","","",`
&\x07&&&`,`
&\x07&&&`,"",""]}),org.antlr.lang.augmentObject(FormulaLexer,{DFA30_eot:org.antlr.runtime.DFA.unpackEncodedString(FormulaLexer.DFA30_eotS),DFA30_eof:org.antlr.runtime.DFA.unpackEncodedString(FormulaLexer.DFA30_eofS),DFA30_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaLexer.DFA30_minS),DFA30_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaLexer.DFA30_maxS),DFA30_accept:org.antlr.runtime.DFA.unpackEncodedString(FormulaLexer.DFA30_acceptS),DFA30_special:org.antlr.runtime.DFA.unpackEncodedString(FormulaLexer.DFA30_specialS),DFA30_transition:function(){var ee=[],re,ne=FormulaLexer.DFA30_transitionS.length;for(re=0;re<ne;re++)ee.push(org.antlr.runtime.DFA.unpackEncodedString(FormulaLexer.DFA30_transitionS[re]));return ee}()}),FormulaLexer.DFA30=function(ee){this.recognizer=ee,this.decisionNumber=30,this.eot=FormulaLexer.DFA30_eot,this.eof=FormulaLexer.DFA30_eof,this.min=FormulaLexer.DFA30_min,this.max=FormulaLexer.DFA30_max,this.accept=FormulaLexer.DFA30_accept,this.special=FormulaLexer.DFA30_special,this.transition=FormulaLexer.DFA30_transition},org.antlr.lang.extend(FormulaLexer.DFA30,org.antlr.runtime.DFA,{getDescription:function(){return"1:1: Tokens : ( T__113 | T__114 | T__115 | T__116 | NEWLINE | WHILESTATEMENT | FORSTATEMENT | FROMSTATEMENT | INSTATEMENT | TOSTATEMENT | BYSTATEMENT | LOOPSTATEMENT | IFSTATEMENT | THENSTATEMENT | ELSESTATEMENT | FUNCTIONSTATEMENT | ENDBLOCK | RETURNSTATEMENT | NEWSTATEMENT | TRYSTATEMENT | CATCHSTATEMENT | THROWSTATEMENT | OR | XOR | AND | EQUALS | NOTEQUALS | LT | LTEQ | GT | GTEQ | PLUS | MINUS | MULT | DIV | MOD | POW | NOT | LARR | RARR | LCURL | RCURL | INTEGER | FLOAT | TRUE | FALSE | PER | SQUARED | CUBED | IDENT | PRIMITIVE | LBRACKET | RBRACKET | COMMENT | LINE_COMMENT | COLON | WS | COMMA | STRING );"},specialStateTransition:function(ee,re){var ne=ee,ie=function(fe,ue){switch(fe){case 0:var ae=ue.LA(1);if(fe=-1,ae>="\0"&&ae<=""?fe=84:fe=83,fe>=0)return fe;break}}.call(this.recognizer,ee,re);if(!org.antlr.lang.isUndefined(ie))return ie;var oe=new org.antlr.runtime.NoViableAltException(this.getDescription(),30,ne,re);throw this.error(oe),oe},dummy:null})})();function FormulaParser(te,ee){ee||(ee=new org.antlr.runtime.RecognizerSharedState),function(){}.call(this),FormulaParser.superclass.constructor.call(this,te,ee),this.dfa5=new FormulaParser.DFA5(this),this.dfa57=new FormulaParser.DFA57(this),this.dfa58=new FormulaParser.DFA58(this),this.dfa65=new FormulaParser.DFA65(this),this.dfa72=new FormulaParser.DFA72(this),this.dfa85=new FormulaParser.DFA85(this),this.adaptor=new org.antlr.runtime.tree.CommonTreeAdaptor}org.antlr.lang.augmentObject(FormulaParser,{EOF:-1,T__113:113,T__114:114,T__115:115,T__116:116,NEGATE:4,ASSIGN:5,FUNCALL:6,MATERIAL:7,UNIT:8,POWER:9,DEFAULTS:10,PARAMS:11,UNITCLUMP:12,ARRAY:13,LINES:14,WHILE:15,IFTHENELSE:16,ELSE:17,FOR:18,FORIN:19,FUNCTION:20,ANONFUNCTION:21,NUMBER:22,LABEL:23,RANGE:24,INNER:25,ASSIGNED:26,SELECTOR:27,DOTSELECTOR:28,NEW:29,TRYCATCH:30,THROW:31,NEWLINE:32,W:33,H:34,I:35,L:36,E:37,WHILESTATEMENT:38,F:39,O:40,R:41,FORSTATEMENT:42,M:43,FROMSTATEMENT:44,N:45,INSTATEMENT:46,T:47,TOSTATEMENT:48,B:49,Y:50,BYSTATEMENT:51,P:52,LOOPSTATEMENT:53,IFSTATEMENT:54,THENSTATEMENT:55,S:56,ELSESTATEMENT:57,U:58,C:59,FUNCTIONSTATEMENT:60,D:61,ENDBLOCK:62,RETURNSTATEMENT:63,NEWSTATEMENT:64,TRYSTATEMENT:65,A:66,CATCHSTATEMENT:67,THROWSTATEMENT:68,IDENT:69,EQUALS:70,PRIMITIVE:71,OR:72,XOR:73,X:74,AND:75,NOTEQUALS:76,LT:77,LTEQ:78,GT:79,GTEQ:80,PLUS:81,MINUS:82,MULT:83,DIV:84,MOD:85,COLON:86,POW:87,NOT:88,LARR:89,RARR:90,LCURL:91,RCURL:92,COMMA:93,STRING:94,INTEGER:95,FLOAT:96,TRUE:97,FALSE:98,PER:99,CUBED:100,SQUARED:101,Q:102,LBRACKET:103,RBRACKET:104,COMMENT:105,LINE_COMMENT:106,WS:107,G:108,J:109,K:110,V:111,Z:112});(function(){var te=-1,ee=4,re=5,ne=6,ie=7,oe=8,fe=9,ue=10,ae=11,se=12,ce=13,le=14,pe=15,de=16,me=18,ve=19,we=20,ge=21,_e=23,Te=24,Ne=25,Le=26,Oe=27,xe=28,Se=29,be=30,De=31,Me=32,Ue=38,Ke=42,ft=44,qe=46,ot=48,nt=51,Ze=53,Ge=54,et=55,tt=57,Ye=60,at=62,Bt=63,Et=64,gt=65,Zt=67,Ot=68,Qe=69,Rt=70,Pt=71,Wt=72,jt=73,hr=75,dr=76,pr=77,mr=80,gr=81,Mt=82,$t=83,vr=84,_r=85,tr=86,ir=87,Gt=88,xt=89,Tr=90,kt=91,Er=92,pt=93,Ut=94,ar=95,wr=96,Nr=97,Vt=98,Fr=99,lr=100,cr=101;org.antlr.lang.extend(FormulaParser,org.antlr.runtime.Parser,{setTreeAdaptor:function(he){this.adaptor=he},getTreeAdaptor:function(){return this.adaptor},getTokenNames:function(){return FormulaParser.tokenNames},getGrammarFileName:function(){return"/Library/WebServer/Documents/calc/Formula.g"}}),org.antlr.lang.augmentObject(FormulaParser.prototype,{lines_return:function(){FormulaParser.lines_return=function(){},org.antlr.lang.extend(FormulaParser.lines_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),lines:function(){var he=new FormulaParser.lines_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token NEWLINE"),Ce=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token EOF"),Ie=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule expression");try{e:do{var Ve=2,We=this.input.LA(1);switch(We==Me&&(Ve=1),Ve){case 1:if(Fe=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_lines160),this.state.failed)return he;this.state.backtracking===0&&Re.add(Fe);break;default:break e}}while(!0);e:do{var $e=2,Be=this.input.LA(1);switch((Be==Ue||Be==Ke||Be==Ge||Be==Ye||Be>=Bt&&Be<=gt||Be>=Ot&&Be<=Qe||Be==Pt||Be==Mt||Be>=Gt&&Be<=xt||Be==kt||Be>=Ut&&Be<=Vt||Be==113)&&($e=1),$e){case 1:if(this.pushFollow(FormulaParser.FOLLOW_expression_in_lines164),Ae=this.expression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Ie.add(Ae.getTree());var Je=2,st=this.input.LA(1);if(st==Me)Je=1;else if(st==te)Je=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var je=new org.antlr.runtime.NoViableAltException("",3,0,this.input);throw je}switch(Je){case 1:var He=0;t:do{var it=2,ct=this.input.LA(1);switch(ct==Me&&(it=1),it){case 1:if(Pe=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_lines168),this.state.failed)return he;this.state.backtracking===0&&Re.add(Pe);break;default:if(He>=1)break t;if(this.state.backtracking>0)return this.state.failed=!0,he;var ht=new org.antlr.runtime.EarlyExitException(2,this.input);throw ht}He++}while(!0);break;case 2:if(ye=this.match(this.input,te,FormulaParser.FOLLOW_EOF_in_lines171),this.state.failed)return he;this.state.backtracking===0&&Ce.add(ye);break}break;default:break e}}while(!0);if(ke=this.match(this.input,te,FormulaParser.FOLLOW_EOF_in_lines176),this.state.failed)return he;if(this.state.backtracking===0&&Ce.add(ke),this.state.backtracking===0){he.tree=Ee;var lt=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var ut=this.adaptor.nil();for(ut=this.adaptor.becomeRoot(this.adaptor.create(le,"LINES"),ut);Ie.hasNext();)this.adaptor.addChild(ut,Ie.nextTree());Ie.reset(),this.adaptor.addChild(Ee,ut)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(ze){if(ze instanceof org.antlr.runtime.RecognitionException)this.reportError(ze),this.recover(this.input,ze),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),ze);else throw ze}finally{}return he},expression_return:function(){FormulaParser.expression_return=function(){},org.antlr.lang.extend(FormulaParser.expression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),expression:function(){var he=new FormulaParser.expression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=null,Ie=null,Ve=null,We=null;try{var $e=10;switch($e=this.dfa5.predict(this.input),$e){case 1:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_assignment_in_expression508),Fe=this.assignment(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Fe.getTree());break;case 2:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_expression514),Pe=this.logicalExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());break;case 3:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_whileLoop_in_expression520),ye=this.whileLoop(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break;case 4:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_forLoop_in_expression526),ke=this.forLoop(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ke.getTree());break;case 5:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_forInLoop_in_expression532),Ae=this.forInLoop(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Ae.getTree());break;case 6:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_ifThenElse_in_expression538),Re=this.ifThenElse(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Re.getTree());break;case 7:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_functionDef_in_expression544),Ce=this.functionDef(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Ce.getTree());break;case 8:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_returnExp_in_expression550),Ie=this.returnExp(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Ie.getTree());break;case 9:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_tryCatch_in_expression556),Ve=this.tryCatch(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Ve.getTree());break;case 10:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_throwExp_in_expression562),We=this.throwExp(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,We.getTree());break}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Be){if(Be instanceof org.antlr.runtime.RecognitionException)this.reportError(Be),this.recover(this.input,Be),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Be);else throw Be}finally{}return he},returnExp_return:function(){FormulaParser.returnExp_return=function(){},org.antlr.lang.extend(FormulaParser.returnExp_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),returnExp:function(){var he=new FormulaParser.returnExp_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null;try{if(Ee=this.adaptor.nil(),Fe=this.match(this.input,Bt,FormulaParser.FOLLOW_RETURNSTATEMENT_in_returnExp574),this.state.failed||(this.state.backtracking===0&&(ye=this.adaptor.create(Fe),Ee=this.adaptor.becomeRoot(ye,Ee)),this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_returnExp577),Pe=this.logicalExpression(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree()),he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(ke){if(ke instanceof org.antlr.runtime.RecognitionException)this.reportError(ke),this.recover(this.input,ke),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),ke);else throw ke}finally{}return he},innerBlock_return:function(){FormulaParser.innerBlock_return=function(){},org.antlr.lang.extend(FormulaParser.innerBlock_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),innerBlock:function(){var he=new FormulaParser.innerBlock_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token NEWLINE"),ke=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule expression");try{e:do{var Ae=2,Re=this.input.LA(1);switch((Re==Ue||Re==Ke||Re==Ge||Re==Ye||Re>=Bt&&Re<=gt||Re>=Ot&&Re<=Qe||Re==Pt||Re==Mt||Re>=Gt&&Re<=xt||Re==kt||Re>=Ut&&Re<=Vt||Re==113)&&(Ae=1),Ae){case 1:if(this.pushFollow(FormulaParser.FOLLOW_expression_in_innerBlock590),Pe=this.expression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&ke.add(Pe.getTree());var Ce=0;t:do{var Ie=2,Ve=this.input.LA(1);switch(Ve==Me&&(Ie=1),Ie){case 1:if(Fe=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_innerBlock594),this.state.failed)return he;this.state.backtracking===0&&ye.add(Fe);break;default:if(Ce>=1)break t;if(this.state.backtracking>0)return this.state.failed=!0,he;var We=new org.antlr.runtime.EarlyExitException(6,this.input);throw We}Ce++}while(!0);break;default:break e}}while(!0);if(this.state.backtracking===0){he.tree=Ee;var $e=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var Be=this.adaptor.nil();if(Be=this.adaptor.becomeRoot(this.adaptor.create(le,"LINES"),Be),!ke.hasNext())throw new org.antlr.runtime.tree.RewriteEarlyExitException;for(;ke.hasNext();)this.adaptor.addChild(Be,ke.nextTree());ke.reset(),this.adaptor.addChild(Ee,Be)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Je){if(Je instanceof org.antlr.runtime.RecognitionException)this.reportError(Je),this.recover(this.input,Je),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Je);else throw Je}finally{}return he},whileLoop_return:function(){FormulaParser.whileLoop_return=function(){},org.antlr.lang.extend(FormulaParser.whileLoop_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),whileLoop:function(){var he=new FormulaParser.whileLoop_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token NEWLINE"),Ie=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token ENDBLOCK"),Ve=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token LOOPSTATEMENT"),We=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token WHILESTATEMENT"),$e=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule innerBlock"),Be=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule logicalExpression");try{if(Fe=this.match(this.input,Ue,FormulaParser.FOLLOW_WHILESTATEMENT_in_whileLoop619),this.state.failed||(this.state.backtracking===0&&We.add(Fe),this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_whileLoop621),Ae=this.logicalExpression(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&Be.add(Ae.getTree());var Je=0;e:do{var st=2,je=this.input.LA(1);switch(je==Me&&(st=1),st){case 1:if(Pe=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_whileLoop623),this.state.failed)return he;this.state.backtracking===0&&Ce.add(Pe);break;default:if(Je>=1)break e;if(this.state.backtracking>0)return this.state.failed=!0,he;var He=new org.antlr.runtime.EarlyExitException(8,this.input);throw He}Je++}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_innerBlock_in_whileLoop626),Re=this.innerBlock(),this.state._fsp--,this.state.failed||(this.state.backtracking===0&&$e.add(Re.getTree()),ye=this.match(this.input,at,FormulaParser.FOLLOW_ENDBLOCK_in_whileLoop629),this.state.failed)||(this.state.backtracking===0&&Ie.add(ye),ke=this.match(this.input,Ze,FormulaParser.FOLLOW_LOOPSTATEMENT_in_whileLoop631),this.state.failed))return he;if(this.state.backtracking===0&&Ve.add(ke),this.state.backtracking===0){he.tree=Ee;var it=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var ct=this.adaptor.nil();ct=this.adaptor.becomeRoot(this.adaptor.create(pe,"WHILE"),ct),this.adaptor.addChild(ct,Be.nextTree()),this.adaptor.addChild(ct,$e.nextTree()),this.adaptor.addChild(Ee,ct)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(ht){if(ht instanceof org.antlr.runtime.RecognitionException)this.reportError(ht),this.recover(this.input,ht),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),ht);else throw ht}finally{}return he},forLoop_return:function(){FormulaParser.forLoop_return=function(){},org.antlr.lang.extend(FormulaParser.forLoop_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),forLoop:function(){var he=new FormulaParser.forLoop_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=null,Ie=null,Ve=null,We=null,$e=null,Be=null,Je=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token FORSTATEMENT"),st=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token IDENT"),je=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token FROMSTATEMENT"),He=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token NEWLINE"),it=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token TOSTATEMENT"),ct=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token ENDBLOCK"),ht=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token LOOPSTATEMENT"),lt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token BYSTATEMENT"),ut=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule innerBlock"),ze=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule logicalExpression");try{if(Fe=this.match(this.input,Ke,FormulaParser.FOLLOW_FORSTATEMENT_in_forLoop652),this.state.failed||(this.state.backtracking===0&&Je.add(Fe),Pe=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_forLoop654),this.state.failed)||(this.state.backtracking===0&&st.add(Pe),ye=this.match(this.input,ft,FormulaParser.FOLLOW_FROMSTATEMENT_in_forLoop656),this.state.failed)||(this.state.backtracking===0&&je.add(ye),this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_forLoop658),Ve=this.logicalExpression(),this.state._fsp--,this.state.failed)||(this.state.backtracking===0&&ze.add(Ve.getTree()),ke=this.match(this.input,ot,FormulaParser.FOLLOW_TOSTATEMENT_in_forLoop660),this.state.failed)||(this.state.backtracking===0&&it.add(ke),this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_forLoop662),We=this.logicalExpression(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&ze.add(We.getTree());var rt=2,vt=this.input.LA(1);switch(vt==nt&&(rt=1),rt){case 1:if(Ae=this.match(this.input,nt,FormulaParser.FOLLOW_BYSTATEMENT_in_forLoop665),this.state.failed||(this.state.backtracking===0&&lt.add(Ae),this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_forLoop667),$e=this.logicalExpression(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&ze.add($e.getTree());break}var wt=0;e:do{var St=2,Xe=this.input.LA(1);switch(Xe==Me&&(St=1),St){case 1:if(Re=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_forLoop671),this.state.failed)return he;this.state.backtracking===0&&He.add(Re);break;default:if(wt>=1)break e;if(this.state.backtracking>0)return this.state.failed=!0,he;var _t=new org.antlr.runtime.EarlyExitException(10,this.input);throw _t}wt++}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_innerBlock_in_forLoop674),Be=this.innerBlock(),this.state._fsp--,this.state.failed||(this.state.backtracking===0&&ut.add(Be.getTree()),Ce=this.match(this.input,at,FormulaParser.FOLLOW_ENDBLOCK_in_forLoop677),this.state.failed)||(this.state.backtracking===0&&ct.add(Ce),Ie=this.match(this.input,Ze,FormulaParser.FOLLOW_LOOPSTATEMENT_in_forLoop679),this.state.failed))return he;if(this.state.backtracking===0&&ht.add(Ie),this.state.backtracking===0){he.tree=Ee;var mt=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var Tt=this.adaptor.nil();Tt=this.adaptor.becomeRoot(this.adaptor.create(me,"FOR"),Tt),this.adaptor.addChild(Tt,st.nextNode());{var Nt=this.adaptor.nil();for(Nt=this.adaptor.becomeRoot(this.adaptor.create(ae,"PARAMS"),Nt);ze.hasNext();)this.adaptor.addChild(Nt,ze.nextTree());ze.reset(),this.adaptor.addChild(Tt,Nt)}this.adaptor.addChild(Tt,ut.nextTree()),this.adaptor.addChild(Ee,Tt)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ft){if(Ft instanceof org.antlr.runtime.RecognitionException)this.reportError(Ft),this.recover(this.input,Ft),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ft);else throw Ft}finally{}return he},forInLoop_return:function(){FormulaParser.forInLoop_return=function(){},org.antlr.lang.extend(FormulaParser.forInLoop_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),forInLoop:function(){var he=new FormulaParser.forInLoop_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=null,Ie=null,Ve=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token FORSTATEMENT"),We=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token IDENT"),$e=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token NEWLINE"),Be=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token ENDBLOCK"),Je=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token LOOPSTATEMENT"),st=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token INSTATEMENT"),je=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule innerBlock"),He=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule logicalExpression");try{if(Fe=this.match(this.input,Ke,FormulaParser.FOLLOW_FORSTATEMENT_in_forInLoop707),this.state.failed||(this.state.backtracking===0&&Ve.add(Fe),Pe=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_forInLoop709),this.state.failed)||(this.state.backtracking===0&&We.add(Pe),ye=this.match(this.input,qe,FormulaParser.FOLLOW_INSTATEMENT_in_forInLoop711),this.state.failed)||(this.state.backtracking===0&&st.add(ye),this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_forInLoop713),Ce=this.logicalExpression(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&He.add(Ce.getTree());var it=0;e:do{var ct=2,ht=this.input.LA(1);switch(ht==Me&&(ct=1),ct){case 1:if(ke=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_forInLoop715),this.state.failed)return he;this.state.backtracking===0&&$e.add(ke);break;default:if(it>=1)break e;if(this.state.backtracking>0)return this.state.failed=!0,he;var lt=new org.antlr.runtime.EarlyExitException(11,this.input);throw lt}it++}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_innerBlock_in_forInLoop718),Ie=this.innerBlock(),this.state._fsp--,this.state.failed||(this.state.backtracking===0&&je.add(Ie.getTree()),Ae=this.match(this.input,at,FormulaParser.FOLLOW_ENDBLOCK_in_forInLoop721),this.state.failed)||(this.state.backtracking===0&&Be.add(Ae),Re=this.match(this.input,Ze,FormulaParser.FOLLOW_LOOPSTATEMENT_in_forInLoop723),this.state.failed))return he;if(this.state.backtracking===0&&Je.add(Re),this.state.backtracking===0){he.tree=Ee;var ut=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var ze=this.adaptor.nil();ze=this.adaptor.becomeRoot(this.adaptor.create(ve,"FORIN"),ze),this.adaptor.addChild(ze,We.nextNode()),this.adaptor.addChild(ze,He.nextTree()),this.adaptor.addChild(ze,je.nextTree()),this.adaptor.addChild(Ee,ze)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(rt){if(rt instanceof org.antlr.runtime.RecognitionException)this.reportError(rt),this.recover(this.input,rt),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),rt);else throw rt}finally{}return he},ifThenElse_return:function(){FormulaParser.ifThenElse_return=function(){},org.antlr.lang.extend(FormulaParser.ifThenElse_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),ifThenElse:function(){var he=new FormulaParser.ifThenElse_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=null,Ie=null,Ve=null,We=null,$e=null,Be=null,Je=null,st=null,je=null,He=null,it=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token IFSTATEMENT"),ct=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token NEWLINE"),ht=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token ENDBLOCK"),lt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token ELSESTATEMENT"),ut=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token THENSTATEMENT"),ze=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule innerBlock"),rt=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule logicalExpression");try{if(Fe=this.match(this.input,Ge,FormulaParser.FOLLOW_IFSTATEMENT_in_ifThenElse748),this.state.failed||(this.state.backtracking===0&&it.add(Fe),this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_ifThenElse750),Be=this.logicalExpression(),this.state._fsp--,this.state.failed)||(this.state.backtracking===0&&rt.add(Be.getTree()),Pe=this.match(this.input,et,FormulaParser.FOLLOW_THENSTATEMENT_in_ifThenElse752),this.state.failed))return he;this.state.backtracking===0&&ut.add(Pe);var vt=0;e:do{var wt=2,St=this.input.LA(1);switch(St==Me&&(wt=1),wt){case 1:if(ye=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_ifThenElse755),this.state.failed)return he;this.state.backtracking===0&&ct.add(ye);break;default:if(vt>=1)break e;if(this.state.backtracking>0)return this.state.failed=!0,he;var Xe=new org.antlr.runtime.EarlyExitException(12,this.input);throw Xe}vt++}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_innerBlock_in_ifThenElse758),Je=this.innerBlock(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&ze.add(Je.getTree());e:do{var _t=2,mt=this.input.LA(1);if(mt==tt){var Tt=this.input.LA(2);Tt==Ge&&(_t=1)}switch(_t){case 1:if(ke=this.match(this.input,tt,FormulaParser.FOLLOW_ELSESTATEMENT_in_ifThenElse762),this.state.failed||(this.state.backtracking===0&&lt.add(ke),Ae=this.match(this.input,Ge,FormulaParser.FOLLOW_IFSTATEMENT_in_ifThenElse764),this.state.failed)||(this.state.backtracking===0&&it.add(Ae),this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_ifThenElse766),st=this.logicalExpression(),this.state._fsp--,this.state.failed)||(this.state.backtracking===0&&rt.add(st.getTree()),Re=this.match(this.input,et,FormulaParser.FOLLOW_THENSTATEMENT_in_ifThenElse768),this.state.failed))return he;this.state.backtracking===0&&ut.add(Re);var Nt=0;t:do{var Ft=2,Lt=this.input.LA(1);switch(Lt==Me&&(Ft=1),Ft){case 1:if(Ce=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_ifThenElse770),this.state.failed)return he;this.state.backtracking===0&&ct.add(Ce);break;default:if(Nt>=1)break t;if(this.state.backtracking>0)return this.state.failed=!0,he;var Xe=new org.antlr.runtime.EarlyExitException(13,this.input);throw Xe}Nt++}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_innerBlock_in_ifThenElse773),je=this.innerBlock(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&ze.add(je.getTree());break;default:break e}}while(!0);var bt=2,It=this.input.LA(1);switch(It==tt&&(bt=1),bt){case 1:if(Ie=this.match(this.input,tt,FormulaParser.FOLLOW_ELSESTATEMENT_in_ifThenElse778),this.state.failed)return he;this.state.backtracking===0&&lt.add(Ie);var Yt=0;e:do{var Qt=2,zt=this.input.LA(1);switch(zt==Me&&(Qt=1),Qt){case 1:if(Ve=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_ifThenElse780),this.state.failed)return he;this.state.backtracking===0&&ct.add(Ve);break;default:if(Yt>=1)break e;if(this.state.backtracking>0)return this.state.failed=!0,he;var Xe=new org.antlr.runtime.EarlyExitException(15,this.input);throw Xe}Yt++}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_innerBlock_in_ifThenElse783),He=this.innerBlock(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&ze.add(He.getTree());break}if(We=this.match(this.input,at,FormulaParser.FOLLOW_ENDBLOCK_in_ifThenElse787),this.state.failed||(this.state.backtracking===0&&ht.add(We),$e=this.match(this.input,Ge,FormulaParser.FOLLOW_IFSTATEMENT_in_ifThenElse789),this.state.failed))return he;if(this.state.backtracking===0&&it.add($e),this.state.backtracking===0){he.tree=Ee;var Xt=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var Dt=this.adaptor.nil();Dt=this.adaptor.becomeRoot(this.adaptor.create(de,"IFTHENELSE"),Dt);{var dt=this.adaptor.nil();if(dt=this.adaptor.becomeRoot(this.adaptor.create(ae,"PARAMS"),dt),!rt.hasNext())throw new org.antlr.runtime.tree.RewriteEarlyExitException;for(;rt.hasNext();)this.adaptor.addChild(dt,rt.nextTree());rt.reset(),this.adaptor.addChild(Dt,dt)}{var dt=this.adaptor.nil();if(dt=this.adaptor.becomeRoot(this.adaptor.create(ae,"PARAMS"),dt),!ze.hasNext())throw new org.antlr.runtime.tree.RewriteEarlyExitException;for(;ze.hasNext();)this.adaptor.addChild(dt,ze.nextTree());ze.reset(),this.adaptor.addChild(Dt,dt)}this.adaptor.addChild(Ee,Dt)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ht){if(Ht instanceof org.antlr.runtime.RecognitionException)this.reportError(Ht),this.recover(this.input,Ht),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ht);else throw Ht}finally{}return he},functionDef_return:function(){FormulaParser.functionDef_return=function(){},org.antlr.lang.extend(FormulaParser.functionDef_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),functionDef:function(){var he=new FormulaParser.functionDef_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=null,Ie=null,Ve=null,We=null,$e=null,Be=null,Je=null,st=null,je=null,He=null,it=null,ct=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token FUNCTIONSTATEMENT"),ht=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token 114"),lt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token IDENT"),ut=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token EQUALS"),ze=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token 113"),rt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token NEWLINE"),vt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token COMMA"),wt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token ENDBLOCK"),St=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule innerBlock"),Xe=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule defaultValue");try{if(Fe=this.match(this.input,Ye,FormulaParser.FOLLOW_FUNCTIONSTATEMENT_in_functionDef820),this.state.failed||(this.state.backtracking===0&&ct.add(Fe),Pe=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_functionDef822),this.state.failed)||(this.state.backtracking===0&&lt.add(Pe),ye=this.match(this.input,113,FormulaParser.FOLLOW_113_in_functionDef824),this.state.failed))return he;this.state.backtracking===0&&ze.add(ye);var _t=2,mt=this.input.LA(1);switch(mt==Qe&&(_t=1),_t){case 1:if(ke=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_functionDef827),this.state.failed)return he;this.state.backtracking===0&&lt.add(ke);var Tt=2,Nt=this.input.LA(1);if(Nt==Rt)Tt=1;else if(Nt==pt||Nt==114)Tt=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Ft=new org.antlr.runtime.NoViableAltException("",18,0,this.input);throw Ft}switch(Tt){case 1:if(Ae=this.match(this.input,Rt,FormulaParser.FOLLOW_EQUALS_in_functionDef831),this.state.failed||(this.state.backtracking===0&&ut.add(Ae),this.pushFollow(FormulaParser.FOLLOW_defaultValue_in_functionDef834),je=this.defaultValue(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&Xe.add(je.getTree());break;case 2:e:do{var Lt=2,bt=this.input.LA(1);if(bt==pt){var It=this.input.LA(2);if(It==Qe){var Yt=this.input.LA(3);(Yt==pt||Yt==114)&&(Lt=1)}}switch(Lt){case 1:if(Re=this.match(this.input,pt,FormulaParser.FOLLOW_COMMA_in_functionDef839),this.state.failed||(this.state.backtracking===0&&vt.add(Re),Ce=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_functionDef841),this.state.failed))return he;this.state.backtracking===0&&lt.add(Ce);break;default:break e}}while(!0);break}e:do{var Qt=2,zt=this.input.LA(1);switch(zt==pt&&(Qt=1),Qt){case 1:if(Ie=this.match(this.input,pt,FormulaParser.FOLLOW_COMMA_in_functionDef848),this.state.failed||(this.state.backtracking===0&&vt.add(Ie),Ve=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_functionDef850),this.state.failed)||(this.state.backtracking===0&&lt.add(Ve),We=this.match(this.input,Rt,FormulaParser.FOLLOW_EQUALS_in_functionDef852),this.state.failed)||(this.state.backtracking===0&&ut.add(We),this.pushFollow(FormulaParser.FOLLOW_defaultValue_in_functionDef854),He=this.defaultValue(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&Xe.add(He.getTree());break;default:break e}}while(!0);break}if($e=this.match(this.input,114,FormulaParser.FOLLOW_114_in_functionDef861),this.state.failed)return he;this.state.backtracking===0&&ht.add($e);var Xt=0;e:do{var Dt=2,dt=this.input.LA(1);switch(dt==Me&&(Dt=1),Dt){case 1:if(Be=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_functionDef863),this.state.failed)return he;this.state.backtracking===0&&rt.add(Be);break;default:if(Xt>=1)break e;if(this.state.backtracking>0)return this.state.failed=!0,he;var Ht=new org.antlr.runtime.EarlyExitException(21,this.input);throw Ht}Xt++}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_innerBlock_in_functionDef866),it=this.innerBlock(),this.state._fsp--,this.state.failed||(this.state.backtracking===0&&St.add(it.getTree()),Je=this.match(this.input,at,FormulaParser.FOLLOW_ENDBLOCK_in_functionDef869),this.state.failed)||(this.state.backtracking===0&&wt.add(Je),st=this.match(this.input,Ye,FormulaParser.FOLLOW_FUNCTIONSTATEMENT_in_functionDef871),this.state.failed))return he;if(this.state.backtracking===0&&ct.add(st),this.state.backtracking===0){he.tree=Ee;var er=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var Kt=this.adaptor.nil();Kt=this.adaptor.becomeRoot(this.adaptor.create(we,"FUNCTION"),Kt);{var qt=this.adaptor.nil();for(qt=this.adaptor.becomeRoot(this.adaptor.create(ae,"PARAMS"),qt);lt.hasNext();)this.adaptor.addChild(qt,lt.nextNode());lt.reset(),this.adaptor.addChild(Kt,qt)}{var qt=this.adaptor.nil();for(qt=this.adaptor.becomeRoot(this.adaptor.create(ue,"DEFAULTS"),qt);Xe.hasNext();)this.adaptor.addChild(qt,Xe.nextTree());Xe.reset(),this.adaptor.addChild(Kt,qt)}this.adaptor.addChild(Kt,St.nextTree()),this.adaptor.addChild(Ee,Kt)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Jt){if(Jt instanceof org.antlr.runtime.RecognitionException)this.reportError(Jt),this.recover(this.input,Jt),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Jt);else throw Jt}finally{}return he},tryCatch_return:function(){FormulaParser.tryCatch_return=function(){},org.antlr.lang.extend(FormulaParser.tryCatch_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),tryCatch:function(){var he=new FormulaParser.tryCatch_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=null,Ie=null,Ve=null,We=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token IDENT"),$e=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token TRYSTATEMENT"),Be=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token NEWLINE"),Je=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token CATCHSTATEMENT"),st=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token ENDBLOCK"),je=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule innerBlock");try{if(Fe=this.match(this.input,gt,FormulaParser.FOLLOW_TRYSTATEMENT_in_tryCatch904),this.state.failed)return he;this.state.backtracking===0&&$e.add(Fe);var He=0;e:do{var it=2,ct=this.input.LA(1);switch(ct==Me&&(it=1),it){case 1:if(Pe=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_tryCatch906),this.state.failed)return he;this.state.backtracking===0&&Be.add(Pe);break;default:if(He>=1)break e;if(this.state.backtracking>0)return this.state.failed=!0,he;var ht=new org.antlr.runtime.EarlyExitException(22,this.input);throw ht}He++}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_innerBlock_in_tryCatch909),Ie=this.innerBlock(),this.state._fsp--,this.state.failed||(this.state.backtracking===0&&je.add(Ie.getTree()),ye=this.match(this.input,Zt,FormulaParser.FOLLOW_CATCHSTATEMENT_in_tryCatch911),this.state.failed)||(this.state.backtracking===0&&Je.add(ye),ke=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_tryCatch913),this.state.failed))return he;this.state.backtracking===0&&We.add(ke);var lt=0;e:do{var ut=2,ze=this.input.LA(1);switch(ze==Me&&(ut=1),ut){case 1:if(Ae=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_tryCatch915),this.state.failed)return he;this.state.backtracking===0&&Be.add(Ae);break;default:if(lt>=1)break e;if(this.state.backtracking>0)return this.state.failed=!0,he;var ht=new org.antlr.runtime.EarlyExitException(23,this.input);throw ht}lt++}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_innerBlock_in_tryCatch919),Ve=this.innerBlock(),this.state._fsp--,this.state.failed||(this.state.backtracking===0&&je.add(Ve.getTree()),Re=this.match(this.input,at,FormulaParser.FOLLOW_ENDBLOCK_in_tryCatch921),this.state.failed)||(this.state.backtracking===0&&st.add(Re),Ce=this.match(this.input,gt,FormulaParser.FOLLOW_TRYSTATEMENT_in_tryCatch923),this.state.failed))return he;if(this.state.backtracking===0&&$e.add(Ce),this.state.backtracking===0){he.tree=Ee;var rt=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var vt=this.adaptor.nil();for(vt=this.adaptor.becomeRoot(this.adaptor.create(be,"TRYCATCH"),vt);je.hasNext();)this.adaptor.addChild(vt,je.nextTree());je.reset(),this.adaptor.addChild(vt,We.nextNode()),this.adaptor.addChild(Ee,vt)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(wt){if(wt instanceof org.antlr.runtime.RecognitionException)this.reportError(wt),this.recover(this.input,wt),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),wt);else throw wt}finally{}return he},throwExp_return:function(){FormulaParser.throwExp_return=function(){},org.antlr.lang.extend(FormulaParser.throwExp_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),throwExp:function(){var he=new FormulaParser.throwExp_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token THROWSTATEMENT"),ke=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule primaryExpression");try{if(Fe=this.match(this.input,Ot,FormulaParser.FOLLOW_THROWSTATEMENT_in_throwExp945),this.state.failed||(this.state.backtracking===0&&ye.add(Fe),this.pushFollow(FormulaParser.FOLLOW_primaryExpression_in_throwExp947),Pe=this.primaryExpression(),this.state._fsp--,this.state.failed))return he;if(this.state.backtracking===0&&ke.add(Pe.getTree()),this.state.backtracking===0){he.tree=Ee;var Ae=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var Re=this.adaptor.nil();Re=this.adaptor.becomeRoot(this.adaptor.create(De,"THROW"),Re),this.adaptor.addChild(Re,ke.nextTree()),this.adaptor.addChild(Ee,Re)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ce){if(Ce instanceof org.antlr.runtime.RecognitionException)this.reportError(Ce),this.recover(this.input,Ce),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ce);else throw Ce}finally{}return he},anonFunctionDef_return:function(){FormulaParser.anonFunctionDef_return=function(){},org.antlr.lang.extend(FormulaParser.anonFunctionDef_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),anonFunctionDef:function(){var he=new FormulaParser.anonFunctionDef_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=null,Ie=null,Ve=null,We=null,$e=null,Be=null,Je=null,st=null,je=null,He=null,it=null,ct=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token FUNCTIONSTATEMENT"),ht=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token 114"),lt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token IDENT"),ut=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token EQUALS"),ze=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token 113"),rt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token NEWLINE"),vt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token COMMA"),wt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token ENDBLOCK"),St=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule expression"),Xe=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule innerBlock"),_t=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule defaultValue");try{if(Fe=this.match(this.input,Ye,FormulaParser.FOLLOW_FUNCTIONSTATEMENT_in_anonFunctionDef967),this.state.failed||(this.state.backtracking===0&&ct.add(Fe),Pe=this.match(this.input,113,FormulaParser.FOLLOW_113_in_anonFunctionDef970),this.state.failed))return he;this.state.backtracking===0&&ze.add(Pe);var mt=2,Tt=this.input.LA(1);switch(Tt==Qe&&(mt=1),mt){case 1:if(ye=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_anonFunctionDef973),this.state.failed)return he;this.state.backtracking===0&&lt.add(ye);var Nt=2,Ft=this.input.LA(1);if(Ft==Rt)Nt=1;else if(Ft==pt||Ft==114)Nt=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Lt=new org.antlr.runtime.NoViableAltException("",25,0,this.input);throw Lt}switch(Nt){case 1:if(ke=this.match(this.input,Rt,FormulaParser.FOLLOW_EQUALS_in_anonFunctionDef977),this.state.failed||(this.state.backtracking===0&&ut.add(ke),this.pushFollow(FormulaParser.FOLLOW_defaultValue_in_anonFunctionDef980),st=this.defaultValue(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&_t.add(st.getTree());break;case 2:e:do{var bt=2,It=this.input.LA(1);if(It==pt){var Yt=this.input.LA(2);if(Yt==Qe){var Qt=this.input.LA(3);(Qt==pt||Qt==114)&&(bt=1)}}switch(bt){case 1:if(Ae=this.match(this.input,pt,FormulaParser.FOLLOW_COMMA_in_anonFunctionDef985),this.state.failed||(this.state.backtracking===0&&vt.add(Ae),Re=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_anonFunctionDef987),this.state.failed))return he;this.state.backtracking===0&&lt.add(Re);break;default:break e}}while(!0);break}e:do{var zt=2,Xt=this.input.LA(1);switch(Xt==pt&&(zt=1),zt){case 1:if(Ce=this.match(this.input,pt,FormulaParser.FOLLOW_COMMA_in_anonFunctionDef994),this.state.failed||(this.state.backtracking===0&&vt.add(Ce),Ie=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_anonFunctionDef996),this.state.failed)||(this.state.backtracking===0&&lt.add(Ie),Ve=this.match(this.input,Rt,FormulaParser.FOLLOW_EQUALS_in_anonFunctionDef998),this.state.failed)||(this.state.backtracking===0&&ut.add(Ve),this.pushFollow(FormulaParser.FOLLOW_defaultValue_in_anonFunctionDef1000),je=this.defaultValue(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&_t.add(je.getTree());break;default:break e}}while(!0);break}if(We=this.match(this.input,114,FormulaParser.FOLLOW_114_in_anonFunctionDef1007),this.state.failed)return he;this.state.backtracking===0&&ht.add(We);var Dt=2,dt=this.input.LA(1);if(dt==Me)Dt=1;else if(dt==Ue||dt==Ke||dt==Ge||dt==Ye||dt>=Bt&&dt<=gt||dt>=Ot&&dt<=Qe||dt==Pt||dt==Mt||dt>=Gt&&dt<=xt||dt==kt||dt>=Ut&&dt<=Vt||dt==113)Dt=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Lt=new org.antlr.runtime.NoViableAltException("",29,0,this.input);throw Lt}switch(Dt){case 1:var Ht=0;e:do{var er=2,Kt=this.input.LA(1);switch(Kt==Me&&(er=1),er){case 1:if($e=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_anonFunctionDef1012),this.state.failed)return he;this.state.backtracking===0&&rt.add($e);break;default:if(Ht>=1)break e;if(this.state.backtracking>0)return this.state.failed=!0,he;var qt=new org.antlr.runtime.EarlyExitException(28,this.input);throw qt}Ht++}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_innerBlock_in_anonFunctionDef1015),He=this.innerBlock(),this.state._fsp--,this.state.failed||(this.state.backtracking===0&&Xe.add(He.getTree()),Be=this.match(this.input,at,FormulaParser.FOLLOW_ENDBLOCK_in_anonFunctionDef1018),this.state.failed)||(this.state.backtracking===0&&wt.add(Be),Je=this.match(this.input,Ye,FormulaParser.FOLLOW_FUNCTIONSTATEMENT_in_anonFunctionDef1020),this.state.failed))return he;this.state.backtracking===0&&ct.add(Je);break;case 2:if(this.pushFollow(FormulaParser.FOLLOW_expression_in_anonFunctionDef1025),it=this.expression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&St.add(it.getTree());break}if(this.state.backtracking===0){he.tree=Ee;var Jt=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var yt=this.adaptor.nil();yt=this.adaptor.becomeRoot(this.adaptor.create(ge,"ANONFUNCTION"),yt);{var At=this.adaptor.nil();for(At=this.adaptor.becomeRoot(this.adaptor.create(ae,"PARAMS"),At);lt.hasNext();)this.adaptor.addChild(At,lt.nextNode());lt.reset(),this.adaptor.addChild(yt,At)}{var At=this.adaptor.nil();for(At=this.adaptor.becomeRoot(this.adaptor.create(ue,"DEFAULTS"),At);_t.hasNext();)this.adaptor.addChild(At,_t.nextTree());_t.reset(),this.adaptor.addChild(yt,At)}Xe.hasNext()&&this.adaptor.addChild(yt,Xe.nextTree()),Xe.reset(),St.hasNext()&&this.adaptor.addChild(yt,St.nextTree()),St.reset(),this.adaptor.addChild(Ee,yt)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ct){if(Ct instanceof org.antlr.runtime.RecognitionException)this.reportError(Ct),this.recover(this.input,Ct),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ct);else throw Ct}finally{}return he},assignment_return:function(){FormulaParser.assignment_return=function(){},org.antlr.lang.extend(FormulaParser.assignment_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),assignment:function(){var he=new FormulaParser.assignment_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=null,Ie=null,Ve=null,We=null,$e=null,Be=null,Je=null,st=null,je=null,He=null,it=null,ct=null,ht=null,lt=null,ut=null,ze=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token 114"),rt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token IDENT"),vt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token 115"),wt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token EQUALS"),St=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token 113"),Xe=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token COMMA"),_t=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token PRIMITIVE"),mt=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule assigned"),Tt=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule defaultValue"),Nt=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule logicalExpression");try{var Ft=2,Lt=this.input.LA(1);if(Lt==Qe){var bt=this.input.LA(2);if(bt==113)Ft=1;else if(bt==xt||bt==kt||bt==pt||bt>=115&&bt<=116)Ft=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var It=new org.antlr.runtime.NoViableAltException("",37,1,this.input);throw It}}else if(Lt==Pt)Ft=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var It=new org.antlr.runtime.NoViableAltException("",37,0,this.input);throw It}switch(Ft){case 1:if(Fe=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_assignment1067),this.state.failed||(this.state.backtracking===0&&rt.add(Fe),Pe=this.match(this.input,113,FormulaParser.FOLLOW_113_in_assignment1069),this.state.failed))return he;this.state.backtracking===0&&St.add(Pe);var Yt=2,Qt=this.input.LA(1);switch(Qt==Qe&&(Yt=1),Yt){case 1:if(ye=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_assignment1072),this.state.failed)return he;this.state.backtracking===0&&rt.add(ye);var zt=2,Xt=this.input.LA(1);if(Xt==Rt)zt=1;else if(Xt==pt||Xt==114)zt=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var It=new org.antlr.runtime.NoViableAltException("",31,0,this.input);throw It}switch(zt){case 1:if(ke=this.match(this.input,Rt,FormulaParser.FOLLOW_EQUALS_in_assignment1076),this.state.failed||(this.state.backtracking===0&&wt.add(ke),this.pushFollow(FormulaParser.FOLLOW_defaultValue_in_assignment1078),He=this.defaultValue(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&Tt.add(He.getTree());break;case 2:e:do{var Dt=2,dt=this.input.LA(1);if(dt==pt){var Ht=this.input.LA(2);if(Ht==Qe){var er=this.input.LA(3);(er==pt||er==114)&&(Dt=1)}}switch(Dt){case 1:if(Ae=this.match(this.input,pt,FormulaParser.FOLLOW_COMMA_in_assignment1083),this.state.failed||(this.state.backtracking===0&&Xe.add(Ae),Re=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_assignment1085),this.state.failed))return he;this.state.backtracking===0&&rt.add(Re);break;default:break e}}while(!0);break}e:do{var Kt=2,qt=this.input.LA(1);switch(qt==pt&&(Kt=1),Kt){case 1:if(Ce=this.match(this.input,pt,FormulaParser.FOLLOW_COMMA_in_assignment1092),this.state.failed||(this.state.backtracking===0&&Xe.add(Ce),Ie=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_assignment1094),this.state.failed)||(this.state.backtracking===0&&rt.add(Ie),Ve=this.match(this.input,Rt,FormulaParser.FOLLOW_EQUALS_in_assignment1096),this.state.failed)||(this.state.backtracking===0&&wt.add(Ve),this.pushFollow(FormulaParser.FOLLOW_defaultValue_in_assignment1098),it=this.defaultValue(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&Tt.add(it.getTree());break;default:break e}}while(!0);break}if(We=this.match(this.input,114,FormulaParser.FOLLOW_114_in_assignment1105),this.state.failed||(this.state.backtracking===0&&ze.add(We),$e=this.match(this.input,115,FormulaParser.FOLLOW_115_in_assignment1107),this.state.failed)||(this.state.backtracking===0&&vt.add($e),this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_assignment1109),ct=this.logicalExpression(),this.state._fsp--,this.state.failed))return he;if(this.state.backtracking===0&&Nt.add(ct.getTree()),this.state.backtracking===0){he.tree=Ee;var Jt=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var yt=this.adaptor.nil();yt=this.adaptor.becomeRoot(this.adaptor.create(we,"FUNCTION"),yt);{var At=this.adaptor.nil();for(At=this.adaptor.becomeRoot(this.adaptor.create(ae,"PARAMS"),At);rt.hasNext();)this.adaptor.addChild(At,rt.nextNode());rt.reset(),this.adaptor.addChild(yt,At)}{var At=this.adaptor.nil();for(At=this.adaptor.becomeRoot(this.adaptor.create(ue,"DEFAULTS"),At);Tt.hasNext();)this.adaptor.addChild(At,Tt.nextTree());Tt.reset(),this.adaptor.addChild(yt,At)}this.adaptor.addChild(yt,Nt.nextTree()),this.adaptor.addChild(Ee,yt)}he.tree=Ee}break;case 2:var Ct=2,sr=this.input.LA(1);if(sr==Pt)Ct=1;else if(sr==Qe)Ct=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var It=new org.antlr.runtime.NoViableAltException("",34,0,this.input);throw It}switch(Ct){case 1:if(Be=this.match(this.input,Pt,FormulaParser.FOLLOW_PRIMITIVE_in_assignment1137),this.state.failed)return he;this.state.backtracking===0&&_t.add(Be);break;case 2:if(this.pushFollow(FormulaParser.FOLLOW_assigned_in_assignment1141),ht=this.assigned(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&mt.add(ht.getTree());break}e:do{var fr=2,Lr=this.input.LA(1);switch(Lr==pt&&(fr=1),fr){case 1:if(Je=this.match(this.input,pt,FormulaParser.FOLLOW_COMMA_in_assignment1145),this.state.failed)return he;this.state.backtracking===0&&Xe.add(Je);var nr=2,or=this.input.LA(1);if(or==Pt)nr=1;else if(or==Qe)nr=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var It=new org.antlr.runtime.NoViableAltException("",35,0,this.input);throw It}switch(nr){case 1:if(st=this.match(this.input,Pt,FormulaParser.FOLLOW_PRIMITIVE_in_assignment1148),this.state.failed)return he;this.state.backtracking===0&&_t.add(st);break;case 2:if(this.pushFollow(FormulaParser.FOLLOW_assigned_in_assignment1152),lt=this.assigned(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&mt.add(lt.getTree());break}break;default:break e}}while(!0);if(je=this.match(this.input,115,FormulaParser.FOLLOW_115_in_assignment1158),this.state.failed||(this.state.backtracking===0&&vt.add(je),this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_assignment1160),ut=this.logicalExpression(),this.state._fsp--,this.state.failed))return he;if(this.state.backtracking===0&&Nt.add(ut.getTree()),this.state.backtracking===0){he.tree=Ee;var Jt=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var yt=this.adaptor.nil();for(yt=this.adaptor.becomeRoot(this.adaptor.create(re,"ASSIGN"),yt);_t.hasNext();)this.adaptor.addChild(yt,_t.nextNode());for(_t.reset();mt.hasNext();)this.adaptor.addChild(yt,mt.nextTree());mt.reset(),this.adaptor.addChild(yt,Nt.nextTree()),this.adaptor.addChild(Ee,yt)}he.tree=Ee}break}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(rr){if(rr instanceof org.antlr.runtime.RecognitionException)this.reportError(rr),this.recover(this.input,rr),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),rr);else throw rr}finally{}return he},assigned_return:function(){FormulaParser.assigned_return=function(){},org.antlr.lang.extend(FormulaParser.assigned_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),assigned:function(){var he=new FormulaParser.assigned_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token IDENT"),ke=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule selector");try{if(Fe=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_assigned1186),this.state.failed)return he;this.state.backtracking===0&&ye.add(Fe);var Ae=2,Re=this.input.LA(1);switch((Re==xt||Re==kt||Re==116)&&(Ae=1),Ae){case 1:if(this.pushFollow(FormulaParser.FOLLOW_selector_in_assigned1188),Pe=this.selector(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&ke.add(Pe.getTree());break}if(this.state.backtracking===0){he.tree=Ee;var Ce=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var Ie=this.adaptor.nil();Ie=this.adaptor.becomeRoot(this.adaptor.create(Le,"ASSIGNED"),Ie),this.adaptor.addChild(Ie,ye.nextNode()),ke.hasNext()&&this.adaptor.addChild(Ie,ke.nextTree()),ke.reset(),this.adaptor.addChild(Ee,Ie)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ve){if(Ve instanceof org.antlr.runtime.RecognitionException)this.reportError(Ve),this.recover(this.input,Ve),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ve);else throw Ve}finally{}return he},logicalExpression_return:function(){FormulaParser.logicalExpression_return=function(){},org.antlr.lang.extend(FormulaParser.logicalExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),logicalExpression:function(){var he=new FormulaParser.logicalExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null;try{if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_booleanXORExpression_in_logicalExpression1214),Pe=this.booleanXORExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());e:do{var Ae=2,Re=this.input.LA(1);if(Re==Wt){var Ce=this.input.LA(2);this.synpred47_Formula()&&(Ae=1)}switch(Ae){case 1:if(Fe=this.match(this.input,Wt,FormulaParser.FOLLOW_OR_in_logicalExpression1217),this.state.failed||(this.state.backtracking===0&&(ke=this.adaptor.create(Fe),Ee=this.adaptor.becomeRoot(ke,Ee)),this.pushFollow(FormulaParser.FOLLOW_booleanXORExpression_in_logicalExpression1220),ye=this.booleanXORExpression(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break;default:break e}}while(!0);he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ie){if(Ie instanceof org.antlr.runtime.RecognitionException)this.reportError(Ie),this.recover(this.input,Ie),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ie);else throw Ie}finally{}return he},booleanXORExpression_return:function(){FormulaParser.booleanXORExpression_return=function(){},org.antlr.lang.extend(FormulaParser.booleanXORExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),booleanXORExpression:function(){var he=new FormulaParser.booleanXORExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null;try{if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_booleanAndExpression_in_booleanXORExpression1250),Pe=this.booleanAndExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());e:do{var Ae=2,Re=this.input.LA(1);if(Re==jt){var Ce=this.input.LA(2);this.synpred48_Formula()&&(Ae=1)}switch(Ae){case 1:if(Fe=this.match(this.input,jt,FormulaParser.FOLLOW_XOR_in_booleanXORExpression1253),this.state.failed||(this.state.backtracking===0&&(ke=this.adaptor.create(Fe),Ee=this.adaptor.becomeRoot(ke,Ee)),this.pushFollow(FormulaParser.FOLLOW_booleanAndExpression_in_booleanXORExpression1256),ye=this.booleanAndExpression(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break;default:break e}}while(!0);he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ie){if(Ie instanceof org.antlr.runtime.RecognitionException)this.reportError(Ie),this.recover(this.input,Ie),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ie);else throw Ie}finally{}return he},booleanAndExpression_return:function(){FormulaParser.booleanAndExpression_return=function(){},org.antlr.lang.extend(FormulaParser.booleanAndExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),booleanAndExpression:function(){var he=new FormulaParser.booleanAndExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null;try{if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_equalityExpression_in_booleanAndExpression1285),Pe=this.equalityExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());e:do{var Ae=2,Re=this.input.LA(1);if(Re==hr){var Ce=this.input.LA(2);this.synpred49_Formula()&&(Ae=1)}switch(Ae){case 1:if(Fe=this.match(this.input,hr,FormulaParser.FOLLOW_AND_in_booleanAndExpression1288),this.state.failed||(this.state.backtracking===0&&(ke=this.adaptor.create(Fe),Ee=this.adaptor.becomeRoot(ke,Ee)),this.pushFollow(FormulaParser.FOLLOW_equalityExpression_in_booleanAndExpression1291),ye=this.equalityExpression(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break;default:break e}}while(!0);he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ie){if(Ie instanceof org.antlr.runtime.RecognitionException)this.reportError(Ie),this.recover(this.input,Ie),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ie);else throw Ie}finally{}return he},equalityExpression_return:function(){FormulaParser.equalityExpression_return=function(){},org.antlr.lang.extend(FormulaParser.equalityExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),equalityExpression:function(){var he=new FormulaParser.equalityExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null;try{if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_relationalExpression_in_equalityExpression1322),Pe=this.relationalExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());e:do{var ke=2,Ae=this.input.LA(1);if(Ae==Rt||Ae==dr){var Re=this.input.LA(2);this.synpred51_Formula()&&(ke=1)}switch(ke){case 1:if(Fe=this.input.LT(1),this.input.LA(1)==Rt||this.input.LA(1)==dr)this.input.consume(),this.state.backtracking===0&&(Ee=this.adaptor.becomeRoot(this.adaptor.create(Fe),Ee)),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Ce=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ce}if(this.pushFollow(FormulaParser.FOLLOW_relationalExpression_in_equalityExpression1332),ye=this.relationalExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break;default:break e}}while(!0);he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ie){if(Ie instanceof org.antlr.runtime.RecognitionException)this.reportError(Ie),this.recover(this.input,Ie),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ie);else throw Ie}finally{}return he},relationalExpression_return:function(){FormulaParser.relationalExpression_return=function(){},org.antlr.lang.extend(FormulaParser.relationalExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),relationalExpression:function(){var he=new FormulaParser.relationalExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null;try{if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_additiveExpression_in_relationalExpression1374),Pe=this.additiveExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());e:do{var ke=2,Ae=this.input.LA(1);if(Ae>=pr&&Ae<=mr){var Re=this.input.LA(2);this.synpred55_Formula()&&(ke=1)}switch(ke){case 1:if(Fe=this.input.LT(1),this.input.LA(1)>=pr&&this.input.LA(1)<=mr)this.input.consume(),this.state.backtracking===0&&(Ee=this.adaptor.becomeRoot(this.adaptor.create(Fe),Ee)),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Ce=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ce}if(this.pushFollow(FormulaParser.FOLLOW_additiveExpression_in_relationalExpression1389),ye=this.additiveExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break;default:break e}}while(!0);he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ie){if(Ie instanceof org.antlr.runtime.RecognitionException)this.reportError(Ie),this.recover(this.input,Ie),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ie);else throw Ie}finally{}return he},additiveExpression_return:function(){FormulaParser.additiveExpression_return=function(){},org.antlr.lang.extend(FormulaParser.additiveExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),additiveExpression:function(){var he=new FormulaParser.additiveExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null;try{if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_multiplicativeExpression_in_additiveExpression1432),Pe=this.multiplicativeExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());e:do{var ke=2,Ae=this.input.LA(1);if(Ae>=gr&&Ae<=Mt){var Re=this.input.LA(2);this.synpred57_Formula()&&(ke=1)}switch(ke){case 1:if(Fe=this.input.LT(1),this.input.LA(1)>=gr&&this.input.LA(1)<=Mt)this.input.consume(),this.state.backtracking===0&&(Ee=this.adaptor.becomeRoot(this.adaptor.create(Fe),Ee)),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Ce=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ce}if(this.pushFollow(FormulaParser.FOLLOW_multiplicativeExpression_in_additiveExpression1443),ye=this.multiplicativeExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break;default:break e}}while(!0);he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ie){if(Ie instanceof org.antlr.runtime.RecognitionException)this.reportError(Ie),this.recover(this.input,Ie),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ie);else throw Ie}finally{}return he},multiplicativeExpression_return:function(){FormulaParser.multiplicativeExpression_return=function(){},org.antlr.lang.extend(FormulaParser.multiplicativeExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),multiplicativeExpression:function(){var he=new FormulaParser.multiplicativeExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null;try{if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_arrayExpression_in_multiplicativeExpression1473),Pe=this.arrayExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());e:do{var ke=2,Ae=this.input.LA(1);if(Ae>=$t&&Ae<=_r){var Re=this.input.LA(2);this.synpred60_Formula()&&(ke=1)}switch(ke){case 1:if(Fe=this.input.LT(1),this.input.LA(1)>=$t&&this.input.LA(1)<=_r)this.input.consume(),this.state.backtracking===0&&(Ee=this.adaptor.becomeRoot(this.adaptor.create(Fe),Ee)),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Ce=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Ce}if(this.pushFollow(FormulaParser.FOLLOW_arrayExpression_in_multiplicativeExpression1486),ye=this.arrayExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break;default:break e}}while(!0);he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ie){if(Ie instanceof org.antlr.runtime.RecognitionException)this.reportError(Ie),this.recover(this.input,Ie),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ie);else throw Ie}finally{}return he},arrayExpression_return:function(){FormulaParser.arrayExpression_return=function(){},org.antlr.lang.extend(FormulaParser.arrayExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),arrayExpression:function(){var he=new FormulaParser.arrayExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token COLON"),Ce=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule negationExpression");try{if(this.pushFollow(FormulaParser.FOLLOW_negationExpression_in_arrayExpression1532),ye=this.negationExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Ce.add(ye.getTree());var Ie=2,Ve=this.input.LA(1);if(Ve==tr){var We=this.input.LA(2);this.synpred61_Formula()&&this.input.get(this.input.index()-1).getText()!=" "&&(Ie=1)}switch(Ie){case 1:if(this.input.get(this.input.index()-1).getText()==" "){if(this.state.backtracking>0)return this.state.failed=!0,he;throw new org.antlr.runtime.FailedPredicateException(this.input,"arrayExpression",' this.input.get(this.input.index()-1).getText()!=" "')}if(Fe=this.match(this.input,tr,FormulaParser.FOLLOW_COLON_in_arrayExpression1538),this.state.failed)return he;if(this.state.backtracking===0&&Re.add(Fe),this.input.get(this.input.index()-1).getText()==" "){if(this.state.backtracking>0)return this.state.failed=!0,he;throw new org.antlr.runtime.FailedPredicateException(this.input,"arrayExpression",' this.input.get(this.input.index()-1).getText()!=" "')}if(this.pushFollow(FormulaParser.FOLLOW_negationExpression_in_arrayExpression1542),ke=this.negationExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Ce.add(ke.getTree());break}var $e=2,Be=this.input.LA(1);if(Be==tr){var Je=this.input.LA(2);this.synpred62_Formula()&&this.input.get(this.input.index()-1).getText()!=" "&&($e=1)}switch($e){case 1:if(this.input.get(this.input.index()-1).getText()==" "){if(this.state.backtracking>0)return this.state.failed=!0,he;throw new org.antlr.runtime.FailedPredicateException(this.input,"arrayExpression",' this.input.get(this.input.index()-1).getText()!=" "')}if(Pe=this.match(this.input,tr,FormulaParser.FOLLOW_COLON_in_arrayExpression1551),this.state.failed)return he;if(this.state.backtracking===0&&Re.add(Pe),this.input.get(this.input.index()-1).getText()==" "){if(this.state.backtracking>0)return this.state.failed=!0,he;throw new org.antlr.runtime.FailedPredicateException(this.input,"arrayExpression",' this.input.get(this.input.index()-1).getText()!=" "')}if(this.pushFollow(FormulaParser.FOLLOW_negationExpression_in_arrayExpression1555),Ae=this.negationExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Ce.add(Ae.getTree());break}if(this.state.backtracking===0){he.tree=Ee;var st=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var je=this.adaptor.nil();for(je=this.adaptor.becomeRoot(this.adaptor.create(Te,"RANGE"),je);Ce.hasNext();)this.adaptor.addChild(je,Ce.nextTree());Ce.reset(),this.adaptor.addChild(Ee,je)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(He){if(He instanceof org.antlr.runtime.RecognitionException)this.reportError(He),this.recover(this.input,He),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),He);else throw He}finally{}return he},negationExpression_return:function(){FormulaParser.negationExpression_return=function(){},org.antlr.lang.extend(FormulaParser.negationExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),negationExpression:function(){var he=new FormulaParser.negationExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token MINUS"),Ae=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule powerExpression");try{var Re=2,Ce=this.input.LA(1);if(Ce==Mt)Re=1;else if(Ce==Ye||Ce==Et||Ce==Qe||Ce==Pt||Ce>=Gt&&Ce<=xt||Ce==kt||Ce>=Ut&&Ce<=Vt||Ce==113)Re=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Ie=new org.antlr.runtime.NoViableAltException("",48,0,this.input);throw Ie}switch(Re){case 1:if(Fe=this.match(this.input,Mt,FormulaParser.FOLLOW_MINUS_in_negationExpression1580),this.state.failed||(this.state.backtracking===0&&ke.add(Fe),this.pushFollow(FormulaParser.FOLLOW_powerExpression_in_negationExpression1582),Pe=this.powerExpression(),this.state._fsp--,this.state.failed))return he;if(this.state.backtracking===0&&Ae.add(Pe.getTree()),this.state.backtracking===0){he.tree=Ee;var Ve=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var We=this.adaptor.nil();We=this.adaptor.becomeRoot(this.adaptor.create(ee,"NEGATE"),We),this.adaptor.addChild(We,Ae.nextTree()),this.adaptor.addChild(Ee,We)}he.tree=Ee}break;case 2:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_powerExpression_in_negationExpression1596),ye=this.powerExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch($e){if($e instanceof org.antlr.runtime.RecognitionException)this.reportError($e),this.recover(this.input,$e),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),$e);else throw $e}finally{}return he},powerExpression_return:function(){FormulaParser.powerExpression_return=function(){},org.antlr.lang.extend(FormulaParser.powerExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),powerExpression:function(){var he=new FormulaParser.powerExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token POW"),Ae=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule unaryOrNegate"),Re=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule unaryExpression");try{if(this.pushFollow(FormulaParser.FOLLOW_unaryExpression_in_powerExpression1607),Pe=this.unaryExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Re.add(Pe.getTree());e:do{var Ce=2,Ie=this.input.LA(1);if(Ie==ir){var Ve=this.input.LA(2);this.synpred64_Formula()&&(Ce=1)}switch(Ce){case 1:if(Fe=this.match(this.input,ir,FormulaParser.FOLLOW_POW_in_powerExpression1610),this.state.failed||(this.state.backtracking===0&&ke.add(Fe),this.pushFollow(FormulaParser.FOLLOW_unaryOrNegate_in_powerExpression1612),ye=this.unaryOrNegate(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&Ae.add(ye.getTree());break;default:break e}}while(!0);if(this.state.backtracking===0){he.tree=Ee;var We=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var $e=this.adaptor.nil();for($e=this.adaptor.becomeRoot(this.adaptor.create(fe,"POWER"),$e),this.adaptor.addChild($e,Re.nextTree());Ae.hasNext();)this.adaptor.addChild($e,Ae.nextTree());Ae.reset(),this.adaptor.addChild(Ee,$e)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Be){if(Be instanceof org.antlr.runtime.RecognitionException)this.reportError(Be),this.recover(this.input,Be),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Be);else throw Be}finally{}return he},unaryOrNegate_return:function(){FormulaParser.unaryOrNegate_return=function(){},org.antlr.lang.extend(FormulaParser.unaryOrNegate_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),unaryOrNegate:function(){var he=new FormulaParser.unaryOrNegate_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token MINUS"),Ae=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule unaryExpression");try{var Re=2,Ce=this.input.LA(1);if(Ce==Ye||Ce==Et||Ce==Qe||Ce==Pt||Ce>=Gt&&Ce<=xt||Ce==kt||Ce>=Ut&&Ce<=Vt||Ce==113)Re=1;else if(Ce==Mt)Re=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Ie=new org.antlr.runtime.NoViableAltException("",50,0,this.input);throw Ie}switch(Re){case 1:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_unaryExpression_in_unaryOrNegate1639),Pe=this.unaryExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());break;case 2:if(Fe=this.match(this.input,Mt,FormulaParser.FOLLOW_MINUS_in_unaryOrNegate1645),this.state.failed||(this.state.backtracking===0&&ke.add(Fe),this.pushFollow(FormulaParser.FOLLOW_unaryExpression_in_unaryOrNegate1647),ye=this.unaryExpression(),this.state._fsp--,this.state.failed))return he;if(this.state.backtracking===0&&Ae.add(ye.getTree()),this.state.backtracking===0){he.tree=Ee;var Ve=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var We=this.adaptor.nil();We=this.adaptor.becomeRoot(this.adaptor.create(ee,"NEGATE"),We),this.adaptor.addChild(We,Ae.nextTree()),this.adaptor.addChild(Ee,We)}he.tree=Ee}break}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch($e){if($e instanceof org.antlr.runtime.RecognitionException)this.reportError($e),this.recover(this.input,$e),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),$e);else throw $e}finally{}return he},unaryExpression_return:function(){FormulaParser.unaryExpression_return=function(){},org.antlr.lang.extend(FormulaParser.unaryExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),unaryExpression:function(){var he=new FormulaParser.unaryExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null;try{var Ae=2,Re=this.input.LA(1);if(Re==Gt)Ae=1;else if(Re==Ye||Re==Et||Re==Qe||Re==Pt||Re==xt||Re==kt||Re>=Ut&&Re<=Vt||Re==113)Ae=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Ce=new org.antlr.runtime.NoViableAltException("",51,0,this.input);throw Ce}switch(Ae){case 1:if(Ee=this.adaptor.nil(),Fe=this.match(this.input,Gt,FormulaParser.FOLLOW_NOT_in_unaryExpression1675),this.state.failed||(this.state.backtracking===0&&(ke=this.adaptor.create(Fe),Ee=this.adaptor.becomeRoot(ke,Ee)),this.pushFollow(FormulaParser.FOLLOW_innerPrimaryExpression_in_unaryExpression1678),Pe=this.innerPrimaryExpression(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());break;case 2:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_innerPrimaryExpression_in_unaryExpression1687),ye=this.innerPrimaryExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ie){if(Ie instanceof org.antlr.runtime.RecognitionException)this.reportError(Ie),this.recover(this.input,Ie),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ie);else throw Ie}finally{}return he},innerPrimaryExpression_return:function(){FormulaParser.innerPrimaryExpression_return=function(){},org.antlr.lang.extend(FormulaParser.innerPrimaryExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),innerPrimaryExpression:function(){var he=new FormulaParser.innerPrimaryExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule selectionExpression");try{if(this.pushFollow(FormulaParser.FOLLOW_selectionExpression_in_innerPrimaryExpression1718),Fe=this.selectionExpression(),this.state._fsp--,this.state.failed)return he;if(this.state.backtracking===0&&Pe.add(Fe.getTree()),this.state.backtracking===0){he.tree=Ee;var ye=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var ke=this.adaptor.nil();ke=this.adaptor.becomeRoot(this.adaptor.create(Ne,"INNER"),ke),this.adaptor.addChild(ke,Pe.nextTree()),this.adaptor.addChild(Ee,ke)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ae){if(Ae instanceof org.antlr.runtime.RecognitionException)this.reportError(Ae),this.recover(this.input,Ae),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ae);else throw Ae}finally{}return he},selectionExpression_return:function(){FormulaParser.selectionExpression_return=function(){},org.antlr.lang.extend(FormulaParser.selectionExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),selectionExpression:function(){var he=new FormulaParser.selectionExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null;try{if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_primaryExpression_in_selectionExpression1738),Fe=this.primaryExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Fe.getTree());e:do{var ke=2;switch(this.input.LA(1)){case xt:var Ae=this.input.LA(2);this.synpred68_Formula()&&this.input.get(this.input.index()-1).getText()!=" "&&(ke=1);break;case kt:var Re=this.input.LA(2);this.synpred68_Formula()&&this.input.get(this.input.index()-1).getText()!=" "&&(ke=1);break;case 116:var Ce=this.input.LA(2);this.synpred68_Formula()&&this.input.get(this.input.index()-1).getText()!=" "&&(ke=1);break;case 113:var Ie=this.input.LA(2);this.synpred68_Formula()&&this.input.get(this.input.index()-1).getText()!=" "&&(ke=1);break}switch(ke){case 1:if(this.input.get(this.input.index()-1).getText()==" "){if(this.state.backtracking>0)return this.state.failed=!0,he;throw new org.antlr.runtime.FailedPredicateException(this.input,"selectionExpression",' this.input.get(this.input.index()-1).getText()!=" "')}var Ve=2,We=this.input.LA(1);if(We==xt||We==kt||We==116)Ve=1;else if(We==113)Ve=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var $e=new org.antlr.runtime.NoViableAltException("",52,0,this.input);throw $e}switch(Ve){case 1:if(this.pushFollow(FormulaParser.FOLLOW_selector_in_selectionExpression1744),Pe=this.selector(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());break;case 2:if(this.pushFollow(FormulaParser.FOLLOW_funCall_in_selectionExpression1746),ye=this.funCall(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break}break;default:break e}}while(!0);he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Be){if(Be instanceof org.antlr.runtime.RecognitionException)this.reportError(Be),this.recover(this.input,Be),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Be);else throw Be}finally{}return he},funCall_return:function(){FormulaParser.funCall_return=function(){},org.antlr.lang.extend(FormulaParser.funCall_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),funCall:function(){var he=new FormulaParser.funCall_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token 114"),Ce=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token 113"),Ie=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token COMMA"),Ve=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule logicalExpression");try{if(Fe=this.match(this.input,113,FormulaParser.FOLLOW_113_in_funCall1761),this.state.failed)return he;this.state.backtracking===0&&Ce.add(Fe);var We=2,$e=this.input.LA(1);switch(($e==Ye||$e==Et||$e==Qe||$e==Pt||$e==Mt||$e>=Gt&&$e<=xt||$e==kt||$e>=Ut&&$e<=Vt||$e==113)&&(We=1),We){case 1:if(this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_funCall1765),ke=this.logicalExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Ve.add(ke.getTree());e:do{var Be=2,Je=this.input.LA(1);switch(Je==pt&&(Be=1),Be){case 1:if(Pe=this.match(this.input,pt,FormulaParser.FOLLOW_COMMA_in_funCall1768),this.state.failed||(this.state.backtracking===0&&Ie.add(Pe),this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_funCall1770),Ae=this.logicalExpression(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&Ve.add(Ae.getTree());break;default:break e}}while(!0);break}if(ye=this.match(this.input,114,FormulaParser.FOLLOW_114_in_funCall1777),this.state.failed)return he;if(this.state.backtracking===0&&Re.add(ye),this.state.backtracking===0){he.tree=Ee;var st=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var je=this.adaptor.nil();for(je=this.adaptor.becomeRoot(this.adaptor.create(ne,"FUNCALL"),je);Ve.hasNext();)this.adaptor.addChild(je,Ve.nextTree());Ve.reset(),this.adaptor.addChild(Ee,je)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(He){if(He instanceof org.antlr.runtime.RecognitionException)this.reportError(He),this.recover(this.input,He),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),He);else throw He}finally{}return he},primaryExpression_return:function(){FormulaParser.primaryExpression_return=function(){},org.antlr.lang.extend(FormulaParser.primaryExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),primaryExpression:function(){var he=new FormulaParser.primaryExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null;try{var Ae=2,Re=this.input.LA(1);if(Re==113)Ae=1;else if(Re==Ye||Re==Et||Re==Qe||Re==Pt||Re==xt||Re==kt||Re>=Ut&&Re<=Vt)Ae=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Ce=new org.antlr.runtime.NoViableAltException("",56,0,this.input);throw Ce}switch(Ae){case 1:if(Ee=this.adaptor.nil(),Fe=this.match(this.input,113,FormulaParser.FOLLOW_113_in_primaryExpression1798),this.state.failed||(this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_primaryExpression1801),ye=this.logicalExpression(),this.state._fsp--,this.state.failed)||(this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree()),Pe=this.match(this.input,114,FormulaParser.FOLLOW_114_in_primaryExpression1803),this.state.failed))return he;break;case 2:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_value_in_primaryExpression1809),ke=this.value(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ke.getTree());break}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ie){if(Ie instanceof org.antlr.runtime.RecognitionException)this.reportError(Ie),this.recover(this.input,Ie),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ie);else throw Ie}finally{}return he},value_return:function(){FormulaParser.value_return=function(){},org.antlr.lang.extend(FormulaParser.value_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),value:function(){var he=new FormulaParser.value_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=null,Ie=null,Ve=null,We=null;try{var $e=9;switch($e=this.dfa57.predict(this.input),$e){case 1:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_number_in_value1823),Pe=this.number(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());break;case 2:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_bool_in_value1829),ye=this.bool(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break;case 3:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_string_in_value1835),ke=this.string(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ke.getTree());break;case 4:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_material_in_value1841),Ae=this.material(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Ae.getTree());break;case 5:if(Ee=this.adaptor.nil(),Fe=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_value1846),this.state.failed)return he;this.state.backtracking===0&&(We=this.adaptor.create(Fe),this.adaptor.addChild(Ee,We));break;case 6:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_primitive_in_value1851),Re=this.primitive(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Re.getTree());break;case 7:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_array_in_value1856),Ce=this.array(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Ce.getTree());break;case 8:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_anonFunctionDef_in_value1861),Ie=this.anonFunctionDef(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Ie.getTree());break;case 9:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_newObject_in_value1866),Ve=this.newObject(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Ve.getTree());break}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Be){if(Be instanceof org.antlr.runtime.RecognitionException)this.reportError(Be),this.recover(this.input,Be),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Be);else throw Be}finally{}return he},newObject_return:function(){FormulaParser.newObject_return=function(){},org.antlr.lang.extend(FormulaParser.newObject_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),newObject:function(){var he=new FormulaParser.newObject_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token IDENT"),Ae=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token NEWSTATEMENT"),Re=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule funCall");try{if(Fe=this.match(this.input,Et,FormulaParser.FOLLOW_NEWSTATEMENT_in_newObject1876),this.state.failed||(this.state.backtracking===0&&Ae.add(Fe),Pe=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_newObject1878),this.state.failed))return he;this.state.backtracking===0&&ke.add(Pe);var Ce=2;switch(Ce=this.dfa58.predict(this.input),Ce){case 1:if(this.pushFollow(FormulaParser.FOLLOW_funCall_in_newObject1880),ye=this.funCall(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Re.add(ye.getTree());break}if(this.state.backtracking===0){he.tree=Ee;var Ie=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var Ve=this.adaptor.nil();Ve=this.adaptor.becomeRoot(this.adaptor.create(Se,"NEW"),Ve),this.adaptor.addChild(Ve,ke.nextNode()),Re.hasNext()&&this.adaptor.addChild(Ve,Re.nextTree()),Re.reset(),this.adaptor.addChild(Ee,Ve)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(We){if(We instanceof org.antlr.runtime.RecognitionException)this.reportError(We),this.recover(this.input,We),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),We);else throw We}finally{}return he},defaultValue_return:function(){FormulaParser.defaultValue_return=function(){},org.antlr.lang.extend(FormulaParser.defaultValue_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),defaultValue:function(){var he=new FormulaParser.defaultValue_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null;try{var Re=5;switch(this.input.LA(1)){case Mt:Re=1;break;case ar:case wr:Re=2;break;case Nr:case Vt:Re=3;break;case Ut:Re=4;break;case xt:case kt:Re=5;break;default:if(this.state.backtracking>0)return this.state.failed=!0,he;var Ce=new org.antlr.runtime.NoViableAltException("",59,0,this.input);throw Ce}switch(Re){case 1:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_negnumber_in_defaultValue1906),Fe=this.negnumber(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Fe.getTree());break;case 2:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_number_in_defaultValue1912),Pe=this.number(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());break;case 3:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_bool_in_defaultValue1918),ye=this.bool(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break;case 4:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_string_in_defaultValue1924),ke=this.string(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ke.getTree());break;case 5:if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_array_in_defaultValue1930),Ae=this.array(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Ae.getTree());break}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ie){if(Ie instanceof org.antlr.runtime.RecognitionException)this.reportError(Ie),this.recover(this.input,Ie),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ie);else throw Ie}finally{}return he},array_return:function(){FormulaParser.array_return=function(){},org.antlr.lang.extend(FormulaParser.array_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),array:function(){var he=new FormulaParser.array_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=null,Ie=null,Ve=null,We=null,$e=null,Be=null,Je=null,st=null,je=null,He=null,it=null,ct=null,ht=null,lt=null,ut=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token LCURL"),ze=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token NEWLINE"),rt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token RARR"),vt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token COMMA"),wt=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token LARR"),St=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token RCURL"),Xe=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule label");try{var _t=2,mt=this.input.LA(1);if(mt==xt)_t=1;else if(mt==kt)_t=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Tt=new org.antlr.runtime.NoViableAltException("",74,0,this.input);throw Tt}switch(_t){case 1:if(Fe=this.match(this.input,xt,FormulaParser.FOLLOW_LARR_in_array1944),this.state.failed)return he;this.state.backtracking===0&&wt.add(Fe);e:do{var Nt=2,Ft=this.input.LA(1);if(Ft==Me){var Lt=this.input.LA(2);this.synpred85_Formula()&&(Nt=1)}switch(Nt){case 1:if(Pe=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_array1946),this.state.failed)return he;this.state.backtracking===0&&ze.add(Pe);break;default:break e}}while(!0);var bt=2;switch(bt=this.dfa65.predict(this.input),bt){case 1:if(this.pushFollow(FormulaParser.FOLLOW_label_in_array1950),it=this.label(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Xe.add(it.getTree());e:do{var It=2,Yt=this.input.LA(1);if(Yt==Me){var Qt=this.input.LA(2);this.synpred86_Formula()&&(It=1)}switch(It){case 1:if(ye=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_array1952),this.state.failed)return he;this.state.backtracking===0&&ze.add(ye);break;default:break e}}while(!0);e:do{var zt=2,Xt=this.input.LA(1);switch(Xt==pt&&(zt=1),zt){case 1:if(ke=this.match(this.input,pt,FormulaParser.FOLLOW_COMMA_in_array1956),this.state.failed)return he;this.state.backtracking===0&&vt.add(ke);t:do{var Dt=2,dt=this.input.LA(1);if(dt==Me){var Ht=this.input.LA(2);this.synpred87_Formula()&&(Dt=1)}switch(Dt){case 1:if(Ae=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_array1958),this.state.failed)return he;this.state.backtracking===0&&ze.add(Ae);break;default:break t}}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_label_in_array1961),ct=this.label(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Xe.add(ct.getTree());t:do{var er=2,Kt=this.input.LA(1);if(Kt==Me){var qt=this.input.LA(2);this.synpred88_Formula()&&(er=1)}switch(er){case 1:if(Re=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_array1963),this.state.failed)return he;this.state.backtracking===0&&ze.add(Re);break;default:break t}}while(!0);break;default:break e}}while(!0);break}e:do{var Jt=2,yt=this.input.LA(1);switch(yt==Me&&(Jt=1),Jt){case 1:if(Ce=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_array1970),this.state.failed)return he;this.state.backtracking===0&&ze.add(Ce);break;default:break e}}while(!0);if(Ie=this.match(this.input,Tr,FormulaParser.FOLLOW_RARR_in_array1973),this.state.failed)return he;if(this.state.backtracking===0&&rt.add(Ie),this.state.backtracking===0){he.tree=Ee;var At=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var Ct=this.adaptor.nil();for(Ct=this.adaptor.becomeRoot(this.adaptor.create(ce,"ARRAY"),Ct);Xe.hasNext();)this.adaptor.addChild(Ct,Xe.nextTree());Xe.reset(),this.adaptor.addChild(Ee,Ct)}he.tree=Ee}break;case 2:if(Ve=this.match(this.input,kt,FormulaParser.FOLLOW_LCURL_in_array1987),this.state.failed)return he;this.state.backtracking===0&&ut.add(Ve);e:do{var sr=2,fr=this.input.LA(1);if(fr==Me){var Lr=this.input.LA(2);this.synpred93_Formula()&&(sr=1)}switch(sr){case 1:if(We=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_array1989),this.state.failed)return he;this.state.backtracking===0&&ze.add(We);break;default:break e}}while(!0);var nr=2;switch(nr=this.dfa72.predict(this.input),nr){case 1:if(this.pushFollow(FormulaParser.FOLLOW_label_in_array1993),ht=this.label(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Xe.add(ht.getTree());e:do{var or=2,rr=this.input.LA(1);if(rr==Me){var Pr=this.input.LA(2);this.synpred94_Formula()&&(or=1)}switch(or){case 1:if($e=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_array1995),this.state.failed)return he;this.state.backtracking===0&&ze.add($e);break;default:break e}}while(!0);e:do{var kr=2,Or=this.input.LA(1);switch(Or==pt&&(kr=1),kr){case 1:if(Be=this.match(this.input,pt,FormulaParser.FOLLOW_COMMA_in_array1998),this.state.failed)return he;this.state.backtracking===0&&vt.add(Be);t:do{var xr=2,Sr=this.input.LA(1);if(Sr==Me){var Mr=this.input.LA(2);this.synpred95_Formula()&&(xr=1)}switch(xr){case 1:if(Je=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_array2000),this.state.failed)return he;this.state.backtracking===0&&ze.add(Je);break;default:break t}}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_label_in_array2003),lt=this.label(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Xe.add(lt.getTree());t:do{var br=2,Ar=this.input.LA(1);if(Ar==Me){var Cr=this.input.LA(2);this.synpred96_Formula()&&(br=1)}switch(br){case 1:if(st=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_array2005),this.state.failed)return he;this.state.backtracking===0&&ze.add(st);break;default:break t}}while(!0);break;default:break e}}while(!0);break}e:do{var yr=2,Rr=this.input.LA(1);switch(Rr==Me&&(yr=1),yr){case 1:if(je=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_array2012),this.state.failed)return he;this.state.backtracking===0&&ze.add(je);break;default:break e}}while(!0);if(He=this.match(this.input,Er,FormulaParser.FOLLOW_RCURL_in_array2015),this.state.failed)return he;if(this.state.backtracking===0&&St.add(He),this.state.backtracking===0){he.tree=Ee;var At=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var Ct=this.adaptor.nil();for(Ct=this.adaptor.becomeRoot(this.adaptor.create(ce,"ARRAY"),Ct);Xe.hasNext();)this.adaptor.addChild(Ct,Xe.nextTree());Xe.reset(),this.adaptor.addChild(Ee,Ct)}he.tree=Ee}break}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(ur){if(ur instanceof org.antlr.runtime.RecognitionException)this.reportError(ur),this.recover(this.input,ur),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),ur);else throw ur}finally{}return he},selector_return:function(){FormulaParser.selector_return=function(){},org.antlr.lang.extend(FormulaParser.selector_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),selector:function(){var he=new FormulaParser.selector_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule dotselector"),ke=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule minarray");try{var Ae=2,Re=this.input.LA(1);if(Re==xt||Re==kt)Ae=1;else if(Re==116)Ae=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Ce=new org.antlr.runtime.NoViableAltException("",75,0,this.input);throw Ce}switch(Ae){case 1:if(this.pushFollow(FormulaParser.FOLLOW_minarray_in_selector2036),Fe=this.minarray(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&ke.add(Fe.getTree());break;case 2:if(this.pushFollow(FormulaParser.FOLLOW_dotselector_in_selector2040),Pe=this.dotselector(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&ye.add(Pe.getTree());break}if(this.state.backtracking===0){he.tree=Ee;var Ie=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var Ve=this.adaptor.nil();Ve=this.adaptor.becomeRoot(this.adaptor.create(Oe,"SELECTOR"),Ve),ke.hasNext()&&this.adaptor.addChild(Ve,ke.nextTree()),ke.reset(),ye.hasNext()&&this.adaptor.addChild(Ve,ye.nextTree()),ye.reset(),this.adaptor.addChild(Ee,Ve)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(We){if(We instanceof org.antlr.runtime.RecognitionException)this.reportError(We),this.recover(this.input,We),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),We);else throw We}finally{}return he},minarray_return:function(){FormulaParser.minarray_return=function(){},org.antlr.lang.extend(FormulaParser.minarray_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),minarray:function(){var he=new FormulaParser.minarray_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=null,Ie=null,Ve=null,We=null,$e=null,Be=null,Je=null,st=null,je=null,He=null,it=null,ct=null;try{var ht=2,lt=this.input.LA(1);if(lt==xt)ht=1;else if(lt==kt)ht=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var ut=new org.antlr.runtime.NoViableAltException("",82,0,this.input);throw ut}switch(ht){case 1:if(Ee=this.adaptor.nil(),Fe=this.match(this.input,xt,FormulaParser.FOLLOW_LARR_in_minarray2067),this.state.failed)return he;var ze=2,rt=this.input.LA(1);if(rt==Ye||rt==Et||rt==Qe||rt==Pt||rt==Mt||rt>=Gt&&rt<=xt||rt==kt||rt>=Ut&&rt<=Vt||rt==113)ze=1;else if(rt==$t)ze=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var ut=new org.antlr.runtime.NoViableAltException("",76,0,this.input);throw ut}switch(ze){case 1:if(this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_minarray2072),$e=this.logicalExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,$e.getTree());break;case 2:if(Pe=this.match(this.input,$t,FormulaParser.FOLLOW_MULT_in_minarray2074),this.state.failed)return he;this.state.backtracking===0&&(je=this.adaptor.create(Pe),this.adaptor.addChild(Ee,je));break}e:do{var vt=2,wt=this.input.LA(1);switch(wt==pt&&(vt=1),vt){case 1:if(ye=this.match(this.input,pt,FormulaParser.FOLLOW_COMMA_in_minarray2078),this.state.failed)return he;var St=2,Xe=this.input.LA(1);if(Xe==Ye||Xe==Et||Xe==Qe||Xe==Pt||Xe==Mt||Xe>=Gt&&Xe<=xt||Xe==kt||Xe>=Ut&&Xe<=Vt||Xe==113)St=1;else if(Xe==$t)St=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var ut=new org.antlr.runtime.NoViableAltException("",77,0,this.input);throw ut}switch(St){case 1:if(this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_minarray2082),Be=this.logicalExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Be.getTree());break;case 2:if(ke=this.match(this.input,$t,FormulaParser.FOLLOW_MULT_in_minarray2084),this.state.failed)return he;this.state.backtracking===0&&(He=this.adaptor.create(ke),this.adaptor.addChild(Ee,He));break}break;default:break e}}while(!0);if(Ae=this.match(this.input,Tr,FormulaParser.FOLLOW_RARR_in_minarray2091),this.state.failed)return he;break;case 2:if(Ee=this.adaptor.nil(),Re=this.match(this.input,kt,FormulaParser.FOLLOW_LCURL_in_minarray2097),this.state.failed)return he;var _t=2,mt=this.input.LA(1);if(mt==Ye||mt==Et||mt==Qe||mt==Pt||mt==Mt||mt>=Gt&&mt<=xt||mt==kt||mt>=Ut&&mt<=Vt||mt==113)_t=1;else if(mt==$t)_t=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var ut=new org.antlr.runtime.NoViableAltException("",79,0,this.input);throw ut}switch(_t){case 1:if(this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_minarray2102),Je=this.logicalExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Je.getTree());break;case 2:if(Ce=this.match(this.input,$t,FormulaParser.FOLLOW_MULT_in_minarray2104),this.state.failed)return he;this.state.backtracking===0&&(it=this.adaptor.create(Ce),this.adaptor.addChild(Ee,it));break}e:do{var Tt=2,Nt=this.input.LA(1);switch(Nt==pt&&(Tt=1),Tt){case 1:if(Ie=this.match(this.input,pt,FormulaParser.FOLLOW_COMMA_in_minarray2108),this.state.failed)return he;var Ft=2,Lt=this.input.LA(1);if(Lt==Ye||Lt==Et||Lt==Qe||Lt==Pt||Lt==Mt||Lt>=Gt&&Lt<=xt||Lt==kt||Lt>=Ut&&Lt<=Vt||Lt==113)Ft=1;else if(Lt==$t)Ft=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var ut=new org.antlr.runtime.NoViableAltException("",80,0,this.input);throw ut}switch(Ft){case 1:if(this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_minarray2112),st=this.logicalExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,st.getTree());break;case 2:if(Ve=this.match(this.input,$t,FormulaParser.FOLLOW_MULT_in_minarray2114),this.state.failed)return he;this.state.backtracking===0&&(ct=this.adaptor.create(Ve),this.adaptor.addChild(Ee,ct));break}break;default:break e}}while(!0);if(We=this.match(this.input,Er,FormulaParser.FOLLOW_RCURL_in_minarray2121),this.state.failed)return he;break}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(bt){if(bt instanceof org.antlr.runtime.RecognitionException)this.reportError(bt),this.recover(this.input,bt),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),bt);else throw bt}finally{}return he},dotselector_return:function(){FormulaParser.dotselector_return=function(){},org.antlr.lang.extend(FormulaParser.dotselector_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),dotselector:function(){var he=new FormulaParser.dotselector_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token 116"),ke=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule arrayName");try{var Ae=0;e:do{var Re=2,Ce=this.input.LA(1);if(Ce==116){var Ie=this.input.LA(2);this.synpred108_Formula()&&(Re=1)}switch(Re){case 1:if(Fe=this.match(this.input,116,FormulaParser.FOLLOW_116_in_dotselector2133),this.state.failed||(this.state.backtracking===0&&ye.add(Fe),this.pushFollow(FormulaParser.FOLLOW_arrayName_in_dotselector2135),Pe=this.arrayName(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&ke.add(Pe.getTree());break;default:if(Ae>=1)break e;if(this.state.backtracking>0)return this.state.failed=!0,he;var Ve=new org.antlr.runtime.EarlyExitException(83,this.input);throw Ve}Ae++}while(!0);if(this.state.backtracking===0){he.tree=Ee;var We=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var $e=this.adaptor.nil();if($e=this.adaptor.becomeRoot(this.adaptor.create(xe,"DOTSELECTOR"),$e),!ke.hasNext())throw new org.antlr.runtime.tree.RewriteEarlyExitException;for(;ke.hasNext();)this.adaptor.addChild($e,ke.nextTree());ke.reset(),this.adaptor.addChild(Ee,$e)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Be){if(Be instanceof org.antlr.runtime.RecognitionException)this.reportError(Be),this.recover(this.input,Be),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Be);else throw Be}finally{}return he},arrayName_return:function(){FormulaParser.arrayName_return=function(){},org.antlr.lang.extend(FormulaParser.arrayName_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),arrayName:function(){var he=new FormulaParser.arrayName_return;he.start=this.input.LT(1);var Ee=null,Fe=null;try{if(Ee=this.adaptor.nil(),Fe=this.input.LT(1),this.input.LA(1)==Qe||this.input.LA(1)==$t||this.input.LA(1)==Ut)this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(Ee,this.adaptor.create(Fe)),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Pe=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Pe}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(ye){if(ye instanceof org.antlr.runtime.RecognitionException)this.reportError(ye),this.recover(this.input,ye),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),ye);else throw ye}finally{}return he},label_return:function(){FormulaParser.label_return=function(){},org.antlr.lang.extend(FormulaParser.label_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),label:function(){var he=new FormulaParser.label_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token COLON"),Ce=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token NEWLINE"),Ie=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule arrayName"),Ve=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule logicalExpression");try{var We=2;switch(We=this.dfa85.predict(this.input),We){case 1:if(this.pushFollow(FormulaParser.FOLLOW_arrayName_in_label2173),ke=this.arrayName(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Ie.add(ke.getTree());e:do{var $e=2,Be=this.input.LA(1);switch(Be==Me&&($e=1),$e){case 1:if(Fe=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_label2175),this.state.failed)return he;this.state.backtracking===0&&Ce.add(Fe);break;default:break e}}while(!0);if(Pe=this.match(this.input,tr,FormulaParser.FOLLOW_COLON_in_label2178),this.state.failed)return he;this.state.backtracking===0&&Re.add(Pe);break}e:do{var Je=2,st=this.input.LA(1);switch(st==Me&&(Je=1),Je){case 1:if(ye=this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_label2182),this.state.failed)return he;this.state.backtracking===0&&Ce.add(ye);break;default:break e}}while(!0);if(this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_label2185),Ae=this.logicalExpression(),this.state._fsp--,this.state.failed)return he;if(this.state.backtracking===0&&Ve.add(Ae.getTree()),this.state.backtracking===0){he.tree=Ee;var je=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var He=this.adaptor.nil();He=this.adaptor.becomeRoot(this.adaptor.create(_e,"LABEL"),He),this.adaptor.addChild(He,Ve.nextTree()),Ie.hasNext()&&this.adaptor.addChild(He,Ie.nextTree()),Ie.reset(),this.adaptor.addChild(Ee,He)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(it){if(it instanceof org.antlr.runtime.RecognitionException)this.reportError(it),this.recover(this.input,it),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),it);else throw it}finally{}return he},number_return:function(){FormulaParser.number_return=function(){},org.antlr.lang.extend(FormulaParser.number_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),number:function(){var he=new FormulaParser.number_return;he.start=this.input.LT(1);var Ee=null,Fe=null;try{if(Ee=this.adaptor.nil(),Fe=this.input.LT(1),this.input.LA(1)>=ar&&this.input.LA(1)<=wr)this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(Ee,this.adaptor.create(Fe)),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Pe=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Pe}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(ye){if(ye instanceof org.antlr.runtime.RecognitionException)this.reportError(ye),this.recover(this.input,ye),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),ye);else throw ye}finally{}return he},negnumber_return:function(){FormulaParser.negnumber_return=function(){},org.antlr.lang.extend(FormulaParser.negnumber_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),negnumber:function(){var he=new FormulaParser.negnumber_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token MINUS"),ke=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule number");try{if(Fe=this.match(this.input,Mt,FormulaParser.FOLLOW_MINUS_in_negnumber2261),this.state.failed||(this.state.backtracking===0&&ye.add(Fe),this.pushFollow(FormulaParser.FOLLOW_number_in_negnumber2263),Pe=this.number(),this.state._fsp--,this.state.failed))return he;if(this.state.backtracking===0&&ke.add(Pe.getTree()),this.state.backtracking===0){he.tree=Ee;var Ae=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var Re=this.adaptor.nil();Re=this.adaptor.becomeRoot(this.adaptor.create(ee,"NEGATE"),Re),this.adaptor.addChild(Re,ke.nextTree()),this.adaptor.addChild(Ee,Re)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ce){if(Ce instanceof org.antlr.runtime.RecognitionException)this.reportError(Ce),this.recover(this.input,Ce),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ce);else throw Ce}finally{}return he},bool_return:function(){FormulaParser.bool_return=function(){},org.antlr.lang.extend(FormulaParser.bool_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),bool:function(){var he=new FormulaParser.bool_return;he.start=this.input.LT(1);var Ee=null,Fe=null;try{if(Ee=this.adaptor.nil(),Fe=this.input.LT(1),this.input.LA(1)>=Nr&&this.input.LA(1)<=Vt)this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(Ee,this.adaptor.create(Fe)),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Pe=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Pe}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(ye){if(ye instanceof org.antlr.runtime.RecognitionException)this.reportError(ye),this.recover(this.input,ye),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),ye);else throw ye}finally{}return he},material_return:function(){FormulaParser.material_return=function(){},org.antlr.lang.extend(FormulaParser.material_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),material:function(){var he=new FormulaParser.material_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token LCURL"),Re=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token RCURL"),Ce=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule unitMultiplicativeExpression"),Ie=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule additiveExpression");try{if(Fe=this.match(this.input,kt,FormulaParser.FOLLOW_LCURL_in_material2415),this.state.failed||(this.state.backtracking===0&&Ae.add(Fe),this.pushFollow(FormulaParser.FOLLOW_additiveExpression_in_material2417),ye=this.additiveExpression(),this.state._fsp--,this.state.failed))return he;if(this.state.backtracking===0&&Ie.add(ye.getTree()),this.input.get(this.input.index()-1).getText()!=" "){if(this.state.backtracking>0)return this.state.failed=!0,he;throw new org.antlr.runtime.FailedPredicateException(this.input,"material",' this.input.get(this.input.index()-1).getText()==" "')}if(this.pushFollow(FormulaParser.FOLLOW_unitMultiplicativeExpression_in_material2421),ke=this.unitMultiplicativeExpression(),this.state._fsp--,this.state.failed||(this.state.backtracking===0&&Ce.add(ke.getTree()),Pe=this.match(this.input,Er,FormulaParser.FOLLOW_RCURL_in_material2423),this.state.failed))return he;if(this.state.backtracking===0&&Re.add(Pe),this.state.backtracking===0){he.tree=Ee;var Ve=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var We=this.adaptor.nil();We=this.adaptor.becomeRoot(this.adaptor.create(ie,"MATERIAL"),We),this.adaptor.addChild(We,Ce.nextTree()),this.adaptor.addChild(We,Ie.nextTree()),this.adaptor.addChild(Ee,We)}he.tree=Ee}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch($e){if($e instanceof org.antlr.runtime.RecognitionException)this.reportError($e),this.recover(this.input,$e),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),$e);else throw $e}finally{}return he},unitMultiplicativeExpression_return:function(){FormulaParser.unitMultiplicativeExpression_return=function(){},org.antlr.lang.extend(FormulaParser.unitMultiplicativeExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),unitMultiplicativeExpression:function(){var he=new FormulaParser.unitMultiplicativeExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null;try{if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_unitInnerMultiplicativeExpression_in_unitMultiplicativeExpression2460),Pe=this.unitInnerMultiplicativeExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());e:do{var Ae=2,Re=this.input.LA(1);switch(Re==Fr&&(Ae=1),Ae){case 1:if(Fe=this.match(this.input,Fr,FormulaParser.FOLLOW_PER_in_unitMultiplicativeExpression2464),this.state.failed||(this.state.backtracking===0&&(ke=this.adaptor.create(Fe),Ee=this.adaptor.becomeRoot(ke,Ee)),this.pushFollow(FormulaParser.FOLLOW_unitInnerMultiplicativeExpression_in_unitMultiplicativeExpression2467),ye=this.unitInnerMultiplicativeExpression(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break;default:break e}}while(!0);he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ce){if(Ce instanceof org.antlr.runtime.RecognitionException)this.reportError(Ce),this.recover(this.input,Ce),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ce);else throw Ce}finally{}return he},unitInnerMultiplicativeExpression_return:function(){FormulaParser.unitInnerMultiplicativeExpression_return=function(){},org.antlr.lang.extend(FormulaParser.unitInnerMultiplicativeExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),unitInnerMultiplicativeExpression:function(){var he=new FormulaParser.unitInnerMultiplicativeExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null;try{if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_unitClump_in_unitInnerMultiplicativeExpression2483),Pe=this.unitClump(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,Pe.getTree());e:do{var ke=2,Ae=this.input.LA(1);switch(Ae>=$t&&Ae<=vr&&(ke=1),ke){case 1:if(Fe=this.input.LT(1),this.input.LA(1)>=$t&&this.input.LA(1)<=vr)this.input.consume(),this.state.backtracking===0&&(Ee=this.adaptor.becomeRoot(this.adaptor.create(Fe),Ee)),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Re=new org.antlr.runtime.MismatchedSetException(null,this.input);throw Re}if(this.pushFollow(FormulaParser.FOLLOW_unitClump_in_unitInnerMultiplicativeExpression2494),ye=this.unitClump(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ye.getTree());break;default:break e}}while(!0);he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Ce){if(Ce instanceof org.antlr.runtime.RecognitionException)this.reportError(Ce),this.recover(this.input,Ce),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Ce);else throw Ce}finally{}return he},unitClump_return:function(){FormulaParser.unitClump_return=function(){},org.antlr.lang.extend(FormulaParser.unitClump_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),unitClump:function(){var he=new FormulaParser.unitClump_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null,Ce=null,Ie=null,Ve=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token INTEGER"),We=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token SQUARED"),$e=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token DIV"),Be=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token CUBED"),Je=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule unitPowerExpression");try{var st=2,je=this.input.LA(1);if(je==ar)st=1;else if(je==Qe||je==113)st=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var He=new org.antlr.runtime.NoViableAltException("",93,0,this.input);throw He}switch(st){case 1:if(Fe=this.match(this.input,ar,FormulaParser.FOLLOW_INTEGER_in_unitClump2510),this.state.failed||(this.state.backtracking===0&&Ve.add(Fe),Pe=this.match(this.input,vr,FormulaParser.FOLLOW_DIV_in_unitClump2512),this.state.failed)||(this.state.backtracking===0&&$e.add(Pe),this.pushFollow(FormulaParser.FOLLOW_unitPowerExpression_in_unitClump2515),Ce=this.unitPowerExpression(),this.state._fsp--,this.state.failed))return he;this.state.backtracking===0&&Je.add(Ce.getTree());var it=2,ct=this.input.LA(1);switch(ct==lr&&(it=1),it){case 1:if(ye=this.match(this.input,lr,FormulaParser.FOLLOW_CUBED_in_unitClump2517),this.state.failed)return he;this.state.backtracking===0&&Be.add(ye);break}var ht=2,lt=this.input.LA(1);switch(lt==cr&&(ht=1),ht){case 1:if(ke=this.match(this.input,cr,FormulaParser.FOLLOW_SQUARED_in_unitClump2520),this.state.failed)return he;this.state.backtracking===0&&We.add(ke);break}if(this.state.backtracking===0){he.tree=Ee;var ut=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var ze=this.adaptor.nil();for(ze=this.adaptor.becomeRoot(this.adaptor.create(se,"UNITCLUMP"),ze),this.adaptor.addChild(ze,Je.nextTree()),this.adaptor.addChild(ze,this.adaptor.create(ee,"NEGATE"));Be.hasNext();)this.adaptor.addChild(ze,Be.nextNode());for(Be.reset();We.hasNext();)this.adaptor.addChild(ze,We.nextNode());We.reset(),this.adaptor.addChild(Ee,ze)}he.tree=Ee}break;case 2:if(this.pushFollow(FormulaParser.FOLLOW_unitPowerExpression_in_unitClump2543),Ie=this.unitPowerExpression(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&Je.add(Ie.getTree());var rt=2,vt=this.input.LA(1);switch(vt==lr&&(rt=1),rt){case 1:if(Ae=this.match(this.input,lr,FormulaParser.FOLLOW_CUBED_in_unitClump2545),this.state.failed)return he;this.state.backtracking===0&&Be.add(Ae);break}var wt=2,St=this.input.LA(1);switch(St==cr&&(wt=1),wt){case 1:if(Re=this.match(this.input,cr,FormulaParser.FOLLOW_SQUARED_in_unitClump2548),this.state.failed)return he;this.state.backtracking===0&&We.add(Re);break}if(this.state.backtracking===0){he.tree=Ee;var ut=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var ze=this.adaptor.nil();for(ze=this.adaptor.becomeRoot(this.adaptor.create(se,"UNITCLUMP"),ze),this.adaptor.addChild(ze,Je.nextTree());Be.hasNext();)this.adaptor.addChild(ze,Be.nextNode());for(Be.reset();We.hasNext();)this.adaptor.addChild(ze,We.nextNode());We.reset(),this.adaptor.addChild(Ee,ze)}he.tree=Ee}break}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Xe){if(Xe instanceof org.antlr.runtime.RecognitionException)this.reportError(Xe),this.recover(this.input,Xe),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Xe);else throw Xe}finally{}return he},unitPowerExpression_return:function(){FormulaParser.unitPowerExpression_return=function(){},org.antlr.lang.extend(FormulaParser.unitPowerExpression_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),unitPowerExpression:function(){var he=new FormulaParser.unitPowerExpression_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=null;try{if(Ee=this.adaptor.nil(),this.pushFollow(FormulaParser.FOLLOW_unit_in_unitPowerExpression2610),ke=this.unit(),this.state._fsp--,this.state.failed)return he;this.state.backtracking===0&&this.adaptor.addChild(Ee,ke.getTree());e:do{var Ce=2,Ie=this.input.LA(1);switch(Ie==ir&&(Ce=1),Ce){case 1:if(Fe=this.match(this.input,ir,FormulaParser.FOLLOW_POW_in_unitPowerExpression2614),this.state.failed)return he;this.state.backtracking===0&&(Ae=this.adaptor.create(Fe),Ee=this.adaptor.becomeRoot(Ae,Ee));var Ve=2,We=this.input.LA(1);switch(We==Mt&&(Ve=1),Ve){case 1:if(Pe=this.match(this.input,Mt,FormulaParser.FOLLOW_MINUS_in_unitPowerExpression2617),this.state.failed)return he;this.state.backtracking===0&&(Re=this.adaptor.create(Pe),this.adaptor.addChild(Ee,Re));break}if(ye=this.input.LT(1),this.input.LA(1)>=ar&&this.input.LA(1)<=wr)this.input.consume(),this.state.backtracking===0&&this.adaptor.addChild(Ee,this.adaptor.create(ye)),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var $e=new org.antlr.runtime.MismatchedSetException(null,this.input);throw $e}break;default:break e}}while(!0);he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(Be){if(Be instanceof org.antlr.runtime.RecognitionException)this.reportError(Be),this.recover(this.input,Be),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),Be);else throw Be}finally{}return he},unit_return:function(){FormulaParser.unit_return=function(){},org.antlr.lang.extend(FormulaParser.unit_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),unit:function(){var he=new FormulaParser.unit_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null,ye=null,ke=null,Ae=null,Re=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token 114"),Ce=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token IDENT"),Ie=new org.antlr.runtime.tree.RewriteRuleTokenStream(this.adaptor,"token 113"),Ve=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"rule unitMultiplicativeExpression");try{var We=2,$e=this.input.LA(1);if($e==Qe)We=1;else if($e==113)We=2;else{if(this.state.backtracking>0)return this.state.failed=!0,he;var Be=new org.antlr.runtime.NoViableAltException("",97,0,this.input);throw Be}switch(We){case 1:if(Fe=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_unit2638),this.state.failed)return he;this.state.backtracking===0&&Ce.add(Fe);e:do{var Je=2,st=this.input.LA(1);switch(st==Qe&&(Je=1),Je){case 1:if(Pe=this.match(this.input,Qe,FormulaParser.FOLLOW_IDENT_in_unit2641),this.state.failed)return he;this.state.backtracking===0&&Ce.add(Pe);break;default:break e}}while(!0);if(this.state.backtracking===0){he.tree=Ee;var je=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var He=this.adaptor.nil();if(He=this.adaptor.becomeRoot(this.adaptor.create(oe,"UNIT"),He),!Ce.hasNext())throw new org.antlr.runtime.tree.RewriteEarlyExitException;for(;Ce.hasNext();)this.adaptor.addChild(He,Ce.nextNode());Ce.reset(),this.adaptor.addChild(Ee,He)}he.tree=Ee}break;case 2:if(ye=this.match(this.input,113,FormulaParser.FOLLOW_113_in_unit2658),this.state.failed||(this.state.backtracking===0&&Ie.add(ye),this.pushFollow(FormulaParser.FOLLOW_unitMultiplicativeExpression_in_unit2660),Ae=this.unitMultiplicativeExpression(),this.state._fsp--,this.state.failed)||(this.state.backtracking===0&&Ve.add(Ae.getTree()),ke=this.match(this.input,114,FormulaParser.FOLLOW_114_in_unit2662),this.state.failed))return he;if(this.state.backtracking===0&&Re.add(ke),this.state.backtracking===0){he.tree=Ee;var je=new org.antlr.runtime.tree.RewriteRuleSubtreeStream(this.adaptor,"token retval",he!=null?he.tree:null);Ee=this.adaptor.nil();{var He=this.adaptor.nil();He=this.adaptor.becomeRoot(this.adaptor.create(se,"UNITCLUMP"),He),this.adaptor.addChild(He,Ve.nextTree()),this.adaptor.addChild(Ee,He)}he.tree=Ee}break}he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(it){if(it instanceof org.antlr.runtime.RecognitionException)this.reportError(it),this.recover(this.input,it),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),it);else throw it}finally{}return he},primitive_return:function(){FormulaParser.primitive_return=function(){},org.antlr.lang.extend(FormulaParser.primitive_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),primitive:function(){var he=new FormulaParser.primitive_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null;try{if(Ee=this.adaptor.nil(),Fe=this.match(this.input,Pt,FormulaParser.FOLLOW_PRIMITIVE_in_primitive2731),this.state.failed)return he;this.state.backtracking===0&&(Pe=this.adaptor.create(Fe),this.adaptor.addChild(Ee,Pe)),he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(ye){if(ye instanceof org.antlr.runtime.RecognitionException)this.reportError(ye),this.recover(this.input,ye),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),ye);else throw ye}finally{}return he},string_return:function(){FormulaParser.string_return=function(){},org.antlr.lang.extend(FormulaParser.string_return,org.antlr.runtime.ParserRuleReturnScope,{getTree:function(){return this.tree}})}(),string:function(){var he=new FormulaParser.string_return;he.start=this.input.LT(1);var Ee=null,Fe=null,Pe=null;try{if(Ee=this.adaptor.nil(),Fe=this.match(this.input,Ut,FormulaParser.FOLLOW_STRING_in_string3200),this.state.failed)return he;this.state.backtracking===0&&(Pe=this.adaptor.create(Fe),Ee=this.adaptor.becomeRoot(Pe,Ee)),he.stop=this.input.LT(-1),this.state.backtracking===0&&(he.tree=this.adaptor.rulePostProcessing(Ee),this.adaptor.setTokenBoundaries(he.tree,he.start,he.stop))}catch(ye){if(ye instanceof org.antlr.runtime.RecognitionException)this.reportError(ye),this.recover(this.input,ye),he.tree=this.adaptor.errorNode(this.input,he.start,this.input.LT(-1),ye);else throw ye}finally{}return he},synpred5_Formula_fragment:function(){this.pushFollow(FormulaParser.FOLLOW_assignment_in_synpred5_Formula508),this.assignment(),this.state._fsp--,this.state.failed},synpred6_Formula_fragment:function(){this.pushFollow(FormulaParser.FOLLOW_logicalExpression_in_synpred6_Formula514),this.logicalExpression(),this.state._fsp--,this.state.failed},synpred8_Formula_fragment:function(){this.pushFollow(FormulaParser.FOLLOW_forLoop_in_synpred8_Formula526),this.forLoop(),this.state._fsp--,this.state.failed},synpred9_Formula_fragment:function(){this.pushFollow(FormulaParser.FOLLOW_forInLoop_in_synpred9_Formula532),this.forInLoop(),this.state._fsp--,this.state.failed},synpred11_Formula_fragment:function(){this.pushFollow(FormulaParser.FOLLOW_functionDef_in_synpred11_Formula544),this.functionDef(),this.state._fsp--,this.state.failed},synpred47_Formula_fragment:function(){this.match(this.input,Wt,FormulaParser.FOLLOW_OR_in_synpred47_Formula1217),!this.state.failed&&(this.pushFollow(FormulaParser.FOLLOW_booleanXORExpression_in_synpred47_Formula1220),this.booleanXORExpression(),this.state._fsp--,this.state.failed)},synpred48_Formula_fragment:function(){this.match(this.input,jt,FormulaParser.FOLLOW_XOR_in_synpred48_Formula1253),!this.state.failed&&(this.pushFollow(FormulaParser.FOLLOW_booleanAndExpression_in_synpred48_Formula1256),this.booleanAndExpression(),this.state._fsp--,this.state.failed)},synpred49_Formula_fragment:function(){this.match(this.input,hr,FormulaParser.FOLLOW_AND_in_synpred49_Formula1288),!this.state.failed&&(this.pushFollow(FormulaParser.FOLLOW_equalityExpression_in_synpred49_Formula1291),this.equalityExpression(),this.state._fsp--,this.state.failed)},synpred51_Formula_fragment:function(){if(this.input.LA(1)==Rt||this.input.LA(1)==dr)this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0){this.state.failed=!0;return}var he=new org.antlr.runtime.MismatchedSetException(null,this.input);throw he}this.pushFollow(FormulaParser.FOLLOW_relationalExpression_in_synpred51_Formula1332),this.relationalExpression(),this.state._fsp--,this.state.failed},synpred55_Formula_fragment:function(){if(this.input.LA(1)>=pr&&this.input.LA(1)<=mr)this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0){this.state.failed=!0;return}var he=new org.antlr.runtime.MismatchedSetException(null,this.input);throw he}this.pushFollow(FormulaParser.FOLLOW_additiveExpression_in_synpred55_Formula1389),this.additiveExpression(),this.state._fsp--,this.state.failed},synpred57_Formula_fragment:function(){if(this.input.LA(1)>=gr&&this.input.LA(1)<=Mt)this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0){this.state.failed=!0;return}var he=new org.antlr.runtime.MismatchedSetException(null,this.input);throw he}this.pushFollow(FormulaParser.FOLLOW_multiplicativeExpression_in_synpred57_Formula1443),this.multiplicativeExpression(),this.state._fsp--,this.state.failed},synpred60_Formula_fragment:function(){if(this.input.LA(1)>=$t&&this.input.LA(1)<=_r)this.input.consume(),this.state.errorRecovery=!1,this.state.failed=!1;else{if(this.state.backtracking>0){this.state.failed=!0;return}var he=new org.antlr.runtime.MismatchedSetException(null,this.input);throw he}this.pushFollow(FormulaParser.FOLLOW_arrayExpression_in_synpred60_Formula1486),this.arrayExpression(),this.state._fsp--,this.state.failed},synpred61_Formula_fragment:function(){if(this.input.get(this.input.index()-1).getText()==" "){if(this.state.backtracking>0){this.state.failed=!0;return}throw new org.antlr.runtime.FailedPredicateException(this.input,"synpred61_Formula",' this.input.get(this.input.index()-1).getText()!=" "')}if(this.match(this.input,tr,FormulaParser.FOLLOW_COLON_in_synpred61_Formula1538),!this.state.failed){if(this.input.get(this.input.index()-1).getText()==" "){if(this.state.backtracking>0){this.state.failed=!0;return}throw new org.antlr.runtime.FailedPredicateException(this.input,"synpred61_Formula",' this.input.get(this.input.index()-1).getText()!=" "')}this.pushFollow(FormulaParser.FOLLOW_negationExpression_in_synpred61_Formula1542),this.negationExpression(),this.state._fsp--,this.state.failed}},synpred62_Formula_fragment:function(){if(this.input.get(this.input.index()-1).getText()==" "){if(this.state.backtracking>0){this.state.failed=!0;return}throw new org.antlr.runtime.FailedPredicateException(this.input,"synpred62_Formula",' this.input.get(this.input.index()-1).getText()!=" "')}if(this.match(this.input,tr,FormulaParser.FOLLOW_COLON_in_synpred62_Formula1551),!this.state.failed){if(this.input.get(this.input.index()-1).getText()==" "){if(this.state.backtracking>0){this.state.failed=!0;return}throw new org.antlr.runtime.FailedPredicateException(this.input,"synpred62_Formula",' this.input.get(this.input.index()-1).getText()!=" "')}this.pushFollow(FormulaParser.FOLLOW_negationExpression_in_synpred62_Formula1555),this.negationExpression(),this.state._fsp--,this.state.failed}},synpred64_Formula_fragment:function(){this.match(this.input,ir,FormulaParser.FOLLOW_POW_in_synpred64_Formula1610),!this.state.failed&&(this.pushFollow(FormulaParser.FOLLOW_unaryOrNegate_in_synpred64_Formula1612),this.unaryOrNegate(),this.state._fsp--,this.state.failed)},synpred68_Formula_fragment:function(){if(this.input.get(this.input.index()-1).getText()==" "){if(this.state.backtracking>0){this.state.failed=!0;return}throw new org.antlr.runtime.FailedPredicateException(this.input,"synpred68_Formula",' this.input.get(this.input.index()-1).getText()!=" "')}var he=2,Ee=this.input.LA(1);if(Ee==xt||Ee==kt||Ee==116)he=1;else if(Ee==113)he=2;else{if(this.state.backtracking>0){this.state.failed=!0;return}var Fe=new org.antlr.runtime.NoViableAltException("",119,0,this.input);throw Fe}switch(he){case 1:if(this.pushFollow(FormulaParser.FOLLOW_selector_in_synpred68_Formula1744),this.selector(),this.state._fsp--,this.state.failed)return;break;case 2:if(this.pushFollow(FormulaParser.FOLLOW_funCall_in_synpred68_Formula1746),this.funCall(),this.state._fsp--,this.state.failed)return;break}},synpred75_Formula_fragment:function(){this.pushFollow(FormulaParser.FOLLOW_material_in_synpred75_Formula1841),this.material(),this.state._fsp--,this.state.failed},synpred78_Formula_fragment:function(){this.pushFollow(FormulaParser.FOLLOW_array_in_synpred78_Formula1856),this.array(),this.state._fsp--,this.state.failed},synpred80_Formula_fragment:function(){this.pushFollow(FormulaParser.FOLLOW_funCall_in_synpred80_Formula1880),this.funCall(),this.state._fsp--,this.state.failed},synpred85_Formula_fragment:function(){this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_synpred85_Formula1946),this.state.failed},synpred86_Formula_fragment:function(){this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_synpred86_Formula1952),this.state.failed},synpred87_Formula_fragment:function(){this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_synpred87_Formula1958),this.state.failed},synpred88_Formula_fragment:function(){this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_synpred88_Formula1963),this.state.failed},synpred93_Formula_fragment:function(){this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_synpred93_Formula1989),this.state.failed},synpred94_Formula_fragment:function(){this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_synpred94_Formula1995),this.state.failed},synpred95_Formula_fragment:function(){this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_synpred95_Formula2000),this.state.failed},synpred96_Formula_fragment:function(){this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_synpred96_Formula2005),this.state.failed},synpred108_Formula_fragment:function(){this.match(this.input,116,FormulaParser.FOLLOW_116_in_synpred108_Formula2133),!this.state.failed&&(this.pushFollow(FormulaParser.FOLLOW_arrayName_in_synpred108_Formula2135),this.arrayName(),this.state._fsp--,this.state.failed)},synpred112_Formula_fragment:function(){if(this.pushFollow(FormulaParser.FOLLOW_arrayName_in_synpred112_Formula2173),this.arrayName(),this.state._fsp--,!this.state.failed){e:do{var he=2,Ee=this.input.LA(1);switch(Ee==Me&&(he=1),he){case 1:if(this.match(this.input,Me,FormulaParser.FOLLOW_NEWLINE_in_synpred112_Formula2175),this.state.failed)return;break;default:break e}}while(!0);this.match(this.input,tr,FormulaParser.FOLLOW_COLON_in_synpred112_Formula2178),this.state.failed}},synpred95_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred95_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred94_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred94_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred80_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred80_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred49_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred49_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred57_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred57_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred68_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred68_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred51_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred51_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred62_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred62_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred64_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred64_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred93_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred93_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred55_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred55_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred85_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred85_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred87_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred87_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred48_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred48_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred86_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred86_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred9_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred9_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred75_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred75_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred96_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred96_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred47_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred47_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred8_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred8_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred112_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred112_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred6_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred6_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred5_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred5_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred60_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred60_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred61_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred61_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred108_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred108_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred11_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred11_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred78_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred78_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee},synpred88_Formula:function(){this.state.backtracking++;var he=this.input.mark();try{this.synpred88_Formula_fragment()}catch(Fe){throw Fe}var Ee=!this.state.failed;return this.input.rewind(he),this.state.backtracking--,this.state.failed=!1,Ee}},!0),org.antlr.lang.augmentObject(FormulaParser,{DFA5_eotS:"",DFA5_eofS:"",DFA5_minS:"&\0\b\0\0\b",DFA5_maxS:"q\0\b\0\0\b",DFA5_acceptS:`	\b	
\x07`,DFA5_specialS:"\0\b\b}>",DFA5_transitionS:[`\r\v\v
`,"","","","","","","","","","","","","","","","","","","","","",""]}),org.antlr.lang.augmentObject(FormulaParser,{DFA5_eot:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA5_eotS),DFA5_eof:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA5_eofS),DFA5_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaParser.DFA5_minS),DFA5_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaParser.DFA5_maxS),DFA5_accept:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA5_acceptS),DFA5_special:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA5_specialS),DFA5_transition:function(){var he=[],Ee,Fe=FormulaParser.DFA5_transitionS.length;for(Ee=0;Ee<Fe;Ee++)he.push(org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA5_transitionS[Ee]));return he}()}),FormulaParser.DFA5=function(he){this.recognizer=he,this.decisionNumber=5,this.eot=FormulaParser.DFA5_eot,this.eof=FormulaParser.DFA5_eof,this.min=FormulaParser.DFA5_min,this.max=FormulaParser.DFA5_max,this.accept=FormulaParser.DFA5_accept,this.special=FormulaParser.DFA5_special,this.transition=FormulaParser.DFA5_transition},org.antlr.lang.extend(FormulaParser.DFA5,org.antlr.runtime.DFA,{getDescription:function(){return"120:1: expression : ( assignment | logicalExpression | whileLoop | forLoop | forInLoop | ifThenElse | functionDef | returnExp | tryCatch | throwExp );"},specialStateTransition:function(he,Ee){var Fe=he,Pe=function(ke,Ae){switch(ke){case 0:Ae.LA(1);var Re=Ae.index();if(Ae.rewind(),ke=-1,this.synpred5_Formula()?ke=19:this.synpred6_Formula()&&(ke=3),Ae.seek(Re),ke>=0)return ke;break;case 1:Ae.LA(1);var Ce=Ae.index();if(Ae.rewind(),ke=-1,this.synpred5_Formula()?ke=19:this.synpred6_Formula()&&(ke=3),Ae.seek(Ce),ke>=0)return ke;break;case 2:Ae.LA(1);var Ie=Ae.index();if(Ae.rewind(),ke=-1,this.synpred6_Formula()?ke=3:this.synpred11_Formula()&&(ke=20),Ae.seek(Ie),ke>=0)return ke;break;case 3:Ae.LA(1);var Ve=Ae.index();if(Ae.rewind(),ke=-1,this.synpred8_Formula()?ke=21:this.synpred9_Formula()&&(ke=22),Ae.seek(Ve),ke>=0)return ke;break}}.call(this.recognizer,he,Ee);if(!org.antlr.lang.isUndefined(Pe))return Pe;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var ye=new org.antlr.runtime.NoViableAltException(this.getDescription(),5,Fe,Ee);throw this.error(ye),ye},dummy:null}),org.antlr.lang.augmentObject(FormulaParser,{DFA57_eotS:"\v",DFA57_eofS:"\v",DFA57_minS:"<\0",DFA57_maxS:"b\0",DFA57_acceptS:"\x07\b	",DFA57_specialS:"\0}>",DFA57_transitionS:["\b	\x07","","","","","","","","","",""]}),org.antlr.lang.augmentObject(FormulaParser,{DFA57_eot:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA57_eotS),DFA57_eof:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA57_eofS),DFA57_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaParser.DFA57_minS),DFA57_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaParser.DFA57_maxS),DFA57_accept:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA57_acceptS),DFA57_special:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA57_specialS),DFA57_transition:function(){var he=[],Ee,Fe=FormulaParser.DFA57_transitionS.length;for(Ee=0;Ee<Fe;Ee++)he.push(org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA57_transitionS[Ee]));return he}()}),FormulaParser.DFA57=function(he){this.recognizer=he,this.decisionNumber=57,this.eot=FormulaParser.DFA57_eot,this.eof=FormulaParser.DFA57_eof,this.min=FormulaParser.DFA57_min,this.max=FormulaParser.DFA57_max,this.accept=FormulaParser.DFA57_accept,this.special=FormulaParser.DFA57_special,this.transition=FormulaParser.DFA57_transition},org.antlr.lang.extend(FormulaParser.DFA57,org.antlr.runtime.DFA,{getDescription:function(){return"283:1: value : ( number | bool | string | material | IDENT | primitive | array | anonFunctionDef | newObject );"},specialStateTransition:function(he,Ee){var Fe=he,Pe=function(ke,Ae){switch(ke){case 0:Ae.LA(1);var Re=Ae.index();if(Ae.rewind(),ke=-1,this.synpred75_Formula()?ke=10:this.synpred78_Formula()&&(ke=7),Ae.seek(Re),ke>=0)return ke;break}}.call(this.recognizer,he,Ee);if(!org.antlr.lang.isUndefined(Pe))return Pe;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var ye=new org.antlr.runtime.NoViableAltException(this.getDescription(),57,Fe,Ee);throw this.error(ye),ye},dummy:null}),org.antlr.lang.augmentObject(FormulaParser,{DFA58_eotS:"",DFA58_eofS:"",DFA58_minS:" \0",DFA58_maxS:"t\0",DFA58_acceptS:"",DFA58_specialS:"\0}>",DFA58_transitionS:["\r\r","","","","","","","","","","","","","","","","","","","","","","","","",""]}),org.antlr.lang.augmentObject(FormulaParser,{DFA58_eot:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA58_eotS),DFA58_eof:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA58_eofS),DFA58_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaParser.DFA58_minS),DFA58_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaParser.DFA58_maxS),DFA58_accept:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA58_acceptS),DFA58_special:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA58_specialS),DFA58_transition:function(){var he=[],Ee,Fe=FormulaParser.DFA58_transitionS.length;for(Ee=0;Ee<Fe;Ee++)he.push(org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA58_transitionS[Ee]));return he}()}),FormulaParser.DFA58=function(he){this.recognizer=he,this.decisionNumber=58,this.eot=FormulaParser.DFA58_eot,this.eof=FormulaParser.DFA58_eof,this.min=FormulaParser.DFA58_min,this.max=FormulaParser.DFA58_max,this.accept=FormulaParser.DFA58_accept,this.special=FormulaParser.DFA58_special,this.transition=FormulaParser.DFA58_transition},org.antlr.lang.extend(FormulaParser.DFA58,org.antlr.runtime.DFA,{getDescription:function(){return"296:22: ( funCall )?"},specialStateTransition:function(he,Ee){var Fe=he,Pe=function(ke,Ae){switch(ke){case 0:Ae.LA(1);var Re=Ae.index();if(Ae.rewind(),ke=-1,this.synpred80_Formula()?ke=25:(this.input.get(this.input.index()-1).getText()==" "||this.input.get(this.input.index()-1).getText()!=" ")&&(ke=2),Ae.seek(Re),ke>=0)return ke;break}}.call(this.recognizer,he,Ee);if(!org.antlr.lang.isUndefined(Pe))return Pe;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var ye=new org.antlr.runtime.NoViableAltException(this.getDescription(),58,Fe,Ee);throw this.error(ye),ye},dummy:null}),org.antlr.lang.augmentObject(FormulaParser,{DFA65_eotS:"",DFA65_eofS:"",DFA65_minS:"  ",DFA65_maxS:"qq",DFA65_acceptS:"",DFA65_specialS:"}>",DFA65_transitionS:[`\x1B
`,"",`\x1B
`,""]}),org.antlr.lang.augmentObject(FormulaParser,{DFA65_eot:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA65_eotS),DFA65_eof:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA65_eofS),DFA65_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaParser.DFA65_minS),DFA65_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaParser.DFA65_maxS),DFA65_accept:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA65_acceptS),DFA65_special:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA65_specialS),DFA65_transition:function(){var he=[],Ee,Fe=FormulaParser.DFA65_transitionS.length;for(Ee=0;Ee<Fe;Ee++)he.push(org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA65_transitionS[Ee]));return he}()}),FormulaParser.DFA65=function(he){this.recognizer=he,this.decisionNumber=65,this.eot=FormulaParser.DFA65_eot,this.eof=FormulaParser.DFA65_eof,this.min=FormulaParser.DFA65_min,this.max=FormulaParser.DFA65_max,this.accept=FormulaParser.DFA65_accept,this.special=FormulaParser.DFA65_special,this.transition=FormulaParser.DFA65_transition},org.antlr.lang.extend(FormulaParser.DFA65,org.antlr.runtime.DFA,{getDescription:function(){return"309:16: ( label ( NEWLINE )* ( ',' ( NEWLINE )* label ( NEWLINE )* )* )?"},dummy:null}),org.antlr.lang.augmentObject(FormulaParser,{DFA72_eotS:"",DFA72_eofS:"",DFA72_minS:"  ",DFA72_maxS:"qq",DFA72_acceptS:"",DFA72_specialS:"}>",DFA72_transitionS:[`\x1B
`,"",`\x1B
`,""]}),org.antlr.lang.augmentObject(FormulaParser,{DFA72_eot:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA72_eotS),DFA72_eof:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA72_eofS),DFA72_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaParser.DFA72_minS),DFA72_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaParser.DFA72_maxS),DFA72_accept:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA72_acceptS),DFA72_special:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA72_specialS),DFA72_transition:function(){var he=[],Ee,Fe=FormulaParser.DFA72_transitionS.length;for(Ee=0;Ee<Fe;Ee++)he.push(org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA72_transitionS[Ee]));return he}()}),FormulaParser.DFA72=function(he){this.recognizer=he,this.decisionNumber=72,this.eot=FormulaParser.DFA72_eot,this.eof=FormulaParser.DFA72_eof,this.min=FormulaParser.DFA72_min,this.max=FormulaParser.DFA72_max,this.accept=FormulaParser.DFA72_accept,this.special=FormulaParser.DFA72_special,this.transition=FormulaParser.DFA72_transition},org.antlr.lang.extend(FormulaParser.DFA72,org.antlr.runtime.DFA,{getDescription:function(){return"310:19: ( label ( NEWLINE )* ( ',' ( NEWLINE )* label ( NEWLINE )* )* )?"},dummy:null}),org.antlr.lang.augmentObject(FormulaParser,{DFA85_eotS:"",DFA85_eofS:"",DFA85_minS:" \0\0",DFA85_maxS:"q\0\0",DFA85_acceptS:"\x07",DFA85_specialS:"\0}>",DFA85_transitionS:[`\x1B\b

`,"","","","","","","","","","","","","",""]}),org.antlr.lang.augmentObject(FormulaParser,{DFA85_eot:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA85_eotS),DFA85_eof:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA85_eofS),DFA85_min:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaParser.DFA85_minS),DFA85_max:org.antlr.runtime.DFA.unpackEncodedStringToUnsignedChars(FormulaParser.DFA85_maxS),DFA85_accept:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA85_acceptS),DFA85_special:org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA85_specialS),DFA85_transition:function(){var he=[],Ee,Fe=FormulaParser.DFA85_transitionS.length;for(Ee=0;Ee<Fe;Ee++)he.push(org.antlr.runtime.DFA.unpackEncodedString(FormulaParser.DFA85_transitionS[Ee]));return he}()}),FormulaParser.DFA85=function(he){this.recognizer=he,this.decisionNumber=85,this.eot=FormulaParser.DFA85_eot,this.eof=FormulaParser.DFA85_eof,this.min=FormulaParser.DFA85_min,this.max=FormulaParser.DFA85_max,this.accept=FormulaParser.DFA85_accept,this.special=FormulaParser.DFA85_special,this.transition=FormulaParser.DFA85_transition},org.antlr.lang.extend(FormulaParser.DFA85,org.antlr.runtime.DFA,{getDescription:function(){return"331:2: ( arrayName ( NEWLINE )* COLON )?"},specialStateTransition:function(he,Ee){var Fe=he,Pe=function(ke,Ae){switch(ke){case 0:Ae.LA(1);var Re=Ae.index();if(Ae.rewind(),ke=-1,this.synpred112_Formula()?ke=10:ke=2,Ae.seek(Re),ke>=0)return ke;break;case 1:Ae.LA(1);var Ce=Ae.index();if(Ae.rewind(),ke=-1,this.synpred112_Formula()?ke=10:ke=2,Ae.seek(Ce),ke>=0)return ke;break}}.call(this.recognizer,he,Ee);if(!org.antlr.lang.isUndefined(Pe))return Pe;if(this.recognizer.state.backtracking>0)return this.recognizer.state.failed=!0,-1;var ye=new org.antlr.runtime.NoViableAltException(this.getDescription(),85,Fe,Ee);throw this.error(ye),ye},dummy:null}),org.antlr.lang.augmentObject(FormulaParser,{tokenNames:["<invalid>","<EOR>","<DOWN>","<UP>","NEGATE","ASSIGN","FUNCALL","MATERIAL","UNIT","POWER","DEFAULTS","PARAMS","UNITCLUMP","ARRAY","LINES","WHILE","IFTHENELSE","ELSE","FOR","FORIN","FUNCTION","ANONFUNCTION","NUMBER","LABEL","RANGE","INNER","ASSIGNED","SELECTOR","DOTSELECTOR","NEW","TRYCATCH","THROW","NEWLINE","W","H","I","L","E","WHILESTATEMENT","F","O","R","FORSTATEMENT","M","FROMSTATEMENT","N","INSTATEMENT","T","TOSTATEMENT","B","Y","BYSTATEMENT","P","LOOPSTATEMENT","IFSTATEMENT","THENSTATEMENT","S","ELSESTATEMENT","U","C","FUNCTIONSTATEMENT","D","ENDBLOCK","RETURNSTATEMENT","NEWSTATEMENT","TRYSTATEMENT","A","CATCHSTATEMENT","THROWSTATEMENT","IDENT","EQUALS","PRIMITIVE","OR","XOR","X","AND","NOTEQUALS","LT","LTEQ","GT","GTEQ","PLUS","MINUS","MULT","DIV","MOD","COLON","POW","NOT","LARR","RARR","LCURL","RCURL","COMMA","STRING","INTEGER","FLOAT","TRUE","FALSE","PER","CUBED","SQUARED","Q","LBRACKET","RBRACKET","COMMENT","LINE_COMMENT","WS","G","J","K","V","Z","'('","')'","'<-'","'.'"],FOLLOW_NEWLINE_in_lines160:new org.antlr.runtime.BitSet([0,2420114497,3406037171,131079]),FOLLOW_expression_in_lines164:new org.antlr.runtime.BitSet([0,1]),FOLLOW_NEWLINE_in_lines168:new org.antlr.runtime.BitSet([0,2420114497,3406037171,131079]),FOLLOW_EOF_in_lines171:new org.antlr.runtime.BitSet([0,2420114496,3406037171,131079]),FOLLOW_EOF_in_lines176:new org.antlr.runtime.BitSet([2,0]),FOLLOW_assignment_in_expression508:new org.antlr.runtime.BitSet([2,0]),FOLLOW_logicalExpression_in_expression514:new org.antlr.runtime.BitSet([2,0]),FOLLOW_whileLoop_in_expression520:new org.antlr.runtime.BitSet([2,0]),FOLLOW_forLoop_in_expression526:new org.antlr.runtime.BitSet([2,0]),FOLLOW_forInLoop_in_expression532:new org.antlr.runtime.BitSet([2,0]),FOLLOW_ifThenElse_in_expression538:new org.antlr.runtime.BitSet([2,0]),FOLLOW_functionDef_in_expression544:new org.antlr.runtime.BitSet([2,0]),FOLLOW_returnExp_in_expression550:new org.antlr.runtime.BitSet([2,0]),FOLLOW_tryCatch_in_expression556:new org.antlr.runtime.BitSet([2,0]),FOLLOW_throwExp_in_expression562:new org.antlr.runtime.BitSet([2,0]),FOLLOW_RETURNSTATEMENT_in_returnExp574:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_logicalExpression_in_returnExp577:new org.antlr.runtime.BitSet([2,0]),FOLLOW_expression_in_innerBlock590:new org.antlr.runtime.BitSet([0,1]),FOLLOW_NEWLINE_in_innerBlock594:new org.antlr.runtime.BitSet([2,2420114497,3406037171,131079]),FOLLOW_WHILESTATEMENT_in_whileLoop619:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_logicalExpression_in_whileLoop621:new org.antlr.runtime.BitSet([0,1]),FOLLOW_NEWLINE_in_whileLoop623:new org.antlr.runtime.BitSet([0,3493856321,3406037171,131079]),FOLLOW_innerBlock_in_whileLoop626:new org.antlr.runtime.BitSet([0,1073741824]),FOLLOW_ENDBLOCK_in_whileLoop629:new org.antlr.runtime.BitSet([0,2097152]),FOLLOW_LOOPSTATEMENT_in_whileLoop631:new org.antlr.runtime.BitSet([2,0]),FOLLOW_FORSTATEMENT_in_forLoop652:new org.antlr.runtime.BitSet([0,0,32,0]),FOLLOW_IDENT_in_forLoop654:new org.antlr.runtime.BitSet([0,4096]),FOLLOW_FROMSTATEMENT_in_forLoop656:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_logicalExpression_in_forLoop658:new org.antlr.runtime.BitSet([0,65536]),FOLLOW_TOSTATEMENT_in_forLoop660:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_logicalExpression_in_forLoop662:new org.antlr.runtime.BitSet([0,524289]),FOLLOW_BYSTATEMENT_in_forLoop665:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_logicalExpression_in_forLoop667:new org.antlr.runtime.BitSet([0,1]),FOLLOW_NEWLINE_in_forLoop671:new org.antlr.runtime.BitSet([0,3493856321,3406037171,131079]),FOLLOW_innerBlock_in_forLoop674:new org.antlr.runtime.BitSet([0,1073741824]),FOLLOW_ENDBLOCK_in_forLoop677:new org.antlr.runtime.BitSet([0,2097152]),FOLLOW_LOOPSTATEMENT_in_forLoop679:new org.antlr.runtime.BitSet([2,0]),FOLLOW_FORSTATEMENT_in_forInLoop707:new org.antlr.runtime.BitSet([0,0,32,0]),FOLLOW_IDENT_in_forInLoop709:new org.antlr.runtime.BitSet([0,16384]),FOLLOW_INSTATEMENT_in_forInLoop711:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_logicalExpression_in_forInLoop713:new org.antlr.runtime.BitSet([0,1]),FOLLOW_NEWLINE_in_forInLoop715:new org.antlr.runtime.BitSet([0,3493856321,3406037171,131079]),FOLLOW_innerBlock_in_forInLoop718:new org.antlr.runtime.BitSet([0,1073741824]),FOLLOW_ENDBLOCK_in_forInLoop721:new org.antlr.runtime.BitSet([0,2097152]),FOLLOW_LOOPSTATEMENT_in_forInLoop723:new org.antlr.runtime.BitSet([2,0]),FOLLOW_IFSTATEMENT_in_ifThenElse748:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_logicalExpression_in_ifThenElse750:new org.antlr.runtime.BitSet([0,8388608]),FOLLOW_THENSTATEMENT_in_ifThenElse752:new org.antlr.runtime.BitSet([0,1]),FOLLOW_NEWLINE_in_ifThenElse755:new org.antlr.runtime.BitSet([0,3527410753,3406037171,131079]),FOLLOW_innerBlock_in_ifThenElse758:new org.antlr.runtime.BitSet([0,1107296256]),FOLLOW_ELSESTATEMENT_in_ifThenElse762:new org.antlr.runtime.BitSet([0,4194304]),FOLLOW_IFSTATEMENT_in_ifThenElse764:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_logicalExpression_in_ifThenElse766:new org.antlr.runtime.BitSet([0,8388608]),FOLLOW_THENSTATEMENT_in_ifThenElse768:new org.antlr.runtime.BitSet([0,1]),FOLLOW_NEWLINE_in_ifThenElse770:new org.antlr.runtime.BitSet([0,3527410753,3406037171,131079]),FOLLOW_innerBlock_in_ifThenElse773:new org.antlr.runtime.BitSet([0,1107296256]),FOLLOW_ELSESTATEMENT_in_ifThenElse778:new org.antlr.runtime.BitSet([0,1]),FOLLOW_NEWLINE_in_ifThenElse780:new org.antlr.runtime.BitSet([0,3493856321,3406037171,131079]),FOLLOW_innerBlock_in_ifThenElse783:new org.antlr.runtime.BitSet([0,1073741824]),FOLLOW_ENDBLOCK_in_ifThenElse787:new org.antlr.runtime.BitSet([0,4194304]),FOLLOW_IFSTATEMENT_in_ifThenElse789:new org.antlr.runtime.BitSet([2,0]),FOLLOW_FUNCTIONSTATEMENT_in_functionDef820:new org.antlr.runtime.BitSet([0,0,32,0]),FOLLOW_IDENT_in_functionDef822:new org.antlr.runtime.BitSet([0,0,0,131072]),FOLLOW_113_in_functionDef824:new org.antlr.runtime.BitSet([0,0,32,262144]),FOLLOW_IDENT_in_functionDef827:new org.antlr.runtime.BitSet([0,0,536870976,262144]),FOLLOW_EQUALS_in_functionDef831:new org.antlr.runtime.BitSet([0,0,3389259776,7]),FOLLOW_defaultValue_in_functionDef834:new org.antlr.runtime.BitSet([0,0,536870912,262144]),FOLLOW_COMMA_in_functionDef839:new org.antlr.runtime.BitSet([0,0,32,0]),FOLLOW_IDENT_in_functionDef841:new org.antlr.runtime.BitSet([0,0,536870912,262144]),FOLLOW_COMMA_in_functionDef848:new org.antlr.runtime.BitSet([0,0,32,0]),FOLLOW_IDENT_in_functionDef850:new org.antlr.runtime.BitSet([0,0,64,0]),FOLLOW_EQUALS_in_functionDef852:new org.antlr.runtime.BitSet([0,0,3389259776,7]),FOLLOW_defaultValue_in_functionDef854:new org.antlr.runtime.BitSet([0,0,536870912,262144]),FOLLOW_114_in_functionDef861:new org.antlr.runtime.BitSet([0,1]),FOLLOW_NEWLINE_in_functionDef863:new org.antlr.runtime.BitSet([0,3493856321,3406037171,131079]),FOLLOW_innerBlock_in_functionDef866:new org.antlr.runtime.BitSet([0,1073741824]),FOLLOW_ENDBLOCK_in_functionDef869:new org.antlr.runtime.BitSet([0,268435456]),FOLLOW_FUNCTIONSTATEMENT_in_functionDef871:new org.antlr.runtime.BitSet([2,0]),FOLLOW_TRYSTATEMENT_in_tryCatch904:new org.antlr.runtime.BitSet([0,1]),FOLLOW_NEWLINE_in_tryCatch906:new org.antlr.runtime.BitSet([0,2420114497,3406037179,131079]),FOLLOW_innerBlock_in_tryCatch909:new org.antlr.runtime.BitSet([0,0,8,0]),FOLLOW_CATCHSTATEMENT_in_tryCatch911:new org.antlr.runtime.BitSet([0,0,32,0]),FOLLOW_IDENT_in_tryCatch913:new org.antlr.runtime.BitSet([0,1]),FOLLOW_NEWLINE_in_tryCatch915:new org.antlr.runtime.BitSet([0,3493856321,3406037171,131079]),FOLLOW_innerBlock_in_tryCatch919:new org.antlr.runtime.BitSet([0,1073741824]),FOLLOW_ENDBLOCK_in_tryCatch921:new org.antlr.runtime.BitSet([0,0,2,0]),FOLLOW_TRYSTATEMENT_in_tryCatch923:new org.antlr.runtime.BitSet([2,0]),FOLLOW_THROWSTATEMENT_in_throwExp945:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_primaryExpression_in_throwExp947:new org.antlr.runtime.BitSet([2,0]),FOLLOW_FUNCTIONSTATEMENT_in_anonFunctionDef967:new org.antlr.runtime.BitSet([0,0,0,131072]),FOLLOW_113_in_anonFunctionDef970:new org.antlr.runtime.BitSet([0,0,32,262144]),FOLLOW_IDENT_in_anonFunctionDef973:new org.antlr.runtime.BitSet([0,0,536870976,262144]),FOLLOW_EQUALS_in_anonFunctionDef977:new org.antlr.runtime.BitSet([0,0,3389259776,7]),FOLLOW_defaultValue_in_anonFunctionDef980:new org.antlr.runtime.BitSet([0,0,536870912,262144]),FOLLOW_COMMA_in_anonFunctionDef985:new org.antlr.runtime.BitSet([0,0,32,0]),FOLLOW_IDENT_in_anonFunctionDef987:new org.antlr.runtime.BitSet([0,0,536870912,262144]),FOLLOW_COMMA_in_anonFunctionDef994:new org.antlr.runtime.BitSet([0,0,32,0]),FOLLOW_IDENT_in_anonFunctionDef996:new org.antlr.runtime.BitSet([0,0,64,0]),FOLLOW_EQUALS_in_anonFunctionDef998:new org.antlr.runtime.BitSet([0,0,3389259776,7]),FOLLOW_defaultValue_in_anonFunctionDef1000:new org.antlr.runtime.BitSet([0,0,536870912,262144]),FOLLOW_114_in_anonFunctionDef1007:new org.antlr.runtime.BitSet([0,2420114497,3406037171,131079]),FOLLOW_NEWLINE_in_anonFunctionDef1012:new org.antlr.runtime.BitSet([0,3493856321,3406037171,131079]),FOLLOW_innerBlock_in_anonFunctionDef1015:new org.antlr.runtime.BitSet([0,1073741824]),FOLLOW_ENDBLOCK_in_anonFunctionDef1018:new org.antlr.runtime.BitSet([0,268435456]),FOLLOW_FUNCTIONSTATEMENT_in_anonFunctionDef1020:new org.antlr.runtime.BitSet([2,0]),FOLLOW_expression_in_anonFunctionDef1025:new org.antlr.runtime.BitSet([2,0]),FOLLOW_IDENT_in_assignment1067:new org.antlr.runtime.BitSet([0,0,0,131072]),FOLLOW_113_in_assignment1069:new org.antlr.runtime.BitSet([0,0,32,262144]),FOLLOW_IDENT_in_assignment1072:new org.antlr.runtime.BitSet([0,0,536870976,262144]),FOLLOW_EQUALS_in_assignment1076:new org.antlr.runtime.BitSet([0,0,3389259776,7]),FOLLOW_defaultValue_in_assignment1078:new org.antlr.runtime.BitSet([0,0,536870912,262144]),FOLLOW_COMMA_in_assignment1083:new org.antlr.runtime.BitSet([0,0,32,0]),FOLLOW_IDENT_in_assignment1085:new org.antlr.runtime.BitSet([0,0,536870912,262144]),FOLLOW_COMMA_in_assignment1092:new org.antlr.runtime.BitSet([0,0,32,0]),FOLLOW_IDENT_in_assignment1094:new org.antlr.runtime.BitSet([0,0,64,0]),FOLLOW_EQUALS_in_assignment1096:new org.antlr.runtime.BitSet([0,0,3389259776,7]),FOLLOW_defaultValue_in_assignment1098:new org.antlr.runtime.BitSet([0,0,536870912,262144]),FOLLOW_114_in_assignment1105:new org.antlr.runtime.BitSet([0,0,0,524288]),FOLLOW_115_in_assignment1107:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_logicalExpression_in_assignment1109:new org.antlr.runtime.BitSet([2,0]),FOLLOW_PRIMITIVE_in_assignment1137:new org.antlr.runtime.BitSet([0,0,536870912,524288]),FOLLOW_assigned_in_assignment1141:new org.antlr.runtime.BitSet([0,0,536870912,524288]),FOLLOW_COMMA_in_assignment1145:new org.antlr.runtime.BitSet([0,0,160,0]),FOLLOW_PRIMITIVE_in_assignment1148:new org.antlr.runtime.BitSet([0,0,536870912,524288]),FOLLOW_assigned_in_assignment1152:new org.antlr.runtime.BitSet([0,0,536870912,524288]),FOLLOW_115_in_assignment1158:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_logicalExpression_in_assignment1160:new org.antlr.runtime.BitSet([2,0]),FOLLOW_IDENT_in_assigned1186:new org.antlr.runtime.BitSet([2,0,167772160,1048576]),FOLLOW_selector_in_assigned1188:new org.antlr.runtime.BitSet([2,0]),FOLLOW_booleanXORExpression_in_logicalExpression1214:new org.antlr.runtime.BitSet([2,0,256,0]),FOLLOW_OR_in_logicalExpression1217:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_booleanXORExpression_in_logicalExpression1220:new org.antlr.runtime.BitSet([2,0,256,0]),FOLLOW_booleanAndExpression_in_booleanXORExpression1250:new org.antlr.runtime.BitSet([2,0,512,0]),FOLLOW_XOR_in_booleanXORExpression1253:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_booleanAndExpression_in_booleanXORExpression1256:new org.antlr.runtime.BitSet([2,0,512,0]),FOLLOW_equalityExpression_in_booleanAndExpression1285:new org.antlr.runtime.BitSet([2,0,2048,0]),FOLLOW_AND_in_booleanAndExpression1288:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_equalityExpression_in_booleanAndExpression1291:new org.antlr.runtime.BitSet([2,0,2048,0]),FOLLOW_relationalExpression_in_equalityExpression1322:new org.antlr.runtime.BitSet([2,0,4160,0]),FOLLOW_set_in_equalityExpression1325:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_relationalExpression_in_equalityExpression1332:new org.antlr.runtime.BitSet([2,0,4160,0]),FOLLOW_additiveExpression_in_relationalExpression1374:new org.antlr.runtime.BitSet([2,0,122880,0]),FOLLOW_set_in_relationalExpression1378:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_additiveExpression_in_relationalExpression1389:new org.antlr.runtime.BitSet([2,0,122880,0]),FOLLOW_multiplicativeExpression_in_additiveExpression1432:new org.antlr.runtime.BitSet([2,0,393216,0]),FOLLOW_set_in_additiveExpression1436:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_multiplicativeExpression_in_additiveExpression1443:new org.antlr.runtime.BitSet([2,0,393216,0]),FOLLOW_arrayExpression_in_multiplicativeExpression1473:new org.antlr.runtime.BitSet([2,0,3670016,0]),FOLLOW_set_in_multiplicativeExpression1477:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_arrayExpression_in_multiplicativeExpression1486:new org.antlr.runtime.BitSet([2,0,3670016,0]),FOLLOW_negationExpression_in_arrayExpression1532:new org.antlr.runtime.BitSet([2,0,4194304,0]),FOLLOW_COLON_in_arrayExpression1538:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_negationExpression_in_arrayExpression1542:new org.antlr.runtime.BitSet([2,0,4194304,0]),FOLLOW_COLON_in_arrayExpression1551:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_negationExpression_in_arrayExpression1555:new org.antlr.runtime.BitSet([2,0]),FOLLOW_MINUS_in_negationExpression1580:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_powerExpression_in_negationExpression1582:new org.antlr.runtime.BitSet([2,0]),FOLLOW_powerExpression_in_negationExpression1596:new org.antlr.runtime.BitSet([2,0]),FOLLOW_unaryExpression_in_powerExpression1607:new org.antlr.runtime.BitSet([2,0,8388608,0]),FOLLOW_POW_in_powerExpression1610:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_unaryOrNegate_in_powerExpression1612:new org.antlr.runtime.BitSet([2,0,8388608,0]),FOLLOW_unaryExpression_in_unaryOrNegate1639:new org.antlr.runtime.BitSet([2,0]),FOLLOW_MINUS_in_unaryOrNegate1645:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_unaryExpression_in_unaryOrNegate1647:new org.antlr.runtime.BitSet([2,0]),FOLLOW_NOT_in_unaryExpression1675:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_innerPrimaryExpression_in_unaryExpression1678:new org.antlr.runtime.BitSet([2,0]),FOLLOW_innerPrimaryExpression_in_unaryExpression1687:new org.antlr.runtime.BitSet([2,0]),FOLLOW_selectionExpression_in_innerPrimaryExpression1718:new org.antlr.runtime.BitSet([2,0]),FOLLOW_primaryExpression_in_selectionExpression1738:new org.antlr.runtime.BitSet([2,0,167772160,1179648]),FOLLOW_selector_in_selectionExpression1744:new org.antlr.runtime.BitSet([2,0,167772160,1179648]),FOLLOW_funCall_in_selectionExpression1746:new org.antlr.runtime.BitSet([2,0,167772160,1179648]),FOLLOW_113_in_funCall1761:new org.antlr.runtime.BitSet([0,268435456,3406037153,393223]),FOLLOW_logicalExpression_in_funCall1765:new org.antlr.runtime.BitSet([0,0,536870912,262144]),FOLLOW_COMMA_in_funCall1768:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_logicalExpression_in_funCall1770:new org.antlr.runtime.BitSet([0,0,536870912,262144]),FOLLOW_114_in_funCall1777:new org.antlr.runtime.BitSet([2,0]),FOLLOW_113_in_primaryExpression1798:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_logicalExpression_in_primaryExpression1801:new org.antlr.runtime.BitSet([0,0,0,262144]),FOLLOW_114_in_primaryExpression1803:new org.antlr.runtime.BitSet([2,0]),FOLLOW_value_in_primaryExpression1809:new org.antlr.runtime.BitSet([2,0]),FOLLOW_number_in_value1823:new org.antlr.runtime.BitSet([2,0]),FOLLOW_bool_in_value1829:new org.antlr.runtime.BitSet([2,0]),FOLLOW_string_in_value1835:new org.antlr.runtime.BitSet([2,0]),FOLLOW_material_in_value1841:new org.antlr.runtime.BitSet([2,0]),FOLLOW_IDENT_in_value1846:new org.antlr.runtime.BitSet([2,0]),FOLLOW_primitive_in_value1851:new org.antlr.runtime.BitSet([2,0]),FOLLOW_array_in_value1856:new org.antlr.runtime.BitSet([2,0]),FOLLOW_anonFunctionDef_in_value1861:new org.antlr.runtime.BitSet([2,0]),FOLLOW_newObject_in_value1866:new org.antlr.runtime.BitSet([2,0]),FOLLOW_NEWSTATEMENT_in_newObject1876:new org.antlr.runtime.BitSet([0,0,32,0]),FOLLOW_IDENT_in_newObject1878:new org.antlr.runtime.BitSet([2,0,167772160,1179648]),FOLLOW_funCall_in_newObject1880:new org.antlr.runtime.BitSet([2,0]),FOLLOW_negnumber_in_defaultValue1906:new org.antlr.runtime.BitSet([2,0]),FOLLOW_number_in_defaultValue1912:new org.antlr.runtime.BitSet([2,0]),FOLLOW_bool_in_defaultValue1918:new org.antlr.runtime.BitSet([2,0]),FOLLOW_string_in_defaultValue1924:new org.antlr.runtime.BitSet([2,0]),FOLLOW_array_in_defaultValue1930:new org.antlr.runtime.BitSet([2,0]),FOLLOW_LARR_in_array1944:new org.antlr.runtime.BitSet([0,268435457,3473670305,131079]),FOLLOW_NEWLINE_in_array1946:new org.antlr.runtime.BitSet([0,268435457,3473670305,131079]),FOLLOW_label_in_array1950:new org.antlr.runtime.BitSet([0,1,603979776,0]),FOLLOW_NEWLINE_in_array1952:new org.antlr.runtime.BitSet([0,1,603979776,0]),FOLLOW_COMMA_in_array1956:new org.antlr.runtime.BitSet([0,268435457,3406561441,131079]),FOLLOW_NEWLINE_in_array1958:new org.antlr.runtime.BitSet([0,268435457,3406561441,131079]),FOLLOW_label_in_array1961:new org.antlr.runtime.BitSet([0,1,603979776,0]),FOLLOW_NEWLINE_in_array1963:new org.antlr.runtime.BitSet([0,1,603979776,0]),FOLLOW_NEWLINE_in_array1970:new org.antlr.runtime.BitSet([0,1,67108864,0]),FOLLOW_RARR_in_array1973:new org.antlr.runtime.BitSet([2,0]),FOLLOW_LCURL_in_array1987:new org.antlr.runtime.BitSet([0,268435457,3674996897,131079]),FOLLOW_NEWLINE_in_array1989:new org.antlr.runtime.BitSet([0,268435457,3674996897,131079]),FOLLOW_label_in_array1993:new org.antlr.runtime.BitSet([0,1,805306368,0]),FOLLOW_NEWLINE_in_array1995:new org.antlr.runtime.BitSet([0,1,805306368,0]),FOLLOW_COMMA_in_array1998:new org.antlr.runtime.BitSet([0,268435457,3406561441,131079]),FOLLOW_NEWLINE_in_array2000:new org.antlr.runtime.BitSet([0,268435457,3406561441,131079]),FOLLOW_label_in_array2003:new org.antlr.runtime.BitSet([0,1,805306368,0]),FOLLOW_NEWLINE_in_array2005:new org.antlr.runtime.BitSet([0,1,805306368,0]),FOLLOW_NEWLINE_in_array2012:new org.antlr.runtime.BitSet([0,1,268435456,0]),FOLLOW_RCURL_in_array2015:new org.antlr.runtime.BitSet([2,0]),FOLLOW_minarray_in_selector2036:new org.antlr.runtime.BitSet([2,0]),FOLLOW_dotselector_in_selector2040:new org.antlr.runtime.BitSet([2,0]),FOLLOW_LARR_in_minarray2067:new org.antlr.runtime.BitSet([0,268435456,3406561441,131079]),FOLLOW_logicalExpression_in_minarray2072:new org.antlr.runtime.BitSet([0,0,603979776,0]),FOLLOW_MULT_in_minarray2074:new org.antlr.runtime.BitSet([0,0,603979776,0]),FOLLOW_COMMA_in_minarray2078:new org.antlr.runtime.BitSet([0,268435456,3406561441,131079]),FOLLOW_logicalExpression_in_minarray2082:new org.antlr.runtime.BitSet([0,0,603979776,0]),FOLLOW_MULT_in_minarray2084:new org.antlr.runtime.BitSet([0,0,603979776,0]),FOLLOW_RARR_in_minarray2091:new org.antlr.runtime.BitSet([2,0]),FOLLOW_LCURL_in_minarray2097:new org.antlr.runtime.BitSet([0,268435456,3406561441,131079]),FOLLOW_logicalExpression_in_minarray2102:new org.antlr.runtime.BitSet([0,0,805306368,0]),FOLLOW_MULT_in_minarray2104:new org.antlr.runtime.BitSet([0,0,805306368,0]),FOLLOW_COMMA_in_minarray2108:new org.antlr.runtime.BitSet([0,268435456,3406561441,131079]),FOLLOW_logicalExpression_in_minarray2112:new org.antlr.runtime.BitSet([0,0,805306368,0]),FOLLOW_MULT_in_minarray2114:new org.antlr.runtime.BitSet([0,0,805306368,0]),FOLLOW_RCURL_in_minarray2121:new org.antlr.runtime.BitSet([2,0]),FOLLOW_116_in_dotselector2133:new org.antlr.runtime.BitSet([0,0,1074266144,0]),FOLLOW_arrayName_in_dotselector2135:new org.antlr.runtime.BitSet([2,0,0,1048576]),FOLLOW_set_in_arrayName0:new org.antlr.runtime.BitSet([2,0]),FOLLOW_arrayName_in_label2173:new org.antlr.runtime.BitSet([0,1,4194304,0]),FOLLOW_NEWLINE_in_label2175:new org.antlr.runtime.BitSet([0,1,4194304,0]),FOLLOW_COLON_in_label2178:new org.antlr.runtime.BitSet([0,268435457,3406037153,131079]),FOLLOW_NEWLINE_in_label2182:new org.antlr.runtime.BitSet([0,268435457,3406037153,131079]),FOLLOW_logicalExpression_in_label2185:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_number0:new org.antlr.runtime.BitSet([2,0]),FOLLOW_MINUS_in_negnumber2261:new org.antlr.runtime.BitSet([0,0,2147483648,1]),FOLLOW_number_in_negnumber2263:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_bool0:new org.antlr.runtime.BitSet([2,0]),FOLLOW_LCURL_in_material2415:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_additiveExpression_in_material2417:new org.antlr.runtime.BitSet([0,0,2147483680,131072]),FOLLOW_unitMultiplicativeExpression_in_material2421:new org.antlr.runtime.BitSet([0,0,268435456,0]),FOLLOW_RCURL_in_material2423:new org.antlr.runtime.BitSet([2,0]),FOLLOW_unitInnerMultiplicativeExpression_in_unitMultiplicativeExpression2460:new org.antlr.runtime.BitSet([2,0,0,8]),FOLLOW_PER_in_unitMultiplicativeExpression2464:new org.antlr.runtime.BitSet([0,0,2147483680,131072]),FOLLOW_unitInnerMultiplicativeExpression_in_unitMultiplicativeExpression2467:new org.antlr.runtime.BitSet([2,0,0,8]),FOLLOW_unitClump_in_unitInnerMultiplicativeExpression2483:new org.antlr.runtime.BitSet([2,0,1572864,0]),FOLLOW_set_in_unitInnerMultiplicativeExpression2487:new org.antlr.runtime.BitSet([0,0,2147483680,131072]),FOLLOW_unitClump_in_unitInnerMultiplicativeExpression2494:new org.antlr.runtime.BitSet([2,0,1572864,0]),FOLLOW_INTEGER_in_unitClump2510:new org.antlr.runtime.BitSet([0,0,1048576,0]),FOLLOW_DIV_in_unitClump2512:new org.antlr.runtime.BitSet([0,0,2147483680,131072]),FOLLOW_unitPowerExpression_in_unitClump2515:new org.antlr.runtime.BitSet([2,0,0,48]),FOLLOW_CUBED_in_unitClump2517:new org.antlr.runtime.BitSet([2,0,0,32]),FOLLOW_SQUARED_in_unitClump2520:new org.antlr.runtime.BitSet([2,0]),FOLLOW_unitPowerExpression_in_unitClump2543:new org.antlr.runtime.BitSet([2,0,0,48]),FOLLOW_CUBED_in_unitClump2545:new org.antlr.runtime.BitSet([2,0,0,32]),FOLLOW_SQUARED_in_unitClump2548:new org.antlr.runtime.BitSet([2,0]),FOLLOW_unit_in_unitPowerExpression2610:new org.antlr.runtime.BitSet([2,0,8388608,0]),FOLLOW_POW_in_unitPowerExpression2614:new org.antlr.runtime.BitSet([0,0,2147745792,1]),FOLLOW_MINUS_in_unitPowerExpression2617:new org.antlr.runtime.BitSet([0,0,2147483648,1]),FOLLOW_set_in_unitPowerExpression2620:new org.antlr.runtime.BitSet([2,0,8388608,0]),FOLLOW_IDENT_in_unit2638:new org.antlr.runtime.BitSet([2,0,32,0]),FOLLOW_IDENT_in_unit2641:new org.antlr.runtime.BitSet([2,0,32,0]),FOLLOW_113_in_unit2658:new org.antlr.runtime.BitSet([0,0,2147483680,131072]),FOLLOW_unitMultiplicativeExpression_in_unit2660:new org.antlr.runtime.BitSet([0,0,0,262144]),FOLLOW_114_in_unit2662:new org.antlr.runtime.BitSet([2,0]),FOLLOW_PRIMITIVE_in_primitive2731:new org.antlr.runtime.BitSet([2,0]),FOLLOW_STRING_in_string3200:new org.antlr.runtime.BitSet([2,0]),FOLLOW_assignment_in_synpred5_Formula508:new org.antlr.runtime.BitSet([2,0]),FOLLOW_logicalExpression_in_synpred6_Formula514:new org.antlr.runtime.BitSet([2,0]),FOLLOW_forLoop_in_synpred8_Formula526:new org.antlr.runtime.BitSet([2,0]),FOLLOW_forInLoop_in_synpred9_Formula532:new org.antlr.runtime.BitSet([2,0]),FOLLOW_functionDef_in_synpred11_Formula544:new org.antlr.runtime.BitSet([2,0]),FOLLOW_OR_in_synpred47_Formula1217:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_booleanXORExpression_in_synpred47_Formula1220:new org.antlr.runtime.BitSet([2,0]),FOLLOW_XOR_in_synpred48_Formula1253:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_booleanAndExpression_in_synpred48_Formula1256:new org.antlr.runtime.BitSet([2,0]),FOLLOW_AND_in_synpred49_Formula1288:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_equalityExpression_in_synpred49_Formula1291:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_synpred51_Formula1325:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_relationalExpression_in_synpred51_Formula1332:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_synpred55_Formula1378:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_additiveExpression_in_synpred55_Formula1389:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_synpred57_Formula1436:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_multiplicativeExpression_in_synpred57_Formula1443:new org.antlr.runtime.BitSet([2,0]),FOLLOW_set_in_synpred60_Formula1477:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_arrayExpression_in_synpred60_Formula1486:new org.antlr.runtime.BitSet([2,0]),FOLLOW_COLON_in_synpred61_Formula1538:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_negationExpression_in_synpred61_Formula1542:new org.antlr.runtime.BitSet([2,0]),FOLLOW_COLON_in_synpred62_Formula1551:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_negationExpression_in_synpred62_Formula1555:new org.antlr.runtime.BitSet([2,0]),FOLLOW_POW_in_synpred64_Formula1610:new org.antlr.runtime.BitSet([0,268435456,3406037153,131079]),FOLLOW_unaryOrNegate_in_synpred64_Formula1612:new org.antlr.runtime.BitSet([2,0]),FOLLOW_selector_in_synpred68_Formula1744:new org.antlr.runtime.BitSet([2,0]),FOLLOW_funCall_in_synpred68_Formula1746:new org.antlr.runtime.BitSet([2,0]),FOLLOW_material_in_synpred75_Formula1841:new org.antlr.runtime.BitSet([2,0]),FOLLOW_array_in_synpred78_Formula1856:new org.antlr.runtime.BitSet([2,0]),FOLLOW_funCall_in_synpred80_Formula1880:new org.antlr.runtime.BitSet([2,0]),FOLLOW_NEWLINE_in_synpred85_Formula1946:new org.antlr.runtime.BitSet([2,0]),FOLLOW_NEWLINE_in_synpred86_Formula1952:new org.antlr.runtime.BitSet([2,0]),FOLLOW_NEWLINE_in_synpred87_Formula1958:new org.antlr.runtime.BitSet([2,0]),FOLLOW_NEWLINE_in_synpred88_Formula1963:new org.antlr.runtime.BitSet([2,0]),FOLLOW_NEWLINE_in_synpred93_Formula1989:new org.antlr.runtime.BitSet([2,0]),FOLLOW_NEWLINE_in_synpred94_Formula1995:new org.antlr.runtime.BitSet([2,0]),FOLLOW_NEWLINE_in_synpred95_Formula2000:new org.antlr.runtime.BitSet([2,0]),FOLLOW_NEWLINE_in_synpred96_Formula2005:new org.antlr.runtime.BitSet([2,0]),FOLLOW_116_in_synpred108_Formula2133:new org.antlr.runtime.BitSet([0,0,1074266144,0]),FOLLOW_arrayName_in_synpred108_Formula2135:new org.antlr.runtime.BitSet([2,0]),FOLLOW_arrayName_in_synpred112_Formula2173:new org.antlr.runtime.BitSet([0,1,4194304,0]),FOLLOW_NEWLINE_in_synpred112_Formula2175:new org.antlr.runtime.BitSet([0,1,4194304,0]),FOLLOW_COLON_in_synpred112_Formula2178:new org.antlr.runtime.BitSet([2,0])})})();org.antlr.runtime.BaseRecognizer.prototype.emitErrorMessage=()=>{};function bootCalc(te){te.varBank=Object.create(null),te.varBank["-parent"]=null,te.varBank.e=new Material(2.718281828459045),te.varBank.pi=new Material(3.141592653589793),te.varBank.phi=new Material(1.61803399),createFunctions(te),createFunctions$1(te)}class PrimitiveStore{constructor(ee,re){this.primitive=ee,this.type=re}}function toNum(te){return te instanceof Material||te instanceof SPrimitive||te instanceof Vector||te instanceof UserFunction||te instanceof SPopulation?te.toNum():te instanceof Function?te([]):te.valueOf()}class UserFunction{constructor(){this.localScope=void 0,this.defaults=void 0,this.fn=void 0}toNum(){return this.fn([])}}let StringObject={},VectorObject={};function createTree(te){let ee=new org.antlr.runtime.ANTLRStringStream(te.replace(/\\n/g,`
`)),re=new FormulaLexer(ee),ne=new org.antlr.runtime.CommonTokenStream(re),ie=new FormulaParser(ne),oe=ie.lines();return convertToObject(oe.tree,ie)}function trimTree(te,ee,re){return trimNode(te,ee,re)}function evaluateTree(te,ee,re){re.evaluatingLine=void 0;try{return evaluateNode(te,ee,re)}catch(ne){if(ne.returnVal)return ne.data;throw ne}}class TreeNode{constructor(ee,re,ne,ie=[]){this.origText=ee,this.text=ee.toLowerCase(),this.typeName=re,this.line=ne,this.children=ie,this.functionFingerprint=null,this.delayEvalParams=null}cloneStructure(){let ee=new TreeNode(this.origText,this.typeName,this.line);return ee.children=this.children.map(re=>{if(re instanceof TreeNode)return re.cloneStructure();throw console.error(this,re),new TypeError("Unknown structure clone type")}),ee}}function convertToObject(te,ee){let re=te.getToken();if(!re)throw new ModelError("Invalid syntax.",{code:7e3});let ne=new TreeNode(re.getText(),ee.getTokenNames()[re.getType()],re.line);if(te.getChildCount()>0){let ie=te.getChildren();for(let oe=0;oe<ie.length;oe++)ne.children.push(convertToObject(ie[oe],ee)),!ne.line&&ne.children[ne.children.length-1].line&&(ne.line=ne.children[ne.children.length-1].line)}return ne}let funcEvalMap=Object.create(null);funcEvalMap.LINES=function(te,ee,re){if(!te.children.length)return new Material(0);let ne;for(let ie of te.children){if(ie.text==="return")throw{returnVal:!0,data:evaluateNode(ie.children[0],ee,re)};ne=evaluateNode(ie,ee,re)}return ne};funcEvalMap.NEGATE=function(te,ee,re){return negate(toNum(evaluateNode(te.children[0],ee,re)))};function negate(te){if(te instanceof Vector)return te.cloneApply(negate);if(te instanceof Material)return new Material(fn["-"](te.value),te.units);throw typeof te=="boolean"?new ModelError("Cannot convert Booleans to Numbers.",{code:7001}):te instanceof String||typeof te=="string"?new ModelError("Cannot convert Strings to Numbers.",{code:7002}):te instanceof SAgent?new ModelError("Cannot convert Agents to Numbers.",{code:7003}):new ModelError("Invalid type - negate",{code:7004})}funcEvalMap.AND=function(te,ee,re){return funAnd(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function funAnd(te,ee){return te instanceof Vector?te.cloneCombine(ee,funAnd,!1):ee instanceof Vector?ee.cloneCombine(te,funAnd,!0):trueValue(te)&&trueValue(ee)}funcEvalMap.OR=function(te,ee,re){return funOr(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function funOr(te,ee){return te instanceof Vector?te.cloneCombine(ee,funOr,!1):ee instanceof Vector?ee.cloneCombine(te,funOr,!0):trueValue(te)||trueValue(ee)}funcEvalMap.XOR=function(te,ee,re){return funXor(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function funXor(te,ee){return te instanceof Vector?te.cloneCombine(ee,funXor,!1):ee instanceof Vector?ee.cloneCombine(te,funXor,!0):(trueValue(te)||trueValue(ee))&&!(trueValue(te)&&trueValue(ee))}funcEvalMap.NOT=function(te,ee,re){return fNot(toNum(evaluateNode(te.children[0],ee,re)))};function fNot(te){return te instanceof Vector?te.cloneApply(fNot):!trueValue(te)}funcEvalMap.NOTEQUALS=function(te,ee,re){return neq(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function neq(te,ee){if(typeof te=="boolean"&&!(ee instanceof Vector)||typeof ee=="boolean"&&!(te instanceof Vector))return trueValue(te)!==trueValue(ee);if((te instanceof String||typeof te=="string")&&!(ee instanceof Vector)||(ee instanceof String||typeof ee=="string")&&!(te instanceof Vector))return(""+te).toLowerCase()!==(""+ee).toLowerCase();if(te instanceof Vector)return te.cloneCombine(ee,neq,!1);if(ee instanceof Vector)return ee.cloneCombine(te,neq,!0);if(!(te instanceof Material)||!(ee instanceof Material))return te!==ee;if(te.units!==ee.units){let re=convertUnits(ee.units,te.units);if(re===0)return!0;ee.value=fn["*"](ee.value,re),ee.units=te.units}return!fn["="](te.value,ee.value)}funcEvalMap.EQUALS=function(te,ee,re){return eq(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function eq(te,ee){if(typeof te=="boolean"&&!(ee instanceof Vector)||typeof ee=="boolean"&&!(te instanceof Vector))return trueValue(te)===trueValue(ee);if((typeof te=="string"||te instanceof String)&&!(ee instanceof Vector)||(typeof ee=="string"||ee instanceof String)&&!(te instanceof Vector))return(""+te).toLowerCase()===(""+ee).toLowerCase();if(te instanceof Vector)return te.cloneCombine(ee,eq,!1);if(ee instanceof Vector)return ee.cloneCombine(te,eq,!0);if(!(te instanceof Material)||!(ee instanceof Material))return te===ee;if(te.units!==ee.units){let re=convertUnits(ee.units,te.units);if(re===0)return!1;ee.value=fn["*"](ee.value,re),ee.units=te.units}return fn["="](te.value,ee.value)}function comparisonValid(te,ee){if(te instanceof String||typeof te=="string"||ee instanceof String||typeof ee=="string")throw new ModelError("Cannot use Strings in logical inequality comparisons.",{code:7005});if(te instanceof Boolean||typeof te=="boolean"||ee instanceof Boolean||typeof ee=="boolean")throw new ModelError("Cannot use Booleans in logical inequality comparisons.",{code:7006});if(te instanceof SAgent||ee instanceof SAgent)throw new ModelError("Cannot use Agents in logical inequality comparisons.",{code:7007})}funcEvalMap.LT=function(te,ee,re){return lessThan(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function lessThan(te,ee){if(comparisonValid(te,ee),te instanceof Vector)return te.cloneCombine(ee,lessThan,!1);if(ee instanceof Vector)return ee.cloneCombine(te,lessThan,!0);if(te instanceof Material&&ee instanceof Material){if(te.units!==ee.units){let re=convertUnits(ee.units,te.units);re===0?unitAlert(te.units,ee.units,"comparison"):(ee.value=fn["*"](ee.value,re),ee.units=te.units)}return fn["<"](te.value,ee.value)}throw new ModelError("Invalid type - lessThan",{code:7008})}funcEvalMap.LTEQ=function(te,ee,re){return lessThanEq(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function lessThanEq(te,ee){if(comparisonValid(te,ee),te instanceof Vector)return te.cloneCombine(ee,lessThanEq,!1);if(ee instanceof Vector)return ee.cloneCombine(te,lessThanEq,!0);if(te instanceof Material&&ee instanceof Material){if(te.units!==ee.units){let re=convertUnits(ee.units,te.units);re===0?unitAlert(te.units,ee.units,"comparison"):(ee.value=fn["*"](ee.value,re),ee.units=te.units)}return fn["<="](te.value,ee.value)}throw new ModelError("Invalid type - lessThanEq",{code:7009})}funcEvalMap.GT=function(te,ee,re){return greaterThan(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function greaterThan(te,ee){if(comparisonValid(te,ee),te instanceof Vector)return te.cloneCombine(ee,greaterThan,!1);if(ee instanceof Vector)return ee.cloneCombine(te,greaterThan,!0);if(te instanceof Material&&ee instanceof Material){if(te.units!==ee.units){let re=convertUnits(ee.units,te.units);re===0?unitAlert(te.units,ee.units,"comparison"):(ee.value=fn["*"](ee.value,re),ee.units=te.units)}return fn[">"](te.value,ee.value)}throw new ModelError("Invalid type - greaterThan",{code:7010})}funcEvalMap.GTEQ=function(te,ee,re){return greaterThanEq(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function greaterThanEq(te,ee){if(comparisonValid(te,ee),te instanceof Vector)return te.cloneCombine(ee,greaterThanEq,!1);if(ee instanceof Vector)return ee.cloneCombine(te,greaterThanEq,!0);if(te instanceof Material&&ee instanceof Material){if(te.units!==ee.units){let re=convertUnits(ee.units,te.units);re===0?unitAlert(te.units,ee.units,"comparison"):(ee.value=fn["*"](ee.value,re),ee.units=te.units)}return fn[">="](te.value,ee.value)}throw new ModelError("Invalid type - greaterThanEq",{code:7011})}funcEvalMap.PLUS=function(te,ee,re){return plus(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function plus(te,ee){if(te instanceof Vector)return te.cloneCombine(ee,plus,!1);if(ee instanceof Vector)return ee.cloneCombine(te,plus,!0);if(te instanceof Material&&ee instanceof Material){if(te.units!==ee.units){let re=convertUnits(ee.units,te.units);re===0?unitAlert(te.units,ee.units,"addition"):(ee.value=fn["*"](ee.value,re),ee.units=te.units)}return new Material(fn["+"](te.value,ee.value),ee.units)}if(typeof te=="boolean"||typeof ee=="boolean")throw new ModelError("Cannot convert Booleans to Numbers.",{code:7012});if(te instanceof SAgent||ee instanceof SAgent)throw new ModelError("Cannot convert Agents to Numbers.",{code:7013});if(typeof te=="string"||te instanceof String||typeof ee=="string"||ee instanceof String)return te.toString()+ee.toString();throw new ModelError("Invalid type - plus",{code:7014})}funcEvalMap.MINUS=function(te,ee,re){return minus(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function minus(te,ee){if(te instanceof Vector)return te.cloneCombine(ee,minus,!1);if(ee instanceof Vector)return ee.cloneCombine(te,minus,!0);if(te instanceof Material&&ee instanceof Material){if(te.units!==ee.units){let re=convertUnits(ee.units,te.units);re===0?unitAlert(te.units,ee.units,"subtraction"):(ee.value=fn["*"](ee.value,re),ee.units=te.units)}return new Material(fn["-"](te.value,ee.value),ee.units)}throw typeof te=="boolean"||typeof ee=="boolean"?new ModelError("Cannot convert Booleans to Numbers.",{code:7015}):te instanceof SAgent||ee instanceof SAgent?new ModelError("Cannot convert Agents to Numbers.",{code:7016}):typeof te=="string"||te instanceof String||typeof ee=="string"||ee instanceof String?new ModelError("Cannot convert Strings to Numbers.",{code:7017}):new ModelError("Invalid type - minus",{code:7018})}funcEvalMap.MULT=function(te,ee,re){return mult(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function mult(te,ee){if(te instanceof Vector)return te.cloneCombine(ee,mult,!1);if(ee instanceof Vector)return ee.cloneCombine(te,mult,!0);if(te instanceof Material&&ee instanceof Material){let re=fn["*"](te.value,ee.value);return te.units&&ee.units?(te.units.addBase(),ee.units.addBase(),new Material(fn["*"](fn["*"](te.units.toBase,re),ee.units.toBase),te.units.multiply(ee.units,1))):te.units?new Material(re,te.units):ee.units?new Material(re,ee.units):new Material(re)}throw typeof te=="boolean"||typeof ee=="boolean"?new ModelError("Cannot convert Booleans to Numbers.",{code:7019}):te instanceof SAgent||ee instanceof SAgent?new ModelError("Cannot convert Agents to Numbers.",{code:7020}):typeof te=="string"||te instanceof String||typeof ee=="string"||ee instanceof String?new ModelError("Cannot convert Strings to Numbers.",{code:7021}):new ModelError("Invalid type - mult",{code:7022})}funcEvalMap.DIV=function(te,ee,re){return div(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function div(te,ee){if(te instanceof Vector)return te.cloneCombine(ee,div,!1);if(ee instanceof Vector)return ee.cloneCombine(te,div,!0);if(te instanceof Material&&ee instanceof Material){let re=fn["/"](te.value,ee.value);return te.units&&ee.units?(te.units.addBase(),ee.units.addBase(),new Material(fn["/"](fn["*"](te.units.toBase,re),ee.units.toBase),te.units.multiply(ee.units,-1))):te.units?new Material(re,te.units):ee.units?new Material(re,ee.units.power(-1)):new Material(re)}throw typeof te=="boolean"||typeof ee=="boolean"?new ModelError("Cannot convert Booleans to Numbers.",{code:7023}):te instanceof SAgent||ee instanceof SAgent?new ModelError("Cannot convert Agents to Numbers.",{code:7024}):typeof te=="string"||te instanceof String||typeof ee=="string"||ee instanceof String?new ModelError("Cannot convert Strings to Numbers.",{code:7025}):new ModelError("Invalid type - div",{code:7026})}funcEvalMap.POWER=function(te,ee,re){if(te.children.length===1)return evaluateNode(te.children[0],ee,re);let ne=toNum(evaluateNode(te.children[te.children.length-1],ee,re));for(let ie=te.children.length-1;ie>0;ie--){let oe=toNum(evaluateNode(te.children[ie-1],ee,re));if(ne instanceof Vector||!ne.units)ne=power(oe,ne);else throw new ModelError("Exponents may not have units.",{code:7027})}return ne};function power(te,ee){if(te instanceof Vector)return te.cloneCombine(ee,power,!1);if(ee instanceof Vector)return ee.cloneCombine(te,power,!0);if(te instanceof Material&&ee instanceof Material){let re=te.value,ne=ee.value;if(re<0&&ne!==Math.round(ne))throw new ModelError(`Cannot take a negative number (${re}) to a fractional power (${ne}).`,{code:7028});return new Material(fn.expt(re,ne),te.units?te.units.power(ne):void 0)}throw typeof te=="boolean"||typeof ee=="boolean"?new ModelError("Cannot convert Booleans to Numbers.",{code:7029}):te instanceof SAgent||ee instanceof SAgent?new ModelError("Cannot convert Agents to Numbers.",{code:7030}):typeof te=="string"||te instanceof String||typeof ee=="string"||ee instanceof String?new ModelError("Cannot convert Strings to Numbers.",{code:7031}):new ModelError("Invalid type - power",{code:7032})}funcEvalMap.MOD=function(te,ee,re){return doMod(toNum(evaluateNode(te.children[0],ee,re)),toNum(evaluateNode(te.children[1],ee,re)))};function doMod(te,ee){if(te instanceof Vector)return te.cloneCombine(ee,doMod,!1);if(ee instanceof Vector)return ee.cloneCombine(te,doMod,!0);if(te instanceof Material&&ee instanceof Material){if(ee.units)throw new ModelError('The right hand side of "mod" may not have units.',{code:7033});return new Material(fn.mod(te.value,ee.value),te.units)}throw typeof te=="boolean"||typeof ee=="boolean"?new ModelError("Cannot convert Booleans to Numbers.",{code:7034}):te instanceof SAgent||ee instanceof SAgent?new ModelError("Cannot convert Agents to Numbers.",{code:7035}):typeof te=="string"||te instanceof String||typeof ee=="string"||ee instanceof String?new ModelError("Cannot convert Strings to Numbers.",{code:7036}):new ModelError("Invalid type - mod",{code:7037})}funcEvalMap.IDENT=function(te,ee,re){let ne=te.text;for(;!(ne in ee);)if(ee["-parent"])ee=ee["-parent"];else throw new ModelError(`The variable or function "${te.origText}" does not exist.`,{code:7038});let ie=ee[ne];return ie instanceof TreeNode&&ie.typeName==="ARRAY"&&(ie=evaluateNode(ie,ee,re)),ie.fullClone&&!(ie instanceof Vector)?ie.fullClone():ie};funcEvalMap.NEW=function(te,ee,re){let ne=evaluateNode(te.children[0],ee,re);if(ne instanceof Vector){let ie=new Vector([],re,void 0,ne),oe,fe;try{fe=selectFromVector(ne,re,"constructor"),oe=fe.data}catch{}if(oe)te.children.length===2?callFunction(oe,te.children[1],re,ee,ie,fe.parent):callFunction(oe,{children:[]},re,ee,ie,fe.parent);else if(te.children.length===2&&te.children[1].children.length>0)throw new ModelError(`No constructor available for '${te.children[0].text}'.`,{code:7039});return ie}else throw new ModelError("'New' can only be use to create instances of Vectors.",{code:7040})};funcEvalMap.INNER=function(te,ee,re){let ne=evaluateNode(te.children[0],ee,re);if(te.children.length===2&&te.children[1].typeName==="FUNCALL")return callFunction(ne,te.children[1],re,ee);let ie,oe;ee.self&&te.children[0].text==="parent"?ie=ee.self:ne instanceof Function||ne instanceof UserFunction||(ie=ne);for(let fe=1;fe<te.children.length;fe++)if(te.children[fe].typeName==="SELECTOR")if(te.children[fe].children[0].typeName==="DOTSELECTOR")for(let ue=0;ue<te.children[fe].children[0].children.length;ue++){let ae=[];te.children[fe].children[0].children[ue].text?ae.push(te.children[fe].children[0].children[ue].text):ae.push(te.children[fe].children[0].children[ue].valueOf());try{ne=selectFromMatrix(ne,re,ae)}catch(se){if(ne instanceof SPrimitive&&!(ne instanceof SAgent))ne=toNum(ne),ue--;else throw se}ne instanceof Function||ne instanceof UserFunction||(ie=ne,oe=ne)}else{ne instanceof SPrimitive&&(ne=toNum(ne),ne instanceof Function||ne instanceof UserFunction||(ie=ne,oe=ne));try{ne=selectFromMatrix(ne,re,createMatrixSelector(te.children[fe],ee,0,re))}catch(ue){if(ne instanceof SPrimitive)ne=toNum(ne),fe--;else throw ue}ne instanceof Function||ne instanceof UserFunction||(ie=ne,oe=ne)}else ne=callFunction(ne,te.children[fe],re,ee,ie,oe),ne instanceof Function||ne instanceof UserFunction||(ie=ne,oe=ne);return ne};let fingerprintCounter=0;function callFunction(te,ee,re,ne,ie,oe){if(typeof te!="function"&&!(te instanceof UserFunction))throw new ModelError("Trying to call a non-function.",{code:7041});let fe=[],ue="";if(ee instanceof Array)fe=ee;else if(ee.functionFingerprint||(ee.functionFingerprint="FINGERPRINT-"+fingerprintCounter++),ue=ee.functionFingerprint,te.delayEvalParams)for(let le=0;le<ee.children.length;le++)fe.push({node:ee.children[le],scope:ne});else for(let le=0;le<ee.children.length;le++){let pe=evaluateNode(ee.children[le],ne,re);pe.fullClone&&!(pe instanceof Vector)&&(pe=pe.fullClone()),fe.push(pe)}let ae;te.fn?ae=te.fn:(ee.delayEvalParams=te.delayEvalParams,ae=te);let se=re.evaluatingLine,ce=ae(fe,ue,ie,oe);return re.evaluatingLine=se,ce}function createMatrixSelector(te,ee,re,ne){let ie=[];re=re||0;for(let oe=re;oe<te.children.length;oe++)if(te.children[oe].typeName==="MULT")ie.push("*");else{let ue=evaluateNode(te.children[oe],ee,ne);if(typeof ue=="function"||ue instanceof UserFunction){let ae;typeof ue=="function"?ae=ue:ae=ue.fn,function(se){ie.push(ce=>{if(!ce[0].stackApply)throw new ModelError("Can't apply function across elements of non-vector.",{code:7042});return ce[0].stackApply(le=>se([le]))})}(ae)}else ie.push(toNum(ue))}return ie}funcEvalMap.ARRAY=function(te,ee,re){if(te.children.length===1&&te.children[0]instanceof Vector)return te.children[0].fullClone();let ne=[],ie=[],oe=!1;for(let fe=0;fe<te.children.length;fe++)ne.push(evaluateNode(te.children[fe].children[0],ee,re)),te.children[fe].children.length>1?(te.children[fe].children[1].text?ie.push(te.children[fe].children[1].origText):ie.push(te.children[fe].children[1].valueOf()),oe=!0):ie.push(void 0);return new Vector(ne,re,oe?ie:void 0)};funcEvalMap.RANGE=function(te,ee,re){if(te.children.length===1)return evaluateNode(te.children[0],ee,re);let ne=[],ie=toNum(evaluateNode(te.children[0],ee,re)),oe=toNum(evaluateNode(te.children[te.children.length-1],ee,re));if(!(ie instanceof Material)||!(oe instanceof Material))throw new ModelError("Range elements must be numbers.",{code:7043});if(ne.push(ie.fullClone()),ie.units!==oe.units&&convertUnits(ie.units,oe.units)!==1)throw new ModelError("Units on both sides of ':' must be equal.",{code:7044});let fe=te.children.length===2?new Material(1,ie.units):toNum(evaluateNode(te.children[1],ee,re));if(!(fe instanceof Material))throw new ModelError("Range elements must be numbers.",{code:7045});if(!eq(ie,oe)){if(lessThan(ie,oe)){let ue=plus(ie,fe);for(;lessThanEq(ue,oe);)ne.push(ue),ue=plus(ue,fe)}else if(greaterThan(ie,oe)){te.children.length===2&&(fe=negate(fe));let ue=plus(ie,fe);for(;greaterThanEq(ue,oe);)ne.push(ue),ue=plus(ue,fe)}}return new Vector(ne,re)};function makeFunctionCall(te,ee,re,ne,ie,oe){let fe=new UserFunction;fe.localScope={},fe.localScope.nVars=ee.length;for(let ue=0;ue<ee.length;ue++)fe.localScope[ue+""]=ee[ue];return fe.localScope["-parent"]=ie,fe.defaults=re,fe.fn=function(ue,ae,se,ce){let le=ue.length;for(let de=0;de<ue.length;de++)ue[de].optional&&le--;if(fe.localScope.nVars-fe.defaults.length>ue.length||le>fe.localScope.nVars){let de=[];for(let me=0;me<fe.localScope.nVars;me++)fe.defaults.length-(fe.localScope.nVars-me)>-1?de.push(fe.localScope[me+""]+"="+fe.defaults[fe.defaults.length-(fe.localScope.nVars-me)]):de.push(fe.localScope[me+""]);throw new ModelError("Wrong number of parameters for "+te+"("+de.join(", ")+").",{code:7049})}let pe={"-parent":ie};for(let de=0;de<ue.length;de++)pe[fe.localScope[de+""]]=ue[de];for(let de=ue.length;de<fe.localScope.nVars;de++)pe[fe.localScope[de+""]]=fe.defaults[fe.defaults.length-(fe.localScope.nVars-de)];se&&(pe.self||(pe.self=se)),ce&&ce.parent&&(pe.parent=ce.parent);try{return evaluateNode(ne,pe,oe)}catch(de){if(de.returnVal)return de.data;throw de}},fe}funcEvalMap.THROW=function(te,ee,re){throw new ModelError(evaluateNode(te.children[0],ee,re),{code:1e4})};funcEvalMap.TRYCATCH=function(te,ee,re){try{return evaluateNode(te.children[0],ee,re)}catch(ne){let ie={"-parent":ee};return ne instanceof ModelError?ie[te.children[2].text]=stringify$1(ne.message,re):ie[te.children[2].text]=stringify$1("An error has occurred.",re),evaluateNode(te.children[1],ie,re)}};funcEvalMap.WHILE=function(te,ee,re){let ne=new Material(0),ie={"-parent":ee};for(;trueValue(toNum(evaluateNode(te.children[0],ee,re)));)ne=evaluateNode(te.children[1],ie,re);return ne};funcEvalMap.IFTHENELSE=function(te,ee,re){let ne={"-parent":ee},ie;for(ie=0;ie<te.children[0].children.length;ie++)if(trueValue(toNum(evaluateNode(te.children[0].children[ie],ee,re))))return evaluateNode(te.children[1].children[ie],ne,re);return te.children[0].children.length!==te.children[1].children.length?evaluateNode(te.children[1].children[ie],ne,re):new Material(0)};funcEvalMap.FORIN=function(te,ee,re){let ne=new Material(0),ie=te.children[0].text,oe={"-parent":ee},fe=evaluateNode(te.children[1],ee,re);if(!(fe instanceof Vector))throw new ModelError("The in argument of a For-In loop must be a vector.",{code:7050});for(let ue=0;ue<fe.items.length;ue++)oe[ie]=fe.items[ue],ne=evaluateNode(te.children[2],oe,re);return ne};funcEvalMap.FOR=function(te,ee,re){let ne=new Material(0),ie=te.children[0].text,oe=toNum(evaluateNode(te.children[1].children[0],ee,re)),fe=new Material(1);te.children[1].children.length===3&&(fe=toNum(evaluateNode(te.children[1].children[2],ee,re)));let ue={"-parent":ee};for(ue[ie]=oe;fn[fe.value>=0?"<=":">="](ue[ie].value,toNum(evaluateNode(te.children[1].children[1],ee,re)));)ne=evaluateNode(te.children[2],ue,re),ue[ie]=plus(ue[ie],fe);return ne};funcEvalMap.FUNCTION=function(te,ee,re){let ne=te.children[0].children[0].text;return functionGenerator(ne,te.children[0],te.children[1],te.children[2],ee,re),`"${ne}" defined`};funcEvalMap.ANONFUNCTION=function(te,ee,re){return functionGenerator(null,te.children[0],te.children[1],te.children[2],ee,re)};funcEvalMap.ASSIGN=function(te,ee,re){let ne=te.children.length-1,ie=evaluateNode(te.children[te.children.length-1],ee,re);if(ne>1&&(!(ie instanceof Vector)||ie.items.length<ne))throw new ModelError("Too few elements returned for assignment.",{code:7051});for(let oe=0;oe<ne;oe++)if(te.children[oe]instanceof PrimitiveStore)ne===1?te.children[oe].primitive.setValue(ie):te.children[oe].primitive.setValue(ie.items[oe]);else{let fe=te.children[oe].children[0].text,ue;te.children[oe].children.length>1&&(ue=createSelector(te.children[oe].children[1],ee,re));let ae=ee;for(;ee["-parent"]!==null&&ee[fe]===void 0;)ee=ee["-parent"];ee["-parent"]===null&&ee[fe]===void 0&&(ee=ae);let se;if(ne===1?se=ie:se=ie.items[oe],te.children[oe].children.length===1)ee[fe]=se;else if(ee[fe]!==void 0)selectFromMatrix(ee[fe],re,ue,se);else throw new ModelError(`The variable '${te.children[oe].children[0].origText}' does not exist.`,{code:7052})}return ne>1?new Vector(ie.items.slice(0,ne),re):ie};function createSelector(te,ee,re){if(te.children[0].typeName==="DOTSELECTOR"){let ne=[];for(let ie=0;ie<te.children[0].children.length;ie++)te.children[0].children[ie].text?ne.push(te.children[0].children[ie].text):ne.push(te.children[0].children[ie].valueOf());return ne}else return createMatrixSelector(te,ee,0,re)}funcEvalMap.MATERIAL=function(te,ee,re){let ne=toNum(evaluateNode(te.children[0],ee,re));if(ne.units)throw new ModelError("Cannot create material where numeric part itself has units.",{code:7053});return new Material(ne.value,te.children[1])};function functionGenerator(te,ee,re,ne,ie,oe){let fe=[],ue=[];for(let ae=te===null?0:1;ae<ee.children.length;ae++)fe.push(ee.children[ae].text);for(let ae=0;ae<re.children.length;ae++)ue.push(re.children[ae]);if(te===null)return makeFunctionCall("Function",fe,ue,ne,ie,oe);ie[te]=makeFunctionCall(te,fe,ue,ne,ie,oe)}let unitEvalMap=Object.create(null);unitEvalMap.MULT=function(te){return evaluateUnits(te.children[0]).concat(evaluateUnits(te.children[1]))};unitEvalMap.POW=function(te){let ee=1,re=1,ne=0;te.children.length===3+ne&&(ee=ee*-1,re++);let ie=evaluateUnits(te.children[ne]),oe=evaluateUnits(te.children[re])*ee;if(ie instanceof Array){for(let fe=0;fe<ie.length;fe++)ie[fe].exponent=ie[fe].exponent*oe;return ie}else return Math.pow(ie,oe)};unitEvalMap.DIV=function(te){let ee=evaluateUnits(te.children[0]),re=evaluateUnits(te.children[1]);for(let ne=0;ne<re.length;ne++)re[ne].exponent=re[ne].exponent*-1;return ee.concat(re)};unitEvalMap.PER=unitEvalMap.DIV;unitEvalMap.UNIT=function(te){let ee="";for(let re=0;re<te.children.length;re++)ee=ee+te.children[re].text,re<te.children.length-1&&(ee=ee+" ");return[{id:ee,exponent:1}]};unitEvalMap.UNITCLUMP=function(te){let ee=evaluateUnits(te.children[0]);if(te.children.length>1){for(let re=1;re<te.children.length;re++)if(te.children[re].typeName==="NEGATE")for(let ne=0;ne<ee.length;ne++)ee[ne].exponent=ee[ne].exponent*-1;else if(te.children[re].typeName==="SQUARED")for(let ne=0;ne<ee.length;ne++)ee[ne].exponent=ee[ne].exponent*2;else if(te.children[re].typeName==="CUBED")for(let ne=0;ne<ee.length;ne++)ee[ne].exponent=ee[ne].exponent*3}return ee};unitEvalMap.INTEGER=function(te){return parseInt(te.text,10)};unitEvalMap.FLOAT=function(te){return parseFloat(te.text)};function evaluateUnits(te){return te instanceof Material?te.value:unitEvalMap[te.typeName](te)}function evaluateNode(te,ee,re){if(te instanceof TreeNode)return re.evaluatingLine=te.line||re.evaluatingLine,funcEvalMap[te.typeName](te,ee,re);if(te instanceof PrimitiveStore){if(te.type==="totalValue"){if(!te.primitive.totalContents)throw new ModelError("You can only use the double-bracket notation for total conveyor contents on Stock primitives.",{code:7054});return te.primitive.totalContents()}else if(te.type==="object")return te.primitive}else return te}let trimEvalMap=Object.create(null);trimEvalMap.POWER=function(te,ee,re){if(te.children.length===1)return trimNode(te.children[0],ee,re);{let ne=new TreeNode(te.origText,te.typeName,te.line);for(let ie=0;ie<te.children.length;ie++)ne.children.push(trimNode(te.children[ie],ee,re));return ne}};trimEvalMap.INNER=function(te,ee,re){if(te.children.length===1)return trimNode(te.children[0],ee,re);{let ne=new TreeNode(te.origText,te.typeName,te.line);for(let ie=0;ie<te.children.length;ie++)ne.children.push(trimNode(te.children[ie],ee,re));return ne}};trimEvalMap.RANGE=trimEvalMap.POWER;trimEvalMap.TRUE=function(){return!0};trimEvalMap.FALSE=function(){return!1};trimEvalMap.STRING=function(te,ee,re){let ne=te.origText.substr(1,te.origText.length-2),ie;return te.origText[0]==='"'?ie=ne.replace(/\\\\/g,"\\\\TEMPTXT\\\\").replace(/\\"/g,'"').replace(/\\'/g,"'").replace(/\\t/g,"	").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\\\TEMPTXT\\\\/g,"\\"):ie=ne.replace(/\n/,"\\n"),ie=new String(ie),ie.vector=new Vector([],re,[],re.varBank.stringbase),ie};trimEvalMap.INTEGER=function(te){return new Material(+te.text)};trimEvalMap.MATERIAL=function(te,ee,re){let ne=trimNode(te.children[1],ee,re),ie=evaluateUnits(te.children[0]),oe=[],fe=[];for(let ue=0;ue<ie.length;ue++){let ae=fe.indexOf(ie[ue].id);ae===-1?(oe.push(ie[ue].exponent),fe.push(ie[ue].id)):oe[ae]=oe[ae]+ie[ue].exponent}if(ne instanceof Material){if(ne.units)throw new ModelError("Cannot create material where numeric part itself has units.",{code:7055});return new Material(ne.value,re.unitManager.getUnitStore(fe,oe,!0))}else{let ue=new TreeNode(te.origText,"MATERIAL",te.line);return ue.children=[ne,re.unitManager.getUnitStore(fe,oe,!0)],ue}};trimEvalMap.MULT=function(te,ee,re){if(!te.children.length)return"*";let ne=trimNode(te.children[0],ee,re),ie=trimNode(te.children[1],ee,re);if(isConst(ne)&&isConst(ie))return mult(ne,ie);{let oe=new TreeNode(te.origText,te.typeName,te.line);return oe.children=[ne,ie],oe}};trimEvalMap.DIV=function(te,ee,re){let ne=trimNode(te.children[0],ee,re),ie=trimNode(te.children[1],ee,re);if(isConst(ne)&&isConst(ie))return div(ne,ie);{let oe=new TreeNode(te.origText,te.typeName,te.line);return oe.children=[ne,ie],oe}};trimEvalMap.PLUS=function(te,ee,re){let ne=trimNode(te.children[0],ee,re),ie=trimNode(te.children[1],ee,re);if(isConst(ne)&&isConst(ie))return plus(ne,ie);{let oe=new TreeNode(te.origText,te.typeName,te.line);return oe.children=[ne,ie],oe}};trimEvalMap.MINUS=function(te,ee,re){let ne=trimNode(te.children[0],ee,re),ie=trimNode(te.children[1],ee,re);if(isConst(ne)&&isConst(ie))return minus(ne,ie);{let oe=new TreeNode(te.origText,te.typeName,te.line);return oe.children=[ne,ie],oe}};trimEvalMap.FLOAT=trimEvalMap.INTEGER;trimEvalMap.PRIMITIVE=function(te,ee){let re;if(te.text.substr(0,2)==="[["?re=new PrimitiveStore(ee[te.text.substr(2,te.text.length-4)],"totalValue"):re=new PrimitiveStore(ee[te.text.substr(1,te.text.length-2)],"object"),re.primitive===void 0)throw new ModelError(`The primitive <i>${toHTML(te.origText)}</i> could not be found.`,{code:7056});return re};trimEvalMap.NEGATE=function(te,ee,re){if(!te.children.length)return new TreeNode(te.origText,te.typeName,te.line);let ne=trimNode(te.children[0],ee,re);if(isConst(ne))return negate(ne);{let ie=new TreeNode(te.origText,te.typeName,te.line);return ie.children=[ne],ie}};trimEvalMap.ARRAY=function(te,ee,re){let ne=new TreeNode(te.origText,te.typeName,te.line),ie=[],oe=[],fe=!1;for(let ae=0;ae<te.children.length;ae++)ne.children.push(trimNode(te.children[ae],ee,re)),ie.push(ne.children[ae].children[0]),ne.children[ae].children.length>1?(ne.children[ae].children[1].text?oe.push(ne.children[ae].children[1].origText):oe.push(ne.children[ae].children[1].valueOf()),fe=!0):oe.push(void 0);let ue=!0;for(let ae=0;ae<ie.length;ae++)if(!isConst(ie[ae])){ue=!1;break}return ue&&(ne.children=[new Vector(ie,re,fe?oe:void 0)]),ne};function isConst(te){return te instanceof Material||typeof te=="string"||te instanceof String||typeof te=="boolean"||te instanceof Vector}function trimNode(te,ee,re){if(te.typeName in trimEvalMap)return re.evaluatingLine=te.line||re.evaluatingLine,trimEvalMap[te.typeName](te,ee,re);{let ne=new TreeNode(te.origText,te.typeName,te.line);for(let ie=0;ie<te.children.length;ie++)ne.children.push(trimNode(te.children[ie],ee,re));return ne}}function trueValue(te){if(typeof te=="boolean")return te;if(te instanceof Material)return neq(te.value,0);throw te instanceof Vector?new ModelError("Cannot convert a Vector to a boolean.",{code:7057}):typeof te=="string"||te instanceof String?new ModelError("Cannot convert a String to a boolean.",{code:7058}):new ModelError("Only numbers can be used in place of booleans.",{code:7059})}class Simulator{constructor(){this.resultsWindow=void 0,this.setResultsCallback=void 0,this.setStatusCallback=void 0,this.finished=void 0,this.status=void 0,this.valueChange=void 0,this.transitionPrimitives=void 0,this.timer=void 0,this.displayInformation=void 0,this.randLoc=-1,this.model=null,this.lastRandPos=-1,this.previousRandLists=[],this.valuedPrimitives=[],this.unitsToBases={},this.distanceCache={},this.distanceCacheCount=0,this.sliders={},this.ids={},this.idCount=0,this.stochastic=!1,this.allPlaceholders={},this.RKOrder=void 0,this.config=null,this.results=void 0,this.evaluatingLine=null,this.varBank=Object.create(null),this.unitManager=new UnitManager,this.random=null,this.clusters=null,this.timeUnitsString=null}setup(ee){this.simulationModel=ee,this.solversCompletedFirstPass=0,this.timeStart=this.simulationModel.timeStart,this.timeLength=this.simulationModel.timeLength,this.timePause=this.simulationModel.timePause,this.timeEnd=new Material(Big(this.timeStart.value).plus(this.timeLength.value).toNumber(),this.timeLength.units),this.timeStep=this.simulationModel.solvers.base.timeStep,this.userTimeStep=this.simulationModel.solvers.base.userTimeStep,this.timeStepCount=Math.floor(this.timeLength.value/this.userTimeStep.value),this.timeUnits=this.timeStart.units,this.timeUnits.addBase(),this.oldAggregateSeries=[],this.distanceCache={},this.tasks=new TaskQueue({start:this.timeStart,end:this.timeEnd})}getID(ee){return this.ids[ee]||(this.idCount++,this.ids[ee]=this.idCount),this.ids[ee]}time(){return this.tasks.time.fullClone()}timeProgressed(){return minus(this.time(),this.timeStart)}frame(ee,re){let ne=ee.length;for(let ie=0;ie<ne;ie++)ee[ie].storeValue();this.printStates(re)}step(ee){if(ee.completedFirstPass||(ee.completedFirstPass=!0,this.solversCompletedFirstPass++,this.solversCompletedFirstPass===Object.keys(this.simulationModel.solvers).length&&this.config.onCompletedFirstPass&&this.config.onCompletedFirstPass()),ee.displayed.length>0)for(let re=this.results.children[ee.displayed[0].id].results.length;re<this.results.times.length;re++)for(let ne of ee.displayed)this.results.children[ne.id].results.push(this.results.data[re][ne.id]);this.config.onStep&&this.config.onStep(ee)}sleep(ee){this.config&&(this.config.silent?this.config.onPause&&(this.shouldSleep=!0):(this.shouldSleep=!0,this.shouldUpdateValues=ee))}resume(){try{this.run()}catch(ee){return checkErr(ee,this.config,this)}}completed(){return this.terminated||this.tasks.completed()}terminate(){this.setStatus("TERMINATED"),this.terminated||(clearTimeout(this.timer),this.sleep(),this.terminated=!0)}setStatus(ee){this.status=ee,this.setStatusCallback&&this.setStatusCallback(ee)}run(ee){this.setStatus("RUNNING");let re=this,ne=(ie,oe)=>{this.tasks.add(new Task({time:ie,expires:1,name:"Interval Pause",priority:1,action:fe=>{this.sleep(!0),oe&&lessThan(plus(ie,this.timePause),this.timeEnd)&&ne(plus(ie,this.timePause),oe)}})),this.tasks.add(new Task({time:ie,expires:1,name:"Interval Pause",priority:1,action:fe=>{if(this.valueChange){re.valuedPrimitives=[];for(let ue in this.simulationModel.solvers){let ae=this.simulationModel.solvers[ue];for(let se=0;se<ae.valued.length;se++)ae.valued[se].clearCached();for(let se=0;se<ae.flows.length;se++)ae.flows[se].predict(!0)}this.valueChange=!1}}}))};if(ee){for(let ie in this.simulationModel.solvers)this.createSolver(this.simulationModel.solvers[ie]);this.timePause&&ne(plus(this.timeStart,this.timePause),!0),this.tasks.cursor=this.tasks.tasks.minNode()}this.wakeUpTime=Date.now();try{for(;!this.completed();)if(this.tasks.step(),this.shouldSleep){for(let ie in this.simulationModel.solvers)updateDisplayed(this.simulationModel.solvers[ie],this);this.setResultsCallback&&this.setResultsCallback(formatSimResults(this.results)),this.shouldUpdateValues&&(this.setStatus("PAUSED"),this.shouldUpdateValues=!1),this.config.onPause&&setTimeout(()=>{let ie=formatSimResults(this.results),oe=ie.data.length,fe=ie.data[oe-1];for(let ue in fe)if(ue!=="time"){if(!ie.children[ue])return;ie.children[ue].results.length<oe&&ie.children[ue].results.push(fe[ue])}ie.resume=this.resume.bind(this),ie.setValue=(ue,ae)=>{let se=simpleEquation(""+ae,this,{"-parent":this.varBank});this.valuedPrimitives.forEach(ce=>{ce.id===ue.id&&(se.fullClone?(ce.dna.equation=se.fullClone(),ce.equation=se.fullClone()):(ce.dna.equation=se,ce.equation=se))}),this.valueChange=!0},this.config.onPause(ie)},10),this.shouldSleep=!1;return}}catch(ie){if(ie.simulationCommand!=="STOP")throw ie}if(this.results=formatSimResults(this.results),this.results.stochastic=this.stochastic,this.config.onSuccess&&this.config.onSuccess(this.results),this.terminate(),this.resultsWindow){this.results.window=this.resultsWindow;for(let ie in this.simulationModel.solvers)updateDisplayed(this.simulationModel.solvers[ie],this)}return this.results}progress(){return div(minus(this.time(),this.timeStart),this.timeLength).value}printStates(ee){let re=parseFloat(this.time().value.toPrecision(20));if(!this.results.times.includes(re)){let ie;for(ie=this.results.times.length;ie>0;ie--)if(this.results.times[ie-1]<re){this.results.times.splice(ie,0,re),this.results.data.splice(ie,0,{});break}ie===0&&(this.results.times.splice(0,0,re),this.results.data.splice(0,0,{}))}let ne=this.results.data[this.results.times.indexOf(re)];for(let ie=0;ie<ee.length;ie++){let oe=ee[ie];if(!(oe instanceof SState&&ne[oe.id]!==void 0))if(oe instanceof SPopulation)this.results.children[oe.id].dataMode="agents",ne[oe.id]={current:oe.collectData()};else{let fe=oe.value();fe instanceof Vector&&!fe.names?(fe.recurseApply(ue=>this.adjustNum(oe,ue)),ne[oe.id]=cleanData(fe),this.results.children[oe.id].dataMode="auto"):fe instanceof Vector?(fe.recurseApply(ue=>this.adjustNum(oe,ue)),ne[oe.id]=cleanData(fe)):fe instanceof SAgent?(ne[oe.id]=fe,this.results.children[oe.id].dataMode="auto"):ne[oe.id]=cleanData(this.adjustNum(oe,fe))}}}unitsToBase(ee,re,ne){let ie=ee.id+"-"+(re?re.id:"");if(ie in this.unitsToBases)return this.unitsToBases[ie];let oe=1;ne&&(oe=this.timeUnits.toBase);let fe=1;return re&&(re.addBase(),fe=re.toBase),this.unitsToBases[ie]=fn["/"](fn["/"](fe,ee.dna.toBase),oe),this.unitsToBases[ie]}adjustNum(ee,re){if(ee.dna.unitless&&re.units)throw new ModelError(`The result of the calculation has units <i>${re.units.toString()}</i>, but the primitive is unitless. Please set the units for the primitive so we can determine the proper output.`,{primitive:ee,showEditor:!0,code:8e3});return ee instanceof SFlow&&!ee.dna.flowUnitless&&(re=mult(re,new Material(1,this.timeUnits))),ee instanceof SState||!re.units&&!(ee instanceof SFlow)?typeof re=="object"&&"value"in re?+re.value:re:+fn["*"](re.value,this.unitsToBase(ee,re.units,ee instanceof SFlow))}createSolver(ee){let re=this,ne=ee.stocks,ie=ee.flows,oe=ee.actions,fe=ee.transitions,ue=ee.valued,ae=ee.displayed,se=ee.id,ce=ee.timeStep,le=ee.RKOrder;ee.RKPosition=1;let pe=0,de=[],me=Math.ceil(new Big(this.timeEnd.value).minus(this.timeStart.value).div(ce.value).toNumber());for(let Le=0;Le<=me+2;Le++)de.push(new Material(new Big(this.timeStart.value).plus(new Big(Le).times(ce.value)).toNumber(),ce.units));let ve=(Le,Oe,xe)=>{this.tasks.add(new Task({time:Le,expires:1,priority:0,name:"RK1 Solver - "+ee.id,action:Se=>{if(re.valuedPrimitives=[],xe){let De=ie.length;for(let Me=0;Me<De;Me++)ie[Me].clean();De=ue.length;for(let Me=0;Me<De;Me++)ue[Me].clearCached()}this.frame(ue,ae);let be=oe.length;for(let De=0;De<be;De++)(!oe[De].initialized||oe[De].dna.recalculate&&!oe[De].block)&&updateTrigger.call(oe[De]);be=fe.length;for(let De=0;De<be;De++)(!fe[De].initialized||fe[De].dna.recalculate)&&updateTrigger.call(fe[De]);this.step(ee),Oe&&pe<=me&&(pe++,ve(de[pe],!0,!0))}}))},we=(Le,Oe)=>{this.tasks.add(new Task({time:Le,name:"RK4 Solver (Init)  - "+ee.id,priority:-10,expires:1,blocker:se+" init",action:xe=>{let Se=ie.length;for(let be=0;be<Se;be++)ie[be].clean();re.valuedPrimitives=[],Se=ue.length;for(let be=0;be<Se;be++)ue[be].clearCached();ee.RKPosition=1,xe.unblock(se+" start"),xe.block()}})),this.tasks.add(new Task({time:Le,name:"RK4 Solver (step 1) - "+ee.id,priority:-5,expires:4,blocker:se+" start",action:xe=>{if(ee.RKPosition>1){re.valuedPrimitives=[];let Se=ue.length;for(let be=0;be<Se;be++)ue[be].clearCached(),ue[be].pastValues.pop();if(ee.RKPosition===4){Se=ie.length;for(let be=0;be<Se;be++){let De=ie[be].checkRate(ie[be].RKPrimary[0].fullClone());ie[be].doRK4Aggregation(),ie[be].rate=De}}}if(this.frame(ue,ae),ee.RKPosition===4){let Se=oe.length;for(let be=0;be<Se;be++)(!oe[be].initialized||oe[be].dna.recalculate&&!oe[be].block)&&updateTrigger.call(oe[be]);Se=fe.length;for(let be=0;be<Se;be++)(!fe[be].initialized||fe[be].dna.recalculate)&&updateTrigger.call(fe[be]);xe.unblock(se+" init"),Oe&&pe<=me&&(pe+=2,we(de[pe],!0)),this.step(ee)}else if(eq(re.time(),re.timeEnd))this.step(ee);else{let Se=ne.length;for(let be=0;be<Se;be++)ne[be].preserveLevel()}xe.block(),xe.unblock(se+" mid")},rollback:function(){let xe=ne.length;for(let Se=0;Se<xe;Se++)ne[Se].restoreLevel()}})),this.tasks.add(new Task({time:de[pe+1],name:"RK4 Solver (step 2,3) - "+ee.id,priority:-10,expires:2,blocker:se+" mid",action:xe=>{re.valuedPrimitives=[];let Se=ue.length;for(let be=0;be<Se;be++)ue[be]instanceof SState||ue[be].clearCached();ee.RKPosition++,Se=ie.length;for(let be=0;be<Se;be++)ie[be].rate=null;for(let be=0;be<Se;be++)ie[be].value();xe.unblock(se+" start"),xe.block()},timeShift:()=>{this.tasks.moveTo(de[pe])}})),this.tasks.add(new Task({time:de[pe+2],name:"RK4 Solver (step 4) - "+ee.id,priority:-30,expires:1,action:xe=>{re.valuedPrimitives=[];let Se=ue.length;for(let be=0;be<Se;be++)ue[be]instanceof SState||ue[be].clearCached();ee.RKPosition++,Se=ie.length;for(let be=0;be<Se;be++)ie[be].rate=null;for(let be=0;be<Se;be++)ie[be].value();xe.unblock(se+" start")},timeShift:()=>{this.tasks.moveTo(de[pe])}}))};function ge(Le,Oe){if(Le instanceof Vector){let xe=!1;return Le.recurseApply(Se=>{xe=xe||Oe(Se)}),xe}else return Oe(Le)}function _e(Le){return Le&&ge(toNum(Le),Oe=>Oe instanceof Material&&Oe.value<0)}function Te(Le){return Le&&ge(toNum(Le),Oe=>Oe instanceof Material&&Oe.value>0)}function Ne(Le,Oe){let xe=[];for(let Se of ie)Se.alpha&&Se.alpha.dna.nonNegative&&Te(Se.rate)||Se.omega&&Se.omega.dna.nonNegative&&_e(Se.rate)?xe.push(Se):Se.apply(Le,Oe);xe.sort((Se,be)=>{let De=re.clusters[Se.id],Me=re.clusters[be.id];return De.cluster<Me.cluster?-1:De.cluster>Me.cluster?1:De.flow<Me.flow?-1:De.flow>Me.flow?1:0});for(let Se of xe)Se.apply(Le,Oe)}if(le===1)this.tasks.addEvent((Le,Oe)=>{Ne(Le,Oe)}),ve(this.timeStart,!0);else if(le===4)this.tasks.addEvent((Le,Oe)=>{Le.value>0&&Ne(Le,Oe)}),we(this.timeStart,!0);else throw new ModelError("Unknown solution algorithm.",{code:8001})}}class DNA{constructor(ee,re){this.primitive=ee,this.id=re||ee.id,this.name=ee.name,this.units=null,this.solver=void 0,this.frozen=void 0,this.slider=void 0,this.targetId=void 0,this.sourceId=void 0,this.value=void 0,this.trigger=void 0,this.repeat=void 0,this.delay=void 0,this.stockType=void 0,this.recalculate=void 0,this.nonNegative=void 0,this.residency=void 0,this.source=void 0,this.interpolation=void 0,this.triggerValue=void 0,this.inputs=void 0,this.outputs=void 0,this.flowUnitless=void 0,this.useMaxConstraint=void 0,this.useMinConstraint=void 0,this.minConstraint=void 0,this.maxConstraint=void 0,this.toBase=void 0,this.unitless=void 0,this.equation=void 0,this.agents=void 0,this.noOutput=!1,this.neighborProxyDNA=null,this.extraLinksPrimitives=[],this.adoptUnits=!1}}let Graph=function(){this.nodeSet={},this.nodes=[],this.edges=[],this.adjacency={},this.nextNodeId=0,this.nextEdgeId=0,this.eventListeners=[]};var Node=function(te,ee){this.id=te,this.data=typeof ee<"u"?ee:{}},Edge=function(te,ee,re,ne){this.id=te,this.source=ee,this.target=re,this.data=typeof ne<"u"?ne:{}};Graph.prototype.addNode=function(te){return typeof this.nodeSet[te.id]>"u"&&this.nodes.push(te),this.nodeSet[te.id]=te,this.notify(),te};Graph.prototype.addEdge=function(te){var ee=!1;return this.edges.forEach(function(re){te.id===re.id&&(ee=!0)}),ee||this.edges.push(te),typeof this.adjacency[te.source.id]>"u"&&(this.adjacency[te.source.id]={}),typeof this.adjacency[te.source.id][te.target.id]>"u"&&(this.adjacency[te.source.id][te.target.id]=[]),ee=!1,this.adjacency[te.source.id][te.target.id].forEach(function(re){te.id===re.id&&(ee=!0)}),ee||this.adjacency[te.source.id][te.target.id].push(te),this.notify(),te};Graph.prototype.newNode=function(te){var ee=new Node(this.nextNodeId++,te);return this.addNode(ee),ee};Graph.prototype.newEdge=function(te,ee,re){var ne=new Edge(this.nextEdgeId++,te,ee,re);return this.addEdge(ne),ne};Graph.prototype.getEdges=function(te,ee){return typeof this.adjacency[te.id]<"u"&&typeof this.adjacency[te.id][ee.id]<"u"?this.adjacency[te.id][ee.id]:[]};Graph.prototype.removeNode=function(te){typeof this.nodeSet[te.id]<"u"&&delete this.nodeSet[te.id];for(var ee=this.nodes.length-1;ee>=0;ee--)this.nodes[ee].id===te.id&&this.nodes.splice(ee,1);this.detachNode(te)};Graph.prototype.detachNode=function(te){var ee=this.edges.slice();ee.forEach(function(re){(re.source.id===te.id||re.target.id===te.id)&&this.removeEdge(re)},this),this.notify()};Graph.prototype.removeEdge=function(te){for(var ee=this.edges.length-1;ee>=0;ee--)this.edges[ee].id===te.id&&this.edges.splice(ee,1);for(var re in this.adjacency)for(var ne in this.adjacency[re])for(var ie=this.adjacency[re][ne],oe=ie.length-1;oe>=0;oe--)this.adjacency[re][ne][oe].id===te.id&&this.adjacency[re][ne].splice(oe,1);this.notify()};Graph.prototype.merge=function(te){var ee=[];te.nodes.forEach(function(re){ee.push(this.addNode(new Node(re.id,re.data)))},this),te.edges.forEach(function(re){var ne=ee[re.from],ie=ee[re.to],oe=re.directed?oe=re.type+"-"+ne.id+"-"+ie.id:ne.id<ie.id?re.type+"-"+ne.id+"-"+ie.id:re.type+"-"+ie.id+"-"+ne.id,fe=this.addEdge(new Edge(oe,ne,ie,re.data));fe.data.type=re.type},this)};Graph.prototype.filterNodes=function(te){var ee=this.nodes.slice();ee.forEach(function(re){te(re)||this.removeNode(re)},this)};Graph.prototype.filterEdges=function(te){var ee=this.edges.slice();ee.forEach(function(re){te(re)||this.removeEdge(re)},this)};Graph.prototype.addGraphListener=function(te){this.eventListeners.push(te)};Graph.prototype.notify=function(){this.eventListeners.forEach(function(te){te.graphChanged()})};let Layout={};Layout.ForceDirected=function(te,ee,re,ne){this.graph=te,this.stiffness=ee,this.repulsion=re,this.damping=ne,this.nodePoints={},this.edgeSprings={},this.getRandom=()=>Math.random()};Layout.ForceDirected.prototype.point=function(te){if(typeof this.nodePoints[te.id]>"u"){var ee=typeof te.data.mass<"u"?te.data.mass:1;this.nodePoints[te.id]=new Layout.ForceDirected.Point(gVector.random(this.getRandom),ee)}return this.nodePoints[te.id]};Layout.ForceDirected.prototype.spring=function(te){if(typeof this.edgeSprings[te.id]>"u"){var ee=typeof te.data.length<"u"?te.data.length:1,re=!1,ne=this.graph.getEdges(te.source,te.target);if(ne.forEach(function(ie){re===!1&&typeof this.edgeSprings[ie.id]<"u"&&(re=this.edgeSprings[ie.id])},this),re!==!1)return new Layout.ForceDirected.Spring(re.point1,re.point2,0,0);if(this.graph.getEdges(te.target,te.source),ne.forEach(function(ie){re===!1&&typeof this.edgeSprings[ie.id]<"u"&&(re=this.edgeSprings[ie.id])},this),re!==!1)return new Layout.ForceDirected.Spring(re.point2,re.point1,0,0);this.edgeSprings[te.id]=new Layout.ForceDirected.Spring(this.point(te.source),this.point(te.target),ee,this.stiffness)}return this.edgeSprings[te.id]};Layout.ForceDirected.prototype.eachNode=function(te){var ee=this;this.graph.nodes.forEach(function(re){te.call(ee,re,ee.point(re))})};Layout.ForceDirected.prototype.eachEdge=function(te){var ee=this;this.graph.edges.forEach(function(re){te.call(ee,re,ee.spring(re))})};Layout.ForceDirected.prototype.eachSpring=function(te){var ee=this;this.graph.edges.forEach(function(re){te.call(ee,ee.spring(re))})};Layout.ForceDirected.prototype.applyCoulombsLaw=function(){this.eachNode(function(te,ee){this.eachNode(function(re,ne){if(ee!==ne){var ie=ee.p.subtract(ne.p),oe=ie.magnitude()+.1,fe=ie.normalise();ee.applyForce(fe.multiply(this.repulsion).divide(oe*oe*.5)),ne.applyForce(fe.multiply(this.repulsion).divide(oe*oe*-.5))}})})};Layout.ForceDirected.prototype.applyHookesLaw=function(){this.eachSpring(function(te){var ee=te.point2.p.subtract(te.point1.p),re=te.length-ee.magnitude(),ne=ee.normalise();te.point1.applyForce(ne.multiply(te.k*re*-.5)),te.point2.applyForce(ne.multiply(te.k*re*.5))})};Layout.ForceDirected.prototype.attractToCentre=function(){this.eachNode(function(te,ee){var re=ee.p.multiply(-1);ee.applyForce(re.multiply(this.repulsion/50))})};Layout.ForceDirected.prototype.updateVelocity=function(te){this.eachNode(function(ee,re){re.v=re.v.add(re.a.multiply(te)).multiply(this.damping),re.a=new gVector(0,0)})};Layout.ForceDirected.prototype.updatePosition=function(te){this.eachNode(function(ee,re){re.p=re.p.add(re.v.multiply(te))})};Layout.ForceDirected.prototype.totalEnergy=function(te){var ee=0;return this.eachNode(function(re,ne){var ie=ne.v.magnitude();ee+=.5*ne.m*ie*ie}),ee};Layout.ForceDirected.prototype.nearest=function(te){var ee={node:null,point:null,distance:null},re=this;return this.graph.nodes.forEach(function(ne){var ie=re.point(ne),oe=ie.p.subtract(te).magnitude();(ee.distance===null||oe<ee.distance)&&(ee={node:ne,point:ie,distance:oe})}),ee};Layout.ForceDirected.prototype.getBoundingBox=function(){var te=new gVector(-2,-2),ee=new gVector(2,2);this.eachNode(function(ne,ie){ie.p.x<te.x&&(te.x=ie.p.x),ie.p.y<te.y&&(te.y=ie.p.y),ie.p.x>ee.x&&(ee.x=ie.p.x),ie.p.y>ee.y&&(ee.y=ie.p.y)});var re=ee.subtract(te).multiply(.07);return{bottomleft:te.subtract(re),topright:ee.add(re)}};var gVector=function(te,ee){this.x=te,this.y=ee};gVector.random=function(te){return new gVector(10*(te()-.5),10*(te()-.5))};gVector.prototype.add=function(te){return new gVector(this.x+te.x,this.y+te.y)};gVector.prototype.subtract=function(te){return new gVector(this.x-te.x,this.y-te.y)};gVector.prototype.multiply=function(te){return new gVector(this.x*te,this.y*te)};gVector.prototype.divide=function(te){return new gVector(this.x/te||0,this.y/te||0)};gVector.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};gVector.prototype.normal=function(){return new gVector(-this.y,this.x)};gVector.prototype.normalise=function(){return this.divide(this.magnitude())};Layout.ForceDirected.Point=function(te,ee){this.p=te,this.m=ee,this.v=new gVector(0,0),this.a=new gVector(0,0)};Layout.ForceDirected.Point.prototype.applyForce=function(te){this.a=this.a.add(te.divide(this.m))};Layout.ForceDirected.Spring=function(te,ee,re,ne){this.point1=te,this.point2=ee,this.length=re,this.k=ne};function toposort(te){return toposort$1(uniqueNodes(te),te)}function toposort$1(te,ee){let re=te.length,ne=new Array(re),ie={},oe=re,fe=makeOutgoingEdges(ee),ue=makeNodesHash(te);for(ee.forEach(se=>{if(!ue.has(se[0])||!ue.has(se[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});oe--;)ie[oe]||ae(te[oe],oe,new Set);return ne;function ae(se,ce,le){if(le.has(se)){let de;try{de=", node was:"+JSON.stringify(se)}catch{de=""}throw new Error("Cyclic dependency"+de)}if(!ue.has(se))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(se));if(ie[ce])return;ie[ce]=!0;let pe=fe.get(se)||new Set;if(pe=Array.from(pe),ce=pe.length){le.add(se);do{let de=pe[--ce];ae(de,ue.get(de),le)}while(ce);le.delete(se)}ne[--re]=se}}function uniqueNodes(te){let ee=new Set;for(let re=0,ne=te.length;re<ne;re++){let ie=te[re];ee.add(ie[0]),ee.add(ie[1])}return Array.from(ee)}function makeOutgoingEdges(te){let ee=new Map;for(let re=0,ne=te.length;re<ne;re++){let ie=te[re];ee.has(ie[0])||ee.set(ie[0],new Set),ee.has(ie[1])||ee.set(ie[1],new Set),ee.get(ie[0]).add(ie[1])}return ee}function makeNodesHash(te){let ee=new Map;for(let re=0,ne=te.length;re<ne;re++)ee.set(te[re],re);return ee}function runSimulation(te){let ee;try{return ee=new Simulator,ee.model=te.model,innerRunSimulation(ee,te)}catch(re){return checkErr(re,te,ee)}}function checkErr(te,ee,re){re.terminate();let ne;if(te instanceof ModelError?ne={error:te.message,errorPrimitive:te.primitive?re.model.getId(te.primitive.id):null,errorCode:te.code}:(console.log(te),ee.processError&&ee.processError(te),ne={error:"An unknown simulation error occurred. Please report this issue to the Insight Maker team at <a href='mailto:support@insightmaker.com' style='color: white'>support@insightmaker.com</a>.",errorPrimitive:null,errorCode:1},te=new ModelError(ne.error,{code:1})),re.results||(re.results={}),re.results.error=te.msg,ne.error&&(ne.error=ne.error.replace(/<br\s*\/?>/g,`
`).replace(/<[^>]*>?/gm,"")),ee.onError&&ee.onError(ne),ee.handleErrorObject)ee.handleErrorObject(te,re);else return ne}function innerRunSimulation(te,ee){ee&&(te.config=ee),te.evaluatingLine=null,ee.resultsWindow&&(ee.resultsWindow.windowContext.simulate.completed()||ee.resultsWindow.windowContext.simulate.terminate(),te.resultsWindow=ee.resultsWindow,ee.resultsWindow.windowContext.simulate=te,ee.resultsWindow.data.simulation=te,ee.resultsWindow.windowContext.componentRef.rerender(),ee.resultsWindow.windowContext.notFirstRun=!0),bootCalc(te),te.allPlaceholders={};let re=te.model.timeUnits;if(!re)throw new ModelError("You must set the time units in the model settings.",{code:1072});re=re.toLowerCase(),te.timeUnitsString=re;let ne={};ne.submodels={base:{id:"base",DNAs:[],agents:[{children:[],childrenId:{}}],size:1}};let ie=te.model.customUnits;if(ie){let ae=[];for(let se of ie)if(se.target.trim()){let ce={sourceString:se.name,scale:se.scale},le=createUnitStore(se.target,te);if(le)ce.target=le;else throw new ModelError('You cannot define a units synonym for "unitless".',{code:1001});ae.push(ce)}te.unitManager.addUnits(ae)}let oe=te.unitManager.getUnitStore([re],[1]);if(ne.timeLength=new Material(te.model.timeLength,oe),ne.timeStart=new Material(te.model.timeStart||0,oe),ne.timeStep=new Material(te.model.timeStep,oe),ne.timeStep.value<=0||isNaN(ne.timeStep.value))throw new ModelError("The model time step must be a positive number.",{code:1002});if(ne.timeLength.value<=0||isNaN(ne.timeLength.value))throw new ModelError("The model time length must be a positive number.",{code:1003});if(te.model.timePause>0&&(ne.timePause=new Material(te.model.timePause,oe),ne.timePause.value<ne.timeStep.value))throw new ModelError("Time pause cannot be smaller than the time step.",{code:1004});te.timeUnits=oe;let fe={};fe.base={timeStep:new Material(te.model.timeStep,oe),algorithm:te.model.algorithm,id:"base",maxLoaded:-1},ne.solvers=fe;let ue=te.model.findFolders().concat(te.model.findAgents());for(let ae=0;ae<ue.length;ae++){let se=ue[ae].customTimeSettings;if(se&&se.enabled){if(fe[ue[ae].id]=Object.assign({},se,{timeStep:new Material(+se.timeStep,oe)}),fe[ue[ae].id].timeStep.value<=0||isNaN(fe[ue[ae].id].timeStep.value))throw new ModelError("The folder time step must be a positive number.",{primitive:ue[ae],showEditor:!1,code:1005});fe[ue[ae].id].id=ue[ae].id,fe[ue[ae].id].maxLoaded=-1}}for(let ae of Object.values(fe))ae.userTimeStep=ae.timeStep,ae.algorithm==="RK4"?ae.RKOrder=4:ae.RKOrder=1,ae.RKOrder===4&&(ae.timeStep=div(ae.userTimeStep,new Material(2))),ae.stocks=[],ae.flows=[],ae.transitions=[],ae.actions=[],ae.states=[],ae.valued=[],ae.displayed=[];try{let ce=function(){if(!se)if(se=!0,te.displayInformation.populated)for(let le=0;le<te.displayInformation.origIds.length;le++){let pe=te.displayInformation.origIds[le],de=te.displayInformation.objects[le];if(de instanceof SPopulation)te.results.children[pe].states=de.stateIds,te.displayInformation.agents[pe.toString()].data=te.results.children[pe].data,te.displayInformation.agents[pe.toString()].results=te.results.children[pe].results;else if(te.results.data[0][pe]instanceof Vector&&te.results.data[0][pe].names){let me=te.results.data[0][pe].fullNames();te.results.children[pe].indexedFullNames=me.slice();for(let ve=0;ve<me.length;ve++)me[ve]=me[ve].join(", ");te.results.children[pe].indexedNames=me}}else{te.displayInformation.populated=!0,te.displayInformation.colors=[],te.displayInformation.headers=[],te.displayInformation.agents=[],te.displayInformation.displayedItems=[],te.displayInformation.renderers=[],te.displayInformation.elementIds=[],te.displayInformation.res=te.results;let le=[];te.displayInformation.origIds=te.displayInformation.ids.slice();for(let pe=0;pe<te.displayInformation.origIds.length;pe++){let de=te.displayInformation.origIds[pe],me=te.displayInformation.objects[pe],ve=me.dna;if(te.displayInformation.displayedItems.push({id:de,header:ve.name,type:ve.primitive._node.value.nodeName}),me instanceof SPopulation){let we=me.stateIds;te.results.children[de].states=we,we.forEach(ge=>{let _e=te.model.getId(ge);le.push(de),te.displayInformation.elementIds.push("e"+de+"-"+ge),te.displayInformation.headers.push(_e.name),te.displayInformation.colors.push(ee.getColor?ee.getColor(_e):"#000000"),te.results.children[de].dataMode==="float"?te.displayInformation.renderers.push(commaStr):te.results.children[de].dataMode==="agents"?te.displayInformation.renderers.push(Te=>Te):te.displayInformation.renderers.push(void 0)}),te.displayInformation.agents[de.toString()]={id:de,item:ve.primitive,data:te.results.children[de].data,results:te.results.children[de].results}}else if(te.results.data.length&&te.results.data[0][de]instanceof Vector&&te.results.data[0][de].names){let we=ee.getColor?ee.getColor(ve.primitive):"#000000",ge=te.results.data[0][de].fullNames();te.results.children[de].indexedFullNames=ge.slice();for(let _e=0;_e<ge.length;_e++)ge[_e]=ge[_e].join(", ");te.results.children[de].indexedNames=ge;for(let _e=0;_e<ge.length;_e++)le.push(de),te.displayInformation.elementIds.push("e"+de+"-"+_e),te.displayInformation.headers.push(ve.name+" ("+ge[_e]+")"),te.displayInformation.colors.push(we),te.displayInformation.renderers.push(commaStr)}else le.push(de),te.displayInformation.elementIds.push("e"+de),te.displayInformation.headers.push(ve.name),te.displayInformation.colors.push(ee.getColor?ee.getColor(ve.primitive):"#000000"),te.results.children[de].dataMode==="float"?te.displayInformation.renderers.push(commaStr):te.displayInformation.renderers.push(void 0)}te.displayInformation.store={data:[]},te.displayInformation.ids=le}};if(te.setup(ne),te.model.globals!==void 0)try{evaluateGlobals(te.model.globals,te)}catch(le){if(le.simulationCommand==="STOP")throw le;let pe=[],de="An error with the macros prevented the simulation from running.";if(le instanceof ModelError)de=de+"<br/><br/>"+le.message;else{if(le.toString&&le.match&&le.match(/line (\d+)/i)){let me=le.match(/line (\d+)/i)[1];pe.push({type:"error",row:me!==void 0?me-1:te.evaluatingLine-1,text:le})}ee.processError&&ee.processError(le)}throw ee.showMacros&&ee.showMacros(pe),new ModelError(de,{code:1e3})}let ae=te.model.find();te.clusters=makeClusters(te);for(let le of ae)if(le instanceof Population){if(le.isInAgent())throw new ModelError(`Cannot have the agent population <i>[${toHTML(le.name)}]</i> placed within an agent folder.`,{primitive:le,showEditor:!1,code:1006});let pe=le.agentBase;if(!pe||!(pe instanceof Agent))throw new ModelError(`You must select a base agent for the primitive <i>[${toHTML(le.name)}]</i>. You can create agent definitions using Folder primitives.`,{primitive:le,showEditor:!1,code:1007});let de=new SPopulation(te);de.dna=new DNA(le,pe.id),de.id=le.id,de.agentId=pe.id,de.createIds(),de.dna.solver=folderSolvers(le,fe),de.dna.solver.displayed.push(de),de.geoDimUnits=le.geoUnits,de.geoDimUnitsObject=createUnitStore(le.geoUnits,te,le);try{de.geoWidth=simpleUnitsTest(simpleEquation(le.geoWidth,te),de.geoDimUnitsObject,te,le)}catch{throw new ModelError(`Invalid width for the agent population <i>[${toHTML(le.name)}]</i>.`,{primitive:le,showEditor:!1,code:1008})}try{de.geoHeight=simpleUnitsTest(simpleEquation(le.geoHeight,te),de.geoDimUnitsObject,te,le)}catch{throw new ModelError(`Invalid height for the agent population <i>[${toHTML(le.name)}]</i>.`,{primitive:le,showEditor:!1,code:1009})}if(de.halfWidth=div(de.geoWidth,new Material(2)),de.halfHeight=div(de.geoHeight,new Material(2)),de.geoWrap=le.geoWrapAround,de.placement=le.geoPlacementType,de.placementFunction=le.geoPlacementFunction,de.network=le.networkType,de.networkFunction=le.networkFunction,de.agentBase=pe.agentParent,de.agentBase&&de.agentBase.trim())try{de.agentBase=simpleEquation(de.agentBase,te,te.varBank)}catch{throw new ModelError(`Invalid Agent Parent for the primitive <i>[${toHTML(pe.name)}]</i>.`,{primitive:pe,showEditor:!1,code:1010})}let me=pe.children();de.DNAs=[];for(let ve of me)modelType(ve)&&de.DNAs.push(getDNA(ve,de,fe,te)),ve instanceof State&&de.stateIds.add(ve.id);de.size=le.populationSize,de.agents=[],de.dna.agents=de,ne.submodels[le.id]=de,ne.submodels.base.DNAs.push(de.dna)}else le.isInAgent()||modelType(le)&&ne.submodels.base.DNAs.push(getDNA(le,ne.submodels.base,fe,te));for(let le of Object.values(ne.submodels)){le.DNAs.sort((pe,de)=>pe.neighborProxyDNA&&!de.neighborProxyDNA?1:de.neighborProxyDNA&&!pe.neighborProxyDNA?-1:0);for(let pe=0;pe<le.size;pe++){let de;le.id==="base"?de=le.agents[0]:(de=new SAgent(te),de.container=le,de.index=pe,de.children=[],de.childrenId={},de.agentId=le.id,de.createIds(),le.agentBase&&(de.vector.parent=le.agentBase),le.agents.push(de));for(let me of le.DNAs)decodeDNA(me,de,te)}}for(let le in ne.submodels){let pe=ne.submodels[le];for(let de=0;de<pe.size;de++)for(let me=0;me<pe.DNAs.length;me++)linkPrimitive(pe.agents[de].children[me],pe.DNAs[me],te)}for(let le in ne.submodels){let pe=ne.submodels[le];for(let de=0;de<pe.size;de++)setAgentInitialValues(pe.agents[de])}for(let le in ne.submodels)if(le!=="base"){try{buildNetwork(ne.submodels[le],te)}catch(pe){let de="An error with the custom network function prevented the simulation from running.";throw pe instanceof ModelError&&(de=de+"<br/><br/>"+pe.message),new ModelError(de,{primitive:ne.submodels[le].node,showEditor:!1,code:1011})}try{buildPlacements(ne.submodels[le],te)}catch(pe){let de="An error with the agent placement function prevented the simulation from running.";throw pe instanceof ModelError&&(de=de+"<br/><br/>"+pe.message),new ModelError(de,{primitive:ne.submodels[le].node,showEditor:!1,code:1012})}}te.results={times:[],data:[],timeUnits:te.timeUnitsString},te.displayInformation={populated:!1,ids:[],times:[],objects:[],maps:[],histograms:[]},ne.submodels.base.agents[0].children.forEach(le=>{if(!(le instanceof SAction||le instanceof STransition)){le.dna.noOutput||(te.displayInformation.objects.push(le),te.displayInformation.ids.push(le.id));let pe={};le instanceof SPopulation?(pe.width=le.geoWidth,pe.height=le.geoHeight,pe.units=le.geoDimUnitsObject,pe.states=le.states()):le.dna.noOutput||le.dna.solver.displayed.push(le),te.results.children||(te.results.children={}),te.results.children[le.id]={data:pe,results:[],dataMode:"float"}}});let se=!1;if(ee.silent)if(ee.onPause)te.run(ee);else return formatSimResults(te.run(ee));else{let le=div(ne.timeLength,ne.timeStep);for(let ve=0;ve<=le.value;ve++)te.displayInformation.times.push(plus(ne.timeStart,mult(ne.timeStep,new Material(ve))).value);let pe=ee.onSuccess;ee.onSuccess=function(ve){ce();for(let we in te.simulationModel.solvers)updateDisplayed(te.simulationModel.solvers[we],te);te.setResultsCallback&&te.setResultsCallback(formatSimResults(te.results)),pe&&pe(ve)},ee.onCompletedFirstPass=function(){ce()};let de=ee.onStep;ee.onStep=function(ve){let we=!1,ge=te.progress();if(!te.shouldSleep){let _e=Date.now()-te.wakeUpTime,Te=1;te.results.times.length>2e4?Te=4:te.results.times.length>5e3?Te=2:te.results.times.length>1e3&&(Te=1.3),(!te.resultsWindow&&_e>100*Te||_e>600*Te)&&(updateDisplayed(ve,te),we=!0,te.timer=setTimeout(()=>{te.resume()},20*Math.pow(Te,1.5)),te.sleep())}ge===1&&!we&&updateDisplayed(ve,te),de&&de(ve)};let me=ee.onError;ee.onError=function(ve){try{for(let we in te.simulationModel.solvers)updateDisplayed(te.simulationModel.solvers[we],te)}catch{}te.finished&&te.finished(),me&&me(ve)},te.run(ee)}}catch(ae){if(ae.simulationCommand!=="STOP")throw ae;if(ee.silent)return{times:[],value:()=>[],lastValue:()=>{},error:"stop() called during initialization"}}}function cleanData(te,ee=!1){if(te instanceof Vector)if(ee)if(te.names&&te.names.length){let re={};for(let ne=0;ne<te.names.length;ne++)re[te.names[ne]]=cleanData(te.items[ne]);return re}else return te.items.map(re=>cleanData(re,ee));else return new Vector(te.items.map(re=>cleanData(re,ee)),te.simulate,te.names,te.parent);else{if(typeof te=="number")return+te.toPrecision(15);if(Array.isArray(te))return te.map(re=>cleanData(re,ee))}return te}function formatSimResults(te){let ee={};return ee.times=te.times.slice(),ee.data=te.data,ee.timeUnits=te.timeUnits,ee.children=te.children,ee.error=te.error,ee.errorPrimitive=te.errorPrimitive,ee.stochastic=te.stochastic,ee.error||(ee.error=null,ee.errorPrimitive=null),ee.value=function(re){if(!re)throw new Error("Cannot get result value() of null or undefined primitive.");let ne=this.children[re.id];if(!ne)throw new Error("Cannot find primitive in value() results.");return cleanData(ne.results,!0)},ee.lastValue=function(re){if(!re)throw new Error("Cannot get result lastValue() of null or undefined primitive.");let ne=this.children[re.id];if(!ne)throw new Error("Cannot find primitive in lastValue() results.");return cleanData(ne.results[ne.results.length-1],!0)},ee.times&&(ee.periods=ee.times.length),ee}function createUnitStore(te,ee,re){if(!(!te||te.trim()===""||te.trim().toLowerCase()==="unitless"))try{return simpleEquation("{1 "+te+"}",ee,{}).units}catch{throw new ModelError(`Invalid units: "<i>${te}</i>"`,{primitive:re,showEditor:!0,code:1012})}}function simpleEquation(te,ee,re,ne,ie){return re||(re=Object.create(null)),ne||(ne=Object.create(null)),ie||(ie=trimTree(createTree(te),ne,ee)),evaluateTree(ie,re,ee)}function simpleNum(te,ee,re){if(te instanceof Vector)return new Vector(te.items.map(ne=>simpleNum(ne,ee,re)),re);if(te instanceof Material){if(!ee&&te.units)throw new ModelError(`The result of the calculation has units <i>${te.units.toString()}</i>, but no units are specified for the calculation. Please set the units for the calculation so we can determine the proper output.`,{code:1013});return te.units?(te.units.addBase(),ee.addBase(),+fn["*"](te.value,fn["/"](te.units.toBase,ee.toBase))):+te.value}}function simpleUnitsTest(te,ee,re,ne=null,ie=!1,oe="Unknown simpleUnits type"){if(te instanceof Vector)return new Vector(te.items.map(fe=>simpleUnitsTest(fe,ee,re,ne,ie,oe)),re);if(te instanceof Material){if(!te.units&&!ee)return te;if(te.units){if(te.units===ee)return te;{let fe=convertUnits(te.units,ee);if(fe===0)throw new ModelError(`Wrong units generated. Expected <i>${ee?ee.toString():"unitless"}</i>, and got <i>${te.units.toString()}</i>.`,{primitive:ne,showEditor:ie,code:1014});return te.value=te.value*fe,te.units=ee,te}}else return te.units=ee,te}throw new ModelError(oe,{code:1015})}function evaluateGlobals(te,ee){evaluateTree(trimTree(createTree(te),{},ee),ee.varBank,ee)}function getDNA(te,ee,re,ne){let ie=new DNA(te),oe;if(ie.solver=folderSolvers(te,re),te){let fe=te.parent;fe&&(ie.frozen=fe.frozen)}if((te instanceof Variable||te instanceof Flow)&&te.external&&(ie.slider=!0),(te instanceof Flow||te instanceof Transition)&&(te.end!==null&&(ie.targetId=te.end.id),te.start!==null&&(ie.sourceId=te.start.id)),te instanceof Converter)ie.value=te.values;else try{te instanceof Stock?ie.value=replaceMacros(te,ie,createTree(te.initial),ee,re,ne,!0):te instanceof Flow?ie.value=replaceMacros(te,ie,createTree(te.rate),ee,re,ne,!1):te instanceof Variable?ie.value=replaceMacros(te,ie,createTree(te.value),ee,re,ne,!1):te instanceof State?ie.value=replaceMacros(te,ie,createTree(te.startActive),ee,re,ne,!0):te instanceof Transition?ie.value=replaceMacros(te,ie,createTree(te.value),ee,re,ne,!1):te instanceof Action&&(ie.value=replaceMacros(te,ie,createTree(te.action),ee,re,ne,!1))}catch(fe){let ue=`The primitive <i>[${toHTML(ie.name)}]</i> has an equation error that must be corrected before the model can be run.`;throw fe instanceof ModelError?ue=ue+"<br/><br/>"+fe.message:(console.error(fe),ue=ue+"<br/><br/>Unknown error."),oe=void 0,fe.match&&fe.match(/line (\d+)/i)&&(oe=fe.match(/line (\d+)/i)[1]),new ModelError(ue,{code:1055,primitive:te,showEditor:!0,line:oe,details:fe.match?fe:void 0})}if(te instanceof Action){ie.trigger=te.trigger,ie.repeat=te.repeat,ie.recalculate=te.recalculate||te.trigger==="Condition";try{ie.triggerValue=createTree(te.value)}catch(fe){let ue=`The trigger for <i>[${toHTML(ie.name)}]</i> has an equation error that must be corrected before the model can be run.`;throw fe instanceof ModelError&&(ue=ue+"<br/><br/>"+fe.message),new ModelError(ue,{code:1056,primitive:te,showEditor:!0,line:oe})}}else if(te instanceof Transition)ie.trigger=te.trigger,ie.repeat=te.repeat,ie.recalculate=te.recalculate||te.trigger==="Condition";else if(te instanceof State)if(te.residency===void 0||te.residency.trim()==="")ie.residency=null;else try{ie.residency=evaluateTree(trimTree(createTree(te.residency),{},ne),{},ne),ie.residency.units||(ie.residency.units=ne.timeUnits),eq(ie.residency,new Material(0,ne.timeUnits))&&(ie.residency=null)}catch{throw new ModelError("Invalid state residency.",{primitive:te,showEditor:!1,code:1016})}else if(te instanceof Stock){if(ie.nonNegative=te.nonNegative,te.type==="Conveyor"){ie.stockType="Conveyor";try{ie.delay=evaluateTree(trimTree(createTree(te.delay),{},ne),{},ne),ie.delay.units||(ie.delay.units=ne.timeUnits)}catch{throw new ModelError("Invalid stock delay.",{primitive:te,showEditor:!1,code:1017})}if(!(ie.delay instanceof Material))throw new ModelError("Stock delay must be a number.",{primitive:te,showEditor:!1,code:1073});if(ie.delay.value<0)throw new ModelError("Stock delay cannot be less than 0.",{primitive:te,showEditor:!1,code:1074})}}else if(te instanceof Flow)ie.nonNegative=te.nonNegative;else if(te instanceof Converter){ie.interpolation=te.interpolation==="Linear"?"linear":"discrete";let fe=te.values;if(!fe||!fe.length)throw new ModelError(`The converter <i>[${toHTML(ie.name)}]</i> does not have any data.`,{primitive:te,showEditor:!0,code:1018});let ue=[],ae=[],se;if(te.input==="Time")se=ne.timeUnits;else{let ce=te.input;if(ce)se=createUnitStore(ce.units,ne,te);else throw new ModelError(`The converter <i>[${toHTML(ie.name)}]</i> does not have a source.`,{primitive:te,showEditor:!0,code:1019})}ie.source=te.input==="Time"?te.input:te.input.id;for(let ce=0;ce<fe.length;ce++)ue.push(new Material(fe[ce].x,se)),ae.push(new Material(fe[ce].y));ie.inputs=ue,ie.outputs=ae}if(te instanceof ValuedPrimitive){if(!(te instanceof Transition)&&!(te instanceof Action)){let ue=te.units;try{!(te instanceof Flow)||ue&&ue.trim()&&ue.trim().toLowerCase()!=="unitless"?ie.units=createUnitStore(ue,ne,te):(ie.units=ne.timeUnits.power(-1),ie.flowUnitless=!0)}catch{throw new ModelError(`Invalid units specified for primitive: "<i>${toHTML(ue)}</i>"`,{primitive:te,showEditor:!0,code:1020})}}else ie.trigger==="Timeout"&&(ie.units=ne.timeUnits);let fe=te.constraints;ie.maxConstraint=fe.max,ie.useMaxConstraint="max"in fe,ie.minConstraint=fe.min,ie.useMinConstraint="min"in fe}return ie.units&&!ie.units.isUnitless()?(ie.units.addBase(),ie.toBase=ie.units.toBase):ie.toBase=1,ie.unitless=!ie.units,ie}function folderSolvers(te,ee){if(!te)return ee.base;if(te instanceof Population){let ne=te.agentBase;if(ne&&ee[ne.id])return ee[ne.id]}let re=te.parent;return re&&ee[re.id]?ee[re.id]:folderSolvers(re,ee)}function decodeDNA(te,ee,re){let ne;te.primitive instanceof Variable?ne=new SVariable(re):te.primitive instanceof State?ne=new SState(re):te.primitive instanceof Transition?ne=new STransition(re):te.primitive instanceof Action?ne=new SAction(re):te.primitive instanceof Stock?ne=new SStock(re):te.primitive instanceof Flow?ne=new SFlow(re):te.primitive instanceof Converter&&(ne=new SConverter(re)),ne?(ne.dna=te,ne.id=te.id,ne.index=ee.index,ne.agentId=ee.agentId,ne.container=ee,ne.createIds(),ne.frozen=te.frozen,ee.children.push(ne),ee.childrenId[ne.id]=ne,te.slider&&(re.sliders[te.id]?re.sliders[te.id].push(ne):re.sliders[te.id]=[ne]),ne instanceof SAction?te.solver.actions.push(ne):ne instanceof STransition?te.solver.transitions.push(ne):ne instanceof SPopulation||(te.solver.valued.push(ne),ne instanceof SFlow?te.solver.flows.push(ne):ne instanceof SStock?te.solver.stocks.push(ne):ne instanceof SState&&te.solver.states.push(ne)),te.neighborProxyDNA&&(ne.neighborProxyPrimitive=ee.children.find(ie=>ie.dna===te.neighborProxyDNA))):te.primitive instanceof Population&&(ee.children.push(te.agents),ee.childrenId[te.id]=te.agents)}function linkPrimitive(te,ee,re){if(!(te instanceof SPopulation)){let ne=getPrimitiveNeighborhood(te.neighborProxyPrimitive?te.neighborProxyPrimitive:te,te.neighborProxyPrimitive?te.dna.neighborProxyDNA:ee,re,te.dna.extraLinksPrimitives);if(te instanceof SFlow||te instanceof STransition){let ie=ne;te.neighborProxyPrimitive&&(ie=getPrimitiveNeighborhood(te,ee,re,te.dna.extraLinksPrimitives));let oe=null,fe=null;if(ie["[alpha"]&&(oe=ie["[alpha"],ie.alpha||(ie.alpha=oe)),ie["[omega"]&&(fe=ie["[omega"],ie.omega||(ie.omega=fe)),te instanceof STransition){if(oe&&!(oe instanceof SState))throw new ModelError(`The start of the primitive <i>[${ee.name}]</i> must be a state.`,{primitive:ee.primitive,showEditor:!1,code:1060});if(fe&&!(fe instanceof SState))throw new ModelError(`The end of the primitive <i>[${ee.name}]</i> must be a state.`,{primitive:ee.primitive,showEditor:!1,code:1061})}if(te instanceof SFlow){if(oe&&!(oe instanceof SStock))throw new ModelError(`The start of the primitive <i>[${ee.name}]</i> must be a stock.`,{primitive:ee.primitive,showEditor:!1,code:1062});if(fe&&!(fe instanceof SStock))throw new ModelError(`The end of the primitive <i>[${ee.name}]</i> must be a stock.`,{primitive:ee.primitive,showEditor:!1,code:1063})}te.setEnds(oe,fe)}if(te instanceof SAction){try{te.equation=trimTree(ee.triggerValue,ne,te.simulate)}catch(ie){let oe=`The primitive <i>[${toHTML(ee.name)}]</i> has an equation error that must be corrected before the model can be run.`;throw ie instanceof ModelError&&(oe=oe+"<br/><br/>"+ie.message),new ModelError(oe,{primitive:ee.primitive,showEditor:!1,code:1064})}try{te.action=trimTree(ee.value,ne,te.simulate)}catch(ie){let oe=`The primitive <i>[${toHTML(ee.name)}]</i> has an equation error that must be corrected before the model can be run.`;ie instanceof ModelError&&(oe=oe+"<br/><br/>"+ie.message);let fe;throw ie.match&&ie.match(/line (\d+)/i)&&(fe=ie.match(/line (\d+)/i)[1]),new ModelError(oe,{primitive:ee.primitive,showEditor:!0,code:1065,line:fe,details:ie.match?ie:void 0})}}else if(te instanceof SConverter)if(ee.source==="Time")te.setSource("*time");else{let ie=ee.source,oe=!1;for(let fe in ne)if(ie===ne[fe].id){te.setSource(ne[fe]),oe=!0;break}if(!oe)throw new ModelError("Converter source could not be found. Please redefine it.",{primitive:ee.primitive,showEditor:!1,code:1066})}else te.setEquation(ee.value,ne)}}function setAgentInitialValues(te){for(let ee of te.children)if(ee instanceof SStock){ee.setDelay();try{ee.setInitialValue()}catch(re){throw re instanceof ModelError&&(re.primitive||(re.primitive=ee.orig())),re}}else if(ee instanceof SState)try{ee.active===null&&ee.setInitialActive(!0)}catch(re){throw re instanceof ModelError&&(re.primitive||(re.primitive=ee.orig())),re}}function buildNetwork(te,ee){if(te.network==="Custom Function"){let re=getPrimitiveNeighborhood(te,te.dna,ee,[]),ne=trimTree(createTree(te.networkFunction),re,ee);for(let ie=0;ie<te.agents.length-1;ie++)for(let oe=ie+1;oe<te.agents.length;oe++)trueValue(simpleEquation(te.networkFunction,ee,{"-parent":ee.varBank,a:te.agents[ie],b:te.agents[oe]},re,ne))&&te.agents[ie].connect(te.agents[oe])}else if(te.network!=="None")throw new ModelError(`Unknown network type: ${toHTML(te.network)}.`,{primitive:te.node,showEditor:!1,code:1020})}function buildPlacements(te,ee){let re,ne,ie;if(te.placement==="Random")for(let oe of te.agents)oe.location=new Vector([mult(te.geoWidth,new Material(Rand(ee))),mult(te.geoHeight,new Material(Rand(ee)))],ee,["x","y"]);else if(te.placement==="Custom Function")te.agents.forEach(oe=>{let fe=getPrimitiveNeighborhood(te,te.dna,ee,[]);fe.self=oe,oe.location=simpleUnitsTest(simpleEquation(te.placementFunction,ee,{"-parent":ee.varBank,self:oe},fe),te.geoDimUnitsObject,ee,null,null,"Agent placement functions must return a two element vector"),validateAgentLocation(oe.location,te.node),oe.location.names||(oe.location.names=["x","y"],oe.location.namesLC=["x","y"])});else if(te.placement==="Grid"){re=trimTree(createTree("{x: x*width(self), y: y*height(self)}"),{},ee);let oe=te.agents.length,fe=simpleNum(simpleEquation("width(self)/height(self)",ee,{"-parent":ee.varBank,self:te},{}),te.geoDimUnitsObject,ee);ie=Math.sqrt(oe/fe),ne=Math.floor(ie*fe),ie=Math.ceil(ie),ie*ne<oe&&(ne=ne+1);let ue=0;te.agents.forEach(ae=>{let se=(ue%ne+.5)/ne,ce=(Math.floor(ue/ne)+.5)/ie;ae.location=simpleUnitsTest(simpleEquation("{x: x*width(self), y: y*height(self)}",ee,{self:ae,x:new Material(se),y:new Material(ce),"-parent":ee.varBank},{},re),te.geoDimUnitsObject,ee),ue++})}else if(te.placement==="Ellipse"){re=trimTree(createTree("{width(self), height(self)}/2+{sin(index(self)/size*2*3.14159), cos(index(self)/size*2*3.14159)}*{width(self), height(self)}/2"),{},ee);let oe=new Material(te.agents.length);te.agents.forEach(fe=>{fe.location=simpleUnitsTest(simpleEquation("{width(self), height(self)}/2+{sin(index(self)/size*2*3.14159), cos(index(self)/size*2*3.14159)}*{width(self), heigh(self)}/2",ee,{self:fe,size:oe,"-parent":ee.varBank},{},re),te.geoDimUnitsObject,ee)})}else if(te.placement==="Network"){re=trimTree(createTree("{x: x*width(self), y: y*height(self)}"),{},ee);let oe=new Graph,fe=te.agents.map(le=>oe.newNode({data:le})),ue=function(le){for(let pe of fe)if(pe.data.data===le)return pe;return null};te.agents.forEach(le=>{le.connected.forEach(pe=>{oe.newEdge(ue(le),ue(pe))})});let ae=new Layout.ForceDirected(oe,400,600,.5);ae.getRandom=()=>Rand(ee);for(let le=0;le<60;le++)ae.applyCoulombsLaw(),ae.applyHookesLaw(),ae.attractToCentre(),ae.updateVelocity(.03),ae.updatePosition(.03);let se=ae.getBoundingBox();se.width=se.topright.x-se.bottomleft.x,se.height=se.topright.y-se.bottomleft.y;let ce=function(le){return{x:(le.x-se.bottomleft.x)/se.width,y:(le.y-se.bottomleft.y)/se.height}};ae.eachNode((le,pe)=>{let de=ce(pe.p);le.data.data.location=simpleUnitsTest(simpleEquation("{x: x*width(self), y: y*height(self)}",ee,{self:te,x:new Material(de.x),y:new Material(de.y),"-parent":ee.varBank},{},re),te.geoDimUnitsObject,ee)})}else throw new ModelError(`Unknown placement type: ${toHTML(te.placement)}.`,{primitive:te.node,showEditor:!1,code:1021})}function getPrimitiveNeighborhood(te,ee,re,ne){let ie=ee.primitive.neighbors();if(ne)for(let ue of ne)ie.push({item:ue,type:"direct"});let oe=re.allPlaceholders[ee.id]?re.allPlaceholders[ee.id]:{},fe={self:te};if(te instanceof SPopulation)for(let ue of te.DNAs)oe[ue.name.toLowerCase()]=new Placeholder(ue,te,re);for(let ue of ie){let ae=ue.item;if(ae instanceof Population){fe[te.simulate.simulationModel.submodels[ae.id].dna.name.toLowerCase()]=te.simulate.simulationModel.submodels[ae.id];for(let se of te.simulate.simulationModel.submodels[ae.id].DNAs){let ce=se.name.toLowerCase();ce in fe||(fe[ce]=new Placeholder(se,te,re))}}else if(ue.type!=="agent"){let se=!1,ce;if(te.container&&te.container.childrenId[ae.id]&&(ce=te.container.childrenId[ae.id].dna.name.toLowerCase(),fe[ce]=te.container.childrenId[ae.id],se=!0),se||te.simulate.simulationModel.submodels.base.agents[0].childrenId[ae.id]&&(ce=te.simulate.simulationModel.submodels.base.agents[0].childrenId[ae.id].dna.name.toLowerCase(),fe[ce]=te.simulate.simulationModel.submodels.base.agents[0].childrenId[ae.id],se=!0),!se&&(te instanceof SFlow||te instanceof STransition)&&ae===re.model.getId(ae.id))throw te instanceof SFlow?new ModelError("Flow primitives may not cross agent boundaries.",{primitive:ee.primitive,showEditor:!1,code:1070}):new ModelError("Transition primitives may not cross agent boundaries.",{primitive:ee.primitive,showEditor:!1,code:1071});(te instanceof SFlow||te instanceof STransition)&&fe[ce]&&(ee.targetId===fe[ce].id?fe["[omega"]=fe[ce]:ee.sourceId===fe[ce].id&&(fe["[alpha"]=fe[ce]))}}for(let ue in oe)ue in fe||(fe[ue]=oe[ue]);return re.allPlaceholders[ee.id]=oe,fe}function modelType(te){return te instanceof Stock||te instanceof Flow||te instanceof State||te instanceof Transition||te instanceof Converter||te instanceof Variable||te instanceof Action||te instanceof Population}function updateDisplayed(te,ee){let re=te.displayed;if(ee.displayInformation.store){for(let ne=ee.displayInformation.store.data.length;ne<ee.results.times.length;ne++){let ie=ee.displayInformation.store.data[ne],oe={};if(ie||(oe.id=ne,oe.Time=ee.results.times[ne]),re.length>0&&ee.results.data[ne][re[0].id]!==void 0)for(let fe=0;fe<re.length;fe++){let ue=ee.displayInformation.ids.indexOf(re[fe].id);if(ue>-1)if(ee.results.children[ee.displayInformation.ids[ue]].states){let ae=ee.results.children[ee.displayInformation.ids[ue]].states;if(ee.results.data[ne][re[fe].id]){let se=ee.results.data[ne][re[fe].id].current,ce={};for(let pe of se)if(pe.state)for(let de of pe.state)ce[de.id.toString()]=ce[de.id.toString()]+1||1;let le=0;ae.forEach(pe=>{oe[ee.displayInformation.elementIds[ue+le]]=ce[pe]||0,le++})}}else if(ee.results.children[ee.displayInformation.ids[ue]].indexedNames){let ae=0;for(;ue<ee.displayInformation.ids.length&&ee.displayInformation.ids[ue]===re[fe].id;){try{oe[ee.displayInformation.elementIds[ue]]=selectFromMatrix(ee.results.data[ne][re[fe].id].fullClone(),ee,ee.results.children[ee.displayInformation.ids[ue]].indexedFullNames[ae].slice())}catch{throw new ModelError("Cannot change vector keys during a simulation.",{primitive:re[fe].dna.primitive,showEditor:!0,code:1022})}ae++,ue++}}else oe[ee.displayInformation.elementIds[ue]]=ee.results.data[ne][re[fe].id]}ie?Object.assign(ie,oe):ee.displayInformation.store.data.push(oe)}ee.resultsWindow||(ee.resultsWindow=ee.config.createResultsWindow(ee))}}function validateAgentLocation(te,ee){let re=()=>{throw new ModelError("Agent placement functions must return a two element vector",{primitive:ee,showEditor:!1,code:1023})};te instanceof Vector||re(),te.length()!==2&&re(),te.items[0]instanceof Material||re(),te.items[1]instanceof Material||re()}function makeClusters(te){let ee={},re=te.model.findFlows(),ne=0;for(;re.length;){ne++;let ie=re[0],oe={availableFlows:re,edges:[],stockSet:new Set,flowSet:new Set,simulate:te};clusterAddFlow(oe,ie);let fe;try{fe=toposort(oe.edges)}catch{let se=[...oe.flowSet.entries()].map(le=>le[0]);se.sort((le,pe)=>le.id-pe.id);let ce=0;for(let le of se)ce++,ee[le.id]={cluster:ne,flow:ce};continue}let ue=0;for(let ae of fe)ae instanceof Flow&&(ue++,ee[ae.id]={cluster:ne,flow:ue})}return ee}function clusterAddFlow(te,ee){te.flowSet.add(ee),te.availableFlows.splice(te.availableFlows.indexOf(ee),1);let re=ee.start,ne=ee.end;re&&re.nonNegative&&(te.edges.push([re,ee]),te.stockSet.has(re)||(te.stockSet.add(re),clusterAddStock(te,re))),ne&&ne.nonNegative&&(te.edges.push([ee,ne]),te.stockSet.has(ne)||(te.stockSet.add(ne),clusterAddStock(te,ne)))}function clusterAddStock(te,ee){let re=!0;for(;re;){re=!1;for(let ne of te.availableFlows){let ie=ne.start,oe=ne.end;if(ie===ee||oe===ee){clusterAddFlow(te,ne),re=!0;break}}}}let macroCounter=0;const MACRO_FNS={_initial:{replacement:te=>{let{input:ee,initialValue:re}=te;return re?re.cloneStructure():ee.cloneStructure()}},smooth:{replacement:(te,ee,re,ne,ie,oe)=>{let{input:fe,initialValue:ue,period:ae}=te;ae=new TreeNode("LINES","LINES",re.line,[new TreeNode("ASSIGN","ASSIGN",re.line,[new TreeNode("ASSIGNED","ASSIGNED",re.line,[new TreeNode("__tmp_macro_period","IDENT",re.line)]),new TreeNode("INNER","INNER",re.line,[new TreeNode("RemoveUnits","IDENT",re.line),new TreeNode("FUNCALL","FUNCALL",re.line,[ae,new TreeNode('"'+oe.timeUnitsString+'"',"STRING",re.line)])])]),new TreeNode("INNER","INNER",re.line,[new TreeNode("Assert","IDENT",re.line),new TreeNode("FUNCALL","FUNCALL",re.line,[new TreeNode(">","GT",re.line,[new TreeNode("__tmp_macro_period","IDENT",re.line),new TreeNode("0","INTEGER",re.line)]),new TreeNode('"Period for Smooth() must be greater than 0."',"STRING",re.line)])]),new TreeNode("__tmp_macro_period","IDENT",re.line)]);let se=new Model,ce="__Smooth Stock "+macroCounter++,le=se.Stock({name:ce,initial:"(iv) || (i)"});le._node.id=""+Math.random();let pe=se.Flow(null,le,{name:"__Smooth Inflow",rate:"((i) - [Omega]) / (p)",nonNegative:!1});pe._node.id=""+Math.random();let de=getDNA(le,ne,ie,oe),me=getDNA(pe,ne,ie,oe);ee.extraLinksPrimitives.push(le),me.extraLinksPrimitives.push(le),de.value=ue?ue.cloneStructure():fe.cloneStructure();let ve=new TreeNode("DIV","DIV",re.line,[new TreeNode("MINUS","MINUS",re.line,[fe.cloneStructure(),new TreeNode("["+ce+"]","PRIMITIVE",re.line)]),ae.cloneStructure()]);return me.value=ve,me.noOutput=!0,de.noOutput=!0,me.adoptUnits=!0,de.adoptUnits=!0,me.neighborProxyDNA=ee,de.neighborProxyDNA=ee,ne.DNAs.push(me),ne.DNAs.push(de),new TreeNode("["+ce+"]","PRIMITIVE",re.line)}},delay1:{replacement:(te,ee,re,ne,ie,oe)=>{let{input:fe,initialValue:ue,period:ae}=te,se=new Model;ae=new TreeNode("LINES","LINES",re.line,[new TreeNode("ASSIGN","ASSIGN",re.line,[new TreeNode("ASSIGNED","ASSIGNED",re.line,[new TreeNode("__tmp_macro_period","IDENT",re.line)]),new TreeNode("INNER","INNER",re.line,[new TreeNode("RemoveUnits","IDENT",re.line),new TreeNode("FUNCALL","FUNCALL",re.line,[ae,new TreeNode('"'+oe.timeUnitsString+'"',"STRING",re.line)])])]),new TreeNode("INNER","INNER",re.line,[new TreeNode("Assert","IDENT",re.line),new TreeNode("FUNCALL","FUNCALL",re.line,[new TreeNode(">","GT",re.line,[new TreeNode("__tmp_macro_period","IDENT",re.line),new TreeNode("0","INTEGER",re.line)]),new TreeNode('"Period for Delay1() must be greater than 0."',"STRING",re.line)])]),new TreeNode("__tmp_macro_period","IDENT",re.line)]);let ce="__Delay1 Stock "+macroCounter++,le="__Delay1 Outflow "+macroCounter++,pe=se.Stock({name:ce,initial:"(iv) || (i)"});pe._node.id=""+Math.random();let de=se.Flow(null,pe,{name:"__Delay1 Inflow",rate:"(i)",nonNegative:!1});de._node.id=""+Math.random();let me=se.Flow(pe,null,{name:le,rate:"(alpha) / (p)",nonNegative:!1});me._node.id=""+Math.random();let ve=getDNA(pe,ne,ie,oe),we=getDNA(de,ne,ie,oe),ge=getDNA(me,ne,ie,oe);return ee.extraLinksPrimitives.push(me),ge.extraLinksPrimitives.push(pe),we.value=fe.cloneStructure(),ve.value=new TreeNode("MULT","MULT",re.line,[ue?ue.cloneStructure():fe.cloneStructure(),ae.cloneStructure()]),ge.value=new TreeNode("DIV","DIV",re.line,[new TreeNode("["+ce+"]","PRIMITIVE",re.line),ae.cloneStructure()]),ve.noOutput=!0,we.noOutput=!0,ge.noOutput=!0,ve.adoptUnits=!0,we.adoptUnits=!0,ge.adoptUnits=!0,ve.neighborProxyDNA=ee,we.neighborProxyDNA=ee,ge.neighborProxyDNA=ee,ne.DNAs.push(ve),ne.DNAs.push(we),ne.DNAs.push(ge),new TreeNode("["+le+"]","PRIMITIVE",re.line)}},delay3:{replacement:(te,ee,re,ne,ie,oe)=>{let{input:fe,initialValue:ue,period:ae}=te,se=new Model,ce="__Delay3 Outflow "+macroCounter++,le="__Delay3 Stock "+macroCounter++,pe="__Delay3 Stock "+macroCounter++,de="__Delay3 Stock "+macroCounter++,me=se.Stock({name:le,initial:"(iv) || (i)"});me._node.id=""+Math.random();let ve=se.Stock({name:pe,initial:"(iv) || (i)"});ve._node.id=""+Math.random();let we=se.Stock({name:de,initial:"(iv) || (i)"});we._node.id=""+Math.random();let ge=se.Flow(null,me,{name:"Delay3 Inflow",rate:"(i)",nonNegative:!1});ge._node.id=""+Math.random();let _e=se.Flow(me,ve,{name:"Delay3 Flow 1",rate:"(alpha) / (p/3)",nonNegative:!1});_e._node.id=""+Math.random();let Te=se.Flow(ve,we,{name:"Delay3 Flow 2",rate:"(alpha) / (p/3)",nonNegative:!1});Te._node.id=""+Math.random();let Ne=se.Flow(we,null,{name:ce,rate:"(alpha) / (p/3)",nonNegative:!1});Ne._node.id=""+Math.random(),ae=new TreeNode("LINES","LINES",re.line,[new TreeNode("ASSIGN","ASSIGN",re.line,[new TreeNode("ASSIGNED","ASSIGNED",re.line,[new TreeNode("__tmp_macro_period","IDENT",re.line)]),new TreeNode("INNER","INNER",re.line,[new TreeNode("RemoveUnits","IDENT",re.line),new TreeNode("FUNCALL","FUNCALL",re.line,[ae,new TreeNode('"'+oe.timeUnitsString+'"',"STRING",re.line)])])]),new TreeNode("INNER","INNER",re.line,[new TreeNode("Assert","IDENT",re.line),new TreeNode("FUNCALL","FUNCALL",re.line,[new TreeNode(">","GT",re.line,[new TreeNode("__tmp_macro_period","IDENT",re.line),new TreeNode("0","INTEGER",re.line)]),new TreeNode('"Period for Delay3() must be greater than 0."',"STRING",re.line)])]),new TreeNode("__tmp_macro_period","IDENT",re.line)]);let Le=new TreeNode("DIV","DIV",re.line,[ae,new TreeNode("3","INTEGER",re.line)]),Oe=getDNA(me,ne,ie,oe),xe=getDNA(ve,ne,ie,oe),Se=getDNA(we,ne,ie,oe),be=getDNA(ge,ne,ie,oe),De=getDNA(_e,ne,ie,oe),Me=getDNA(Te,ne,ie,oe),Ue=getDNA(Ne,ne,ie,oe);De.extraLinksPrimitives.push(me),Me.extraLinksPrimitives.push(ve),Ue.extraLinksPrimitives.push(we),ee.extraLinksPrimitives.push(Ne),be.value=fe.cloneStructure();let Ke=new TreeNode("MULT","MULT",re.line,[ue?ue.cloneStructure():fe.cloneStructure(),Le.cloneStructure()]);return Oe.value=Ke.cloneStructure(),xe.value=Ke.cloneStructure(),Se.value=Ke.cloneStructure(),De.value=new TreeNode("DIV","DIV",re.line,[new TreeNode("["+le+"]","PRIMITIVE",re.line),Le.cloneStructure()]),Me.value=new TreeNode("DIV","DIV",re.line,[new TreeNode("["+pe+"]","PRIMITIVE",re.line),Le.cloneStructure()]),Ue.value=new TreeNode("DIV","DIV",re.line,[new TreeNode("["+de+"]","PRIMITIVE",re.line),Le.cloneStructure()]),Oe.noOutput=!0,xe.noOutput=!0,Se.noOutput=!0,be.noOutput=!0,De.noOutput=!0,Me.noOutput=!0,Ue.noOutput=!0,Oe.adoptUnits=!0,xe.adoptUnits=!0,Se.adoptUnits=!0,be.adoptUnits=!0,De.adoptUnits=!0,Me.adoptUnits=!0,Ue.adoptUnits=!0,Oe.neighborProxyDNA=ee,xe.neighborProxyDNA=ee,Se.neighborProxyDNA=ee,be.neighborProxyDNA=ee,De.neighborProxyDNA=ee,Me.neighborProxyDNA=ee,Ue.neighborProxyDNA=ee,ne.DNAs.push(Oe),ne.DNAs.push(xe),ne.DNAs.push(Se),ne.DNAs.push(be),ne.DNAs.push(De),ne.DNAs.push(Me),ne.DNAs.push(Ue),new TreeNode("["+ce+"]","PRIMITIVE",re.line)}}};function getMacroParameters(te,ee,re){if(te.length>3||te.length<2)throw new ModelError(`Wrong number of parameters for ${ee}().`,{code:10001});function ne(ie){if(ie.typeName==="IDENT"){for(let oe of re)if(oe.target===ie.text)return oe.value.cloneStructure()}return ie.children=ie.children.map(oe=>ne(oe)),ie}return re.length&&(te=te.map(ie=>ne(ie))),{input:te[0],period:te[1],initialValue:te[2]}}const MACRO_FNS_NAMES=Object.keys(MACRO_FNS).filter(te=>!te.startsWith("_"));function replaceMacros(te,ee,re,ne,ie,oe,fe,ue=[]){let ae,se;return re.typeName==="INNER"&&(re.children.length===2?re.children[0].typeName==="IDENT"&&MACRO_FNS_NAMES.includes(re.children[0].text)&&(ae=re.children[0].text,re.children[1].typeName==="FUNCALL"&&(se=getMacroParameters(re.children[1].children.slice(),ae,ue))):re.children.length===3&&re.children[0].typeName==="PRIMITIVE"&&re.children[1].typeName==="SELECTOR"&&re.children[1].children[0].typeName==="DOTSELECTOR"&&MACRO_FNS_NAMES.includes(re.children[1].children[0].children[0].text)&&re.children[2].typeName==="FUNCALL"&&(ae=re.children[1].children[0].children[0].text,se=getMacroParameters([re.children[0]].concat(re.children[2].children),ae,ue))),ae?fe?MACRO_FNS._initial.replacement(se,ee,re,ne,ie,oe):MACRO_FNS[ae].replacement(se,ee,re,ne,ie,oe):(re.children=re.children.map(ce=>replaceMacros(te,ee,ce,ne,ie,oe,fe,ue)),re.typeName==="ASSIGN"&&re.children.length===2&&re.children[0].typeName==="ASSIGNED"&&re.children[0].children.length&&ue.push({target:re.children[0].children[0].text,value:re.children[1]}),re)}const nodeBase=Object.create(null),defaultSolver=JSON.stringify({enabled:!1,algorithm:"RK1",timeStep:1});let DI=typeof window>"u"?new DOMImplementation$1:document.implementation,doc=DI.createDocument("","",null);nodeBase.text=doc.createElement("Text");nodeBase.text.setAttribute("name","Text Area");nodeBase.text.setAttribute("LabelPosition","Middle");nodeBase.folder=doc.createElement("Folder");nodeBase.folder.setAttribute("name","New Folder");nodeBase.folder.setAttribute("Note","");nodeBase.folder.setAttribute("Type","None");nodeBase.folder.setAttribute("Solver",defaultSolver);nodeBase.folder.setAttribute("Image","None");nodeBase.folder.setAttribute("FlipHorizontal","false");nodeBase.folder.setAttribute("FlipVertical","false");nodeBase.folder.setAttribute("LabelPosition","Middle");nodeBase.folder.setAttribute("AgentBase","");nodeBase.ghost=doc.createElement("Ghost");nodeBase.ghost.setAttribute("Source","");nodeBase.picture=doc.createElement("Picture");nodeBase.picture.setAttribute("name","");nodeBase.picture.setAttribute("Note","");nodeBase.picture.setAttribute("Image","Growth");nodeBase.picture.setAttribute("FlipHorizontal","false");nodeBase.picture.setAttribute("FlipVertical","false");nodeBase.picture.setAttribute("LabelPosition","Bottom");nodeBase.display=doc.createElement("Display");nodeBase.display.setAttribute("name","Default Display");nodeBase.display.setAttribute("Note","");nodeBase.display.setAttribute("Type","Time Series");nodeBase.display.setAttribute("xAxis","Time (%u)");nodeBase.display.setAttribute("yAxis","");nodeBase.display.setAttribute("yAxis2","");nodeBase.display.setAttribute("showMarkers","false");nodeBase.display.setAttribute("showLines","true");nodeBase.display.setAttribute("showArea","false");nodeBase.display.setAttribute("Primitives","");nodeBase.display.setAttribute("Primitives2","");nodeBase.display.setAttribute("AutoAddPrimitives","false");nodeBase.display.setAttribute("ScatterplotOrder","X Primitive, Y Primitive");nodeBase.display.setAttribute("Image","Display");nodeBase.display.setAttribute("FlipHorizontal","false");nodeBase.display.setAttribute("FlipVertical","false");nodeBase.display.setAttribute("LabelPosition","Bottom");function setValuedProperties(te){te.setAttribute("Units","Unitless"),te.setAttribute("MaxConstraintUsed","false"),te.setAttribute("MinConstraintUsed","false"),te.setAttribute("MaxConstraint","100"),te.setAttribute("MinConstraint","0"),te.setAttribute("ShowSlider","false"),te.setAttribute("SliderMax",100),te.setAttribute("SliderMin",0),te.setAttribute("SliderStep","")}nodeBase.stock=doc.createElement("Stock");nodeBase.stock.setAttribute("name","New Stock");nodeBase.stock.setAttribute("Note","");nodeBase.stock.setAttribute("InitialValue","0");nodeBase.stock.setAttribute("StockMode","Store");nodeBase.stock.setAttribute("Delay","10");nodeBase.stock.setAttribute("Volume","100");nodeBase.stock.setAttribute("NonNegative","false");setValuedProperties(nodeBase.stock);nodeBase.stock.setAttribute("Image","None");nodeBase.stock.setAttribute("FlipHorizontal","false");nodeBase.stock.setAttribute("FlipVertical","false");nodeBase.stock.setAttribute("LabelPosition","Middle");nodeBase.state=doc.createElement("State");nodeBase.state.setAttribute("name","New State");nodeBase.state.setAttribute("Note","");nodeBase.state.setAttribute("Active","false");nodeBase.state.setAttribute("Residency","0");nodeBase.state.setAttribute("Image","None");nodeBase.state.setAttribute("FlipHorizontal","false");nodeBase.state.setAttribute("FlipVertical","false");nodeBase.state.setAttribute("LabelPosition","Middle");nodeBase.transition=doc.createElement("Transition");nodeBase.transition.setAttribute("name","Transition");nodeBase.transition.setAttribute("Note","");nodeBase.transition.setAttribute("Trigger","Timeout");nodeBase.transition.setAttribute("Value","1");nodeBase.transition.setAttribute("Repeat","false");nodeBase.transition.setAttribute("Recalculate","false");setValuedProperties(nodeBase.transition);nodeBase.action=doc.createElement("Action");nodeBase.action.setAttribute("name","New Action");nodeBase.action.setAttribute("Note","");nodeBase.action.setAttribute("Trigger","Probability");nodeBase.action.setAttribute("Value","0.5");nodeBase.action.setAttribute("Repeat","true");nodeBase.action.setAttribute("Recalculate","false");nodeBase.action.setAttribute("Action","Self.Move({Rand(), Rand()})");nodeBase.agents=doc.createElement("Agents");nodeBase.agents.setAttribute("name","New Agent Population");nodeBase.agents.setAttribute("Note","");nodeBase.agents.setAttribute("Size","100");nodeBase.agents.setAttribute("GeoWrap","false");nodeBase.agents.setAttribute("GeoDimUnits","Unitless");nodeBase.agents.setAttribute("GeoWidth","200");nodeBase.agents.setAttribute("GeoHeight","100");nodeBase.agents.setAttribute("Placement","Random");nodeBase.agents.setAttribute("PlacementFunction","{Rand()*Width(Self), Rand()*Height(Self)}");nodeBase.agents.setAttribute("Network","None");nodeBase.agents.setAttribute("NetworkFunction","RandBoolean(0.02)");nodeBase.agents.setAttribute("Agent","");nodeBase.agents.setAttribute("Image","None");nodeBase.agents.setAttribute("FlipHorizontal","false");nodeBase.agents.setAttribute("FlipVertical","false");nodeBase.agents.setAttribute("LabelPosition","Middle");nodeBase.agents.setAttribute("ShowSlider","false");nodeBase.agents.setAttribute("SliderMax","100");nodeBase.agents.setAttribute("SliderMin","0");nodeBase.agents.setAttribute("SliderStep","1");nodeBase.variable=doc.createElement("Variable");nodeBase.variable.setAttribute("name","New Variable");nodeBase.variable.setAttribute("Note","");nodeBase.variable.setAttribute("Equation","0");setValuedProperties(nodeBase.variable);nodeBase.variable.setAttribute("Image","None");nodeBase.variable.setAttribute("FlipHorizontal","false");nodeBase.variable.setAttribute("FlipVertical","false");nodeBase.variable.setAttribute("LabelPosition","Middle");nodeBase.button=doc.createElement("Button");nodeBase.button.setAttribute("name","New Button");nodeBase.button.setAttribute("Note","");nodeBase.button.setAttribute("Function",'showMessage("Button action triggered!\\n\\nIf you want to edit this Action, click on the button while holding down the Shift key on your keyboard.")');nodeBase.button.setAttribute("Image","None");nodeBase.button.setAttribute("FlipHorizontal","false");nodeBase.button.setAttribute("FlipVertical","false");nodeBase.button.setAttribute("LabelPosition","Middle");nodeBase.converter=doc.createElement("Converter");nodeBase.converter.setAttribute("name","New Converter");nodeBase.converter.setAttribute("Note","");nodeBase.converter.setAttribute("Source","Time");nodeBase.converter.setAttribute("Data","0,0; 1,1; 2,4; 3,9");nodeBase.converter.setAttribute("Interpolation","Linear");setValuedProperties(nodeBase.converter);nodeBase.converter.setAttribute("Image","None");nodeBase.converter.setAttribute("FlipHorizontal","false");nodeBase.converter.setAttribute("FlipVertical","false");nodeBase.converter.setAttribute("LabelPosition","Middle");nodeBase.flow=doc.createElement("Flow");nodeBase.flow.setAttribute("name","Flow");nodeBase.flow.setAttribute("Note","");nodeBase.flow.setAttribute("FlowRate","0");nodeBase.flow.setAttribute("OnlyPositive","true");nodeBase.flow.setAttribute("TimeIndependent","false");setValuedProperties(nodeBase.flow);nodeBase.link=doc.createElement("Link");nodeBase.link.setAttribute("name","Link");nodeBase.link.setAttribute("Note","");nodeBase.link.setAttribute("BiDirectional","false");nodeBase.setting=doc.createElement("Setting");nodeBase.setting.setAttribute("Note","");nodeBase.setting.setAttribute("Version","37");nodeBase.setting.setAttribute("Throttle","1");nodeBase.setting.setAttribute("TimeLength","100");nodeBase.setting.setAttribute("TimeStart","0");nodeBase.setting.setAttribute("TimeStep","1");nodeBase.setting.setAttribute("TimeUnits","Years");nodeBase.setting.setAttribute("Units","");nodeBase.setting.setAttribute("SolutionAlgorithm","RK1");nodeBase.setting.setAttribute("BackgroundColor","white");nodeBase.setting.setAttribute("Macros","");nodeBase.setting.setAttribute("SensitivityPrimitives","");nodeBase.setting.setAttribute("SensitivityRuns","50");nodeBase.setting.setAttribute("SensitivityBounds","50, 80, 95, 100");nodeBase.setting.setAttribute("SensitivityShowRuns","false");nodeBase.setting.setAttribute("StyleSheet","{}");class Results{constructor(ee,re){this._data=ee,this._nameIdMapping=re,this.timeUnits=ee.timeUnits;for(let ne=0;ne<this._data.data.length;ne++){let ie=this._data.data[ne];for(let oe in ie)ie[oe]=simplifyResults(ie[oe])}}times(){return this._data.times.slice()}table(ee){if(ee){let re=ee.map(oe=>({primitive:oe,series:this.series(oe)})),ne=this.times(),ie=[];for(let oe=0;oe<ne.length;oe++){let fe={_time:ne[oe]};for(let ue of re)fe[ue.primitive.name]=ue.series[oe];ie.push(fe)}return ie}else{let re=[];for(let ne=0;ne<this._data.data.length;ne++){let ie={};ie._time=this._data.times[ne];let oe=this._data.data[ne];for(let fe in oe)ie[this._nameIdMapping[fe]]=oe[fe];re.push(ie)}return re}}series(ee){return this._data.value(ee._node).slice()}value(ee,re=null){let ne=this.series(ee);if(re===null)return ne[ne.length-1];let ie=this.times(),oe=ie.indexOf(re);if(oe===-1)throw new Error("Could not find time: "+re+". Available options are: "+JSON.stringify(ie));return ne[oe]}}function simplifyResults(te){if(te instanceof Vector)if(te.names){let ee={};for(let re=0;re<te.names.length;re++)ee[te.names[re]]=simplifyResults(te.items[re]);return ee}else return te.items.map(simplifyResults);return te}class SimulationError extends Error{constructor(ee,re){super(ee),Error.captureStackTrace&&Error.captureStackTrace(this,SimulationError),this.name="SimulationError",this.primitive=re.primitive,this.code=re.code,Object.defineProperty(this,"code",{enumerable:!1}),Object.defineProperty(this,"primitive",{enumerable:!1})}}class Model{constructor(ee={}){this._graph=new ModelNode,this._graph.id="1",this._graph.addChild(new ModelNode),this._graph.children[0].addChild(new ModelNode),this.settings=this._createNode("setting"),this.p=ee.primitiveFn||primitives;for(let re in excludeKeys(ee,["primitiveFn"]))if(re in this)this[re]=ee[re];else throw new Error("Unknown model property: "+re)}_createNode(ee){let re=this._graph.children[0].children[0],ne=modelNodeClone(nodeBase[ee],re);return re.addChild(ne),ne}_createConnector(ee,re,ne){let ie=this._graph.children[0].children[0];re&&(ie=re._node.parent),ne&&(ie=ne._node.parent);let oe=modelNodeClone(nodeBase[ee],ie);return ie.addChild(oe),re?oe.source=re._node:oe.source=null,ne?oe.target=ne._node:oe.target=null,oe}simulate(){let re=runSimulation({silent:!0,model:this});if(re.error){let oe={code:re.errorCode};throw re.errorPrimitive&&(oe.primitive=this.get(fe=>fe.id===re.errorPrimitive.id)),new SimulationError(re.error,oe)}let ne=this.find(),ie={};for(let oe of ne)ie[oe.id]=oe.name;return new Results(re,ie)}Stock(ee={}){let re=this._createNode("stock").primitive(this,excludeKeys(ee,["name"]));return re.name=ee.name||"New Stock",re.model=this,re}Variable(ee={}){let re=this._createNode("variable").primitive(this,excludeKeys(ee,["name"]));return re.name=ee.name||"New Variable",re.model=this,re}Converter(ee={}){let re=this._createNode("converter").primitive(this,excludeKeys(ee,["name"]));return re.name=ee.name||"New Converter",re.model=this,re}State(ee={}){let re=this._createNode("state").primitive(this,excludeKeys(ee,["name"]));return re.name=ee.name||"New State",re.model=this,re}Action(ee={}){let re=this._createNode("action").primitive(this,excludeKeys(ee,["name"]));return re.name=ee.name||"New Action",re.model=this,re}Population(ee={}){let re=this._createNode("agents").primitive(this,excludeKeys(ee,["name"]));return re.name=ee.name||"New Population",re.model=this,re}Flow(ee,re,ne={}){let ie=this._createConnector("flow",ee||ne.start||null,re||ne.end||null).primitive(this,excludeKeys(ne,["name","start","end"]));return ie.name=ne.name||"New Flow",ie.model=this,ie}Transition(ee,re,ne={}){let ie=this._createConnector("transition",ee||ne.start||null,re||ne.end||null).primitive(this,excludeKeys(ne,["name","start","end"]));return ie.name=ne.name||"New Transition",ie.model=this,ie}Link(ee,re,ne={}){let ie=this._createConnector("link",ee||ne.start||null,re||ne.end||null).primitive(this,excludeKeys(ne,["name","start","end"]));return ie.name=ne.name||"Link",ie.model=this,ie}Agent(ee={}){let re=this._createNode("folder");re.setAttribute("Type","Agent");let ne=re.primitive(this,excludeKeys(ee,["name"]));return ne.name=ee.name||"New Agent",ne.model=this,ne}Folder(ee={}){let re=this._createNode("folder").primitive(this,excludeKeys(ee,["name"]));return re.name=ee.name||"New Folder",re.model=this,re._node.setAttribute("Type","None"),re}getId(ee){return this.get(re=>re.id===ee)}get(ee){let ne=this.p(this._graph).find(ie=>ie.primitive()&&ee(ie.primitive()));return ne?ne.primitive():null}getLink(ee){let ne=this.p(this._graph,"Link").find(ie=>ee(ie.primitive()));return ne?ne.primitive():null}getFlow(ee){let ne=this.p(this._graph,"Flow").find(ie=>ee(ie.primitive()));return ne?ne.primitive():null}getTransition(ee){let ne=this.p(this._graph,"Transition").find(ie=>ee(ie.primitive()));return ne?ne.primitive():null}getStock(ee){let ne=this.p(this._graph,"Stock").find(ie=>ee(ie.primitive()));return ne?ne.primitive():null}getVariable(ee){let ne=this.p(this._graph,"Variable").find(ie=>ee(ie.primitive()));return ne?ne.primitive():null}getConverter(ee){let ne=this.p(this._graph,"Converter").find(ie=>ee(ie.primitive()));return ne?ne.primitive():null}getState(ee){let ne=this.p(this._graph,"State").find(ie=>ee(ie.primitive()));return ne?ne.primitive():null}getAction(ee){let ne=this.p(this._graph,"Action").find(ie=>ee(ie.primitive()));return ne?ne.primitive():null}getPopulation(ee){let ne=this.p(this._graph,"Agents").find(ie=>ee(ie.primitive()));return ne?ne.primitive():null}getFolder(ee){let ne=this.p(this._graph,"Folder").filter(ie=>ie.getAttribute("Type")!=="Agent").find(ie=>ee(ie.primitive()));return ne?ne.primitive():null}getAgent(ee){let ne=this.p(this._graph,"Folder").filter(ie=>ie.getAttribute("Type")==="Agent").find(ie=>ee(ie.primitive()));return ne?ne.primitive():null}find(ee=()=>!0){return this.p(this._graph).filter(ne=>ne.primitive()&&ee(ne.primitive())).map(ne=>ne.primitive())}findLinks(ee=()=>!0){return this.p(this._graph,"Link").filter(ne=>ee(ne.primitive())).map(ne=>ne.primitive())}findFlows(ee=()=>!0){return this.p(this._graph,"Flow").filter(ne=>ee(ne.primitive())).map(ne=>ne.primitive())}findTransitions(ee=()=>!0){return this.p(this._graph,"Transition").filter(ne=>ee(ne.primitive())).map(ne=>ne.primitive())}findStocks(ee=()=>!0){return this.p(this._graph,"Stock").filter(ne=>ee(ne.primitive())).map(ne=>ne.primitive())}findVariables(ee=()=>!0){return this.p(this._graph,"Variable").filter(ne=>ee(ne.primitive())).map(ne=>ne.primitive())}findConverters(ee=()=>!0){return this.p(this._graph,"Converter").filter(ne=>ee(ne.primitive())).map(ne=>ne.primitive())}findStates(ee=()=>!0){return this.p(this._graph,"State").filter(ne=>ee(ne.primitive())).map(ne=>ne.primitive())}findActions(ee=()=>!0){return this.p(this._graph,"Action").filter(ne=>ee(ne.primitive())).map(ne=>ne.primitive())}findPopulations(ee=()=>!0){return this.p(this._graph,"Agents").filter(ne=>ee(ne.primitive())).map(ne=>ne.primitive())}findFolders(ee=()=>!0){return this.p(this._graph,"Folder").filter(ne=>ne.getAttribute("Type")!=="Agent").filter(ne=>ee(ne.primitive())).map(ne=>ne.primitive())}findAgents(ee=()=>!0){return this.p(this._graph,"Folder").filter(ne=>ne.getAttribute("Type")==="Agent").filter(ne=>ee(ne.primitive())).map(ne=>ne.primitive())}get timeStart(){return+this.settings.getAttribute("TimeStart")}set timeStart(ee){this.settings.setAttribute("TimeStart",ee)}get timeLength(){return+this.settings.getAttribute("TimeLength")}set timeLength(ee){this.settings.setAttribute("TimeLength",ee)}get timePause(){return+this.settings.getAttribute("TimePause")}set timePause(ee){this.settings.setAttribute("TimePause",ee)}get timeStep(){return+this.settings.getAttribute("TimeStep")}set timeStep(ee){this.settings.setAttribute("TimeStep",ee)}get timeUnits(){return this.settings.getAttribute("TimeUnits")}set timeUnits(ee){this.settings.setAttribute("TimeUnits",ee)}get algorithm(){let ee=this.settings.getAttribute("SolutionAlgorithm");return ee==="RK1"?"Euler":ee}set algorithm(ee){let re;ee==="Euler"?re="RK1":re=ee,this.settings.setAttribute("SolutionAlgorithm",re)}get globals(){return this.settings.getAttribute("Macros")||""}set globals(ee){this.settings.setAttribute("Macros",ee)}get customUnits(){return(this.settings.getAttribute("Units")||"").split(`
`).filter(ee=>!!ee).map(ee=>{let re=ee.split("<>");return{name:re[0],scale:+re[1],target:re[2]}})}set customUnits(ee){this.settings.setAttribute("Units",ee.map(re=>re.name+"<>"+re.scale+"<>"+re.target).join(`
`))}}function excludeKeys(te,ee){let re={};for(let ne in te)ee.includes(ne)||(re[ne]=te[ne]);return re}function formatProdErrorMessage(te){return"Minified Redux error #"+te+"; visit https://redux.js.org/Errors?code="+te+" for the full message or use the non-minified dev environment for full errors. "}var $$observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),randomString=function(){return Math.random().toString(36).substring(7).split("").join(".")},ActionTypes={INIT:"@@redux/INIT"+randomString(),REPLACE:"@@redux/REPLACE"+randomString(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+randomString()}};function isPlainObject(te){if(typeof te!="object"||te===null)return!1;for(var ee=te;Object.getPrototypeOf(ee)!==null;)ee=Object.getPrototypeOf(ee);return Object.getPrototypeOf(te)===ee}function createStore(te,ee,re){var ne;if(typeof ee=="function"&&typeof re=="function"||typeof re=="function"&&typeof arguments[3]=="function")throw new Error(formatProdErrorMessage(0));if(typeof ee=="function"&&typeof re>"u"&&(re=ee,ee=void 0),typeof re<"u"){if(typeof re!="function")throw new Error(formatProdErrorMessage(1));return re(createStore)(te,ee)}if(typeof te!="function")throw new Error(formatProdErrorMessage(2));var ie=te,oe=ee,fe=[],ue=fe,ae=!1;function se(){ue===fe&&(ue=fe.slice())}function ce(){if(ae)throw new Error(formatProdErrorMessage(3));return oe}function le(ve){if(typeof ve!="function")throw new Error(formatProdErrorMessage(4));if(ae)throw new Error(formatProdErrorMessage(5));var we=!0;return se(),ue.push(ve),function(){if(we){if(ae)throw new Error(formatProdErrorMessage(6));we=!1,se();var _e=ue.indexOf(ve);ue.splice(_e,1),fe=null}}}function pe(ve){if(!isPlainObject(ve))throw new Error(formatProdErrorMessage(7));if(typeof ve.type>"u")throw new Error(formatProdErrorMessage(8));if(ae)throw new Error(formatProdErrorMessage(9));try{ae=!0,oe=ie(oe,ve)}finally{ae=!1}for(var we=fe=ue,ge=0;ge<we.length;ge++){var _e=we[ge];_e()}return ve}function de(ve){if(typeof ve!="function")throw new Error(formatProdErrorMessage(10));ie=ve,pe({type:ActionTypes.REPLACE})}function me(){var ve,we=le;return ve={subscribe:function(_e){if(typeof _e!="object"||_e===null)throw new Error(formatProdErrorMessage(11));function Te(){_e.next&&_e.next(ce())}Te();var Ne=we(Te);return{unsubscribe:Ne}}},ve[$$observable]=function(){return this},ve}return pe({type:ActionTypes.INIT}),ne={dispatch:pe,subscribe:le,getState:ce,replaceReducer:de},ne[$$observable]=me,ne}function commonjsRequire(te){throw new Error('Could not dynamically require "'+te+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var flexsearch_bundle={exports:{}};flexsearch_bundle.exports;(function(module){(function _f(self){try{module&&(self=module)}catch(te){}self._factory=_f;var t;function u(te){return typeof te<"u"?te:!0}function aa(te){const ee=Array(te);for(let re=0;re<te;re++)ee[re]=v();return ee}function v(){return Object.create(null)}function ba(te,ee){return ee.length-te.length}function x(te){return typeof te=="string"}function C(te){return typeof te=="object"}function D(te){return typeof te=="function"}function ca(te,ee){var re=da;if(te&&(ee&&(te=E(te,ee)),this.H&&(te=E(te,this.H)),this.J&&1<te.length&&(te=E(te,this.J)),re||re==="")){if(te=te.split(re),this.filter){ee=this.filter,re=te.length;const ne=[];for(let ie=0,oe=0;ie<re;ie++){const fe=te[ie];fe&&!ee[fe]&&(ne[oe++]=fe)}te=ne}return te}return te}const da=/[\p{Z}\p{S}\p{P}\p{C}]+/u,ea=/[\u0300-\u036f]/g;function fa(te,ee){const re=Object.keys(te),ne=re.length,ie=[];let oe="",fe=0;for(let ue=0,ae,se;ue<ne;ue++)ae=re[ue],(se=te[ae])?(ie[fe++]=F(ee?"(?!\\b)"+ae+"(\\b|_)":ae),ie[fe++]=se):oe+=(oe?"|":"")+ae;return oe&&(ie[fe++]=F(ee?"(?!\\b)("+oe+")(\\b|_)":"("+oe+")"),ie[fe]=""),ie}function E(te,ee){for(let re=0,ne=ee.length;re<ne&&(te=te.replace(ee[re],ee[re+1]),te);re+=2);return te}function F(te){return new RegExp(te,"g")}function ha(te){let ee="",re="";for(let ne=0,ie=te.length,oe;ne<ie;ne++)(oe=te[ne])!==re&&(ee+=re=oe);return ee}var ja={encode:ia,F:!1,G:""};function ia(te){return ca.call(this,(""+te).toLowerCase(),!1)}const ka={},G={};function la(te){I(te,"add"),I(te,"append"),I(te,"search"),I(te,"update"),I(te,"remove")}function I(te,ee){te[ee+"Async"]=function(){const re=this,ne=arguments;var ie=ne[ne.length-1];let oe;return D(ie)&&(oe=ie,delete ne[ne.length-1]),ie=new Promise(function(fe){setTimeout(function(){re.async=!0;const ue=re[ee].apply(re,ne);re.async=!1,fe(ue)})}),oe?(ie.then(oe),this):ie}}function ma(te,ee,re,ne){const ie=te.length;let oe=[],fe,ue,ae=0;ne&&(ne=[]);for(let se=ie-1;0<=se;se--){const ce=te[se],le=ce.length,pe=v();let de=!fe;for(let me=0;me<le;me++){const ve=ce[me],we=ve.length;if(we)for(let ge=0,_e,Te;ge<we;ge++)if(Te=ve[ge],fe){if(fe[Te]){if(!se){if(re)re--;else if(oe[ae++]=Te,ae===ee)return oe}(se||ne)&&(pe[Te]=1),de=!0}if(ne&&(ue[Te]=(_e=ue[Te])?++_e:_e=1,_e<ie)){const Ne=ne[_e-2]||(ne[_e-2]=[]);Ne[Ne.length]=Te}}else pe[Te]=1}if(ne)fe||(ue=pe);else if(!de)return[];fe=pe}if(ne)for(let se=ne.length-1,ce,le;0<=se;se--){ce=ne[se],le=ce.length;for(let pe=0,de;pe<le;pe++)if(de=ce[pe],!fe[de]){if(re)re--;else if(oe[ae++]=de,ae===ee)return oe;fe[de]=1}}return oe}function na(te,ee){const re=v(),ne=v(),ie=[];for(let oe=0;oe<te.length;oe++)re[te[oe]]=1;for(let oe=0,fe;oe<ee.length;oe++){fe=ee[oe];for(let ue=0,ae;ue<fe.length;ue++)ae=fe[ue],re[ae]&&!ne[ae]&&(ne[ae]=1,ie[ie.length]=ae)}return ie}function J(te){this.l=te!==!0&&te,this.cache=v(),this.h=[]}function oa(te,ee,re){C(te)&&(te=te.query);let ne=this.cache.get(te);return ne||(ne=this.search(te,ee,re),this.cache.set(te,ne)),ne}J.prototype.set=function(te,ee){if(!this.cache[te]){var re=this.h.length;for(re===this.l?delete this.cache[this.h[re-1]]:re++,--re;0<re;re--)this.h[re]=this.h[re-1];this.h[0]=te}this.cache[te]=ee},J.prototype.get=function(te){const ee=this.cache[te];if(this.l&&ee&&(te=this.h.indexOf(te))){const re=this.h[te-1];this.h[te-1]=this.h[te],this.h[te]=re}return ee};const qa={memory:{charset:"latin:extra",D:3,B:4,m:!1},performance:{D:3,B:3,s:!1,context:{depth:2,D:1}},match:{charset:"latin:extra",G:"reverse"},score:{charset:"latin:advanced",D:20,B:3,context:{depth:3,D:9}},default:{}};function ra(te,ee,re,ne,ie,oe){setTimeout(function(){const fe=te(re,JSON.stringify(oe));fe&&fe.then?fe.then(function(){ee.export(te,ee,re,ne,ie+1)}):ee.export(te,ee,re,ne,ie+1)})}function K(te,ee){if(!(this instanceof K))return new K(te);var re;if(te){x(te)?te=qa[te]:(re=te.preset)&&(te=Object.assign({},re[re],te)),re=te.charset;var ne=te.lang;x(re)&&(re.indexOf(":")===-1&&(re+=":default"),re=G[re]),x(ne)&&(ne=ka[ne])}else te={};let ie,oe,fe=te.context||{};if(this.encode=te.encode||re&&re.encode||ia,this.register=ee||v(),this.D=ie=te.resolution||9,this.G=ee=re&&re.G||te.tokenize||"strict",this.depth=ee==="strict"&&fe.depth,this.l=u(fe.bidirectional),this.s=oe=u(te.optimize),this.m=u(te.fastupdate),this.B=te.minlength||1,this.C=te.boost,this.map=oe?aa(ie):v(),this.A=ie=fe.resolution||1,this.h=oe?aa(ie):v(),this.F=re&&re.F||te.rtl,this.H=(ee=te.matcher||ne&&ne.H)&&fa(ee,!1),this.J=(ee=te.stemmer||ne&&ne.J)&&fa(ee,!0),re=ee=te.filter||ne&&ne.filter){re=ee,ne=v();for(let ue=0,ae=re.length;ue<ae;ue++)ne[re[ue]]=1;re=ne}this.filter=re,this.cache=(ee=te.cache)&&new J(ee)}t=K.prototype,t.append=function(te,ee){return this.add(te,ee,!0)},t.add=function(te,ee,re,ne){if(ee&&(te||te===0)){if(!ne&&!re&&this.register[te])return this.update(te,ee);if(ee=this.encode(ee),ne=ee.length){const se=v(),ce=v(),le=this.depth,pe=this.D;for(let de=0;de<ne;de++){let me=ee[this.F?ne-1-de:de];var ie=me.length;if(me&&ie>=this.B&&(le||!ce[me])){var oe=L(pe,ne,de),fe="";switch(this.G){case"full":if(3<ie){for(oe=0;oe<ie;oe++)for(var ue=ie;ue>oe;ue--)if(ue-oe>=this.B){var ae=L(pe,ne,de,ie,oe);fe=me.substring(oe,ue),M(this,ce,fe,ae,te,re)}break}case"reverse":if(2<ie){for(ue=ie-1;0<ue;ue--)fe=me[ue]+fe,fe.length>=this.B&&M(this,ce,fe,L(pe,ne,de,ie,ue),te,re);fe=""}case"forward":if(1<ie){for(ue=0;ue<ie;ue++)fe+=me[ue],fe.length>=this.B&&M(this,ce,fe,oe,te,re);break}default:if(this.C&&(oe=Math.min(oe/this.C(ee,me,de)|0,pe-1)),M(this,ce,me,oe,te,re),le&&1<ne&&de<ne-1){for(ie=v(),fe=this.A,oe=me,ue=Math.min(le+1,ne-de),ie[oe]=1,ae=1;ae<ue;ae++)if((me=ee[this.F?ne-1-de-ae:de+ae])&&me.length>=this.B&&!ie[me]){ie[me]=1;const ve=this.l&&me>oe;M(this,se,ve?oe:me,L(fe+(ne/2>fe?0:1),ne,de,ue-1,ae-1),te,re,ve?me:oe)}}}}}this.m||(this.register[te]=1)}}return this};function L(te,ee,re,ne,ie){return re&&1<te?ee+(ne||0)<=te?re+(ie||0):(te-1)/(ee+(ne||0))*(re+(ie||0))+1|0:0}function M(te,ee,re,ne,ie,oe,fe){let ue=fe?te.h:te.map;(!ee[re]||fe&&!ee[re][fe])&&(te.s&&(ue=ue[ne]),fe?(ee=ee[re]||(ee[re]=v()),ee[fe]=1,ue=ue[fe]||(ue[fe]=v())):ee[re]=1,ue=ue[re]||(ue[re]=[]),te.s||(ue=ue[ne]||(ue[ne]=[])),oe&&ue.indexOf(ie)!==-1||(ue[ue.length]=ie,te.m&&(te=te.register[ie]||(te.register[ie]=[]),te[te.length]=ue)))}t.search=function(te,ee,re){re||(!ee&&C(te)?(re=te,te=re.query):C(ee)&&(re=ee));let ne=[],ie,oe,fe=0;if(re){ee=re.limit,fe=re.offset||0;var ue=re.context;oe=re.suggest}if(te&&(te=this.encode(te),ie=te.length,1<ie)){re=v();var ae=[];for(let ce=0,le=0,pe;ce<ie;ce++)if((pe=te[ce])&&pe.length>=this.B&&!re[pe])if(this.s||oe||this.map[pe])ae[le++]=pe,re[pe]=1;else return ne;te=ae,ie=te.length}if(!ie)return ne;ee||(ee=100),ue=this.depth&&1<ie&&ue!==!1,re=0;let se;ue?(se=te[0],re=1):1<ie&&te.sort(ba);for(let ce,le;re<ie;re++){if(le=te[re],ue?(ce=sa(this,ne,oe,ee,fe,ie===2,le,se),oe&&ce===!1&&ne.length||(se=le)):ce=sa(this,ne,oe,ee,fe,ie===1,le),ce)return ce;if(oe&&re===ie-1){if(ae=ne.length,!ae){if(ue){ue=0,re=-1;continue}return ne}if(ae===1)return ta(ne[0],ee,fe)}}return ma(ne,ee,fe,oe)};function sa(te,ee,re,ne,ie,oe,fe,ue){let ae=[],se=ue?te.h:te.map;if(te.s||(se=ua(se,fe,ue,te.l)),se){let ce=0;const le=Math.min(se.length,ue?te.A:te.D);for(let pe=0,de=0,me,ve;pe<le&&!((me=se[pe])&&(te.s&&(me=ua(me,fe,ue,te.l)),ie&&me&&oe&&(ve=me.length,ve<=ie?(ie-=ve,me=null):(me=me.slice(ie),ie=0)),me&&(ae[ce++]=me,oe&&(de+=me.length,de>=ne))));pe++);if(ce){if(oe)return ta(ae,ne,0);ee[ee.length]=ae;return}}return!re&&ae}function ta(te,ee,re){return te=te.length===1?te[0]:[].concat.apply([],te),re||te.length>ee?te.slice(re,re+ee):te}function ua(te,ee,re,ne){return re?(ne=ne&&ee>re,te=(te=te[ne?ee:re])&&te[ne?re:ee]):te=te[ee],te}t.contain=function(te){return!!this.register[te]},t.update=function(te,ee){return this.remove(te).add(te,ee)},t.remove=function(te,ee){const re=this.register[te];if(re){if(this.m)for(let ne=0,ie;ne<re.length;ne++)ie=re[ne],ie.splice(ie.indexOf(te),1);else N(this.map,te,this.D,this.s),this.depth&&N(this.h,te,this.A,this.s);if(ee||delete this.register[te],this.cache){ee=this.cache;for(let ne=0,ie,oe;ne<ee.h.length;ne++)oe=ee.h[ne],ie=ee.cache[oe],ie.indexOf(te)!==-1&&(ee.h.splice(ne--,1),delete ee.cache[oe])}}return this};function N(te,ee,re,ne,ie){let oe=0;if(te.constructor===Array)if(ie)ee=te.indexOf(ee),ee!==-1?1<te.length&&(te.splice(ee,1),oe++):oe++;else{ie=Math.min(te.length,re);for(let fe=0,ue;fe<ie;fe++)(ue=te[fe])&&(oe=N(ue,ee,re,ne,ie),ne||oe||delete te[fe])}else for(let fe in te)(oe=N(te[fe],ee,re,ne,ie))||delete te[fe];return oe}t.searchCache=oa,t.export=function(te,ee,re,ne,ie){let oe,fe;switch(ie||(ie=0)){case 0:if(oe="reg",this.m){fe=v();for(let ue in this.register)fe[ue]=1}else fe=this.register;break;case 1:oe="cfg",fe={doc:0,opt:this.s?1:0};break;case 2:oe="map",fe=this.map;break;case 3:oe="ctx",fe=this.h;break;default:return}return ra(te,ee||this,re?re+"."+oe:oe,ne,ie,fe),!0},t.import=function(te,ee){if(ee)switch(x(ee)&&(ee=JSON.parse(ee)),te){case"cfg":this.s=!!ee.opt;break;case"reg":this.m=!1,this.register=ee;break;case"map":this.map=ee;break;case"ctx":this.h=ee}},la(K.prototype);function va(te){te=te.data;var ee=self._index;const re=te.args;var ne=te.task;switch(ne){case"init":ne=te.options||{},te=te.factory,ee=ne.encode,ne.cache=!1,ee&&ee.indexOf("function")===0&&(ne.encode=Function("return "+ee)()),te?(Function("return "+te)()(self),self._index=new self.FlexSearch.Index(ne),delete self.FlexSearch):self._index=new K(ne);break;default:te=te.id,ee=ee[ne].apply(ee,re),postMessage(ne==="search"?{id:te,msg:ee}:{id:te})}}let wa=0;function O(te){if(!(this instanceof O))return new O(te);var ee;te?D(ee=te.encode)&&(te.encode=ee.toString()):te={},(ee=(self||window)._factory)&&(ee=ee.toString());const re=self.exports,ne=this;this.o=xa(ee,re,te.worker),this.h=v(),this.o&&(re?this.o.on("message",function(ie){ne.h[ie.id](ie.msg),delete ne.h[ie.id]}):this.o.onmessage=function(ie){ie=ie.data,ne.h[ie.id](ie.msg),delete ne.h[ie.id]},this.o.postMessage({task:"init",factory:ee,options:te}))}P("add"),P("append"),P("search"),P("update"),P("remove");function P(te){O.prototype[te]=O.prototype[te+"Async"]=function(){const ee=this,re=[].slice.call(arguments);var ne=re[re.length-1];let ie;return D(ne)&&(ie=ne,re.splice(re.length-1,1)),ne=new Promise(function(oe){setTimeout(function(){ee.h[++wa]=oe,ee.o.postMessage({task:te,id:wa,args:re})})}),ie?(ne.then(ie),this):ne}}function xa(a,b,c){let d;try{d=b?eval('new (require("worker_threads")["Worker"])("../dist/node/node.js")'):a?new Worker(URL.createObjectURL(new Blob(["onmessage="+va.toString()],{type:"text/javascript"}))):new Worker(x(c)?c:"worker/worker.js",{type:"module"})}catch(te){}return d}function Q(te){if(!(this instanceof Q))return new Q(te);var ee=te.document||te.doc||te,re;this.K=[],this.h=[],this.A=[],this.register=v(),this.key=(re=ee.key||ee.id)&&S(re,this.A)||"id",this.m=u(te.fastupdate),this.C=(re=ee.store)&&re!==!0&&[],this.store=re&&v(),this.I=(re=ee.tag)&&S(re,this.A),this.l=re&&v(),this.cache=(re=te.cache)&&new J(re),te.cache=!1,this.o=te.worker,this.async=!1,re=v();let ne=ee.index||ee.field||ee;x(ne)&&(ne=[ne]);for(let ie=0,oe,fe;ie<ne.length;ie++)oe=ne[ie],x(oe)||(fe=oe,oe=oe.field),fe=C(fe)?Object.assign({},te,fe):te,this.o&&(re[oe]=new O(fe),re[oe].o||(this.o=!1)),this.o||(re[oe]=new K(fe,this.register)),this.K[ie]=S(oe,this.A),this.h[ie]=oe;if(this.C)for(te=ee.store,x(te)&&(te=[te]),ee=0;ee<te.length;ee++)this.C[ee]=S(te[ee],this.A);this.index=re}function S(te,ee){const re=te.split(":");let ne=0;for(let ie=0;ie<re.length;ie++)te=re[ie],0<=te.indexOf("[]")&&(te=te.substring(0,te.length-2))&&(ee[ne]=!0),te&&(re[ne++]=te);return ne<re.length&&(re.length=ne),1<ne?re:re[0]}function T(te,ee){if(x(ee))te=te[ee];else for(let re=0;te&&re<ee.length;re++)te=te[ee[re]];return te}function U(te,ee,re,ne,ie){if(te=te[ie],ne===re.length-1)ee[ie]=te;else if(te)if(te.constructor===Array)for(ee=ee[ie]=Array(te.length),ie=0;ie<te.length;ie++)U(te,ee,re,ne,ie);else ee=ee[ie]||(ee[ie]=v()),ie=re[++ne],U(te,ee,re,ne,ie)}function V(te,ee,re,ne,ie,oe,fe,ue){if(te=te[fe])if(ne===ee.length-1){if(te.constructor===Array){if(re[ne]){for(ee=0;ee<te.length;ee++)ie.add(oe,te[ee],!0,!0);return}te=te.join(" ")}ie.add(oe,te,ue,!0)}else if(te.constructor===Array)for(fe=0;fe<te.length;fe++)V(te,ee,re,ne,ie,oe,fe,ue);else fe=ee[++ne],V(te,ee,re,ne,ie,oe,fe,ue)}t=Q.prototype,t.add=function(te,ee,re){if(C(te)&&(ee=te,te=T(ee,this.key)),ee&&(te||te===0)){if(!re&&this.register[te])return this.update(te,ee);for(let ne=0,ie,oe;ne<this.h.length;ne++)oe=this.h[ne],ie=this.K[ne],x(ie)&&(ie=[ie]),V(ee,ie,this.A,0,this.index[oe],te,ie[0],re);if(this.I){let ne=T(ee,this.I),ie=v();x(ne)&&(ne=[ne]);for(let oe=0,fe,ue;oe<ne.length;oe++)if(fe=ne[oe],!ie[fe]&&(ie[fe]=1,ue=this.l[fe]||(this.l[fe]=[]),!re||ue.indexOf(te)===-1)&&(ue[ue.length]=te,this.m)){const ae=this.register[te]||(this.register[te]=[]);ae[ae.length]=ue}}if(this.store&&(!re||!this.store[te])){let ne;if(this.C){ne=v();for(let ie=0,oe;ie<this.C.length;ie++)oe=this.C[ie],x(oe)?ne[oe]=ee[oe]:U(ee,ne,oe,0,oe[0])}this.store[te]=ne||ee}}return this},t.append=function(te,ee){return this.add(te,ee,!0)},t.update=function(te,ee){return this.remove(te).add(te,ee)},t.remove=function(te){if(C(te)&&(te=T(te,this.key)),this.register[te]){for(var ee=0;ee<this.h.length&&(this.index[this.h[ee]].remove(te,!this.o),!this.m);ee++);if(this.I&&!this.m)for(let re in this.l){ee=this.l[re];const ne=ee.indexOf(te);ne!==-1&&(1<ee.length?ee.splice(ne,1):delete this.l[re])}this.store&&delete this.store[te],delete this.register[te]}return this},t.search=function(te,ee,re,ne){re||(!ee&&C(te)?(re=te,te=re.query):C(ee)&&(re=ee,ee=0));let ie=[],oe=[],fe,ue,ae,se,ce,le,pe=0;if(re)if(re.constructor===Array)ae=re,re=null;else{if(ae=(fe=re.pluck)||re.index||re.field,se=re.tag,ue=this.store&&re.enrich,ce=re.bool==="and",ee=re.limit||100,le=re.offset||0,se&&(x(se)&&(se=[se]),!te)){for(let me=0,ve;me<se.length;me++)(ve=ya.call(this,se[me],ee,le,ue))&&(ie[ie.length]=ve,pe++);return pe?ie:[]}x(ae)&&(ae=[ae])}ae||(ae=this.h),ce=ce&&(1<ae.length||se&&1<se.length);const de=!ne&&(this.o||this.async)&&[];for(let me=0,ve,we,ge;me<ae.length;me++){let _e;if(we=ae[me],x(we)||(_e=we,we=we.field),de)de[me]=this.index[we].searchAsync(te,ee,_e||re);else{if(ne?ve=ne[me]:ve=this.index[we].search(te,ee,_e||re),ge=ve&&ve.length,se&&ge){const Te=[];let Ne=0;ce&&(Te[0]=[ve]);for(let Le=0,Oe,xe;Le<se.length;Le++)Oe=se[Le],(ge=(xe=this.l[Oe])&&xe.length)&&(Ne++,Te[Te.length]=ce?[xe]:xe);Ne&&(ve=ce?ma(Te,ee||100,le||0):na(ve,Te),ge=ve.length)}if(ge)oe[pe]=we,ie[pe++]=ve;else if(ce)return[]}}if(de){const me=this;return new Promise(function(ve){Promise.all(de).then(function(we){ve(me.search(te,ee,re,we))})})}if(!pe)return[];if(fe&&(!ue||!this.store))return ie[0];for(let me=0,ve;me<oe.length;me++){if(ve=ie[me],ve.length&&ue&&(ve=za.call(this,ve)),fe)return ve;ie[me]={field:oe[me],result:ve}}return ie};function ya(te,ee,re,ne){let ie=this.l[te],oe=ie&&ie.length-re;if(oe&&0<oe)return(oe>ee||re)&&(ie=ie.slice(re,re+ee)),ne&&(ie=za.call(this,ie)),{tag:te,result:ie}}function za(te){const ee=Array(te.length);for(let re=0,ne;re<te.length;re++)ne=te[re],ee[re]={id:ne,doc:this.store[ne]};return ee}t.contain=function(te){return!!this.register[te]},t.get=function(te){return this.store[te]},t.set=function(te,ee){return this.store[te]=ee,this},t.searchCache=oa,t.export=function(te,ee,re,ne,ie){if(ie||(ie=0),ne||(ne=0),ne<this.h.length){const oe=this.h[ne],fe=this.index[oe];ee=this,setTimeout(function(){fe.export(te,ee,ie?oe.replace(":","-"):"",ne,ie++)||(ne++,ie=1,ee.export(te,ee,oe,ne,ie))})}else{let oe;switch(ie){case 1:re="tag",oe=this.l;break;case 2:re="store",oe=this.store;break;default:return}ra(te,this,re,ne,ie,oe)}},t.import=function(te,ee){if(ee)switch(x(ee)&&(ee=JSON.parse(ee)),te){case"tag":this.l=ee;break;case"reg":this.m=!1,this.register=ee;for(let ne=0,ie;ne<this.h.length;ne++)ie=this.index[this.h[ne]],ie.register=ee,ie.m=!1;break;case"store":this.store=ee;break;default:te=te.split(".");const re=te[0];te=te[1],re&&te&&this.index[re].import(te,ee)}},la(Q.prototype);var Ba={encode:Aa,F:!1,G:""};const Ca=[F("[]"),"a",F("[]"),"e",F("[]"),"i",F("[]"),"o",F("[]"),"u",F("[]"),"y",F(""),"n",F("[c]"),"k",F(""),"s",F(" & ")," and "];function Aa(te){var ee=te;return ee.normalize&&(ee=ee.normalize("NFD").replace(ea,"")),ca.call(this,ee.toLowerCase(),!te.normalize&&Ca)}var Ea={encode:Da,F:!1,G:"strict"};const Fa=/[^a-z0-9]+/,Ga={b:"p",v:"f",w:"f",z:"s",x:"s",:"s",d:"t",n:"m",c:"k",g:"k",j:"k",q:"k",i:"e",y:"e",u:"o"};function Da(te){te=Aa.call(this,te).join(" ");const ee=[];if(te){const re=te.split(Fa),ne=re.length;for(let ie=0,oe,fe=0;ie<ne;ie++)if((te=re[ie])&&(!this.filter||!this.filter[te])){oe=te[0];let ue=Ga[oe]||oe,ae=ue;for(let se=1;se<te.length;se++){oe=te[se];const ce=Ga[oe]||oe;ce&&ce!==ae&&(ue+=ce,ae=ce)}ee[fe++]=ue}}return ee}var Ia={encode:Ha,F:!1,G:""};const Ja=[F("ae"),"a",F("oe"),"o",F("sh"),"s",F("th"),"t",F("ph"),"f",F("pf"),"f",F("(?![aeo])h(?![aeo])"),"",F("(?!^[aeo])h(?!^[aeo])"),""];function Ha(te,ee){return te&&(te=Da.call(this,te).join(" "),2<te.length&&(te=E(te,Ja)),ee||(1<te.length&&(te=ha(te)),te&&(te=te.split(" ")))),te}var La={encode:Ka,F:!1,G:""};const Ma=F("(?!\\b)[aeo]");function Ka(te){return te&&(te=Ha.call(this,te,!0),1<te.length&&(te=te.replace(Ma,"")),1<te.length&&(te=ha(te)),te&&(te=te.split(" "))),te}G["latin:default"]=ja,G["latin:simple"]=Ba,G["latin:balance"]=Ea,G["latin:advanced"]=Ia,G["latin:extra"]=La;const W=self;let Y;const Z={Index:K,Document:Q,Worker:O,registerCharset:function(te,ee){G[te]=ee},registerLanguage:function(te,ee){ka[te]=ee}};(Y=W.define)&&Y.amd?Y([],function(){return Z}):W.exports?W.exports=Z:W.FlexSearch=Z})(commonjsGlobal)})(flexsearch_bundle);var flexsearch_bundleExports=flexsearch_bundle.exports;const FlexSearch=getDefaultExportFromCjs(flexsearch_bundleExports);var fuzzysort$1={exports:{}};(function(te){(function(ee,re){te.exports?te.exports=re():ee.fuzzysort=re()})(commonjsGlobal,function(){function re(ve){var we={single:function(ge,_e,Te){if(!ge||(pe(ge)||(ge=we.getPreparedSearch(ge)),!_e))return null;pe(_e)||(_e=we.getPrepared(_e));var Ne=Te&&Te.allowTypo!==void 0?Te.allowTypo:ve&&ve.allowTypo!==void 0?ve.allowTypo:!0,Le=Ne?we.algorithm:we.algorithmNoTypo;return Le(ge,_e,ge[0])},go:function(ge,_e,Te){if(!ge)return fe;ge=we.prepareSearch(ge);var Ne=ge[0],Le=Te&&Te.threshold||ve&&ve.threshold||-9007199254740991,Oe=Te&&Te.limit||ve&&ve.limit||9007199254740991,xe=Te&&Te.allowTypo!==void 0?Te.allowTypo:ve&&ve.allowTypo!==void 0?ve.allowTypo:!0,Se=xe?we.algorithm:we.algorithmNoTypo,be=0,De=0,Me=_e.length;if(Te&&Te.keys)for(var Ue=Te.scoreFn||ce,Ke=Te.keys,ft=Ke.length,qe=Me-1;qe>=0;--qe){for(var ot=_e[qe],nt=new Array(ft),Ze=ft-1;Ze>=0;--Ze){var Ge=Ke[Ze],et=le(ot,Ge);if(!et){nt[Ze]=null;continue}pe(et)||(et=we.getPrepared(et)),nt[Ze]=Se(ge,et,Ne)}nt.obj=ot;var tt=Ue(nt);tt!==null&&(tt<Le||(nt.score=tt,be<Oe?(me.add(nt),++be):(++De,tt>me.peek().score&&me.replaceTop(nt))))}else if(Te&&Te.key)for(var Ge=Te.key,qe=Me-1;qe>=0;--qe){var ot=_e[qe],et=le(ot,Ge);if(et){pe(et)||(et=we.getPrepared(et));var Ye=Se(ge,et,Ne);Ye!==null&&(Ye.score<Le||(Ye={target:Ye.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:Ye.score,indexes:Ye.indexes,obj:ot},be<Oe?(me.add(Ye),++be):(++De,Ye.score>me.peek().score&&me.replaceTop(Ye))))}}else for(var qe=Me-1;qe>=0;--qe){var et=_e[qe];if(et){pe(et)||(et=we.getPrepared(et));var Ye=Se(ge,et,Ne);Ye!==null&&(Ye.score<Le||(be<Oe?(me.add(Ye),++be):(++De,Ye.score>me.peek().score&&me.replaceTop(Ye))))}}if(be===0)return fe;for(var at=new Array(be),qe=be-1;qe>=0;--qe)at[qe]=me.poll();return at.total=be+De,at},goAsync:function(ge,_e,Te){var Ne=!1,Le=new Promise(function(Oe,xe){if(!ge)return Oe(fe);ge=we.prepareSearch(ge);var Se=ge[0],be=de(),De=_e.length-1,Me=Te&&Te.threshold||ve&&ve.threshold||-9007199254740991,Ue=Te&&Te.limit||ve&&ve.limit||9007199254740991,Ke=Te&&Te.allowTypo!==void 0?Te.allowTypo:ve&&ve.allowTypo!==void 0?ve.allowTypo:!0,ft=Ke?we.algorithm:we.algorithmNoTypo,qe=0,ot=0;function nt(){if(Ne)return xe("canceled");var Ze=Date.now();if(Te&&Te.keys)for(var Ge=Te.scoreFn||ce,et=Te.keys,tt=et.length;De>=0;--De){for(var Ye=_e[De],at=new Array(tt),Bt=tt-1;Bt>=0;--Bt){var Et=et[Bt],gt=le(Ye,Et);if(!gt){at[Bt]=null;continue}pe(gt)||(gt=we.getPrepared(gt)),at[Bt]=ft(ge,gt,Se)}at.obj=Ye;var Zt=Ge(at);if(Zt!==null&&!(Zt<Me)&&(at.score=Zt,qe<Ue?(be.add(at),++qe):(++ot,Zt>be.peek().score&&be.replaceTop(at)),De%1e3===0&&Date.now()-Ze>=10)){ne?setImmediate(nt):setTimeout(nt);return}}else if(Te&&Te.key)for(var Et=Te.key;De>=0;--De){var Ye=_e[De],gt=le(Ye,Et);if(gt){pe(gt)||(gt=we.getPrepared(gt));var Ot=ft(ge,gt,Se);if(Ot!==null&&!(Ot.score<Me)&&(Ot={target:Ot.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:Ot.score,indexes:Ot.indexes,obj:Ye},qe<Ue?(be.add(Ot),++qe):(++ot,Ot.score>be.peek().score&&be.replaceTop(Ot)),De%1e3===0&&Date.now()-Ze>=10)){ne?setImmediate(nt):setTimeout(nt);return}}}else for(;De>=0;--De){var gt=_e[De];if(gt){pe(gt)||(gt=we.getPrepared(gt));var Ot=ft(ge,gt,Se);if(Ot!==null&&!(Ot.score<Me)&&(qe<Ue?(be.add(Ot),++qe):(++ot,Ot.score>be.peek().score&&be.replaceTop(Ot)),De%1e3===0&&Date.now()-Ze>=10)){ne?setImmediate(nt):setTimeout(nt);return}}}if(qe===0)return Oe(fe);for(var Qe=new Array(qe),Rt=qe-1;Rt>=0;--Rt)Qe[Rt]=be.poll();Qe.total=qe+ot,Oe(Qe)}ne?setImmediate(nt):nt()});return Le.cancel=function(){Ne=!0},Le},highlight:function(ge,_e,Te){if(ge===null)return null;_e===void 0&&(_e="<b>"),Te===void 0&&(Te="</b>");for(var Ne="",Le=0,Oe=!1,xe=ge.target,Se=xe.length,be=ge.indexes,De=0;De<Se;++De){var Me=xe[De];if(be[Le]===De){if(++Le,Oe||(Oe=!0,Ne+=_e),Le===be.length){Ne+=Me+Te+xe.substr(De+1);break}}else Oe&&(Oe=!1,Ne+=Te);Ne+=Me}return Ne},prepare:function(ge){if(ge)return{target:ge,_targetLowerCodes:we.prepareLowerCodes(ge),_nextBeginningIndexes:null,score:null,indexes:null,obj:null}},prepareSlow:function(ge){if(ge)return{target:ge,_targetLowerCodes:we.prepareLowerCodes(ge),_nextBeginningIndexes:we.prepareNextBeginningIndexes(ge),score:null,indexes:null,obj:null}},prepareSearch:function(ge){if(ge)return we.prepareLowerCodes(ge)},getPrepared:function(ge){if(ge.length>999)return we.prepare(ge);var _e=ie.get(ge);return _e!==void 0||(_e=we.prepare(ge),ie.set(ge,_e)),_e},getPreparedSearch:function(ge){if(ge.length>999)return we.prepareSearch(ge);var _e=oe.get(ge);return _e!==void 0||(_e=we.prepareSearch(ge),oe.set(ge,_e)),_e},algorithm:function(ge,_e,Te){for(var Ne=_e._targetLowerCodes,Le=ge.length,Oe=Ne.length,Ue=0,xe=0,Se=0,be=0;;){var De=Te===Ne[xe];if(De){if(ue[be++]=xe,++Ue,Ue===Le)break;Te=ge[Se===0?Ue:Se===Ue?Ue+1:Se===Ue-1?Ue-1:Ue]}if(++xe,xe>=Oe)for(;;){if(Ue<=1)return null;if(Se===0){--Ue;var Me=ge[Ue];if(Te===Me)continue;Se=Ue}else{if(Se===1)return null;--Se,Ue=Se,Te=ge[Ue+1];var Me=ge[Ue];if(Te===Me)continue}be=Ue,xe=ue[be-1]+1;break}}var Ue=0,Ke=0,ft=!1,qe=0,ot=_e._nextBeginningIndexes;ot===null&&(ot=_e._nextBeginningIndexes=we.prepareNextBeginningIndexes(_e.target));var nt=xe=ue[0]===0?0:ot[ue[0]-1];if(xe!==Oe)for(;;)if(xe>=Oe){if(Ue<=0){if(++Ke,Ke>Le-2)break;if(ge[Ke]===ge[Ke+1])continue;xe=nt;continue}--Ue;var Ze=ae[--qe];xe=ot[Ze]}else{var De=ge[Ke===0?Ue:Ke===Ue?Ue+1:Ke===Ue-1?Ue-1:Ue]===Ne[xe];if(De){if(ae[qe++]=xe,++Ue,Ue===Le){ft=!0;break}++xe}else xe=ot[xe]}{if(ft)var Ge=ae,et=qe;else var Ge=ue,et=be;for(var tt=0,Ye=-1,at=0;at<Le;++at){var xe=Ge[at];Ye!==xe-1&&(tt-=xe),Ye=xe}ft?Ke!==0&&(tt+=-20):(tt*=1e3,Se!==0&&(tt+=-20)),tt-=Oe-Le,_e.score=tt,_e.indexes=new Array(et);for(var at=et-1;at>=0;--at)_e.indexes[at]=Ge[at];return _e}},algorithmNoTypo:function(ge,_e,Te){for(var Ne=_e._targetLowerCodes,Le=ge.length,Oe=Ne.length,De=0,xe=0,Se=0;;){var be=Te===Ne[xe];if(be){if(ue[Se++]=xe,++De,De===Le)break;Te=ge[De]}if(++xe,xe>=Oe)return null}var De=0,Me=!1,Ue=0,Ke=_e._nextBeginningIndexes;if(Ke===null&&(Ke=_e._nextBeginningIndexes=we.prepareNextBeginningIndexes(_e.target)),xe=ue[0]===0?0:Ke[ue[0]-1],xe!==Oe)for(;;)if(xe>=Oe){if(De<=0)break;--De;var ft=ae[--Ue];xe=Ke[ft]}else{var be=ge[De]===Ne[xe];if(be){if(ae[Ue++]=xe,++De,De===Le){Me=!0;break}++xe}else xe=Ke[xe]}{if(Me)var qe=ae,ot=Ue;else var qe=ue,ot=Se;for(var nt=0,Ze=-1,Ge=0;Ge<Le;++Ge){var xe=qe[Ge];Ze!==xe-1&&(nt-=xe),Ze=xe}Me||(nt*=1e3),nt-=Oe-Le,_e.score=nt,_e.indexes=new Array(ot);for(var Ge=ot-1;Ge>=0;--Ge)_e.indexes[Ge]=qe[Ge];return _e}},prepareLowerCodes:function(ge){for(var _e=ge.length,Te=[],Ne=ge.toLowerCase(),Le=0;Le<_e;++Le)Te[Le]=Ne.charCodeAt(Le);return Te},prepareBeginningIndexes:function(ge){for(var _e=ge.length,Te=[],Ne=0,Le=!1,Oe=!1,xe=0;xe<_e;++xe){var Se=ge.charCodeAt(xe),be=Se>=65&&Se<=90,De=be||Se>=97&&Se<=122||Se>=48&&Se<=57,Me=be&&!Le||!Oe||!De;Le=be,Oe=De,Me&&(Te[Ne++]=xe)}return Te},prepareNextBeginningIndexes:function(ge){for(var _e=ge.length,Te=we.prepareBeginningIndexes(ge),Ne=[],Le=Te[0],Oe=0,xe=0;xe<_e;++xe)Le>xe?Ne[xe]=Le:(Le=Te[++Oe],Ne[xe]=Le===void 0?_e:Le);return Ne},cleanup:se,new:re};return we}var ne=typeof commonjsRequire<"u"&&typeof window>"u",ie=new Map,oe=new Map,fe=[];fe.total=0;var ue=[],ae=[];function se(){ie.clear(),oe.clear(),ue=[],ae=[]}function ce(ve){for(var we=-9007199254740991,ge=ve.length-1;ge>=0;--ge){var _e=ve[ge];if(_e!==null){var Te=_e.score;Te>we&&(we=Te)}}return we===-9007199254740991?null:we}function le(ve,we){var ge=ve[we];if(ge!==void 0)return ge;var _e=we;Array.isArray(we)||(_e=we.split("."));for(var Te=_e.length,Ne=-1;ve&&++Ne<Te;)ve=ve[_e[Ne]];return ve}function pe(ve){return typeof ve=="object"}var de=function(){var ve=[],we=0,ge={};function _e(){for(var Te=0,Ne=ve[Te],Le=1;Le<we;){var Oe=Le+1;Te=Le,Oe<we&&ve[Oe].score<ve[Le].score&&(Te=Oe),ve[Te-1>>1]=ve[Te],Le=1+(Te<<1)}for(var xe=Te-1>>1;Te>0&&Ne.score<ve[xe].score;xe=(Te=xe)-1>>1)ve[Te]=ve[xe];ve[Te]=Ne}return ge.add=function(Te){var Ne=we;ve[we++]=Te;for(var Le=Ne-1>>1;Ne>0&&Te.score<ve[Le].score;Le=(Ne=Le)-1>>1)ve[Ne]=ve[Le];ve[Ne]=Te},ge.poll=function(){if(we!==0){var Te=ve[0];return ve[0]=ve[--we],_e(),Te}},ge.peek=function(Te){if(we!==0)return ve[0]},ge.replaceTop=function(Te){ve[0]=Te,_e()},ge},me=de();return re()})})(fuzzysort$1);var fuzzysortExports=fuzzysort$1.exports;const fuzzysort=getDefaultExportFromCjs(fuzzysortExports);export{$,A$2 as A,D,En as E,F$1 as F,K$1 as K,M,O,Provider as P,React as R,T$1 as T,_extends$1 as _,_ as a,_$1 as b,_objectWithoutPropertiesLoose as c,d$1 as d,_n as e,Rn as f,getAugmentedNamespace as g,_toPropertyKey as h,E$1 as i,createStore as j,k$5 as k,l$4 as l,mn as m,Model as n,connect as o,commonjsGlobal as p,q$4 as q,commonjsRequire as r,getDefaultExportFromCjs as s,FlexSearch as t,fuzzysort as u,x$3 as v,__vitePreload as w,x$2 as x,y$1 as y};
